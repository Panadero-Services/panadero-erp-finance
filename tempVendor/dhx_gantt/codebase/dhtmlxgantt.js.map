{"version":3,"file":"dhtmlxgantt.js","sources":["../sources/ext/auto_scheduling_configs.js","../sources/core/relations/links_common.js","../sources/utils/helpers.js","../sources/core/relations/graph_helper.js","../sources/core/relations/links_builder.js","../sources/ext/auto_scheduling/constraint_types.ts","../sources/core/ui/utils/dom_helpers.js","../sources/ext/auto_scheduling/task_plan.ts","../sources/ext/auto_scheduling/constraints.ts","../sources/ext/auto_scheduling/date_comparator.ts","../sources/ext/auto_scheduling/alap_strategy.ts","../sources/ext/auto_scheduling/asap_strategy.ts","../sources/ext/auto_scheduling/planner.ts","../sources/ext/auto_scheduling/connected_groups.ts","../sources/ext/auto_scheduling/loops_finder.ts","../sources/ext/auto_scheduling/ui_handlers.ts","../sources/utils/global.js","../sources/ext/click_drag/eventsManager.ts","../sources/utils/eventable.js","../sources/ext/click_drag/selectedRegion.ts","../sources/ext/drag_timeline/eventsManager.ts","../sources/ext/keyboard_navigation/modals.js","../sources/ext/quick_info/quickInfo.ts","../sources/utils/utils.js","../sources/core/ui/utils/dom_event_scope.js","../sources/ext/tooltip/tooltip.ts","../sources/ext/tooltip/tooltipManager.ts","../sources/ext/undo/monitor.ts","../sources/ext/undo/undo.ts","../sources/ext/extensions_all.ts","../sources/ext/auto_scheduling.js","../sources/ext/click_drag/index.ts","../sources/ext/critical_path.js","../sources/ext/critical_path/slack.js","../sources/ext/critical_path/critical_path.js","../sources/ext/drag_timeline/index.ts","../sources/ext/fullscreen/index.ts","../sources/ext/keyboard_navigation.js","../sources/ext/keyboard_navigation/common/keyboard_shortcuts.js","../sources/ext/keyboard_navigation/common/eventhandler.js","../sources/ext/keyboard_navigation/common/trap_modal_focus.js","../sources/ext/keyboard_navigation/elements/gantt_node.js","../sources/ext/keyboard_navigation/elements/nav_node.js","../sources/ext/keyboard_navigation/elements/header_cell.js","../sources/ext/keyboard_navigation/elements/task_row.js","../sources/ext/keyboard_navigation/elements/task_cell.js","../sources/ext/keyboard_navigation/core.js","../sources/ext/quick_info/index.ts","../sources/ext/tooltip/index.ts","../sources/ext/undo/index.ts","../sources/ext/grouping.js","../sources/ext/marker.js","../sources/ext/multiselect.js","../sources/ext/overlay.js","../sources/ext/export_api/index.ts","../sources/constants/index.js","../sources/ext/extension_manager.ts","../sources/core/common/config.ts","../sources/utils/env.js","../sources/core/common/serialize.ts","../sources/core/common/ajax.js","../sources/core/common/date_parsers/fast_version.ts","../sources/core/common/date_parsers/csp_compliant_version.ts","../sources/core/common/date.js","../node_modules/remote-client/dist/remote.es6.js","../sources/core/remote/remote_events.js","../sources/utils/timeout.js","../sources/core/common/state.js","../sources/utils/promise.js","../sources/core/facades/datastore_tasks.js","../sources/core/datastore/power_array.js","../sources/utils/placeholder_task.js","../sources/core/datastore/datastore.js","../sources/core/datastore/treedatastore.js","../sources/utils/is_headless.js","../sources/core/datastore/datastore_render.js","../sources/core/facades/datastore.js","../sources/core/datastore/select.js","../sources/core/facades/datastore_links.js","../sources/core/ui/timeline/scales.js","../sources/core/ui/timeline/scales_ignore.js","../sources/core/gantt_data_range.js","../sources/utils/task_tree_helpers.js","../sources/core/dataprocessor/data_processor_events.ts","../sources/core/dataprocessor/simple_storage.ts","../sources/core/dataprocessor/data_processor.ts","../sources/core/dataprocessor/extend_gantt.ts","../sources/core/dataprocessor/index.js","../sources/core/plugins/batch_update.js","../sources/core/plugins/wbs.js","../sources/core/plugins/resources.js","../sources/core/plugins/resource_assignments.js","../sources/core/plugins/new_task_placeholder.js","../sources/core/plugins/auto_task_types.js","../sources/core/common/duration_formatter.ts","../sources/core/common/link_formatter_simple.ts","../sources/core/common/link_formatter.ts","../sources/core/plugins/formatters.js","../sources/core/plugins/empty_state_screen.ts","../sources/core/ui/render/baseline_helper.js","../sources/core/plugins/baselines.js","../sources/core/ui/row_position_mixin.js","../sources/core/ui/row_position_fixed_height.js","../sources/core/ui/plugins/column_grid_dnd/scrollable_grid.ts","../sources/core/ui/plugins/column_grid_dnd/column_grid_dnd.ts","../sources/core/ui/mouse_event_container.js","../sources/core/ui/grid/grid.js","../sources/core/loading/parsing.js","../sources/core/worktime/calendar_arguments_helper.js","../sources/core/ui/grid/grid_resize.js","../sources/core/ui/grid/task_grid_row_resize.js","../sources/core/worktime/strategy/work_calendar_merger.js","../sources/core/worktime/strategy/work_unit_cache/workunit_map_cache.ts","../sources/core/worktime/strategy/work_unit_cache/workunit_object_cache.ts","../sources/core/worktime/strategy/work_unit_cache/larger_units_helper.ts","../sources/core/worktime/strategy/work_unit_cache/date_duration_cache.ts","../sources/core/worktime/strategy/calendar_strategy.js","../sources/core/worktime/strategy/work_unit_cache/index.ts","../sources/core/worktime/legacy_resource_config.js","../sources/core/worktime/calendar_manager.js","../sources/core/worktime/dynamic_resource_calendars.js","../sources/core/worktime/strategy/no_work_time.js","../sources/core/worktime/time_calculator.js","../sources/core/facades/worktime_calendars.js","../sources/core/data.js","../sources/core/ui/resize_listener.js","../sources/core/gantt_core.js","../sources/core/common/assert.js","../sources/locale/locale_ar.ts","../sources/locale/locale_be.ts","../sources/locale/locale_ca.ts","../sources/locale/locale_cn.ts","../sources/locale/locale_cs.ts","../sources/locale/locale_da.ts","../sources/locale/locale_de.ts","../sources/locale/locale_el.ts","../sources/locale/locale_en.ts","../sources/locale/locale_es.ts","../sources/locale/locale_fa.ts","../sources/locale/locale_fi.ts","../sources/locale/locale_fr.ts","../sources/locale/locale_he.ts","../sources/locale/locale_hr.ts","../sources/locale/locale_hu.ts","../sources/locale/locale_id.ts","../sources/locale/locale_it.ts","../sources/locale/locale_jp.ts","../sources/locale/locale_kr.ts","../sources/locale/locale_manager.ts","../sources/locale/locale_nb.ts","../sources/locale/locale_nl.ts","../sources/locale/locale_no.ts","../sources/locale/locale_pl.ts","../sources/locale/locale_pt.ts","../sources/locale/locale_ro.ts","../sources/locale/locale_ru.ts","../sources/locale/locale_si.ts","../sources/locale/locale_sk.ts","../sources/locale/locale_sv.ts","../sources/locale/locale_tr.ts","../sources/locale/locale_ua.ts","../sources/factory/make_instance_common.js","../sources/core/common/services.js","../sources/core/common/dnd.js","../sources/core/common/templates.js","../sources/core/datastore/datastore_hooks.js","../sources/core/plugins/index.js","../sources/core/grid_column_api.js","../sources/core/grid_column_api.gpl.js","../sources/core/tasks.js","../sources/core/worktime/work_time.js","../sources/core/data_task_types.js","../sources/core/cached_functions.js","../sources/core/destructor.js","../sources/locale/index.ts","../sources/core/ui/message.js","../sources/core/ui/configurable.js","../sources/core/ui/ui_factory.js","../sources/core/ui/mouse.js","../sources/core/ui/render/viewport/is_in_viewport.js","../sources/core/ui/render/is_legacy_smart_render.js","../sources/core/ui/render/viewport/get_grid_row_rectangle.js","../sources/core/ui/render/viewport/get_visible_bars_range.js","../sources/core/ui/render/render_factory.js","../sources/core/ui/render/layer_engine.js","../sources/core/ui/render/viewport/get_bar_rectangle.js","../sources/core/ui/render/viewport/factory/get_visible_link_range.js","../sources/core/ui/render/viewport/get_link_rectangle.js","../sources/core/ui/render/viewport/is_link_in_viewport.js","../sources/core/ui/gantt_layers.js","../sources/core/ui/layout/cell.js","../sources/utils/extends.js","../sources/core/ui/layout/layout.js","../sources/core/ui/layout/view_layout.js","../sources/core/ui/layout/view_cell.js","../sources/core/ui/layout/resizer_cell.js","../sources/core/ui/layout/scrollbar_cell.js","../sources/core/ui/timeline/tasks_canvas_render.js","../sources/core/ui/timeline/timeline.js","../sources/core/ui/resource_store_mixin.js","../sources/core/ui/timeline/timeline_layers.js","../sources/core/ui/grid/resource_grid.js","../sources/core/ui/timeline/resource_timeline.js","../sources/core/ui/timeline/resource_histogram.js","../sources/core/ui/grid/editors/keyboard_mappings/default.js","../sources/core/ui/grid/editors/keyboard_mappings/keyboard_navigation.js","../sources/core/ui/grid/editors/editors/base.js","../sources/core/ui/grid/editors/editors/text.js","../sources/core/ui/grid/editors/editors/number.js","../sources/core/ui/grid/editors/editors/select.js","../sources/core/ui/grid/editors/editors/date.js","../sources/core/ui/grid/editors/editors/predecessor.js","../sources/core/ui/grid/editors/editors/duration.js","../sources/core/ui/grid/editors/linked_properties.js","../sources/core/ui/grid/editors/controller.js","../sources/core/ui/grid/editors/keyboard_mappings.js","../sources/core/ui/render/viewport/is_bar_in_viewport.js","../sources/core/ui/render/task_bar_render.js","../sources/core/ui/render/viewport/is_project_bar_in_viewport.js","../sources/core/ui/render/task_project_render.js","../sources/core/ui/render/viewport/is_split_task_in_viewport.js","../sources/core/ui/render/viewport/get_bg_row_rectangle.js","../sources/core/ui/render/viewport/get_visible_cells_range.js","../sources/core/ui/render/viewport/is_column_visible.js","../sources/core/ui/render/prerender/task_bg_placeholder.js","../sources/core/ui/render/link_render.js","../sources/core/ui/render/viewport/is_grid_row_in_viewport.js","../sources/core/resource_timetable_builder.js","../sources/core/ui/render/resource_histogram_render.js","../sources/core/ui/render/viewport/are_dates_in_viewport.js","../sources/core/ui/render/task_constraints_render.js","../sources/core/ui/render/task_deadline_render.js","../sources/core/ui/render/task_baselines_render.js","../sources/core/ui/grid/tasks_grid_dnd.js","../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/drop_target.js","../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/locked_level.js","../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/highlight.js","../sources/core/ui/grid/tasks_grid_dnd_marker.js","../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/multi_level.js","../sources/core/ui/grid/main_grid_initializer.js","../sources/core/ui/timeline/tasks_dnd.js","../sources/core/ui/timeline/links_dnd.js","../sources/core/ui/timeline/main_timeline_initializer.js","../sources/core/ui/main_layout_initializer.js","../sources/core/ui/index.js","../sources/core/ui/render/task_grid_line_render.js","../sources/core/ui/render/task_bg_render.js","../sources/core/ui/render/task_bar_smart_render.js","../sources/core/ui/render/task_project_smart_render.js","../sources/core/ui/render/task_rollup_render.js","../sources/core/ui/render/task_split_render.js","../sources/core/ui/render/resource_matrix_render.js","../sources/core/ui/render/task_grid_row_resize_render.js","../sources/core/ui/skin.js","../sources/core/ui/plugins/autoscroll.js","../sources/core/ui/plugins/jquery_hooks.js","../sources/core/ui/plugins/dhtmlx_hooks.js","../sources/core/ui/plugins/timeline_zoom.ts","../sources/core/ui/touch.js","../sources/core/ui/lightbox/controls/base_control.js","../sources/core/ui/utils/html_helpers.js","../sources/core/ui/lightbox/controls/select_control.js","../sources/core/common/duration_formatter_numeric.ts","../sources/core/ui/lightbox/controls/parent_control.js","../sources/core/ui/lightbox/controls/resources_control.js","../sources/core/ui/lightbox/index.js","../sources/core/ui/lightbox/controls/template_control.js","../sources/core/ui/lightbox/controls/textarea_control.js","../sources/core/ui/lightbox/controls/time_control.js","../sources/core/ui/lightbox/controls/checkbox_control.js","../sources/core/ui/lightbox/controls/radio_control.js","../sources/core/ui/lightbox/controls/duration_control.js","../sources/core/ui/lightbox/controls/constraint_control.js","../sources/core/ui/lightbox/controls/typeselect_control.js","../sources/core/ui/lightbox/controls/baseline_control.js","../sources/core/ui_core.js","../sources/core/facades/layout.js","../sources/css/skins/skyblue.js","../sources/css/skins/dark.js","../sources/css/skins/meadow.js","../sources/css/skins/terrace.js","../sources/css/skins/broadway.js","../sources/css/skins/material.js","../sources/css/skins/contrast_black.js","../sources/css/skins/contrast_white.js","../sources/core/ui/plugins/index.js","../sources/core/ui/lightbox/lightbox_optional_time.js","../sources/core/ui/wai_aria.js","../sources/core/loading/dynamic_loading.js","../sources/dhtmlxgantt.web.single.ts","../sources/factory/make_instance_web.js","../sources/core/loading/ajax_loading.js","../sources/dhtmlxgantt.individual.ts"],"sourcesContent":["export default function(gantt) {\n\tgantt.config.auto_scheduling_use_progress = false;\n\tgantt.config.auto_scheduling_project_constraint = false;\n\n};\n\n","export default function (gantt) {\n\t// helpers for building chain of dependencies, used for critical path calculation and for auto scheduling\n\n\tgantt._get_linked_task = function (link, getTarget) {\n\t\tvar task = null;\n\t\tvar taskId = getTarget ? link.target : link.source;\n\n\t\tif (gantt.isTaskExists(taskId)) {\n\t\t\ttask = gantt.getTask(taskId);\n\t\t}\n\n\t\treturn task;\n\t};\n\tgantt._get_link_target = function (link) {\n\t\treturn gantt._get_linked_task(link, true);\n\t};\n\n\tgantt._get_link_source = function (link) {\n\t\treturn gantt._get_linked_task(link, false);\n\t};\n\n\tvar caching = false;\n\tvar formattedLinksStash = {};\n\tvar inheritedSuccessorsStash = {};\n\tvar inheritedPredecessorsStash = {};\n\tvar getPredecessorsCache = {};\n\n\n\tgantt._isLinksCacheEnabled = function () {\n\t\treturn caching;\n\t};\n\tgantt._startLinksCache = function () {\n\t\tformattedLinksStash = {};\n\t\tinheritedSuccessorsStash = {};\n\t\tinheritedPredecessorsStash = {};\n\t\tgetPredecessorsCache = {};\n\t\tcaching = true;\n\t};\n\tgantt._endLinksCache = function () {\n\t\tformattedLinksStash = {};\n\t\tinheritedSuccessorsStash = {};\n\t\tinheritedPredecessorsStash = {};\n\t\tgetPredecessorsCache = {};\n\t\tcaching = false;\n\t};\n\n\tfunction isManuallyScheduledSummary(task){\n\t\treturn gantt.isSummaryTask(task) && task.auto_scheduling === false;\n\t}\n\n\tgantt._formatLink = function (link, sourceDates, targetDates) {\n\n\n\t\tif (caching && formattedLinksStash[link.id]) {\n\t\t\treturn formattedLinksStash[link.id];\n\t\t}\n\n\t\tvar relations = [];\n\t\tvar target = this._get_link_target(link);\n\t\tvar source = this._get_link_source(link);\n\n\t\tif (!(source && target)) {\n\t\t\treturn relations;\n\t\t}\n\n\t\tif ((gantt.isSummaryTask(target) && gantt.isChildOf(source.id, target.id)) || (gantt.isSummaryTask(source) && gantt.isChildOf(target.id, source.id))) {\n\t\t\treturn relations;\n\t\t}\n\n\t\tvar backwardsScheduling = gantt.config.schedule_from_end && gantt.config.project_end;\n\t\tvar respectTargetOffset = gantt.config.auto_scheduling_move_projects;\n\t\tif(!gantt.config.auto_scheduling_compatibility && gantt.config.auto_scheduling_strict){\n\t\t\trespectTargetOffset = false;\n\t\t}\n\n\n\n\t\t// there are three kinds of connections at this point\n\t\t// task -> task - regular link\n\t\t// task -> project - transform it into set of regular links (task -> [each subtask]), use offset beetween subtask and project dates as lag, in order not to change mutual positions of subtasks inside a project\n\t\t// project -> task - transform it into ([each subtask] -> task) links\n\t\t// project -> project - transform it into ([each subtask of p1] -> [each subtask of p2]) links\n\t\tsourceDates = sourceDates || (this.isSummaryTask(source) && !isManuallyScheduledSummary(source)) ? this.getSubtaskDates(source.id) : {\n\t\t\tstart_date: source.start_date,\n\t\t\tend_date: source.end_date\n\t\t};\n\n\t\tvar from = this._getImplicitLinks(link, source, function (c) {\n\t\t\tif(!respectTargetOffset || !backwardsScheduling){\n\t\t\t\treturn 0;\t\n\t\t\t}else{\n\t\t\t\tif (!c.$source.length && !(gantt.getState(\"tasksDnd\").drag_id == c.id)) {\n\t\t\t\t\t// drag_id - virtual lag shouldn't restrict task that is being moved inside project\n\t\t\t\t\treturn gantt.calculateDuration({\n\t\t\t\t\t\tstart_date: c.end_date,\n\t\t\t\t\t\tend_date: sourceDates.end_date,\n\t\t\t\t\t\ttask: source\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}, true);\n\n\t\tif (!targetDates){\n\t\t\ttargetDates = {\n\t\t\t\tstart_date: target.start_date,\n\t\t\t\tend_date: target.end_date\n\t\t\t};\n\t\t\tif (this.isSummaryTask(target) && !isManuallyScheduledSummary(target)){\n\t\t\t\ttargetDates = this.getSubtaskDates(target.id);\n\t\t\t\ttargetDates.start_date = targetDates.end_date;\n\t\t\t\t// GS-2427. When a successor starts earlier its predecessor, we should\n\t\t\t\t// obtain the dates of the predecessor\n\t\t\t\tthis.eachTask(function(child){\n\t\t\t\t\t// exclude projects as their dates are unreliable until the scheduling is done\n\t\t\t\t\tif (child.type === this.config.types.project){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (!child.$target.length && child.start_date < targetDates.start_date){\n\t\t\t\t\t\ttargetDates.start_date = child.start_date;\n\t\t\t\t\t}\n\t\t\t\t},target.id);\n\t\t\t}\n\t\t}\n\n\t\tvar to = this._getImplicitLinks(link, target, function (actualTarget) {\n\t\t\tif (!respectTargetOffset || backwardsScheduling) {\n\t\t\t\treturn 0;\n\t\t\t} else {\n\t\t\t\tif (!actualTarget.$target.length && !(gantt.getState(\"tasksDnd\").drag_id == actualTarget.id)) {// drag_id - virtual lag shouldn't restrict task that is being moved inside project\n\t\t\t\t\treturn gantt.calculateDuration({\n\t\t\t\t\t\tstart_date: targetDates.start_date,\n\t\t\t\t\t\tend_date: actualTarget.start_date,\n\t\t\t\t\t\ttask: target\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tfor (var i = 0, fromLength = from.length; i < fromLength; i++) {\n\t\t\tvar fromTask = from[i];\n\t\t\tfor (var j = 0, toLength = to.length; j < toLength; j++) {\n\t\t\t\tvar toTask = to[j];\n\n\t\t\t\tvar lag = fromTask.lag * 1 + toTask.lag * 1;\n\n\t\t\t\tvar subtaskLink = {\n\t\t\t\t\tid: link.id,\n\t\t\t\t\ttype: link.type,\n\t\t\t\t\tsource: fromTask.task,\n\t\t\t\t\ttarget: toTask.task,\n\t\t\t\t\tsubtaskLink: fromTask.subtaskLink,\n\t\t\t\t\tlag: (link.lag * 1 || 0) + lag\n\t\t\t\t};\n\n\t\t\t\tgantt._linkedTasks[subtaskLink.target] = gantt._linkedTasks[subtaskLink.target] || {};\n\t\t\t\tgantt._linkedTasks[subtaskLink.target][subtaskLink.source] = true;\n\n\t\t\t\trelations.push(gantt._convertToFinishToStartLink(toTask.task, subtaskLink, source, target, fromTask.taskParent, toTask.taskParent));\n\t\t\t}\n\t\t}\n\n\t\tif (caching)\n\t\t\tformattedLinksStash[link.id] = relations;\n\n\t\treturn relations;\n\t};\n\n\tgantt._isAutoSchedulable = function (task) {\n\t\tconst scheduleTask = task.auto_scheduling !== false && task.unscheduled !== true;\n\t\tif (!scheduleTask){\n\t\t\treturn false;\n\t\t}\n\t\t// GS-2420. Don't auto-schedule project when it has only unscheduled children\n\t\tif (this.isSummaryTask(task)){\n\t\t\tlet unscheduledChildren = true;\n\t\t\tthis.eachTask(function(child){\n\t\t\t\tif (unscheduledChildren){\n\t\t\t\t\tconst scheduleChild = gantt._isAutoSchedulable(child);\n\t\t\t\t\tif (scheduleChild){\n\t\t\t\t\t\tunscheduledChildren = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, task.id);\n\t\t\tif (unscheduledChildren){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t};\n\n\tgantt._getImplicitLinks = function (link, parent, selectOffset, selectSourceLinks) {\n\t\tvar relations = [];\n\n\t\tif (this.isSummaryTask(parent) && !isManuallyScheduledSummary(parent)) {\n\n\t\t\t// if the summary task contains multiple chains of linked tasks - no need to consider every task of the chain,\n\t\t\t// it will be enough to check the first/last tasks of the chain\n\t\t\t// special conditions if there are unscheduled tasks in the chain, or negative lag values that put the end date of the successor task prior to its predecessors' date\n\t\t\tvar children = {};\n\t\t\tthis.eachTask(function (c) {\n\t\t\t\tif (!this.isSummaryTask(c) || isManuallyScheduledSummary(c)) {\n\t\t\t\t\tchildren[c.id] = c;\n\t\t\t\t}\n\t\t\t}, parent.id);\n\n\t\t\tvar skipChild;\n\n\t\t\tfor (var c in children) {\n\t\t\t\tvar task = children[c];\n\t\t\t\t// don't create subtask links with unscheduled tasks\n\t\t\t\tif (!gantt._isAutoSchedulable(task)){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tvar linksCollection = selectSourceLinks ? task.$source : task.$target;\n\n\t\t\t\tskipChild = false;\n\n\t\t\t\tfor (var l = 0; l < linksCollection.length; l++) {\n\t\t\t\t\t// GS-2014 and GS-2588. If the link type is SS or SF, we shouldn't change the skipChild variable\n\t\t\t\t\t// because the target task should be moved to an earlier date\n\t\t\t\t\tif (link.type == gantt.config.links.start_to_start || link.type == gantt.config.links.start_to_finish){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tvar siblingLink = gantt.getLink(linksCollection[l]);\n\t\t\t\t\tvar siblingId = selectSourceLinks ? siblingLink.target : siblingLink.source;\n\t\t\t\t\tvar siblingTask = children[siblingId];\n\t\t\t\t\tif (siblingTask && gantt._isAutoSchedulable(task) && gantt._isAutoSchedulable(siblingTask)) {\n\t\t\t\t\t\tlet linkLag = 0;\n\t\t\t\t\t\tif (siblingLink.lag){\n\t\t\t\t\t\t\tlinkLag = Math.abs(siblingLink.lag);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// GS-2014 and GS-2588. If the link type is not FS, the actual lag will be different\n\t\t\t\t\t\tif (siblingLink.type != gantt.config.links.finish_to_start){\n\t\t\t\t\t\t\tlinkLag += gantt._convertToFinishToStartLink(null, {}, task, siblingTask).additionalLag;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst sameTarget = siblingLink.target == siblingTask.id;\n\t\t\t\t\t\tconst insignificantTargetLag = sameTarget && linkLag && linkLag <= siblingTask.duration;\n\n\t\t\t\t\t\tconst sameSource = siblingLink.target == task.id;\n\t\t\t\t\t\tconst insignificantSourceLag = sameSource && linkLag && linkLag <= task.duration;\n\n\t\t\t\t\t\tif (insignificantTargetLag || insignificantSourceLag) {\n\t\t\t\t\t\t\tskipChild = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!skipChild) {\n\t\t\t\t\t// GS-1689. If a task has links between other tasks within the project,\n\t\t\t\t\t// Gantt shouldn't try to keep the position within the project\n\t\t\t\t\tlet calculateLag = true;\n\t\t\t\t\tfor (const predecessorId in gantt._linkedTasks[task.id]){\n\t\t\t\t\t\tif (gantt.isChildOf(predecessorId, link.target)){\n\t\t\t\t\t\t\tcalculateLag = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlet offsetLag = 0;\n\t\t\t\t\tif (calculateLag) {\n\t\t\t\t\t\toffsetLag = selectOffset(task);\n\t\t\t\t\t}\n\t\t\t\t\trelations.push({ task: task.id, taskParent: task.parent, lag: offsetLag, subtaskLink: true });\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\t\t\trelations.push({ task: parent.id, taskParent: parent.parent, lag: 0 });\n\t\t}\n\n\t\treturn relations;\n\t};\n\n\tgantt._getDirectDependencies = function (task, selectSuccessors) {\n\t\tgantt._linkedTasks = gantt._linkedTasks || {};\n\n\t\tvar links = [],\n\t\t\tsuccessors = [];\n\n\t\tvar linksIds = selectSuccessors ? task.$source : task.$target;\n\n\t\tfor (var i = 0; i < linksIds.length; i++) {\n\t\t\tvar link = this.getLink(linksIds[i]);\n\t\t\tif (this.isTaskExists(link.source) && this.isTaskExists(link.target)) {\n\t\t\t\tvar target = this.getTask(link.target);\n\t\t\t\tif (!this._isAutoSchedulable(target) || !this._isAutoSchedulable(task)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t} else if(gantt.config.auto_scheduling_use_progress) {\n\t\t\t\t\tif(target.progress == 1){\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tlinks.push(link);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tlinks.push(link);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\tsuccessors = successors.concat(this._formatLink(links[i]));\n\t\t}\n\n\t\treturn successors;\n\t};\n\n\tgantt._getInheritedDependencies = function (task, selectSuccessors) {\n\n\t\t//var successors = [];\n\t\tvar stop = false;\n\t\tvar inheritedRelations = [];\n\t\tvar cacheCollection;\n\t\tif (this.isTaskExists(task.id)) {\n\t\t\tthis.eachParent(function (parent) {\n\t\t\t\tif (stop)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (caching) {\n\t\t\t\t\tcacheCollection = selectSuccessors ? inheritedSuccessorsStash : inheritedPredecessorsStash;\n\t\t\t\t\tif (cacheCollection[parent.id]) {\n\t\t\t\t\t\tinheritedRelations = inheritedRelations.concat(cacheCollection[parent.id]);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar parentDependencies;\n\t\t\t\tif (this.isSummaryTask(parent)) {\n\t\t\t\t\tif (!this._isAutoSchedulable(parent)) {\n\t\t\t\t\t\tstop = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparentDependencies = this._getDirectDependencies(parent, selectSuccessors);\n\t\t\t\t\t\tif (caching) {\n\t\t\t\t\t\t\tcacheCollection[parent.id] = parentDependencies;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tinheritedRelations = inheritedRelations.concat(parentDependencies);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}, task.id, this);\n\t\t}\n\n\t\treturn inheritedRelations;\n\t};\n\n\n\tgantt._getDirectSuccessors = function (task) {\n\t\treturn this._getDirectDependencies(task, true);\n\t};\n\n\tgantt._getInheritedSuccessors = function (task) {\n\t\treturn this._getInheritedDependencies(task, true);\n\t};\n\n\tgantt._getDirectPredecessors = function (task) {\n\t\treturn this._getDirectDependencies(task, false);\n\t};\n\n\tgantt._getInheritedPredecessors = function (task) {\n\t\treturn this._getInheritedDependencies(task, false);\n\t};\n\n\tgantt._getSuccessors = function (task, skipInherited) {\n\t\tvar successors = this._getDirectSuccessors(task);\n\t\tif (skipInherited) {\n\t\t\treturn successors;\n\t\t} else {\n\t\t\treturn successors.concat(this._getInheritedSuccessors(task));\n\t\t}\n\t};\n\n\tgantt._getPredecessors = function (task, skipInherited) {\n\t\tvar key = String(task.id) + \"-\" + String(skipInherited);\n\t\tvar result;\n\n\t\tif (caching && getPredecessorsCache[key]) {\n\t\t\treturn getPredecessorsCache[key];\n\t\t}\n\n\t\tvar predecessors = this._getDirectPredecessors(task);\n\t\tif (skipInherited) {\n\t\t\tresult = predecessors;\n\t\t} else {\n\t\t\tresult = predecessors.concat(this._getInheritedPredecessors(task));\n\t\t}\n\t\tif (caching) {\n\t\t\tgetPredecessorsCache[key] = result;\n\t\t}\n\t\treturn result;\n\t};\n\n\n\tgantt._convertToFinishToStartLink = function (id, link, sourceTask, targetTask, sourceParent, targetParent) {\n\t\t// convert finish-to-finish, start-to-finish and start-to-start to finish-to-start link and provide some additional properties\n\t\tvar res = {\n\t\t\ttarget: id,\n\t\t\tlink: gantt.config.links.finish_to_start,\n\t\t\tid: link.id,\n\t\t\tlag: link.lag || 0,\n\t\t\tsourceLag: 0,\n\t\t\ttargetLag: 0,\n\t\t\ttrueLag: link.lag || 0,\n\t\t\tsource: link.source,\n\t\t\tpreferredStart: null,\n\t\t\tsourceParent: sourceParent,\n\t\t\ttargetParent: targetParent,\n\t\t\thashSum: null,\n\t\t\tsubtaskLink: link.subtaskLink\n\t\t};\n\t\t// GS-148: switch uses strict comparison, so we need to convert the values to the same type\n\t\tvar additionalLag = 0;\n\t\tswitch (String(link.type)) {\n\t\t\tcase String(gantt.config.links.start_to_start):\n\t\t\t\tadditionalLag = -sourceTask.duration;\n\t\t\t\tres.sourceLag = additionalLag;\n\t\t\t\tbreak;\n\t\t\tcase String(gantt.config.links.finish_to_finish):\n\t\t\t\tadditionalLag = -targetTask.duration;\n\t\t\t\tres.targetLag = additionalLag;\n\t\t\t\tbreak;\n\t\t\tcase String(gantt.config.links.start_to_finish):\n\t\t\t\tadditionalLag = -sourceTask.duration - targetTask.duration;\n\t\t\t\tres.sourceLag = -sourceTask.duration;\n\t\t\t\tres.targetLag = -targetTask.duration;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tadditionalLag = 0;\n\t\t}\n\n\t\tres.lag += additionalLag;\n\t\tres.hashSum = res.lag + \"_\" + res.link + \"_\" + res.source + \"_\" + res.target;\n\t\treturn res;\n\t};\n};","var units = {\n\t\"second\": 1,\n\t\"minute\": 60,\n\t\"hour\": 60 * 60,\n\t\"day\": 60 * 60 * 24,\n\t\"week\": 60 * 60 * 24 * 7,\n\t\"month\": 60 * 60 * 24 * 30,\n\t\"quarter\": 60 * 60 * 24 * 30 * 3,\n\t\"year\": 60 * 60 * 24 * 365\n};\nfunction getSecondsInUnit(unit){\n\treturn units[unit] || units.hour;\n}\n\nfunction forEach(arr, callback) {\n\tif (arr.forEach) {\n\t\tarr.forEach(callback);\n\t} else {\n\t\tvar workArray = arr.slice();\n\t\tfor (var i = 0; i < workArray.length; i++) {\n\t\t\tcallback(workArray[i], i);\n\t\t}\n\t}\n}\n\nfunction arrayMap(arr, callback) {\n\tif (arr.map) {\n\t\treturn arr.map(callback);\n\t} else {\n\t\tvar workArray = arr.slice();\n\t\tvar resArray = [];\n\n\t\tfor (var i = 0; i < workArray.length; i++) {\n\t\t\tresArray.push(callback(workArray[i], i));\n\t\t}\n\t\treturn resArray;\n\t}\n}\n\n\nfunction arrayFind(arr, callback) {\n\tif (arr.find) {\n\t\treturn arr.find(callback);\n\t} else {\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tif (callback(arr[i], i)) {\n\t\t\t\treturn arr[i];\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction arrayIncludes(arr, item) {\n\tif(arr.includes){\n\t\treturn arr.includes(item);\n\t}else{\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tif (arr[i] === item) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n\n// iframe-safe array type check instead of using instanceof\nfunction isArray(obj){\n\tif(Array.isArray){\n\t\treturn Array.isArray(obj);\n\t}else{\n\t\t// close enough\n\t\treturn (obj && obj.length !== undefined && obj.pop && obj.push);\n\t}\n}\n\n// non-primitive string object, e.g. new String(\"abc\")\nfunction isStringObject(obj){\n\treturn obj && typeof obj === \"object\"\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function String() { [native code] }\";\n}\n\n// non-primitive number object, e.g. new Number(5)\nfunction isNumberObject(obj){\n\treturn obj && typeof obj === \"object\"\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function Number() { [native code] }\";\n}\n\n// non-primitive number object, e.g. new Boolean(true)\nfunction isBooleanObject(obj){\n\treturn obj && typeof obj === \"object\"\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function Boolean() { [native code] }\";\n}\n\nfunction isDate(obj) {\n\tif (obj && typeof obj === \"object\") {\n\t\treturn !!(obj.getFullYear && obj.getMonth && obj.getDate);\n\t} else {\n\t\treturn false;\n\t}\n}\n\nfunction isValidDate(obj){\n\treturn isDate(obj) && !isNaN(obj.getTime());\n}\n\nfunction arrayFilter(arr, callback) {\n\tvar result = [];\n\n\tif (arr.filter) {\n\t\treturn arr.filter(callback);\n\t} else {\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tif (callback(arr[i], i)) {\n\t\t\t\tresult[result.length] = arr[i];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\nfunction hashToArray(hash) {\n\tvar result = [];\n\n\tfor (var key in hash) {\n\t\tif (hash.hasOwnProperty(key)) {\n\t\t\tresult.push(hash[key]);\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction arraySome(arr, callback) {\n\tif (arr.length === 0) return false;\n\n\tfor (var i = 0; i < arr.length; i++) {\n\t\tif (callback(arr[i], i, arr)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction arrayDifference(arr, callback) {\n\treturn arrayFilter(arr, function(item, i) {\n\t\treturn !callback(item, i);\n\t});\n}\n\nfunction throttle (callback, timeout) {\n\tvar wait = false;\n\n\treturn function () {\n\t\tif (!wait) {\n\t\t\tcallback.apply(null, arguments);\n\t\t\twait = true;\n\t\t\tsetTimeout(function () {\n\t\t\t\twait = false;\n\t\t\t}, timeout);\n\t\t}\n\t};\n}\n\nfunction delay (callback, timeout){\n\tvar timer;\n\n\tvar result = function() {\n\t\tresult.$cancelTimeout();\n\t\tresult.$pending = true;\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\ttimer = setTimeout(function(){\n\t\t\tcallback.apply(this, args);\n\t\t\tresult.$pending = false;\n\t\t}, timeout);\n\t};\n\n\tresult.$pending = false;\n\tresult.$cancelTimeout = function(){\n\t\tclearTimeout(timer);\n\t\tresult.$pending = false;\n\t};\n\tresult.$execute = function(){\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\tcallback.apply(this, args);\n\t\tresult.$cancelTimeout();\n\t};\n\n\treturn result;\n}\n\nfunction sortArrayOfHash(arr, field, desc) {\n\tvar compare = function(a, b) {\n\t\treturn a < b;\n\t};\n\n\tarr.sort(function(a, b) {\n\t\tif (a[field] === b[field]) return 0;\n\n\t\treturn desc ? compare(a[field], b[field]) : compare(b[field], a[field]);\n\t});\n}\n\nfunction objectKeys(obj) {\n\tif (Object.keys) {\n\t\treturn Object.keys(obj);\n\t}\n\tvar result = [];\n\tvar key;\n\tfor (key in obj) {\n\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction isEventable(obj) {\n\treturn obj.attachEvent && obj.detachEvent;\n}\n\n//GS-1090: A task should be able to have the id = 0\nfunction replaceValidZeroId(id, rootId) {\n\tif (checkZeroId(id) && !checkZeroId(rootId)){\n\t\tid = \"0\";\n\t}\n\treturn id;\n}\n\nfunction checkZeroId(id) {\n\tif (id === 0){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction findBinary(array, target) {\n\t// modified binary search, target value not exactly match array elements, looking for closest one\n\n\tvar low = 0, high = array.length - 1, i, item, prev;\n\twhile (low <= high) {\n\n\t\ti = Math.floor((low + high) / 2);\n\t\titem = +array[i];\n\t\tprev = +array[i - 1];\n\t\tif (item < target) {\n\t\t\tlow = i + 1;\n\t\t\tcontinue;\n\t\t}\n\t\tif (item > target) {\n\t\t\tif (!(!isNaN(prev) && prev < target)) {\n\t\t\t\thigh = i - 1;\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\t// if target is between 'i' and 'i-1' return 'i - 1'\n\t\t\t\treturn i - 1;\n\t\t\t}\n\n\t\t}\n\t\twhile (+array[i] == +array[i + 1]) i++;\n\n\t\treturn i;\n\t}\n\treturn array.length - 1;\n}\n\nexport {\n\tgetSecondsInUnit,\n\tforEach,\n\tarrayMap,\n\tarrayIncludes,\n\tarrayFind,\n\tarrayFilter,\n\tarrayDifference,\n\tarraySome,\n\thashToArray,\n\tsortArrayOfHash,\n\tthrottle,\n\tisArray,\n\tisDate,\n\tisValidDate,\n\tisStringObject,\n\tisNumberObject,\n\tisBooleanObject,\n\tdelay,\n\tobjectKeys,\n\tisEventable,\n\treplaceValidZeroId,\n\tcheckZeroId,\n\tfindBinary\n};","import * as helpers from \"../../utils/helpers\";\n\nexport default function(){\n\treturn {\n\t\tgetVertices: function(relations){\n\t\t\tvar ids = {};\n\t\t\tvar rel;\n\t\t\tfor(var i = 0, len = relations.length; i < len; i++){\n\t\t\t\trel = relations[i];\n\t\t\t\tids[rel.target] = rel.target;\n\t\t\t\tids[rel.source] = rel.source;\n\t\t\t}\n\n\t\t\tvar vertices = [];\n\t\t\tvar id;\n\t\t\tfor(var i in ids){\n\t\t\t\tid = ids[i];\n\t\t\t\tvertices.push(id);\n\t\t\t}\n\n\t\t\treturn vertices;\n\t\t},\n\t\ttopologicalSort: function(edges){\n\t\t\tvar vertices = this.getVertices(edges);\n\t\t\tvar hash = {};\n\n\t\t\tfor(var i = 0, len = vertices.length; i < len; i ++){\n\t\t\t\thash[vertices[i]] = {id: vertices[i], $source:[], $target:[], $incoming: 0};\n\t\t\t}\n\n\t\t\tfor(var i = 0, len = edges.length; i < len; i++){\n\t\t\t\tvar successor = hash[edges[i].target];\n\t\t\t\tsuccessor.$target.push(i);\n\t\t\t\tsuccessor.$incoming = successor.$target.length;\n\t\t\t\thash[edges[i].source].$source.push(i);\n\n\t\t\t}\n\n\t\t\t// topological sort, Kahn's algorithm\n\t\t\tvar S = vertices.filter(function(v){ return !hash[v].$incoming; });\n\n\t\t\tvar L = [];\n\n\t\t\twhile(S.length){\n\t\t\t\tvar n = S.pop();\n\n\t\t\t\tL.push(n);\n\n\t\t\t\tvar node = hash[n];\n\n\t\t\t\tfor(var i = 0; i < node.$source.length; i++){\n\t\t\t\t\tvar m = hash[edges[node.$source[i]].target];\n\t\t\t\t\tm.$incoming--;\n\t\t\t\t\tif(!m.$incoming){\n\t\t\t\t\t\tS.push(m.id);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn L;\n\n\t\t},\n\t\tgroupAdjacentEdges: function(edges){\n\t\t\tvar res = {};\n\t\t\tvar edge;\n\t\t\tfor(var i = 0, len = edges.length; i < len; i++){\n\t\t\t\tedge = edges[i];\n\t\t\t\tif(!res[edge.source]){\n\t\t\t\t\tres[edge.source] = [];\n\t\t\t\t}\n\t\t\t\tres[edge.source].push(edge);\n\t\t\t}\n\t\t\treturn res;\n\t\t},\n\t\ttarjanStronglyConnectedComponents: function(vertices, edges){\n\t\t\t//https://en.wikipedia.org/wiki/Tarjan%27s_strongly_connected_components_algorithm\n\t\t\t// iterative implementation\n\t\t\tvar verticesHash = {};\n\t\t\tvar stack = [];\n\t\t\tvar edgesFromTasks = this.groupAdjacentEdges(edges);\n\t\t\tvar recurse = false;\n\t\t\tvar connectedComponents = [];\n\n\t\t\tfor(var i = 0; i < vertices.length; i++){\n\t\t\t\tvar root = getVertex(vertices[i]);\n\t\t\t\tif(root.visited) continue;\n\t\t\t\tvar workStack = [root];\n\t\t\t\tvar index = 0;\n\t\t\t\twhile(workStack.length){\n\t\t\t\t\tvar v = workStack.pop();\n\n\t\t\t\t\tif(!v.visited){\n\t\t\t\t\t\tv.index = index;\n\t\t\t\t\t\tv.lowLink = index;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t\tstack.push(v);\n\t\t\t\t\t\tv.onStack = true;\n\t\t\t\t\t\tv.visited = true;\n\t\t\t\t\t}\n\t\t\t\t\trecurse = false;\n\t\t\t\t\tvar edges = edgesFromTasks[v.id] || [];\n\t\t\t\t\tfor(var e = 0; e < edges.length; e++){\n\t\t\t\t\t\tvar w = getVertex(edges[e].target);\n\t\t\t\t\t\tw.edge = edges[e];\n\t\t\t\t\t\tif(w.index === undefined){\n\t\t\t\t\t\t\tworkStack.push(v);\n\t\t\t\t\t\t\tworkStack.push(w);\n\t\t\t\t\t\t\trecurse = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}else if(w.onStack){\n\t\t\t\t\t\t\tv.lowLink = Math.min(v.lowLink, w.index);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(recurse)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (v.index == v.lowLink){\n\t\t\t\t\t\tvar com = {tasks:[], links:[], linkKeys:[]};\n\t\t\t\t\t\twhile(true){\n\t\t\t\t\t\t\tw = stack.pop();\n\t\t\t\t\t\t\tw.onStack = false;\n\t\t\t\t\t\t\tcom.tasks.push(w.id);\n\t\t\t\t\t\t\tif(w.edge){\n\t\t\t\t\t\t\t\tcom.links.push(w.edge.id);\n\t\t\t\t\t\t\t\tcom.linkKeys.push(w.edge.hashSum);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(w == v){\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconnectedComponents.push(com);\n\t\t\t\t\t}\n\t\t\t\t\tif(workStack.length){\n\t\t\t\t\t\tw = v;\n\t\t\t\t\t\tv = workStack[workStack.length - 1];\n\t\t\t\t\t\tv.lowLink = Math.min(v.lowLink, w.lowLink);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn connectedComponents;\n\n\t\t\tfunction getVertex(id){\n\t\t\t\tif(!verticesHash[id]){\n\t\t\t\t\tverticesHash[id] = {id: id, onStack:false, index: undefined, lowLink: undefined, edge: undefined};\n\t\t\t\t}\n\n\t\t\t\treturn verticesHash[id];\n\t\t\t}\n\t\t},\n\n\t\tfindLoops: function(relations){\n\t\t\tvar cycles = [];\n\n\t\t\thelpers.forEach(relations, function(rel){\n\t\t\t\tif(rel.target == rel.source)\n\t\t\t\t\tcycles.push({ tasks: [rel.source], links: [rel.id]});\n\t\t\t});\n\n\t\t\tvar vertices = this.getVertices(relations);\n\n\t\t\tvar connectedComponents = this.tarjanStronglyConnectedComponents(vertices, relations);\n\t\t\thelpers.forEach(connectedComponents, function(component){\n\t\t\t\tif(component.tasks.length > 1){\n\t\t\t\t\tcycles.push(component);//{ tasks: [task ids], links: [links ids]}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn cycles;\n\t\t\t//{task:id, link:link.type, lag: link.lag || 0, source: link.source}\n\t\t}\n\t};\n};","export default function(gantt) {\n\treturn {\n\t\tgetVirtualRoot: function(){\n\t\t\treturn gantt.mixin(\n\t\t\t\tgantt.getSubtaskDates(),\n\t\t\t\t{\n\t\t\t\t\tid: gantt.config.root_id,\n\t\t\t\t\ttype: gantt.config.types.project,\n\t\t\t\t\t$source: [],\n\t\t\t\t\t$target: [],\n\t\t\t\t\t$virtual: true\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\n\t\tgetLinkedTasks: function(id, includePredecessors){\n\t\t\tvar startIds = [id];\n\t\n\t\t\t//TODO: format links cache\n\t\t\tvar clearCache = false;\n\t\t\tif(!gantt._isLinksCacheEnabled()) {\n\t\t\t\tgantt._startLinksCache();\n\t\t\t\tclearCache = true;\n\t\t\t}\n\t\t\tvar relations = [];\n\t\t\tvar visited = {};\n\t\t\tvar result = {};\n\t\t\tfor(var i = 0; i < startIds.length; i++){\n\t\t\t\tthis._getLinkedTasks(startIds[i], visited, includePredecessors, result);\n\t\t\t}\n\t\n\t\t\tfor(var i in result){\n\t\t\t\trelations.push(result[i]);\n\t\t\t}\n\t\n\t\t\t//TODO: remove redundant edges before continue https://en.wikipedia.org/wiki/Transitive_reduction\n\t\t\tif(clearCache)\n\t\t\t\tgantt._endLinksCache();\n\t\t\treturn relations;\n\t\t},\n\t\n\t\t_collectRelations: function(rootObj, isChild, includePredecessors, visitedLinks){\n\t\t\tvar successors = gantt._getSuccessors(rootObj, isChild);\n\t\n\t\t\tvar predecessors = [];\n\t\t\tif (includePredecessors) {\n\t\t\t\tpredecessors = gantt._getPredecessors(rootObj, isChild);\n\t\t\t}\n\t\t\t\n\t\t\tvar linkKey;\n\t\t\tvar relations = [];\n\t\t\tfor(var i = 0; i < successors.length; i++){\n\t\t\t\tlinkKey = successors[i].hashSum;\n\t\t\t\tif(visitedLinks[linkKey]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}else{\n\t\t\t\t\tvisitedLinks[linkKey] = true;\n\t\t\t\t\trelations.push(successors[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(var i = 0; i < predecessors.length; i++){\n\t\t\t\tlinkKey = predecessors[i].hashSum;\n\t\t\t\tif(visitedLinks[linkKey]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}else{\n\t\t\t\t\tvisitedLinks[linkKey] = true;\n\t\t\t\t\trelations.push(predecessors[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn relations;\n\t\t},\n\t\t_getLinkedTasks: function(rootTask, visitedTasks, includePredecessors, output) {\n\t\t\tvar from = rootTask === undefined ? gantt.config.root_id : rootTask;\n\t\t\tvar visitedTasks = {};\n\t\t\tvar visitedLinks = {};\n\t\t\tvar rootObj;\n\t\n\t\t\tvar tasksStack = [{from: from, includePredecessors: includePredecessors, isChild:false}];\n\t\n\t\t\twhile(tasksStack.length){\n\t\t\t\tvar current = tasksStack.pop();\n\t\t\t\tvar isChild = current.isChild;\n\t\n\t\t\t\tfrom = current.from;\n\t\t\t\tif(visitedTasks[from]){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trootObj = gantt.isTaskExists(from) ? gantt.getTask(from) : this.getVirtualRoot();\n\t\t\t\tvisitedTasks[from] = true;\n\t\t\t\t\n\t\t\t\tvar relations = this._collectRelations(rootObj, isChild, includePredecessors, visitedLinks);\n\t\n\t\t\t\tfor(var i=0; i < relations.length; i++){\n\t\t\t\t\tvar rel = relations[i];\n\n\t\t\t\t\tlet includeRelation = true;\n\t\t\t\t\tif(gantt.config.auto_scheduling_use_progress){\n\t\t\t\t\t\tconst target = gantt.getTask(rel.target);\n\t\t\t\t\t\tif(target.progress == 1){\n\t\t\t\t\t\t\tincludeRelation = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// don't process links for unscheduled tasks\n\t\t\t\t\tconst target = gantt.getTask(rel.target);\n\t\t\t\t\tconst source = gantt.getTask(rel.source);\n\t\t\t\t\tif (target.unscheduled || source.unscheduled){\n\t\t\t\t\t\tincludeRelation = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(includeRelation){\n\t\t\t\t\t\toutput[rel.hashSum] = rel;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar isSameParent = rel.sourceParent == rel.targetParent;\n\t\t\t\t\tvar targetTask = rel.target;\n\t\t\t\t\tif(!visitedTasks[targetTask])\n\t\t\t\t\t\ttasksStack.push({from: rel.target, includePredecessors: true, isChild: isSameParent});\n\t\t\t\t}\n\t\n\t\t\t\tif(gantt.hasChild(rootObj.id)){\n\t\t\t\t\tvar children = gantt.getChildren(rootObj.id);\n\t\t\t\t\tfor(var i=0; i < children.length; i++){\n\t\t\t\t\t\tif(!visitedTasks[children[i]])\n\t\t\t\t\t\t\ttasksStack.push({from: children[i], includePredecessors: true, isChild: true});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn output;\n\t\t}\n\t};\n};","export enum ConstraintTypes {\n\t// As Soon As Possible (ASAP)\n\tASAP = \"asap\",\n\t// As Late As Possible (ALAP)\n\tALAP = \"alap\",\n\t// Start No Earlier Than (SNET)\n\tSNET = \"snet\",\n\t// Start No Later Than (SNLT)\n\tSNLT = \"snlt\",\n\t// Finish No Earlier Than (FNET)\n\tFNET = \"fnet\",\n\t// Finish No Later Than (FNLT)\n\tFNLT = \"fnlt\",\n\t// Must Start On (MSO)\n\tMSO = \"mso\",\n\t// Must Finish On (MFO)\n\tMFO = \"mfo\"\n}","//returns position of html element on the page\nfunction getNodePosition(elem) {\n\tvar top=0, left=0, right=0, bottom=0;\n\tif (elem.getBoundingClientRect) { //HTML5 method\n\t\tvar box = elem.getBoundingClientRect();\n\t\tvar body = document.body;\n\t\tvar docElem = (document.documentElement ||\n\t\t\tdocument.body.parentNode ||\n\t\t\tdocument.body);\n\n\t\tvar scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\n\t\tvar scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\n\t\tvar clientTop = docElem.clientTop || body.clientTop || 0;\n\t\tvar clientLeft = docElem.clientLeft || body.clientLeft || 0;\n\t\ttop  = box.top +  scrollTop - clientTop;\n\t\tleft = box.left + scrollLeft - clientLeft;\n\n\t\tright = document.body.offsetWidth - box.right;\n\t\tbottom = document.body.offsetHeight - box.bottom;\n\t} else { //fallback to naive approach\n\t\twhile(elem) {\n\t\t\ttop = top + parseInt(elem.offsetTop,10);\n\t\t\tleft = left + parseInt(elem.offsetLeft,10);\n\t\t\telem = elem.offsetParent;\n\t\t}\n\n\t\tright = document.body.offsetWidth - elem.offsetWidth - left;\n\t\tbottom = document.body.offsetHeight - elem.offsetHeight - top;\n\t}\n\treturn { y: Math.round(top), x: Math.round(left), width:elem.offsetWidth, height:elem.offsetHeight, right: Math.round(right), bottom: Math.round(bottom) };\n}\n\nfunction isVisible(node){\n\tvar display = false,\n\t\tvisibility = false;\n\tif(window.getComputedStyle){\n\t\tvar style = window.getComputedStyle(node, null);\n\t\tdisplay = style[\"display\"];\n\t\tvisibility = style[\"visibility\"];\n\t}else if(node.currentStyle){\n\t\tdisplay = node.currentStyle[\"display\"];\n\t\tvisibility = node.currentStyle[\"visibility\"];\n\t}\n\treturn (display != \"none\" && visibility != \"hidden\");\n}\n\nfunction hasNonNegativeTabIndex(node){\n\treturn !isNaN(node.getAttribute(\"tabindex\")) && (node.getAttribute(\"tabindex\")*1 >= 0);\n}\n\nfunction hasHref(node){\n\tvar canHaveHref = {\"a\": true, \"area\": true};\n\tif(canHaveHref[node.nodeName.loLowerCase()]){\n\t\treturn !!node.getAttribute(\"href\");\n\t}\n\treturn true;\n}\n\nfunction isEnabled(node){\n\tvar canDisable = {\"input\":true, \"select\":true, \"textarea\":true, \"button\":true, \"object\":true};\n\tif(canDisable[node.nodeName.toLowerCase()]){\n\t\treturn !node.hasAttribute(\"disabled\");\n\t}\n\n\treturn true;\n}\n\nfunction getFocusableNodes(root){\n\tvar nodes = root.querySelectorAll([\n\t\t\"a[href]\",\n\t\t\"area[href]\",\n\t\t\"input\",\n\t\t\"select\",\n\t\t\"textarea\",\n\t\t\"button\",\n\t\t\"iframe\",\n\t\t\"object\",\n\t\t\"embed\",\n\t\t\"[tabindex]\",\n\t\t\"[contenteditable]\"\n\t].join(\", \"));\n\n\tvar nodesArray = Array.prototype.slice.call(nodes, 0);\n\t\n\tfor(var i = 0; i < nodesArray.length; i++){\n\t\tnodesArray[i].$position = i;\n\t\t// we remember original nodes order, \n\t\t// so when we sort them by tabindex we ensure order of nodes with same tabindex is preserved, \n\t\t// since some browsers do unstable sort\n\t}\n\t\n\t// use tabindex to sort focusable nodes\n\tnodesArray.sort(function(a, b) {\n\t\tif(a.tabIndex === 0 && b.tabIndex !== 0){\n\t\t\treturn 1;\n\t\t}\n\t\tif(a.tabIndex !== 0 && b.tabIndex === 0){\n\t\t\treturn -1;\n\t\t}\n\t\t\n\t\tif (a.tabIndex === b.tabIndex){\n\t\t\t// ensure we do stable sort\n\t\t\treturn a.$position - b.$position;\n\t\t}\n\t\tif (a.tabIndex < b.tabIndex) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn 1;\n\t});\n\t\n\tfor(var i = 0; i < nodesArray.length; i++){\n\t\tvar node = nodesArray[i];\n\t\tvar isValid = (hasNonNegativeTabIndex(node)  || isEnabled(node) || hasHref(node)) && isVisible(node);\n\t\tif(!isValid){\n\t\t\tnodesArray.splice(i, 1);\n\t\t\ti--;\n\t\t}\n\t}\n\treturn nodesArray;\n}\n\nfunction getScrollSize(){\n\tvar div = document.createElement(\"div\");\n\tdiv.style.cssText=\"visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;\";\n\n\tdocument.body.appendChild(div);\n\tvar width = div.offsetWidth-div.clientWidth;\n\tdocument.body.removeChild(div);\n\n\treturn Math.max(width, 15);\n}\n\nfunction getClassName(node){\n\tif(!node) return \"\";\n\n\tvar className = node.className || \"\";\n\tif(className.baseVal)//'className' exist but not a string - IE svg element in DOM\n\t\tclassName = className.baseVal;\n\n\tif(!className.indexOf)\n\t\tclassName = \"\";\n\n\treturn _trimString(className);\n}\n\nfunction addClassName(node, className){\n\tif (className && node.className.indexOf(className) === -1) {\n\t\tnode.className += \" \" + className;\n\t}\n}\n\nfunction removeClassName(node, name) {\n\tname = name.split(\" \");\n\tfor (var i = 0; i < name.length; i++) {\n\t\tvar regEx = new RegExp(\"\\\\s?\\\\b\" + name[i] + \"\\\\b(?![-_.])\", \"\");\n\t\tnode.className = node.className.replace(regEx, \"\");\n\t}\n}\n\nfunction hasClass(element, className){\n\tif ('classList' in element) {\n\t\treturn element.classList.contains(className);\n\t} else { \n\t\treturn new RegExp(\"\\\\b\" + className + \"\\\\b\").test(element.className);\n\t}\n}\n\nfunction toNode(node) {\n\tif (typeof node === \"string\") {\n\t\treturn (document.getElementById(node) || document.querySelector(node) || document.body);\n\t}\n\treturn node || document.body;\n}\n\nvar _slave;\nfunction insertNode(node, newone) {\n\tif(!_slave){\n\t\t_slave = document.createElement(\"div\");\n\t}\n\t_slave.innerHTML = newone;\n\tvar child = _slave.firstChild;\n\tnode.appendChild(child);\n\treturn child;\n}\n\nfunction removeNode(node) {\n\tif (node && node.parentNode) {\n\t\tnode.parentNode.removeChild(node);\n\t}\n}\n\nfunction getChildNodes(node, css) {\n\tvar ch = node.childNodes;\n\tvar len = ch.length;\n\tvar out = [];\n\tfor (var i = 0; i < len; i++) {\n\t\tvar obj = ch[i];\n\t\tif (obj.className && obj.className.indexOf(css) !== -1) {\n\t\t\tout.push(obj);\n\t\t}\n\t}\n\treturn out;\n}\n\nfunction getTargetNode(e) {\n\tvar trg;\n\tif (e.tagName)\n\t\ttrg = e;\n\telse {\n\t\te = e || window.event;\n\t\ttrg = e.target || e.srcElement;\n\t\tif (trg.shadowRoot && e.composedPath) {\n\t\t\ttrg = e.composedPath()[0];\n\t\t}\n\t}\n\treturn trg;\n}\n\nfunction locateAttribute(e, attribute) {\n\tif(!attribute) return;\n\n\tvar trg = getTargetNode(e);\n\n\twhile (trg){\n\t\tif (trg.getAttribute){\t//text nodes has not getAttribute\n\t\t\tvar test = trg.getAttribute(attribute);\n\t\t\tif (test) return trg;\n\t\t}\n\t\ttrg=trg.parentNode;\n\t}\n\treturn null;\n}\n\nfunction _trimString(str){\n\tvar func = String.prototype.trim || function(){ return this.replace(/^\\s+|\\s+$/g, \"\"); };\n\treturn func.apply(str);\n}\n\nfunction locateClassName(e, classname, strict){\n\tvar trg = getTargetNode(e);\n\tvar css = \"\";\n\n\tif(strict === undefined)\n\t\tstrict = true;\n\n\twhile (trg){\n\t\tcss = getClassName(trg);\n\t\tif(css){\n\t\t\tvar ind = css.indexOf(classname);\n\t\t\tif (ind >= 0){\n\t\t\t\tif (!strict)\n\t\t\t\t\treturn trg;\n\n\t\t\t\t//check that we have exact match\n\t\t\t\tvar left = (ind === 0) || (!_trimString(css.charAt(ind - 1)));\n\t\t\t\tvar right = ((ind + classname.length >= css.length)) || (!_trimString(css.charAt(ind + classname.length)));\n\n\t\t\t\tif (left && right)\n\t\t\t\t\treturn trg;\n\t\t\t}\n\t\t}\n\t\ttrg=trg.parentNode;\n\t}\n\treturn null;\n}\n\n/*\nevent position relatively to DOM element\n */\nfunction getRelativeEventPosition(ev, node){\n\tvar d = document.documentElement;\n\tvar box = getNodePosition(node);\n\n\treturn {\n\t\tx: ev.clientX + d.scrollLeft - d.clientLeft - box.x + node.scrollLeft,\n\t\ty: ev.clientY + d.scrollTop - d.clientTop - box.y + node.scrollTop\n\t};\n}\n\nfunction getRelativeNodePosition(child, parent){\n\tconst childPos = getNodePosition(child);\n\tconst parentPos = getNodePosition(parent);\n\treturn {\n\t\tx: childPos.x - parentPos.x,\n\t\ty: childPos.y - parentPos.y\n\t};\n}\n\nfunction isChildOf(child, parent){\n\tif(!child || !parent){\n\t\treturn false;\n\t}\n\n\twhile(child && child != parent) {\n\t\tchild = child.parentNode;\n\t}\n\n\treturn child === parent;\n}\n\nfunction closest(element, selector){\n\tif(element.closest){\n\t\treturn element.closest(selector);\n\t}else if(element.matches || element.msMatchesSelector || element.webkitMatchesSelector){\n\t\tvar el = element;\n\t\tif (!document.documentElement.contains(el)) return null;\n\t\tdo {\n\t\t\tvar method = el.matches || el.msMatchesSelector || el.webkitMatchesSelector;\n\n\t\t\tif (method.call(el, selector)) return el;\n\t\t\tel = el.parentElement || el.parentNode;\n\t\t} while (el !== null && el.nodeType === 1); \n\t\treturn null;\n\t}else{\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error(\"Your browser is not supported\");\n\t\treturn null;\n\t}\n}\n\nfunction getClosestSizedElement(element) {\n\twhile (element) {\n\t\tif (element.offsetWidth > 0 && element.offsetHeight > 0) {\n\t\t\treturn element;\n\t\t}\n\t\telement = element.parentElement;\n\t}\n\treturn null;\n}\n\nfunction isShadowDomSupported() {\n\treturn document.head.createShadowRoot || document.head.attachShadow;\n}\n\n/**\n * Returns element that has the browser focus, or null if no element has focus.\n * Works with shadow DOM, so it's prefereed to use this function instead of document.activeElement directly.\n * @returns HTMLElement\n */\nfunction getActiveElement(){\n\tvar activeElement = document.activeElement;\n\tif (activeElement.shadowRoot) {\n\t\tactiveElement = activeElement.shadowRoot.activeElement;\n\t}\n\tif (activeElement === document.body && document.getSelection) {\n\t\tactiveElement = document.getSelection().focusNode || document.body;\n\t}\n\n\treturn activeElement;\n}\n\n/**\n * Returns document.body or the host node of the ShadowRoot, if the element is attached to ShadowDom\n * @param {HTMLElement} element \n * @returns HTMLElement\n */\nfunction getRootNode(element) {\n\tif (!element) {\n\t\treturn document.body;\n\t}\n\tif (!isShadowDomSupported()) {\n\t\treturn document.body;\n\t}\n\twhile (element.parentNode && (element = element.parentNode)) {\n\t\tif (element instanceof ShadowRoot) {\n\t\t\treturn element.host;\n\t\t}\n\t}\n\treturn document.body;\n}\n\nfunction hasShadowParent(element) {\n\treturn !!getRootNode(element);\n}\n\nexport {\n\tgetNodePosition,\n\tgetFocusableNodes,\n\tgetScrollSize,\n\tgetClassName,\n\taddClassName,\n\tremoveClassName,\n\tinsertNode,\n\tremoveNode,\n\tgetChildNodes,\n\ttoNode,\n\tlocateClassName,\n\tlocateAttribute,\n\tgetTargetNode,\n\tgetRelativeEventPosition,\n\tisChildOf,\n\thasClass,\n\tclosest,\n\tgetRootNode,\n\thasShadowParent,\n\tisShadowDomSupported,\n\tgetActiveElement,\n\tgetRelativeNodePosition,\n\tgetClosestSizedElement\n};","export class TaskPlan implements ITaskPlan {\n\tstatic Create(parent?: TaskPlan): TaskPlan {\n\t\tconst plan = new TaskPlan();\n\t\tif (parent) {\n\t\t\tfor (const i in plan) {\n\t\t\t\tif (parent[i] !== undefined) {\n\t\t\t\t\tplan[i] = parent[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn plan;\n\t}\n\n\tpublic link: string | number;\n\tpublic task: string | number;\n\t// tslint:disable-next-line variable-name\n\tpublic start_date: Date | null;\n\t// tslint:disable-next-line variable-name\n\tpublic end_date: Date | null;\n\n\tpublic latestStart: Date;\n\tpublic earliestStart: Date;\n\tpublic earliestEnd: Date;\n\tpublic latestEnd: Date;\n\n\tpublic latestSchedulingStart: Date;\n\tpublic earliestSchedulingStart: Date;\n\tpublic latestSchedulingEnd: Date;\n\tpublic earliestSchedulingEnd: Date;\n\n\tpublic kind: string;\n\tpublic conflict: boolean;\n\n\tconstructor() {\n\t\tthis.link = null;\n\t\tthis.task = null;\n\t\tthis.start_date = null;\n\t\tthis.end_date = null;\n\t\tthis.latestStart = null;\n\t\tthis.earliestStart = null;\n\t\tthis.earliestEnd = null;\n\t\tthis.latestEnd = null;\n\t\tthis.latestSchedulingStart = null;\n\t\tthis.earliestSchedulingStart = null;\n\t\tthis.latestSchedulingEnd = null;\n\t\tthis.earliestSchedulingEnd = null;\n\t\tthis.kind = \"asap\";\n\t\tthis.conflict = false;\n\t}\n}","import * as helpers from \"../../utils/helpers\";\nimport { ConstraintTypes } from \"./constraint_types\";\nimport { TaskPlan } from \"./task_plan\";\n\nexport class ConstraintsHelper {\n\tstatic Create(gantt: any): ConstraintsHelper {\n\t\treturn new ConstraintsHelper(gantt);\n\t}\n\n\tprivate _gantt: any;\n\tprivate constructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t}\n\n\tisAsapTask = (task: ITask): boolean => {\n\t\tconst constraintType = this.getConstraintType(task);\n\t\tif (this._gantt.config.schedule_from_end) {\n\t\t\tif (constraintType === ConstraintTypes.ASAP) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} else {\n\t\t\tif (constraintType === ConstraintTypes.ALAP) {\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t};\n\n\tisAlapTask = (task: ITask): boolean => {\n\t\treturn !this.isAsapTask(task);\n\t};\n\n\tgetConstraintType = (task: ITask): ConstraintTypes => {\n\t\t// GS-1487. Don't add a constraint if auto-scheduling is cancelled\n\t\tif (!this._gantt._isAutoSchedulable(task)){\n\t\t\treturn;\n\t\t}\n\n\t\tconst constraint = this._getTaskConstraint(task);\n\n\t\t// in case of backward scheduling, tasks without explicit constraints are considered ALAP tasks\n\t\tif (constraint.constraint_type) {\n\t\t\treturn constraint.constraint_type;\n\t\t} else if (this._gantt.config.schedule_from_end) {\n\t\t\treturn ConstraintTypes.ALAP;\n\t\t} else {\n\t\t\treturn ConstraintTypes.ASAP;\n\t\t}\n\t};\n\n\t_getTaskConstraint = (task: ITask) => {\n\n\t\tlet constraint = this._getOwnConstraint(task);\n\n\t\t// GS-2231. Child task shouldn't inherit constraints in the group mode\n\t\tif(this._gantt.config.auto_scheduling_project_constraint && !this._gantt.getState().group_mode){\n\n\t\t\tlet defaultConstraintType = ConstraintTypes.ASAP;\n\t\t\tif(this._gantt.config.schedule_from_end){\n\t\t\t\tdefaultConstraintType = ConstraintTypes.ALAP;\n\t\t\t}\n\n\t\t\tif((constraint && constraint.constraint_type) === defaultConstraintType || !constraint){\n\t\t\t\tconstraint = this._getParentConstraint(task);\n\t\t\t}\n\t\t}\n\n\t\treturn constraint;\n\t};\n\n\t_getOwnConstraint = (task: ITask) => {\n\t\treturn {\n\t\t\tconstraint_type: task.constraint_type,\n\t\t\tconstraint_date: task.constraint_date\n\t\t};\n\t};\n\n\t_getParentConstraint = (task: ITask) => {\n\t\tlet defaultConstraintType = ConstraintTypes.ASAP;\n\t\tif(this._gantt.config.schedule_from_end){\n\t\t\tdefaultConstraintType = ConstraintTypes.ALAP;\n\t\t}\n\n\t\tlet constraint = {\n\t\t\tconstraint_type: defaultConstraintType,\n\t\t\tconstraint_date: null\n\t\t};\n\n\t\tthis._gantt.eachParent((parent) => {\n\t\t\tif(constraint.constraint_type !== defaultConstraintType){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(parent.constraint_type && parent.constraint_type !== defaultConstraintType){\n\t\t\t\tconstraint = {\n\t\t\t\t\tconstraint_type: parent.constraint_type,\n\t\t\t\t\tconstraint_date: parent.constraint_date\n\t\t\t\t};\n\t\t\t}\n\t\t}, task.id);\n\t\treturn constraint;\n\t};\n\n\thasConstraint = (task: ITask): boolean => {\n\t\treturn !!this.getConstraintType(task);\n\t};\n\n\tprocessConstraint = (task: ITask, plan: TaskPlan): TaskPlan => {\n\t\tconst constraint = this._getTaskConstraint(task);\n\n\t\tif (constraint) {\n\t\t\tif (\n\t\t\t\tconstraint.constraint_type === ConstraintTypes.ALAP ||\n\t\t\t\tconstraint.constraint_type === ConstraintTypes.ASAP\n\t\t\t) {\n\t\t\t\t// this kind of constraint is calculated after main scheduling\n\t\t\t} else if(helpers.isValidDate(constraint.constraint_date)) {\n\t\t\t\tconst constraintDate = constraint.constraint_date;\n\n\t\t\t\tconst newPlan = TaskPlan.Create(plan);\n\t\t\t\tnewPlan.task = task.id;\n\n\t\t\t\tswitch (constraint.constraint_type) {\n\t\t\t\t\tcase ConstraintTypes.SNET:\n\t\t\t\t\t\tnewPlan.earliestStart = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.earliestEnd = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: newPlan.earliestStart,\n\t\t\t\t\t\t\tduration: task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.SNLT:\n\t\t\t\t\t\tnewPlan.latestStart = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.latestEnd = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: newPlan.latestStart,\n\t\t\t\t\t\t\tduration: task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.FNET:\n\t\t\t\t\t\tnewPlan.earliestStart = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: constraintDate,\n\t\t\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.earliestEnd = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.FNLT:\n\t\t\t\t\t\tnewPlan.latestStart = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: constraintDate,\n\t\t\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.latestEnd = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.MSO:\n\t\t\t\t\t\tnewPlan.earliestStart = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.earliestEnd = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: newPlan.earliestStart,\n\t\t\t\t\t\t\tduration: task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.latestStart = newPlan.earliestStart;\n\t\t\t\t\t\tnewPlan.latestEnd = newPlan.earliestEnd;\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.MFO:\n\t\t\t\t\t\tnewPlan.earliestStart = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: constraintDate,\n\t\t\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.earliestEnd = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: newPlan.earliestStart,\n\t\t\t\t\t\t\tduration: task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.latestStart = newPlan.earliestStart;\n\t\t\t\t\t\tnewPlan.latestEnd = newPlan.earliestEnd;\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\treturn newPlan;\n\t\t\t}\n\t\t}\n\n\t\treturn plan;\n\t};\n\n\tgetConstraints = (id: TaskID, relations: IInternalLink[]): ITask[] => {\n\t\tconst result = [];\n\t\tconst tasks = {};\n\n\t\tconst store = (task: any) => {\n\t\t\tif (tasks[task.id]) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.hasConstraint(task) && !this._gantt.isSummaryTask(task)) {\n\t\t\t\ttasks[task.id] = task;\n\t\t\t}\n\t\t};\n\n\t\tif (this._gantt.isTaskExists(id)) {\n\t\t\tconst task = this._gantt.getTask(id);\n\t\t\tstore(task);\n\t\t}\n\n\t\tthis._gantt.eachTask(task => store(task), id);\n\n\t\tlet current;\n\t\tif (relations) {\n\t\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\t\tconst rel = relations[i];\n\t\t\t\tif (!tasks[rel.target]) {\n\t\t\t\t\tcurrent = this._gantt.getTask(rel.target);\n\t\t\t\t\tstore(current);\n\t\t\t\t}\n\t\t\t\tif (!tasks[rel.source]) {\n\t\t\t\t\tcurrent = this._gantt.getTask(rel.source);\n\t\t\t\t\tstore(current);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const taskId in tasks) {\n\t\t\t// GS-745 do not auto-schedule placeholders\n\t\t\tif (tasks[taskId].type !== this._gantt.config.types.placeholder) {\n\t\t\t\tresult.push(tasks[taskId]);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n}\n","export default class DateComparator  {\n\tprotected _gantt: any;\n\n\tconstructor(gantt) {\n\t\tthis._gantt = gantt;\n\t}\n\n\tpublic isEqual(dateA: Date, dateB: Date, task: ITask): boolean {\n\t\treturn !this._gantt._hasDuration(dateA, dateB, task);\n\t}\n\n\tpublic isFirstSmaller(small: Date, big: Date, task: ITask): boolean {\n\t\tif (small.valueOf() < big.valueOf() && !this.isEqual(small, big, task)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic isSmallerOrDefault(smallDate: Date, bigDate: Date, task: ITask): boolean {\n\t\treturn !!(!smallDate || this.isFirstSmaller(smallDate, bigDate, task));\n\t}\n\n\tpublic isGreaterOrDefault(smallDate: Date, bigDate: Date, task: ITask): boolean {\n\t\treturn !!(!smallDate || this.isFirstSmaller(bigDate, smallDate, task));\n\t}\n}","import DateComparator from \"./date_comparator\";\nimport { TaskPlan } from \"./task_plan\";\n\nexport class AlapStrategy implements ISchedulingStrategy {\n\tstatic Create(gantt: any): AlapStrategy {\n\t\tconst instance = new AlapStrategy();\n\t\tinstance._gantt = gantt;\n\t\tinstance._comparator = new DateComparator(gantt);\n\t\treturn instance;\n\t}\n\n\tprotected _gantt: any;\n\tprotected _comparator: DateComparator;\n\n\tresolveRelationDate(taskId: TaskID, adjacentLinks: ITaskRelations, plansHash: IPlansHash): TaskPlan {\n\t\tlet maxEnd = null;\n\t\tlet linkId = null;\n\t\tlet maxStart = null;\n\t\tlet defaultStart = null;\n\t\tconst task = this._gantt.getTask(taskId);\n\t\tconst relations = adjacentLinks.successors;\n\t\tlet maxRelationDate = null;\n\t\tconst masterPlan = plansHash[taskId];\n\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\tconst relation = relations[i];\n\n\t\t\t// .preferredStart still exists only to emulate pre 6.1 auto scheduling behavior\n\t\t\t// will be removed in future versions\n\t\t\t// TODO: remove .preferredStart in v7.0\n\t\t\tdefaultStart = relation.preferredStart;\n\t\t\tconst constraintDate = this.getLatestEndDate(relation, plansHash, task);\n\t\t\tconst constraintStartDate = this._gantt.calculateEndDate({ start_date: constraintDate, duration: - task.duration, task });\n\n\t\t\tif (this._comparator.isGreaterOrDefault(maxRelationDate, constraintDate, task)) {\n\t\t\t\tmaxRelationDate = constraintDate;\n\t\t\t}\n\t\t\tif (this._comparator.isGreaterOrDefault(defaultStart, constraintStartDate, task) && this._comparator.isGreaterOrDefault(maxEnd, constraintDate, task)) {\n\t\t\t\tmaxEnd = constraintDate;\n\t\t\t\tmaxStart = constraintStartDate;\n\t\t\t\tlinkId = relation.id;\n\t\t\t}\n\t\t}\n\n\t\tif (!relations.length && this._gantt.config.project_end) {\n\t\t\tif (this._comparator.isGreaterOrDefault(this._gantt.config.project_end, task.end_date, task)) {\n\t\t\t\tmaxEnd = this._gantt.config.project_end;\n\t\t\t}\n\t\t\t// GS-1152. don't process tasks with cancelled auto-scheduling\n\t\t\tif (this._gantt.callEvent(\"onBeforeTaskAutoSchedule\", [task, task.end_date]) === false) {\n\t\t\t\tmaxEnd = task.end_date;\n\t\t\t}\n\t\t}\n\n\t\tif (maxEnd) {\n\t\t\t// GS-1556. Tasks with zero duration shouldn't violate the project_end date\n\t\t\tif (task.duration){\n\t\t\t\tmaxEnd = this._gantt.getClosestWorkTime({ date: maxEnd, dir: \"future\", task });\n\t\t\t\tmaxStart = this._gantt.calculateEndDate({ start_date: maxEnd, duration: - task.duration, task });\n\t\t\t} else {\n\t\t\t\tmaxStart = maxEnd = this._gantt.getClosestWorkTime({ date: maxEnd, dir: \"past\", task });\n\t\t\t}\n\t\t}\n\n\t\tconst currentPlan = TaskPlan.Create(masterPlan);\n\n\t\tcurrentPlan.link = linkId;\n\t\tcurrentPlan.task = taskId;\n\t\tcurrentPlan.end_date = maxEnd;\n\t\tcurrentPlan.start_date = maxStart;\n\t\tcurrentPlan.kind = \"alap\";\n\n\t\tif (maxRelationDate) {\n\t\t\tcurrentPlan.latestSchedulingStart = this._gantt.calculateEndDate({ start_date: maxRelationDate, duration: - task.duration, task });\n\t\t\tcurrentPlan.latestSchedulingEnd = maxRelationDate;\n\t\t}\n\n\t\treturn currentPlan;\n\n\t}\n\n\tprotected getSuccessorStartDate(id: TaskID, plansHash: IPlansHash): Date {\n\t\tconst plan = plansHash[id];\n\t\tconst task = this._gantt.getTask(id);\n\t\tlet res;\n\n\t\tif (!(plan && (plan.start_date || plan.end_date))) {\n\t\t\tres = task.start_date;\n\t\t} else if (plan.start_date) {\n\t\t\tres = plan.start_date;\n\t\t} else {\n\t\t\tres = this._gantt.calculateEndDate({ start_date: plan.end_date, duration: - task.duration, task });\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tprotected getLatestEndDate(relation: IInternalLink, plansHash: IPlansHash, task: ITask) {\n\t\tconst successorStart = this.getSuccessorStartDate(relation.target, plansHash);\n\t\tconst predecessor = task;\n\n\t\tlet predecessorEnd = this._gantt.getClosestWorkTime({ date: successorStart, dir: \"past\", task: predecessor });\n\n\t\tif (predecessorEnd && relation.lag && relation.lag * 1 === relation.lag * 1) {\n\t\t\tpredecessorEnd = this._gantt.calculateEndDate({ start_date: predecessorEnd, duration: -relation.lag * 1, task: predecessor });\n\t\t}\n\n\t\treturn predecessorEnd;\n\t}\n}","import DateComparator from \"./date_comparator\";\nimport { TaskPlan } from \"./task_plan\";\n\nexport class AsapStrategy implements ISchedulingStrategy {\n\tstatic Create(gantt: any): AsapStrategy {\n\t\tconst instance = new AsapStrategy();\n\t\tinstance._gantt = gantt;\n\t\tinstance._comparator = new DateComparator(gantt);\n\t\treturn instance;\n\t}\n\n\tprotected _gantt: any;\n\tprotected _comparator: DateComparator;\n\n\tresolveRelationDate(\n\t\ttaskId: TaskID,\n\t\tadjacentLinks: ITaskRelations,\n\t\tplansHash: IPlansHash\n\t): TaskPlan {\n\t\tlet minStart = null;\n\t\tlet linkId = null;\n\n\t\tlet defaultStart = null;\n\t\tconst task = this._gantt.getTask(taskId);\n\t\tconst relations = adjacentLinks.predecessors;\n\n\t\tconst autoScheduledDates = {};\n\t\tlet minRelationDate = null;\n\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\tconst relation = relations[i];\n\n\t\t\t// .preferredStart still exists only to emulate pre 6.1 auto scheduling behavior\n\t\t\t// will be removed in future versions\n\t\t\t// TODO: remove .preferredStart in v7.0\n\t\t\tdefaultStart = relation.preferredStart;\n\n\t\t\tconst constraintDate = this.getEarliestStartDate(\n\t\t\t\trelation,\n\t\t\t\tplansHash,\n\t\t\t\ttask\n\t\t\t);\n\n\t\t\tif (this._comparator.isSmallerOrDefault(minRelationDate, constraintDate, task)) {\n\t\t\t\tminRelationDate = constraintDate;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tthis._comparator.isSmallerOrDefault(defaultStart, constraintDate, task) &&\n\t\t\t\tthis._comparator.isSmallerOrDefault(minStart, constraintDate, task)\n\t\t\t) {\n\t\t\t\tminStart = constraintDate;\n\t\t\t\tlinkId = relation.id;\n\t\t\t}\n\t\t\tif (!task.duration){\n\t\t\t\tconst link = this._gantt.getLink(relation.id);\n\t\t\t\tif (autoScheduledDates[link.type] === undefined){\n\t\t\t\t\tautoScheduledDates[link.type] = +constraintDate;\n\t\t\t\t}\n\t\t\t\telse if (autoScheduledDates[link.type] < +constraintDate){\n\t\t\t\t\tautoScheduledDates[link.type] = +constraintDate;\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (!relations.length && this._gantt.config.project_start) {\n\t\t\tif (this._comparator.isSmallerOrDefault(task.start_date, this._gantt.config.project_start, task) ||\n\t\t\t// GS-403 - auto_scheduling_strict = true to schedule independent asap tasks to the earliest date, auto_scheduling_strict=false to keep the old behavior\n\t\t\t(this._gantt.config.auto_scheduling_strict && this._comparator.isGreaterOrDefault(task.start_date, this._gantt.config.project_start, task)\n\t\t\t)\n\t\t\t) {\n\t\t\t\tminStart = this._gantt.config.project_start;\n\t\t\t}\n\t\t\t// GS-1152. don't process tasks with cancelled auto-scheduling\n\t\t\tif (this._gantt.callEvent(\"onBeforeTaskAutoSchedule\", [task, task.start_date]) === false) {\n\t\t\t\tminStart = task.start_date;\n\t\t\t}\n\t\t}\n\n\t\tlet maxEnd = null;\n\t\tif (minStart) {\n\t\t\tif (task.duration) {\n\t\t\t\tminStart = this._gantt.getClosestWorkTime({\n\t\t\t\t\tdate: minStart,\n\t\t\t\t\tdir: \"future\",\n\t\t\t\t\ttask\n\t\t\t\t});\n\t\t\t\tmaxEnd = this._gantt.calculateEndDate({\n\t\t\t\t\tstart_date: minStart,\n\t\t\t\t\tduration: task.duration,\n\t\t\t\t\ttask\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// GS-1340 and GS-2508. For FF links, the milestones should start before the weekends\n\t\t\t\t// When there are multiple links, other types have a higher priority over FF links\n\t\t\t\tlet milestoneWorktimeDirection = \"future\";\n\t\t\t\tconst linkProps = this._gantt.config.links;\n\t\t\t\tif (autoScheduledDates[linkProps.finish_to_finish] !== undefined){\n\t\t\t\t\tconst onlyFFLink = relations.length === 1;\n\t\t\t\t\tlet noRelevantLinks = true;\n\t\t\t\t\tfor (const linkType in autoScheduledDates){\n\t\t\t\t\t\tif (linkType != linkProps.finish_to_finish &&\n\t\t\t\t\t\t\tautoScheduledDates[linkProps.finish_to_finish] < autoScheduledDates[linkType]){\n\t\t\t\t\t\t\t\tnoRelevantLinks = false;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (onlyFFLink || noRelevantLinks){\n\t\t\t\t\t\tmilestoneWorktimeDirection = \"past\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tminStart = maxEnd = this._gantt.getClosestWorkTime({ date: minStart, dir: milestoneWorktimeDirection, task });\n\t\t\t}\n\n\t\t}\n\n\t\tconst masterPlan = plansHash[taskId];\n\t\tconst currentPlan = TaskPlan.Create(masterPlan);\n\n\t\tcurrentPlan.link = linkId;\n\t\tcurrentPlan.task = taskId;\n\t\tcurrentPlan.start_date = minStart;\n\t\tcurrentPlan.end_date = maxEnd;\n\t\tcurrentPlan.kind = \"asap\";\n\n\t\tif (minRelationDate) {\n\t\t\tcurrentPlan.earliestSchedulingStart = minRelationDate;\n\t\t\tcurrentPlan.earliestSchedulingEnd = this._gantt.calculateEndDate({\n\t\t\t\tstart_date: minRelationDate,\n\t\t\t\tduration: task.duration,\n\t\t\t\ttask\n\t\t\t});\n\t\t}\n\n\t\treturn currentPlan;\n\t}\n\n\tprotected getPredecessorEndDate(id: TaskID, plansHash: IPlansHash): Date {\n\t\tconst plan = plansHash[id];\n\t\tconst task = this._gantt.getTask(id);\n\t\tlet res;\n\n\t\tif (!(plan && (plan.start_date || plan.end_date))) {\n\t\t\tres = task.end_date;\n\t\t} else if (plan.end_date) {\n\t\t\tres = plan.end_date;\n\t\t} else {\n\t\t\tres = this._gantt.calculateEndDate({\n\t\t\t\tstart_date: plan.start_date,\n\t\t\t\tduration: task.duration,\n\t\t\t\ttask\n\t\t\t});\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tprotected getEarliestStartDate(relation: IInternalLink, plansHash: IPlansHash, task: ITask): Date {\n\t\tconst predecessorEnd = this.getPredecessorEndDate(\n\t\t\trelation.source,\n\t\t\tplansHash\n\t\t);\n\t\tconst successor = task;\n\t\tconst predecessor = this._gantt.getTask(relation.source);\n\t\tlet successorStart: Date;\n\n\t\tif (\n\t\t\t(predecessorEnd &&\n\t\t\trelation.lag &&\n\t\t\trelation.lag * 1 === relation.lag * 1)\n\t\t) {\n\t\t\t// GS-2330. If it is a subtask link and we move projects, we should use the project calendar\n\t\t\tlet taskCalendar = successor;\n\t\t\tif (this._gantt.config.auto_scheduling_move_projects && relation.subtaskLink && this._gantt.isTaskExists(relation.targetParent)){\n\t\t\t\ttaskCalendar = this._gantt.getTask(relation.targetParent);\n\t\t\t}\n\n\t\t\tsuccessorStart = this._gantt.getClosestWorkTime({\n\t\t\t\tdate: predecessorEnd,\n\t\t\t\tdir: \"future\",\n\t\t\t\ttask: predecessor\n\t\t\t});\n\n\t\t\tif(relation.sourceLag){\n\t\t\t\tsuccessorStart = this._gantt.calculateEndDate({\n\t\t\t\t\tstart_date: successorStart,\n\t\t\t\t\tduration: relation.sourceLag * 1,\n\t\t\t\t\ttask: predecessor\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif(relation.targetLag){\n\t\t\t\tsuccessorStart = this._gantt.calculateEndDate({\n\t\t\t\t\tstart_date: successorStart,\n\t\t\t\t\tduration: relation.targetLag * 1,\n\t\t\t\t\ttask: taskCalendar\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tsuccessorStart = this._gantt.calculateEndDate({\n\t\t\t\tstart_date: successorStart,\n\t\t\t\tduration: relation.trueLag * 1,\n\t\t\t\ttask: taskCalendar\n\t\t\t});\n\n\t\t} else {\n\t\t\tconst ffLink = this._gantt.getLink(relation.id).type === this._gantt.config.links.finish_to_finish;\n\n\t\t\tif (!successor.duration && ffLink) {\n\t\t\t\tsuccessorStart = this._gantt.getClosestWorkTime({\n\t\t\t\t\tdate: predecessorEnd,\n\t\t\t\t\tdir: \"past\",\n\t\t\t\t\ttask: successor\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tsuccessorStart = this._gantt.getClosestWorkTime({\n\t\t\t\t\tdate: predecessorEnd,\n\t\t\t\t\tdir: \"future\",\n\t\t\t\t\ttask: successor\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\n\t\treturn successorStart;\n\t}\n}\n","import { AlapStrategy } from \"./alap_strategy\";\nimport { AsapStrategy } from \"./asap_strategy\";\nimport { ConstraintTypes } from \"./constraint_types\";\nimport { ConstraintsHelper } from \"./constraints\";\nimport { TaskPlan } from \"./task_plan\";\n\nexport class AutoSchedulingPlanner {\n\tprivate _gantt: any;\n\tprivate _constraintsHelper: ConstraintsHelper;\n\tprivate _graphHelper: any;\n\tprivate _asapStrategy: AsapStrategy;\n\tprivate _alapStrategy: AlapStrategy;\n\tprivate _secondIterationRequired?: boolean;\n\tprivate _secondIteration: boolean = false;\n\n\tconstructor(\n\t\tgantt: any,\n\t\tgraphHelper: any,\n\t\tconstraintsHelper: ConstraintsHelper\n\t) {\n\t\tthis._gantt = gantt;\n\t\tthis._constraintsHelper = constraintsHelper;\n\t\tthis._graphHelper = graphHelper;\n\t\tthis._asapStrategy = AsapStrategy.Create(gantt);\n\t\tthis._alapStrategy = AlapStrategy.Create(gantt);\n\t\tthis._secondIterationRequired = false;\n\t}\n\n\tgeneratePlan(relations: IInternalLink[], constraints: ITask[]): TaskPlan[] {\n\t\tconst graphHelper = this._graphHelper;\n\t\tconst gantt = this._gantt;\n\t\tconst constraintsHelper = this._constraintsHelper;\n\t\tconst alapStrategy = this._alapStrategy;\n\t\tconst asapStrategy = this._asapStrategy;\n\n\t\tconst {\n\t\t\torderedIds,\n\t\t\treversedIds,\n\t\t\trelationsMap,\n\t\t\tplansHash } = this.buildWorkCollections(relations, constraints, graphHelper);\n\n\t\tlet result: TaskPlan[];\n\n\t\tthis.processConstraints(orderedIds, plansHash, gantt, constraintsHelper);\n\n\t\tif (gantt.config.schedule_from_end) {\n\t\t\t// when scheduling from end - iterate tasks from end and schedule them as late as possible\n\t\t\t// after that - iterate tasks from start and schedule asap tasks\n\t\t\tresult = this.iterateTasks(reversedIds, orderedIds, constraintsHelper.isAlapTask, alapStrategy, asapStrategy, relationsMap, plansHash);\n\t\t} else {\n\t\t\t// when scheduling from end - iterate tasks from start and schedule them as soon as possible\n\t\t\t// after that - iterate tasks from end and schedule asap alap\n\t\t\tresult = this.iterateTasks(orderedIds, reversedIds, constraintsHelper.isAsapTask, asapStrategy, alapStrategy, relationsMap, plansHash);\n\t\t}\n\t\treturn result;\n\t}\n\n\tapplyProjectPlan(projectPlan: TaskPlan[]): ITask[] {\n\t\tconst gantt = this._gantt;\n\n\t\tlet plan: TaskPlan;\n\t\tlet task: ITask;\n\t\tlet link: ILink;\n\t\tlet reason: ITask;\n\n\t\tconst updateTasks = [];\n\t\tfor (let i = 0; i < projectPlan.length; i++) {\n\t\t\tlink = null;\n\t\t\treason = null;\n\t\t\tplan = projectPlan[i];\n\n\t\t\tif (!gantt.isTaskExists(plan.task)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttask = gantt.getTask(plan.task);\n\t\t\tif (plan.link) {\n\t\t\t\tlink = gantt.getLink(plan.link);\n\t\t\t\tif (plan.kind === \"asap\") {\n\t\t\t\t\treason = this._gantt.getTask(link.source);\n\t\t\t\t} else {\n\t\t\t\t\t// alap tasks are scheduled by their successors\n\t\t\t\t\treason = this._gantt.getTask(link.target);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet newDate = null;\n\t\t\tif (\n\t\t\t\tplan.start_date &&\n\t\t\t\ttask.start_date.valueOf() !== plan.start_date.valueOf()\n\t\t\t) {\n\t\t\t\tnewDate = plan.start_date;\n\t\t\t}\n\n\t\t\tif (!newDate) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttask.start_date = newDate;\n\t\t\ttask.end_date = gantt.calculateEndDate(task);\n\n\t\t\tupdateTasks.push(task.id);\n\t\t\tgantt.callEvent(\"onAfterTaskAutoSchedule\", [\n\t\t\t\ttask,\n\t\t\t\tnewDate,\n\t\t\t\tlink,\n\t\t\t\treason\n\t\t\t]);\n\t\t}\n\t\treturn updateTasks;\n\t}\n\n\tprotected iterateTasks(\n\t\tmainSequence: TaskID[],\n\t\tsecondarySequence: TaskID[],\n\t\tisMainSequence: (task: ITask) => boolean,\n\t\tmainSequenceStrategy: ISchedulingStrategy,\n\t\tsecondarySequenceStrategy: ISchedulingStrategy,\n\t\trelationsMap: ITaskLinksMap,\n\t\tplansHash: IPlansHash\n\n\t): TaskPlan[] {\n\t\tconst gantt = this._gantt;\n\t\tconst result: TaskPlan[] = [];\n\n\t\tfor (let i = 0; i < mainSequence.length; i++) {\n\t\t\tconst currentId = mainSequence[i];\n\t\t\tconst task = gantt.getTask(currentId);\n\t\t\tif (!gantt._isAutoSchedulable(task)){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst plan = mainSequenceStrategy.resolveRelationDate(\n\t\t\t\tcurrentId,\n\t\t\t\trelationsMap[currentId],\n\t\t\t\tplansHash\n\t\t\t);\n\t\t\tthis.limitPlanDates(task, plan);\n\t\t\tif (isMainSequence(task)) {\n\t\t\t\tthis.processResolvedDate(task, plan, result, plansHash);\n\t\t\t} else {\n\t\t\t\tplansHash[task.id] = plan;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < secondarySequence.length; i++) {\n\t\t\tconst currentId = secondarySequence[i];\n\t\t\tconst task = gantt.getTask(currentId);\n\t\t\tif (!gantt._isAutoSchedulable(task)){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!isMainSequence(task)) {\n\t\t\t\tconst plan = secondarySequenceStrategy.resolveRelationDate(\n\t\t\t\t\tcurrentId,\n\t\t\t\t\trelationsMap[currentId],\n\t\t\t\t\tplansHash\n\t\t\t\t);\n\t\t\t\tthis.limitPlanDates(task, plan);\n\t\t\t\tthis.processResolvedDate(task, plan, result, plansHash);\n\t\t\t}\n\t\t}\n\n\t\tif (this._secondIterationRequired){\n\t\t\tif (this._secondIteration){\n\t\t\t\tthis._secondIteration = false;\n\t\t\t} else {\n\t\t\t\tthis._secondIteration = true;\n\n\t\t\t\t// if the duration of the project tasks changed, the lag value is updated\n\t\t\t\t// so, we need to auto-schedule tasks again with the updated dates\n\t\t\t\tif (this.summaryLagChanged(gantt, relationsMap, plansHash)){\n\t\t\t\t\treturn this.iterateTasks(\n\t\t\t\t\t\tmainSequence,\n\t\t\t\t\t\tsecondarySequence,\n\t\t\t\t\t\tisMainSequence,\n\t\t\t\t\t\tmainSequenceStrategy,\n\t\t\t\t\t\tsecondarySequenceStrategy,\n\t\t\t\t\t\trelationsMap,\n\t\t\t\t\t\tplansHash\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected summaryLagChanged(gantt, relationsMap, plansHash){\n\t\t// update projects and relations from plans\n\t\tconst projectUpdates = {};\n\t\tconst linksToUpdate = {};\n\n\t\t// get minimal and maximal dates for target and source projects\n\t\tfor (const taskId in relationsMap){\n\t\t\trelationsMap[taskId].predecessors.forEach((relation)=>{\n\t\t\t\tif (relation.subtaskLink){\n\t\t\t\t\tconst link = gantt.getLink(relation.id);\n\t\t\t\t\tthis.getProjectUpdates(gantt, plansHash, relation, link, \"source\", projectUpdates, linksToUpdate);\n\t\t\t\t\tthis.getProjectUpdates(gantt, plansHash, relation, link, \"target\", projectUpdates, linksToUpdate);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// update project tasks\n\t\tlet shouldReschedule = false;\n\n\t\tfor (const projectId in projectUpdates){\n\t\t\tconst updatedProject = projectUpdates[projectId];\n\t\t\tif (!updatedProject.min || !updatedProject.max){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst task = gantt.getTask(projectId);\n\t\t\t// we cannot rely on the `duration` parameter as it can have a different value for project tasks\n\t\t\t// during the initial scheduling\n\t\t\tconst initialDuration = gantt.calculateDuration({start_date: task.start_date, end_date: task.end_date, task});\n\t\t\t// we need to modify the dates and duration of the project tasks as\n\t\t\t// the _formatLink and the functions that follow rely on these parameters\n\t\t\t// it shouldn't impact logic as project tasks ignore the date parameters\n\t\t\tconst newDuration = gantt.calculateDuration({start_date: updatedProject.min, end_date: updatedProject.max, task});\n\t\t\tif (newDuration === initialDuration){\n\t\t\t\t// no need to reschedule\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttask.start_date = updatedProject.min;\n\t\t\ttask.end_date = updatedProject.max;\n\t\t\ttask.duration = newDuration;\n\t\t}\n\t\t\n\t\tfor (const linkId in linksToUpdate){\n\t\t\tconst link = linksToUpdate[linkId];\n\t\t\tlet sourceDates, targetDates;\n\n\t\t\tconst updatedSource = projectUpdates[link.source];\n\t\t\tconst updatedTarget = projectUpdates[link.target];\n\t\t\tif (updatedSource){\n\t\t\t\tsourceDates = {\n\t\t\t\t\tstart_date: updatedSource.start_date,\n\t\t\t\t\tend_date: updatedSource.end_date\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (updatedTarget){\n\t\t\t\tsourceDates = {\n\t\t\t\t\tstart_date: updatedTarget.start_date,\n\t\t\t\t\tend_date: updatedTarget.end_date\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// get updated formatted link with updated dates\n\t\t\tconst updatedRelations = gantt._formatLink(link, sourceDates, targetDates);\n\t\t\t// update relationsMap\n\t\t\tupdatedRelations.forEach(function(updatedRelation){\n\t\t\tfor (const taskId in relationsMap){\n\t\t\t\trelationsMap[taskId].predecessors.forEach(function(relation){\n\t\t\t\t\t\tconst idMatch = relation.id === updatedRelation.id;\n\t\t\t\t\t\tconst targetMatch = relation.target === updatedRelation.target;\n\t\t\t\t\t\tconst sourceMatch = relation.source === updatedRelation.source;\n\t\t\t\t\t\tif (idMatch && targetMatch && sourceMatch){\n\t\t\t\t\t\t\trelation.lag = updatedRelation.lag;\n\t\t\t\t\t\t\trelation.sourceLag = updatedRelation.sourceLag;\n\t\t\t\t\t\t\trelation.targetLag = updatedRelation.targetLag;\n\t\t\t\t\t\t\trelation.hashSum = updatedRelation.hashSum;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tshouldReschedule = true;\n\t\t}\n\t\treturn shouldReschedule;\n\t}\n\n\tprotected getProjectUpdates(gantt, plansHash, relation, link, relationProp, projectUpdates, linksToUpdate){\n\t\tconst task = gantt.getTask(link[relationProp]);\n\t\tif (task.type === gantt.config.types.project){\n\t\t\tprojectUpdates[link[relationProp]] = projectUpdates[link[relationProp]] || {id: link[relationProp], link};\n\t\t\tconst projectForUpdate = projectUpdates[link[relationProp]];\n\t\t\tlet childTask = plansHash[relation[relationProp]];\n\t\t\tif (childTask){\n\t\t\t\tif (relationProp == \"source\" && (!childTask.start_date || !childTask.end_date)){\n\t\t\t\t\tchildTask = gantt.getTask(childTask.task);\n\t\t\t\t}\n\n\t\t\t\tprojectForUpdate.min = projectForUpdate.min || childTask.start_date;\n\t\t\t\tif (projectForUpdate.min > childTask.start_date){\n\t\t\t\t\tprojectForUpdate.min = childTask.start_date;\n\t\t\t\t}\n\t\t\t\tprojectForUpdate.max = projectForUpdate.max || childTask.end_date;\n\t\t\t\tif (projectForUpdate.max < childTask.end_date){\n\t\t\t\t\tprojectForUpdate.max = childTask.end_date;\n\t\t\t\t}\n\t\t\t\tlinksToUpdate[link.id] = link;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected processResolvedDate(\n\t\ttask: ITask,\n\t\tplan: TaskPlan,\n\t\tresult: TaskPlan[],\n\t\tplansHash: any\n\t): void {\n\t\tif (plan.start_date && this._gantt.isLinkExists(plan.link)) {\n\t\t\tlet link = null;\n\t\t\tlet reason = null;\n\t\t\tif (plan.link) {\n\t\t\t\tlink = this._gantt.getLink(plan.link);\n\t\t\t\tif (plan.kind === \"asap\") {\n\t\t\t\t\treason = this._gantt.getTask(link.source);\n\t\t\t\t} else {\n\t\t\t\t\t// alap tasks are scheduled by their successors\n\t\t\t\t\treason = this._gantt.getTask(link.target);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttask.start_date.valueOf() !== plan.start_date.valueOf() &&\n\t\t\t\tthis._gantt.callEvent(\"onBeforeTaskAutoSchedule\", [\n\t\t\t\t\ttask,\n\t\t\t\t\tplan.start_date,\n\t\t\t\t\tlink,\n\t\t\t\t\treason\n\t\t\t\t]) === false\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tplansHash[task.id] = plan;\n\t\tif (plan.start_date) {\n\t\t\tresult.push(plan);\n\t\t}\n\t}\n\n\tprotected limitPlanDates(task: ITask, plan: TaskPlan): TaskPlan {\n\t\tconst effectiveStart = plan.start_date || task.start_date;\n\n\t\tif (plan.earliestStart) {\n\t\t\tif (effectiveStart < plan.earliestStart) {\n\t\t\t\tplan.start_date = plan.earliestStart;\n\t\t\t\tplan.end_date = plan.earliestEnd;\n\t\t\t}\n\t\t}\n\n\t\tif (plan.latestStart) {\n\t\t\tif (effectiveStart > plan.latestStart) {\n\t\t\t\tplan.start_date = plan.latestStart;\n\t\t\t\tplan.end_date = plan.latestEnd;\n\t\t\t}\n\t\t}\n\n\t\tif (plan.latestSchedulingStart && effectiveStart > plan.latestSchedulingStart) {\n\t\t\tplan.start_date = plan.latestSchedulingStart;\n\t\t\tplan.end_date = plan.latestSchedulingEnd;\n\t\t}\n\n\t\tif (plan.earliestSchedulingStart && effectiveStart < plan.earliestSchedulingStart) {\n\t\t\tplan.start_date = plan.earliestSchedulingStart;\n\t\t\tplan.end_date = plan.earliestSchedulingEnd;\n\t\t}\n\n\t\tif (plan.start_date) { // start/end dates are either both defined or both not\n\t\t\tif (plan.start_date > plan.latestSchedulingStart ||\n\t\t\t\tplan.start_date < plan.earliestSchedulingStart ||\n\t\t\t\tplan.start_date > plan.latestStart ||\n\t\t\t\tplan.start_date < plan.earliestStart ||\n\t\t\t\tplan.end_date > plan.latestSchedulingEnd ||\n\t\t\t\tplan.end_date < plan.earliestSchedulingEnd ||\n\t\t\t\tplan.end_date > plan.latestEnd ||\n\t\t\t\tplan.end_date < plan.earliestEnd) {\n\n\t\t\t\tplan.conflict = true;\n\t\t\t}\n\t\t}\n\t\treturn plan;\n\t}\n\n\tprotected buildWorkCollections(relations: IInternalLink[], constraints: ITask[], graphHelper: any) {\n\t\tconst gantt = this._gantt;\n\t\tconst orderedIds: TaskID[] = graphHelper.topologicalSort(relations);\n\t\tconst reversedIds: TaskID[] = orderedIds.slice().reverse();\n\t\tconst plansHash: IPlansHash = {};\n\n\t\tconst relationsMap: ITaskLinksMap = {};\n\t\tfor (let i = 0, len = orderedIds.length; i < len; i++) {\n\t\t\tconst id = orderedIds[i];\n\t\t\tconst task = gantt.getTask(id);\n\t\t\tif (!gantt._isAutoSchedulable(task)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\trelationsMap[id] = {\n\t\t\t\tsuccessors: [],\n\t\t\t\tpredecessors: []\n\t\t\t};\n\n\t\t\tplansHash[id] = null;\n\t\t}\n\n\t\tfor (let i = 0, len = constraints.length; i < len; i++) {\n\t\t\tconst task = constraints[i];\n\n\t\t\tif (plansHash[task.id] === undefined) {\n\t\t\t\treversedIds.unshift(task.id);\n\t\t\t\torderedIds.unshift(task.id);\n\t\t\t\tplansHash[task.id] = null;\n\t\t\t\trelationsMap[task.id] = {\n\t\t\t\t\tsuccessors: [],\n\t\t\t\t\tpredecessors: []\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0, len = relations.length; i < len; i++) {\n\t\t\tconst rel = relations[i];\n\t\t\tif (relationsMap[rel.source]) {\n\t\t\t\trelationsMap[rel.source].successors.push(rel);\n\t\t\t}\n\n\t\t\tif (relationsMap[rel.target]) {\n\t\t\t\trelationsMap[rel.target].predecessors.push(rel);\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\torderedIds,\n\t\t\treversedIds,\n\t\t\trelationsMap,\n\t\t\tplansHash\n\t\t};\n\t}\n\n\tprotected processConstraints(orderedIds: TaskID[], plansHash: IPlansHash, gantt: any, constraintsHelper: ConstraintsHelper) {\n\t\tfor (let i = 0; i < orderedIds.length; i++) {\n\t\t\tconst currentId = orderedIds[i];\n\t\t\tconst task = gantt.getTask(currentId);\n\n\t\t\tconst constraintType = constraintsHelper.getConstraintType(task);\n\t\t\tif (\n\t\t\t\tconstraintType &&\n\t\t\t\tconstraintType !== ConstraintTypes.ASAP &&\n\t\t\t\tconstraintType !== ConstraintTypes.ALAP\n\t\t\t) {\n\t\t\t\tconst plan = constraintsHelper.processConstraint(\n\t\t\t\t\ttask,\n\t\t\t\t\tTaskPlan.Create()\n\t\t\t\t);\n\t\t\t\tplansHash[task.id] = plan;\n\t\t\t}\n\t\t}\n\t}\n}\n","interface IFlagHash {\n\t[id: string]: boolean;\n}\n\nfunction findGroups(links: IInternalLink[]): IConnectedGroup[] {\n\tconst visited: IFlagHash = {};\n\tconst groups = [];\n\tlet source: TaskID;\n\tlet target: TaskID;\n\tlet root: TaskID;\n\t// main loop - find any unvisited vertex from the input array and\n\t// treat it as the source, then perform a breadth first search from\n\t// it. All vertices visited from this search belong to the same group\n\tfor (let i = 0; i < links.length; i++) {\n\t\tsource = links[i].source;\n\t\ttarget = links[i].target;\n\t\troot = null;\n\t\tif (!visited[source]) {\n\t\t\troot = source;\n\t\t} else if (!visited[target]) {\n\t\t\troot = target;\n\t\t}\n\t\tif (root) {\n\t\t\t// there is an unvisited vertex in this pair.\n\t\t\t// perform a breadth first search, and push the resulting\n\t\t\t// group onto the list of all groups\n\t\t\tconst length = links.length;\n\t\t\tgroups.push(breadthFirstSearch(root, links, visited));\n\t\t\tif (length !== links.length) {\n\t\t\t\ti = -1;\n\t\t\t}\n\t\t}\n\t}\n\treturn groups;\n}\n\n// Breadth First Search function\n// v is the source vertex\n// links is the input array, which contains all gantt relations\n// visited is a dictionary for keeping track of whether a node is visited\nfunction breadthFirstSearch(\n\tv: TaskID,\n\tlinks: IInternalLink[],\n\tvisited: IFlagHash\n): IConnectedGroupsDetailed {\n\tconst queue: TaskID[] = [v];\n\tconst groupTasks: TaskID[] = [];\n\tconst groupLinksInternal: { [hashSum: string]: IInternalLink } = {};\n\tconst groupLinksPublic: { [id: string]: boolean } = {};\n\n\tlet currentVertex: TaskID;\n\twhile (queue.length > 0) {\n\t\tcurrentVertex = queue.shift();\n\t\tif (!visited[currentVertex]) {\n\t\t\tvisited[currentVertex] = true;\n\t\t\tgroupTasks.push(currentVertex);\n\t\t\t// go through the input array to find vertices that are\n\t\t\t// directly adjacent to the current vertex, and put them\n\t\t\t// onto the queue\n\t\t\tfor (let i = 0; i < links.length; i++) {\n\t\t\t\tconst link = links[i];\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\tif ((link.source == currentVertex || link.sourceParent == currentVertex)) {\n\t\t\t\t\tif (!visited[link.target]) {\n\t\t\t\t\t\tqueue.push(link.target);\n\t\t\t\t\t\tgroupLinksPublic[link.id] = true;\n\t\t\t\t\t\tlinks.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t\tgroupLinksInternal[link.hashSum] = link;\n\n\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t} else if ((link.target == currentVertex || link.targetParent == currentVertex)) {\n\t\t\t\t\tif (!visited[link.source]) {\n\t\t\t\t\t\tqueue.push(link.source);\n\t\t\t\t\t\tgroupLinksPublic[link.id] = true;\n\t\t\t\t\t\tlinks.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t\tgroupLinksInternal[link.hashSum] = link;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst linksArray: LinkID[] = [];\n\tlet linksObjects: IInternalLink[] = [];\n\tfor (const i in groupLinksPublic) {\n\t\tlinksArray.push(i);\n\t}\n\tfor (const i in groupLinksInternal) {\n\t\tlinksObjects.push(groupLinksInternal[i]);\n\t}\n\t// GS-1689. If we have several levels of projects, the code above might not add the links\n\t// so, we need to return the original `links` object\n\tif (!linksObjects.length){\n\t\tlinksObjects = links;\n\t}\n\t// return everything in the current \"group\"\n\treturn { tasks: groupTasks, links: linksArray, processedLinks: linksObjects };\n}\n\nexport class ConnectedGroupsHelper {\n\tprivate _linksBuilder: any;\n\tprivate _gantt: any;\n\tconstructor(gantt: any, linksBuilder: any) {\n\t\tthis._linksBuilder = linksBuilder;\n\t\tthis._gantt = gantt;\n\t}\n\n\tgetConnectedGroupRelations = (id: TaskID): IInternalLink[] => {\n\t\tconst links = this._linksBuilder.getLinkedTasks();\n\t\tconst group = breadthFirstSearch(id, links, {});\n\t\treturn group.processedLinks;\n\t};\n\n\tgetConnectedGroup = (id: TaskID): IConnectedGroup | IConnectedGroup[] => {\n\t\tconst links = this._linksBuilder.getLinkedTasks();\n\t\tif (id !== undefined) {\n\t\t\tif (this._gantt.getTask(id).type === this._gantt.config.types.project) {\n\t\t\t\treturn { tasks: [], links: [] };\n\t\t\t}\n\n\t\t\tconst group = breadthFirstSearch(id, links, {});\n\t\t\treturn {\n\t\t\t\ttasks: group.tasks,\n\t\t\t\tlinks: group.links\n\t\t\t};\n\t\t} else {\n\t\t\treturn findGroups(links).map(group => ({ tasks: group.tasks, links: group.links }));\n\t\t}\n\t};\n}\n","export class LoopsFinder {\n\tprivate _linksBuilder: any;\n\tprivate _graphHelper: any;\n\tprivate _gantt: any;\n\tconstructor(gantt: any, graphHelper: any, linksBuilder: any) {\n\t\tthis._linksBuilder = linksBuilder;\n\t\tthis._graphHelper = graphHelper;\n\t\tthis._gantt = gantt;\n\t}\n\tisCircularLink = (link: ILink): boolean => {\n\t\treturn !!this.getLoopContainingLink(link);\n\t};\n\n\tgetLoopContainingLink = (link: ILink): any => {\n\t\tconst graphHelper = this._graphHelper;\n\t\tconst linksBuilder = this._linksBuilder;\n\t\tconst gantt = this._gantt;\n\n\t\tlet allRelations = linksBuilder.getLinkedTasks();\n\t\tif (!gantt.isLinkExists(link.id)) {\n\t\t\tallRelations = allRelations.concat(gantt._formatLink(link));\n\t\t}\n\n\t\tconst cycles = graphHelper.findLoops(allRelations);\n\n\t\tconst found = false;\n\t\tfor (let i = 0; i < cycles.length && !found; i++) {\n\t\t\tconst links = cycles[i].links;\n\t\t\tfor (let j = 0; j < links.length; j++) {\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\tif (links[j] == link.id) {\n\t\t\t\t\treturn cycles[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tfindCycles = () => {\n\t\tconst graphHelper = this._graphHelper;\n\t\tconst linksBuilder = this._linksBuilder;\n\n\t\tconst allRelations = linksBuilder.getLinkedTasks();\n\t\treturn graphHelper.findLoops(allRelations);\n\t};\n}\n","import { ConnectedGroupsHelper } from \"./connected_groups\";\n\nexport function attachUIHandlers(\n\tgantt: any,\n\tlinksBuilder: any,\n\tloopsFinder: any,\n\tconnectedGroupsHelper: ConnectedGroupsHelper\n) {\n\tconst _attachAutoSchedulingHandlers = function() {\n\t\tlet _scheduleAfterBatchUpdate = false;\n\t\tgantt.attachEvent(\"onAfterBatchUpdate\", function(){\n\n\t\t\tif(_scheduleAfterBatchUpdate){\n\t\t\t\tgantt.autoSchedule();\n\t\t\t}\n\t\t\t_scheduleAfterBatchUpdate = false;\n\t\t});\n\n\t\tfunction _autoScheduleAfterLinkChange(id: LinkID, link: ILink) {\n\t\t\tif (gantt.config.auto_scheduling && !gantt._autoscheduling_in_progress) {\n\t\t\t\tif(gantt.getState().batch_update){\n\t\t\t\t\t_scheduleAfterBatchUpdate = true;\n\t\t\t\t}else{\n\t\t\t\t\tgantt.autoSchedule(link.source);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tgantt.attachEvent(\"onAfterLinkUpdate\", _autoScheduleAfterLinkChange);\n\t\tgantt.attachEvent(\"onAfterLinkAdd\", _autoScheduleAfterLinkChange);\n\n\t\tgantt.attachEvent(\"onAfterLinkDelete\", function(id: LinkID, link: ILink) {\n\t\t\tif (\n\t\t\t\tgantt.config.auto_scheduling &&\n\t\t\t\t!gantt._autoscheduling_in_progress &&\n\t\t\t\tgantt.isTaskExists(link.target)\n\t\t\t) {\n\t\t\t\t// after link deleted - auto schedule target for other relations that may be left\n\t\t\t\tconst target = gantt.getTask(link.target);\n\t\t\t\tconst predecessors = gantt._getPredecessors(target);\n\t\t\t\tif (predecessors.length) {\n\t\t\t\t\tif(gantt.getState().batch_update){\n\t\t\t\t\t\t_scheduleAfterBatchUpdate = true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tgantt.autoSchedule(predecessors[0].source, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tgantt.attachEvent(\"onParse\", function() {\n\t\t\tif (\n\t\t\t\tgantt.config.auto_scheduling &&\n\t\t\t\tgantt.config.auto_scheduling_initial\n\t\t\t) {\n\t\t\t\tgantt.autoSchedule();\n\t\t\t}\n\t\t});\n\n\t\tfunction _preventCircularLink(id: LinkID, link: ILink): boolean {\n\t\t\tconst slackConfigValue = gantt.config.auto_scheduling_use_progress;\n\t\t\tgantt.config.auto_scheduling_use_progress = false;\n\n\t\t\tif (gantt.isCircularLink(link)) {\n\t\t\t\tgantt.callEvent(\"onCircularLinkError\", [\n\t\t\t\t\tlink,\n\t\t\t\t\tloopsFinder.getLoopContainingLink(link)\n\t\t\t\t]);\n\t\t\t\tgantt.config.auto_scheduling_use_progress = slackConfigValue;\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\tgantt.config.auto_scheduling_use_progress = slackConfigValue;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tfunction _preventDescendantLink(id: LinkID, link: ILink): boolean {\n\t\t\tconst source = gantt.getTask(link.source);\n\t\t\tconst target = gantt.getTask(link.target);\n\n\t\t\tif (!gantt.config.auto_scheduling_descendant_links) {\n\t\t\t\tif (\n\t\t\t\t\t(gantt.isChildOf(source.id, target.id) &&\n\t\t\t\t\t\tgantt.isSummaryTask(target)) ||\n\t\t\t\t\t(gantt.isChildOf(target.id, source.id) && gantt.isSummaryTask(source))\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tgantt.attachEvent(\"onBeforeLinkAdd\", _preventCircularLink);\n\t\tgantt.attachEvent(\"onBeforeLinkAdd\", _preventDescendantLink);\n\t\tgantt.attachEvent(\"onBeforeLinkUpdate\", _preventCircularLink);\n\t\tgantt.attachEvent(\"onBeforeLinkUpdate\", _preventDescendantLink);\n\n\t\tfunction _datesNotEqual(\n\t\t\tdateA: Date,\n\t\t\tdateB: Date,\n\t\t\ttaskA: ITask,\n\t\t\ttaskB: ITask\n\t\t): boolean {\n\t\t\tif (!!dateA !== !!dateB) {\n\t\t\t\t// if one of dates is empty or null and the other is not\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!dateA && !dateB) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (dateA.valueOf() > dateB.valueOf()) {\n\t\t\t\treturn gantt._hasDuration({\n\t\t\t\t\tstart_date: dateB,\n\t\t\t\t\tend_date: dateA,\n\t\t\t\t\ttask: taskB\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn gantt._hasDuration({\n\t\t\t\t\tstart_date: dateA,\n\t\t\t\t\tend_date: dateB,\n\t\t\t\t\ttask: taskA\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tfunction _notEqualTaskDates(task1: ITask, task2: ITask): boolean {\n\t\t\tif (_datesNotEqual(task1.start_date, task2.start_date, task1, task2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (gantt.getConstraintType(task1) !== gantt.getConstraintType(task2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t_datesNotEqual(\n\t\t\t\t\ttask1.constraint_date,\n\t\t\t\t\ttask2.constraint_date,\n\t\t\t\t\ttask1,\n\t\t\t\t\ttask2\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t_datesNotEqual(task1.start_date, task2.start_date, task1, task2) ||\n\t\t\t\t((_datesNotEqual(task1.end_date, task2.end_date, task1, task2) ||\n\t\t\t\t\ttask1.duration !== task2.duration) &&\n\t\t\t\t\ttask1.type !== gantt.config.types.milestone)\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tfunction getRelations(id: TaskID) {\n\t\t\t// collect relations before drag and drop  in order to have original positions of subtasks within project since they are used as lag when moving dependent project\n\n\t\t\t// TODO: remove in 7.0\n\t\t\tif (gantt.config.auto_scheduling_compatibility) {\n\t\t\t\t// collect only downstream dependencies since there is no backward or ALAP scheduling in pre 6.1 auto scheduling\n\t\t\t\treturn linksBuilder.getLinkedTasks(id, true);\n\t\t\t} else {\n\t\t\t\t// get all connected group (both upstream and downstream dependencies)\n\t\t\t\treturn connectedGroupsHelper.getConnectedGroupRelations(id);\n\t\t\t}\n\t\t}\n\n\t\tlet relations;\n\t\tlet movedTask;\n\t\tgantt.attachEvent(\"onBeforeTaskDrag\", function(\n\t\t\tid: TaskID,\n\t\t\tmode: string,\n\t\t\ttask: ITask\n\t\t) {\n\t\t\tif (\n\t\t\t\tgantt.config.auto_scheduling\n\t\t\t\t// We need to get the movedTask so that we can use it later internally\n\t\t\t\t// && gantt.config.auto_scheduling_move_projects\n\t\t\t) {\n\t\t\t\t// collect relations before drag and drop  in order to have original positions of subtasks within project since they are used as lag when moving dependent project\n\t\t\t\tif(gantt.getState().drag_mode !== \"progress\"){\n\t\t\t\t\trelations = getRelations(id);\n\t\t\t\t}\n\n\t\t\t\tmovedTask = id;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tfunction resetToStartLinksLags(taskId, relationsArray) {\n\t\t\t// task duration is used as lag when converting start_to_start and start_to_finish into finish_to_start links\n\t\t\t// recalculate these links if task duration has changed\n\n\t\t\tlet skipped = false;\n\t\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\t\tconst originalLink = gantt.getLink(relationsArray[i].id);\n\t\t\t\tif (\n\t\t\t\t\toriginalLink &&\n\t\t\t\t\t(originalLink.type === gantt.config.links.start_to_start ||\n\t\t\t\t\t\toriginalLink.type === gantt.config.links.start_to_finish)\n\t\t\t\t) {\n\t\t\t\t\trelationsArray.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t\tskipped = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (skipped) {\n\t\t\t\tconst presentLinks = {};\n\t\t\t\tfor (let i = 0; i < relationsArray.length; i++) {\n\t\t\t\t\tpresentLinks[relationsArray[i].id] = true;\n\t\t\t\t}\n\n\t\t\t\tconst updatedLinks = getRelations(taskId);\n\n\t\t\t\tfor (let i = 0; i < updatedLinks.length; i++) {\n\t\t\t\t\tif (!presentLinks[updatedLinks[i].id]) {\n\t\t\t\t\t\trelationsArray.push(updatedLinks[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// GS-686. We shouldn't change the constraint after changing only the duration or end_date\n\t\tfunction shouldKeepConstraints(task, oldTask){\n\t\t\tif (gantt.config.schedule_from_end) {\n\t\t\t\tif (oldTask.end_date && task.end_date && task.end_date.valueOf() === oldTask.end_date.valueOf()){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (oldTask.start_date && task.start_date && task.start_date.valueOf() === oldTask.start_date.valueOf()){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction updateTaskConstraints(task){\n\t\t\t// GS-1487. Don't add a constraint if auto-scheduling is cancelled\n\t\t\tif (task.auto_scheduling === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// GS-2452. We should keep the constraints type if it doesn't affect the task dates\n\t\t\tconst constraintTypes = gantt.config.constraint_types;\n\t\t\tconst backwardConstraints = [\n\t\t\t\tconstraintTypes.SNLT,\n\t\t\t\tconstraintTypes.FNLT,\n\t\t\t\tconstraintTypes.MSO,\n\t\t\t\tconstraintTypes.MFO\n\t\t\t];\n\t\t\tconst forwardConstraints = [\n\t\t\t\tconstraintTypes.SNET,\n\t\t\t\tconstraintTypes.FNET,\n\t\t\t\tconstraintTypes.MSO,\n\t\t\t\tconstraintTypes.MFO\n\t\t\t];\n\n\t\t\tif (gantt.config.schedule_from_end) {\n\t\t\t\tif (backwardConstraints.indexOf(task.constraint_type) > -1) {\n\t\t\t\t\t// keep the constraint type\n\t\t\t\t\tif (task.constraint_type == constraintTypes.SNLT ||\n\t\t\t\t\t\ttask.constraint_type == constraintTypes.MSO) {\n\t\t\t\t\t\ttask.constraint_date = new Date(task.start_date);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttask.constraint_date = new Date(task.end_date);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// set the default constraint\n\t\t\t\t\ttask.constraint_type = constraintTypes.FNLT;\n\t\t\t\t\ttask.constraint_date = new Date(task.end_date);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (forwardConstraints.indexOf(task.constraint_type) > -1) {\n\t\t\t\t\t// keep the constraint type\n\t\t\t\t\tif (task.constraint_type == constraintTypes.SNET ||\n\t\t\t\t\t\ttask.constraint_type == constraintTypes.MSO) {\n\t\t\t\t\t\ttask.constraint_date = new Date(task.start_date);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttask.constraint_date = new Date(task.end_date);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// set the default constraint\n\t\t\t\t\ttask.constraint_type = constraintTypes.SNET;\n\t\t\t\t\ttask.constraint_date = new Date(task.start_date);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction finalizeTaskConstraints(task){\n\t\t\t// TODO: remove in 7.0\n\t\t\tif (gantt.config.auto_scheduling_compatibility) {\n\t\t\t\tif (task.constraint_type === gantt.config.constraint_types.SNET ||\n\t\t\t\t\ttask.constraint_type === gantt.config.constraint_types.FNLT) {\n\t\t\t\t\t\ttask.constraint_type = null;\n\t\t\t\t\t\ttask.constraint_date = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst _processConstraints = function(taskId, oldTask) {\n\t\t\tconst newTask = gantt.getTask(taskId);\n\t\t\tif (shouldKeepConstraints(newTask, oldTask)) {\n\t\t\t\t// don't change constraints\n\t\t\t} else {\n\t\t\t\tupdateTaskConstraints(newTask);\n\t\t\t}\n\t\t};\n\n\t\tconst _autoScheduleAfterDND = function(taskId, task) {\n\t\t\tif (gantt.config.auto_scheduling && !gantt._autoscheduling_in_progress) {\n\t\t\t\tconst newTask = gantt.getTask(taskId);\n\n\t\t\t\tconst progressScheduling = (gantt.config.auto_scheduling_use_progress && ((task.progress === 1) !== (newTask.progress === 1)));\n\n\t\t\t\tif (_notEqualTaskDates(task, newTask)) {\n\t\t\t\t\t_processConstraints(taskId, task);\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tgantt.config.auto_scheduling_move_projects &&\n\t\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t\t\tmovedTask == taskId\n\t\t\t\t\t) {\n\t\t\t\t\t\tlet shouldResetSSandSFLinkLags = true;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tgantt.calculateDuration(task) !== gantt.calculateDuration(newTask)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// task duration is used as lag when converting start_to_start and start_to_finish into finish to start links\n\t\t\t\t\t\t\t// recalculate these links if task duration has changed\n\t\t\t\t\t\t\tresetToStartLinksLags(taskId, relations);\n\t\t\t\t\t\t\t// to not call the function above twice\n\t\t\t\t\t\t\tshouldResetSSandSFLinkLags = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(progressScheduling){\n\t\t\t\t\t\t\tgantt.autoSchedule();\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t// GS-2588. The duration of the project tasks can be changed after the child drag,\n\t\t\t\t\t\t\t// so, we need to update that information for the SS and SF links\n\t\t\t\t\t\t\tif (shouldResetSSandSFLinkLags) {\n\t\t\t\t\t\t\t\tresetToStartLinksLags(taskId, relations);\n\t\t\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t\t\t\tgantt._autoSchedule(taskId, relations);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgantt.autoSchedule(newTask.id);\n\t\t\t\t\t}\n\n\t\t\t\t\tfinalizeTaskConstraints(newTask);\n\t\t\t\t}\n\t\t\t}\n\t\t\trelations = null;\n\t\t\tmovedTask = null;\n\t\t\treturn true;\n\t\t};\n\n\n\n\n\t\tlet modifiedTaskId = null;\n\t\tif (gantt.ext && gantt.ext.inlineEditors) {\n\t\t\tconst inlineEditors = gantt.ext.inlineEditors;\n\t\t\tconst autoscheduleColumns = {\n\t\t\t\tstart_date: true,\n\t\t\t\tend_date: true,\n\t\t\t\tduration: true,\n\t\t\t\tconstraint_type: true,\n\t\t\t\tconstraint_date: true\n\t\t\t};\n\n\t\t\tinlineEditors.attachEvent(\"onBeforeSave\", function(state) {\n\t\t\t\tif (autoscheduleColumns[state.columnName]) {\n\t\t\t\t\tmodifiedTaskId = state.id;\n\t\t\t\t\t// GS-711. The constraint type set by the user should be saved\n\t\t\t\t\tif (state.columnName === \"constraint_type\"){\n\t\t\t\t\t\tchangedConstraint = true;\n\t\t\t\t\t}\n\t\t\t\t\t// GS-686. We shouldn't change the constraint after changing only the duration or end_date\n\t\t\t\t\tconst durationColumn = state.columnName === \"duration\";\n\t\t\t\t\tconst startDateColumn = gantt.config.schedule_from_end && (state.columnName === \"start_date\");\n\t\t\t\t\tconst endDateColumn = !gantt.config.schedule_from_end && (state.columnName === \"end_date\");\n\n\t\t\t\t\tconst linkedDateModification = gantt.config.inline_editors_date_processing !== \"keepDuration\";\n\t\t\t\t\tconst linkedColumnEdit = linkedDateModification && (startDateColumn || endDateColumn);\n\n\t\t\t\t\tconst constraintDateColumn = state.columnName === \"constraint_date\";\n\n\t\t\t\t\tconst keepConstraints = durationColumn || linkedColumnEdit || constraintDateColumn;\n\n\t\t\t\t\tif (keepConstraints) {\n\t\t\t\t\t\tconst task = gantt.getTask(state.id);\n\t\t\t\t\t\ttask.$keep_constraints = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tlet changedConstraint;\n\t\tfunction onBeforeLigthboxSaveHandler(taskId: TaskID, task: ITask): boolean {\n\t\t\tif (gantt.config.auto_scheduling && !gantt._autoscheduling_in_progress) {\n\t\t\t\tchangedConstraint = false;\n\t\t\t\tconst oldTask = gantt.getTask(taskId);\n\t\t\t\tif (_notEqualTaskDates(task, oldTask)) {\n\t\t\t\t\tmodifiedTaskId = taskId;\n\t\t\t\t\tif (shouldKeepConstraints(task, oldTask)){\n\t\t\t\t\t\ttask.$keep_constraints = true;\n\t\t\t\t\t}\n\t\t\t\t\tif(gantt.getConstraintType(task) !== gantt.getConstraintType(oldTask) ||\n\t\t\t\t\t\t+task.constraint_date !== +oldTask.constraint_date\n\t\t\t\t\t){\n\t\t\t\t\t\tchangedConstraint = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\tfunction onAfterTaskUpdateHandler(taskId: TaskID, task: ITask): boolean {\n\t\t\tif (gantt.config.auto_scheduling && !gantt._autoscheduling_in_progress) {\n\t\t\t\tif (\n\t\t\t\t\tmodifiedTaskId !== null &&\n\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t\tmodifiedTaskId == taskId\n\t\t\t\t) {\n\t\t\t\t\tmodifiedTaskId = null;\n\t\t\t\t\tif (task.$keep_constraints){\n\t\t\t\t\t\tdelete task.$keep_constraints;\n\t\t\t\t\t} else if(!changedConstraint){\n\t\t\t\t\t\tupdateTaskConstraints(task);\n\t\t\t\t\t}\n\t\t\t\t\tgantt.autoSchedule(task.id);\n\n\t\t\t\t\tif(!changedConstraint){\n\t\t\t\t\t\tfinalizeTaskConstraints(task);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tconst draggedTask = {};\n\t\tlet timeout;\n\t\tgantt.attachEvent(\"onBeforeTaskChanged\", function(\n\t\t\tid: TaskID,\n\t\t\tmode: string,\n\t\t\ttask: ITask\n\t\t) {\n\t\t\t_processConstraints(id, task);\n\t\t\tdraggedTask[id] = task;\n\t\t\treturn true;\n\t\t});\n\n\t\t// GS-499, GS-264 and GS-836. Autoschedule only after finishing dragging the task\n\t\tgantt.attachEvent(\"onAfterTaskDrag\", function(id, mode, e) {\n\t\t\tif (id === movedTask) {\n\t\t\t\tclearTimeout(timeout);\n\t\t\t\ttimeout = setTimeout(function() {\n\t\t\t\t\t_autoScheduleAfterDND(id, draggedTask[id]);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tif(gantt.ext.inlineEditors){\n\t\t\tgantt.ext.inlineEditors.attachEvent(\"onBeforeSave\", function(state){\n\t\t\t\tif (gantt.config.auto_scheduling && !gantt._autoscheduling_in_progress) {\n\t\t\t\t\tconst api = gantt.ext.inlineEditors;\n\t\t\t\t\tconst editorConfig = api.getEditorConfig(state.columnName);\n\t\t\t\t\tif(editorConfig.map_to === \"start_date\" || editorConfig.map_to === \"end_date\" || editorConfig.map_to === \"duration\"){\n\t\t\t\t\t\tmodifiedTaskId = state.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tgantt.attachEvent(\"onLightboxSave\", onBeforeLigthboxSaveHandler);\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", onAfterTaskUpdateHandler);\n\t};\n\n\tgantt.attachEvent(\"onGanttReady\", function() {\n\t\t_attachAutoSchedulingHandlers();\n\t\t// attach handlers only when initialized for the first time\n\t}, {once: true});\n}\n","\n/* eslint-disable no-restricted-globals */\nvar globalScope;\nif(typeof window !== \"undefined\"){\n\tglobalScope = window;\n}else{\n\tglobalScope = global;\n}\n/* eslint-enable no-restricted-globals */\n\nexport default globalScope;","import * as domHelpers from \"../../core/ui/utils/dom_helpers\";\nimport global from \"../../utils/global\";\nimport { SelectedRegion } from \"./selectedRegion\";\n\nexport class EventsManager {\n\tprivate _mouseDown: boolean = false;\n\tprivate _domEvents: any;\n\tprivate _originPosition: string;\n\tprivate _gantt: any;\n\tprivate _restoreOriginPosition: () => void;\n\tconstructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t\tthis._domEvents = gantt._createDomEventScope();\n\t}\n\n\tattach(selectedRegion: SelectedRegion, useKey?: \"shiftKey\" | \"ctrlKey\" | \"altKey\", ignore?: any): void {\n\t\tconst gantt = this._gantt;\n\t\tconst _target = selectedRegion.getViewPort();\n\t\tthis._originPosition = global.getComputedStyle(_target).display;\n\t\tthis._restoreOriginPosition = () => {\n\t\t\t_target.style.position = this._originPosition;\n\t\t};\n\t\tif (this._originPosition === \"static\") {\n\t\t\t_target.style.position = \"relative\";\n\t\t}\n\t\tconst state = gantt.$services.getService(\"state\");\n\t\tstate.registerProvider(\"clickDrag\", () => {\n\t\t\tconst result = { autoscroll: false };\n\t\t\treturn result;\n\t\t});\n\n\n\t\tlet scheduledDndCoordinates = null;\n\t\tconst startDragAndDrop = () => {\n\t\t\tif (!scheduledDndCoordinates) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._mouseDown = true;\n\t\t\tselectedRegion.setStart(gantt.copy(scheduledDndCoordinates));\n\t\t\tselectedRegion.setPosition(gantt.copy(scheduledDndCoordinates));\n\t\t\tselectedRegion.setEnd(gantt.copy(scheduledDndCoordinates));\n\t\t\tscheduledDndCoordinates = null;\n\t\t};\n\n\t\tthis._domEvents.attach(_target, \"mousedown\", (event) => {\n\t\t\tscheduledDndCoordinates = null;\n\t\t\tlet filterTargets = \".gantt_task_line, .gantt_task_link\";\n\t\t\tif (ignore !== undefined) {\n\t\t\t\tif (ignore instanceof Array) {\n\t\t\t\t\tfilterTargets = ignore.join(\", \");\n\t\t\t\t} else {\n\t\t\t\t\tfilterTargets = ignore;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (filterTargets) {\n\t\t\t\tif (gantt.utils.dom.closest(event.target, filterTargets)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstate.registerProvider(\"clickDrag\", () => {\n\t\t\t\tconst result = { autoscroll: this._mouseDown };\n\t\t\t\treturn result;\n\t\t\t});\n\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\tscheduledDndCoordinates = this._getCoordinates(event, selectedRegion);\n\t\t});\n\t\tconst eventElement = domHelpers.getRootNode(gantt.$root) || document.body;\n\t\tthis._domEvents.attach(eventElement, \"mouseup\", (event) => {\n\t\t\tscheduledDndCoordinates = null;\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\tif (this._mouseDown === true) {\n\t\t\t\tthis._mouseDown = false;\n\t\t\t\tconst coordinates = this._getCoordinates(event, selectedRegion);\n\t\t\t\tselectedRegion.dragEnd(coordinates);\n\t\t\t}\n\t\t});\n\t\tthis._domEvents.attach(_target, \"mousemove\", (event) => {\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\t// GS-854. If we don't have useKey for the click_drag extension,\n\t\t\t// check the drag_timeline to not simultaneously use both extensions\n\t\t\tconst dragTimeline = this._gantt.ext.clickDrag;\n\t\t\tconst dragTimelineUseKey = (this._gantt.config.drag_timeline || {}).useKey;\n\t\t\tif (dragTimeline && dragTimelineUseKey) {\n\t\t\t\tif (!useKey && event[dragTimelineUseKey]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet coordinates = null;\n\t\t\tif(!this._mouseDown && scheduledDndCoordinates){\n\t\t\t\tcoordinates = this._getCoordinates(event, selectedRegion);\n\t\t\t\tif(Math.abs(scheduledDndCoordinates.relative.left - coordinates.relative.left) > 5){\n\t\t\t\t\t// add small threshold not to start dnd on simple click\n\t\t\t\t\tstartDragAndDrop();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._mouseDown === true) {\n\t\t\t\tcoordinates = this._getCoordinates(event, selectedRegion);\n\t\t\t\tselectedRegion.setEnd(coordinates);\n\t\t\t\tselectedRegion.render();\n\t\t\t}\n\t\t});\n\t}\n\n\tdetach(): void {\n\t\tconst gantt = this._gantt;\n\t\tthis._domEvents.detachAll();\n\t\tif(this._restoreOriginPosition){\n\t\t\tthis._restoreOriginPosition();\n\t\t}\n\n\t\tconst state = gantt.$services.getService(\"state\");\n\t\tstate.unregisterProvider(\"clickDrag\");\n\t}\n\n\tdestructor(): void {\n\t\tthis.detach();\n\t}\n\n\tprivate _getCoordinates(event: MouseEvent, selectedRegion: SelectedRegion) {\n\t\tconst viewPort = selectedRegion.getViewPort();\n\t\tconst viewPortBounds = viewPort.getBoundingClientRect();\n\t\tconst { clientX, clientY } = event;\n\t\tconst result = {\n\t\t\tabsolute: {\n\t\t\t\tleft: clientX,\n\t\t\t\ttop: clientY\n\t\t\t},\n\t\t\trelative: {\n\t\t\t\tleft: clientX - viewPortBounds.left + viewPort.scrollLeft,\n\t\t\t\ttop: clientY - viewPortBounds.top + viewPort.scrollTop\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n}","var EventHost = function(){\n\tthis._silent_mode = false;\n\tthis.listeners = {};\n};\n\nEventHost.prototype = {\n\t_silentStart: function() {\n\t\tthis._silent_mode = true;\n\t},\n\t_silentEnd: function() {\n\t\tthis._silent_mode = false;\n\t}\n};\n\nvar\tcreateEventStorage = function(obj) {\n\tvar handlers = {};\n\tvar index = 0;\n\tvar eventStorage = function(){\n\t\tvar combinedResult = true;\n\t\tfor(var i in handlers){\n\t\t\tvar handlerResult = handlers[i].apply(obj, arguments);\n\t\t\tcombinedResult=combinedResult && handlerResult;\n\t\t}\n\t\treturn combinedResult;\n\t};\n\teventStorage.addEvent=function(handler, settings){\n\t\tif (typeof (handler) == \"function\"){\n\t\t\tvar handlerId;\n\t\t\tif(settings && settings.id){\n\t\t\t\thandlerId = settings.id;\n\t\t\t}else{\n\t\t\t\thandlerId = index;\n\t\t\t\tindex++;\n\t\t\t}\n\n\t\t\tif(settings && settings.once){\n\t\t\t\tvar originalHandler = handler;\n\t\t\t\thandler = function(){\n\t\t\t\t\toriginalHandler();\n\t\t\t\t\teventStorage.removeEvent(handlerId);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\thandlers[handlerId] = handler;\n\t\t\treturn handlerId;\n\t\t}\n\t\treturn false;\n\t};\n\teventStorage.removeEvent=function(id){\n\t\tdelete handlers[id];\n\t};\n\n\teventStorage.clear = function(){\n\t\thandlers = {};\n\t};\n\n\treturn eventStorage;\n};\n\nfunction makeEventable(obj){\n\n\tvar eventHost = new EventHost();\n\tobj.attachEvent=function(eventName, handler, settings){\n\t\teventName = 'ev_'+eventName.toLowerCase();\n\t\tif (!eventHost.listeners[eventName]){\n\t\t\teventHost.listeners[eventName] = createEventStorage(this);\n\t\t}\n\n\t\tif(settings && settings.thisObject){\n\t\t\thandler = handler.bind(settings.thisObject);\n\t\t}\n\n\t\tvar innerId = eventHost.listeners[eventName].addEvent(handler, settings);\n\n\t\tvar handlerId = (eventName+':'+innerId); //return ID (ev_eventname:1)\n\t\tif(settings && settings.id){\n\t\t\thandlerId = settings.id;\n\t\t}\n\t\treturn handlerId;\n\t};\n\n\tobj.attachAll = function(callback){\n\t\tthis.attachEvent('listen_all', callback);\n\t};\n\n\tobj.callEvent=function(name, eventArguments){\n\t\tif (eventHost._silent_mode) return true;\n\n\t\tvar handlerName = 'ev_'+name.toLowerCase();\n\n\t\tvar listeners = eventHost.listeners;\n\t\tif (listeners['ev_listen_all']){\n\t\t\tlisteners['ev_listen_all'].apply(this, [name].concat(eventArguments));\n\t\t}\n\n\t\tif (listeners[handlerName])\n\t\t\treturn listeners[handlerName].apply(this, eventArguments);\n\t\treturn true;\n\t};\n\n\tobj.checkEvent=function(name){\n\t\tvar listeners = eventHost.listeners;\n\t\treturn (!!listeners['ev_'+name.toLowerCase()]);\n\t};\n\n\tobj.detachEvent=function(id){\n\t\tif (id){\n\t\t\tvar listeners = eventHost.listeners;\n\t\t\tfor(var i in listeners){\n\t\t\t\tlisteners[i].removeEvent(id); //remove event\n\t\t\t}\n\n\t\t\tvar list = id.split(':');//get EventName and ID\n\t\t\tvar listeners = eventHost.listeners;\n\t\t\tif(list.length === 2){\n\t\t\t\tvar eventName = list[0];\n\t\t\t\tvar eventId = list[1];\n\t\t\t\tif(listeners[eventName]){\n\t\t\t\t\tlisteners[eventName].removeEvent(eventId); //remove event\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tobj.detachAllEvents = function(){\n\t\tfor (var name in eventHost.listeners) {\n\t\t\teventHost.listeners[name].clear();\n\t\t}\n\t};\n\n}\n\nexport default makeEventable;","import eventable from \"../../utils/eventable\";\nimport { isEventable } from \"../../utils/helpers\";\n\nexport interface ISelectedRegionConfig {\n\tclassName?: string;\n\trender?: (startPoint: IPoint, endPoint: IPoint) => HTMLElement;\n\tviewPort?: HTMLElement;\n\tuseRequestAnimationFrame: boolean;\n\tcallback?: (startPoint: IPoint, endPoint: IPoint, startDate: Date, endDate: Date, tasksByDate: any[], tasksByIndex: any[]) => void;\n\tsingleRow: boolean;\n}\n\ninterface ICoordinates {\n\tleft: number;\n\ttop: number;\n}\n\nexport interface IPoint {\n\tabsolute: ICoordinates;\n\trelative: ICoordinates;\n}\n\nexport class SelectedRegion {\n\trender: () => void;\n\tprivate _viewPort: HTMLElement & eventable;\n\tprivate _el: HTMLElement = document.createElement(\"div\");\n\tprivate _callback: (startPoint: IPoint, endPoint: IPoint, startDate: Date, endDate: Date, tasksByDate: any[], tasksByIndex: any[]) => void;\n\tprivate _startPoint: IPoint;\n\tprivate _endPoint: IPoint;\n\tprivate _positionPoint: IPoint;\n\tprivate _useRequestAnimationFrame: boolean;\n\tprivate _startDate: Date;\n\tprivate _endDate: Date;\n\tprivate _singleRow: boolean;\n\tprivate _gantt: any;\n\tprivate _view: any;\n\n\tconstructor(config: ISelectedRegionConfig, gantt: any, view: any) {\n\t\tthis._gantt = gantt;\n\t\tthis._view = view;\n\t\tthis._viewPort = config.viewPort;\n\t\tthis._el.classList.add(config.className);\n\t\tif (typeof config.callback === \"function\") {\n\t\t\tthis._callback = config.callback;\n\t\t}\n\n\t\tthis.render = () => {\n\t\t\tlet node;\n\t\t\tif(config.render){\n\t\t\t\tnode = config.render(this._startPoint, this._endPoint);\n\t\t\t}else{\n\t\t\t\tnode = this.defaultRender(this._startPoint, this._endPoint);\n\t\t\t}\n\n\t\t\tif(node !== this._el){\n\t\t\t\tif(this._el && this._el.parentNode){\n\t\t\t\t\tthis._el.parentNode.removeChild(this._el);\n\t\t\t\t}\n\t\t\t\tthis._el = node;\n\t\t\t}\n\n\t\t\tif (config.className !== \"\") {\n\t\t\t\tthis._el.classList.add(config.className);\n\t\t\t}\n\t\t\tthis.draw();\n\t\t};\n\n\t\tif (!isEventable(this._viewPort)) {\n\t\t\teventable(this._viewPort);\n\t\t}\n\t\tthis._singleRow = config.singleRow;\n\t\tthis._useRequestAnimationFrame = config.useRequestAnimationFrame;\n\t}\n\n\tdefaultRender = (start: IPoint, end: IPoint) => {\n\t\tif(!this._el){\n\t\t\tthis._el = document.createElement(\"div\");\n\t\t}\n\t\tconst node = this._el;\n\t\t// const gantt = this._gantt;\n\n\t\tconst top = Math.min(start.relative.top, end.relative.top);\n\t\tconst bottom = Math.max(start.relative.top, end.relative.top);\n\t\tconst left = Math.min(start.relative.left, end.relative.left);\n\t\tconst right = Math.max(start.relative.left, end.relative.left);\n\n\t\tif (this._singleRow) {\n\t\t\tconst pos = this._getTaskPositionByTop(this._startPoint.relative.top);\n\t\t\tnode.style.height = pos.height + \"px\";\n\t\t\tnode.style.top = pos.top + \"px\";\n\t\t} else {\n\t\t\tnode.style.height = Math.abs(bottom - top) + \"px\";\n\t\t\tnode.style.top = top + \"px\";\n\t\t}\n\t\tnode.style.width = Math.abs(right - left) + \"px\";\n\t\tnode.style.left = left + \"px\";\n\t\treturn node;\n\t};\n\n\tdraw() {\n\t\tif (this._useRequestAnimationFrame) {\n\t\t\treturn requestAnimationFrame(() => {\n\t\t\t\tthis._viewPort.appendChild(this.getElement());\n\t\t\t});\n\t\t} else {\n\t\t\tthis._viewPort.appendChild(this.getElement());\n\t\t}\n\t}\n\n\tclear() {\n\t\tif (this._useRequestAnimationFrame) {\n\t\t\treturn requestAnimationFrame(() => {\n\t\t\t\tif (!this._el.parentNode) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._viewPort.removeChild(this._el);\n\t\t\t});\n\t\t} else {\n\t\t\tif (!this._el.parentNode) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._viewPort.removeChild(this._el);\n\t\t}\n\t}\n\n\tgetElement() {\n\t\treturn this._el;\n\t}\n\n\tgetViewPort() {\n\t\treturn this._viewPort;\n\t}\n\n\tsetStart(startPoint: IPoint) {\n\t\tconst gantt = this._gantt;\n\t\tthis._startPoint = startPoint;\n\t\tthis._startDate = gantt.dateFromPos(this._startPoint.relative.left);\n\t\tthis._viewPort.callEvent(\"onBeforeDrag\", [this._startPoint]);\n\t}\n\n\tsetEnd(endPoint: IPoint) {\n\t\tconst gantt = this._gantt;\n\t\tthis._endPoint = endPoint;\n\t\tif (this._singleRow) {\n\t\t\tconst pos = this._getTaskPositionByTop(this._startPoint.relative.top);\n\t\t\tthis._endPoint.relative.top = pos.top;\n\t\t}\n\t\tthis._endDate = gantt.dateFromPos(this._endPoint.relative.left);\n\t\tif (this._startPoint.relative.left > this._endPoint.relative.left) {\n\t\t\tthis._positionPoint = {\n\t\t\t\trelative: { left: this._endPoint.relative.left, top: this._positionPoint.relative.top },\n\t\t\t\tabsolute: { left: this._endPoint.absolute.left, top: this._positionPoint.absolute.top }\n\t\t\t};\n\t\t}\n\t\tif (this._startPoint.relative.top > this._endPoint.relative.top) {\n\t\t\tthis._positionPoint = {\n\t\t\t\trelative: { left: this._positionPoint.relative.left, top: this._endPoint.relative.top },\n\t\t\t\tabsolute: { left: this._positionPoint.absolute.left, top: this._endPoint.absolute.top }\n\t\t\t};\n\t\t}\n\n\n\t\tthis._viewPort.callEvent(\"onDrag\", [this._startPoint, this._endPoint]);\n\t}\n\n\tsetPosition(positionPoint: IPoint) {\n\t\tthis._positionPoint = positionPoint;\n\t}\n\n\tdragEnd(endPoint: IPoint) {\n\t\tconst gantt = this._gantt;\n\t\tif(endPoint.relative.left < 0){\n\t\t\tendPoint.relative.left = 0;\n\t\t}\n\t\tthis._viewPort.callEvent(\"onBeforeDragEnd\", [this._startPoint, endPoint]);\n\t\tthis.setEnd(endPoint);\n\t\t// GS-1422. The endDate can be null if we drag the mouse outside the Gantt container\n\t\tthis._endDate = this._endDate || gantt.getState().max_date;\n\n\t\tif (this._startDate.valueOf() > this._endDate.valueOf()) {\n\t\t\t[ this._startDate, this._endDate ] = [ this._endDate, this._startDate ];\n\t\t}\n\t\tthis.clear();\n\t\tconst tasksByTime = gantt.getTaskByTime(this._startDate, this._endDate);\n\t\tconst tasksByIndex = this._getTasksByTop(this._startPoint.relative.top, this._endPoint.relative.top);\n\n\t\tthis._viewPort.callEvent(\"onDragEnd\", [this._startPoint, this._endPoint]);\n\t\tif (this._callback) {\n\t\t\tthis._callback(this._startPoint, this._endPoint, this._startDate, this._endDate, tasksByTime, tasksByIndex);\n\t\t}\n\t}\n\n\tgetInBounds() {\n\t\treturn this._singleRow;\n\t}\n\n\tprivate _getTasksByTop(start: number, end:number) {\n\t\tconst gantt = this._gantt;\n\t\tlet startValue = start;\n\t\tlet endValue = end;\n\t\tif (start > end) {\n\t\t\tstartValue = end;\n\t\t\tendValue = start;\n\t\t}\n\t\tconst startIndex = this._getTaskPositionByTop(startValue).index;\n\t\tconst endIndex = this._getTaskPositionByTop(endValue).index;\n\t\tconst result = [];\n\t\tfor (let i = startIndex; i <= endIndex; i++) {\n\t\t\tconst task = gantt.getTaskByIndex(i);\n\t\t\tif (task) {\n\t\t\t\tresult.push(gantt.getTaskByIndex(i));\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _getTaskPositionByTop(top: number){\n\t\tconst gantt = this._gantt;\n\t\tconst view = this._view;\n\t\tconst index = view.getItemIndexByTopPosition(top);\n\t\tconst task = gantt.getTaskByIndex(index);\n\t\tif(task){\n\t\t\tconst height = view.getItemHeight(task.id);\n\t\t\tconst itemTop = view.getItemTop(task.id);\n\t\t\treturn {\n\t\t\t\ttop: itemTop || 0,\n\t\t\t\theight: height || 0,\n\t\t\t\tindex\n\t\t\t};\n\t\t} else {\n\t\t\tconst dataHeight = view.getTotalHeight();\n\t\t\treturn {\n\t\t\t\ttop: top > dataHeight ? dataHeight : 0,\n\t\t\t\theight: gantt.config.row_height,\n\t\t\t\tindex: top > dataHeight ? gantt.getTaskCount() : 0\n\t\t\t};\n\t\t}\n\t}\n}","interface IPoint {\n\tx: number;\n\ty: number;\n}\n\nlet _dragInProgress: boolean = false;\n\nexport class EventsManager {\n\tstatic create(gantt: any) {\n\t\treturn new EventsManager(gantt);\n\t}\n\tstatic _isDragInProgress() {\n\t\treturn _dragInProgress;\n\t}\n\tprivate _mouseDown: boolean = false;\n\tprivate _startPoint: IPoint;\n\tprivate _scrollState: IPoint;\n\tprivate _originAutoscroll: boolean;\n\tprivate _domEvents: any;\n\tprivate _timeline: any;\n\tprivate _gantt: any;\n\tprivate _trace: IPoint[];\n\tprivate _originalReadonly: boolean;\n\n\tconstructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t\tthis._domEvents = gantt._createDomEventScope();\n\t\tthis._trace = [];\n\t}\n\n\tdestructor() {\n\t\tthis._domEvents.detachAll();\n\t}\n\n\tattach(timeline: any): void {\n\t\tthis._timeline = timeline;\n\t\tconst gantt = this._gantt;\n\t\tthis._domEvents.attach(timeline.$task, \"mousedown\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey,ignore, enabled } = gantt.config.drag_timeline;\n\t\t\tif(enabled === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet filterTargets = \".gantt_task_line, .gantt_task_link\";\n\t\t\tif(ignore !== undefined) {\n\t\t\t\tif(ignore instanceof Array){\n\t\t\t\t\tfilterTargets = ignore.join(\", \");\n\t\t\t\t} else {\n\t\t\t\t\tfilterTargets = ignore;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (filterTargets) {\n\t\t\t\tif (gantt.utils.dom.closest(event.target, filterTargets)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\n\t\t\tthis._startDrag(event);\n\t\t});\n\n\t\tthis._domEvents.attach(document, \"keydown\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] === true) {\n\t\t\t\tthis._applyDndReadyStyles();\n\t\t\t}\n\t\t});\n\t\tthis._domEvents.attach(document, \"keyup\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] === false) {\n\t\t\t\tthis._clearDndReadyStyles();\n\t\t\t\tthis._stopDrag(event);\n\t\t\t}\n\t\t});\n\n\t\tthis._domEvents.attach(document, \"mouseup\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(gantt.$root, \"mouseup\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(document, \"mouseleave\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(gantt.$root, \"mouseleave\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\n\t\tthis._domEvents.attach(gantt.$root, \"mousemove\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\t// GS-854. If we don't have useKey for the drag_timeline extension,\n\t\t\t// check the click_drag to not simultaneously use both extensions\n\t\t\tconst clickDrag = this._gantt.ext.clickDrag;\n\t\t\tconst clickDragUseKey = (this._gantt.config.click_drag || {}).useKey;\n\t\t\tif (clickDrag && clickDragUseKey) {\n\t\t\t\tif (!useKey && event[clickDragUseKey]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._mouseDown === true) {\n\t\t\t\tthis._trace.push({ x: event.clientX, y: event.clientY });\n\t\t\t\tconst scrollPosition: IPoint = this._countNewScrollPosition({ x: event.clientX, y: event.clientY });\n\t\t\t\tthis._setScrollPosition(timeline, scrollPosition);\n\t\t\t\tthis._scrollState = scrollPosition;\n\t\t\t\tthis._startPoint = { x: event.clientX, y: event.clientY };\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _calculateDirectionVector = () => {\n\t\tconst traceSteps = 10;\n\t\tif(this._trace.length >= traceSteps) {\n\t\t\tconst dots = this._trace.slice(this._trace.length - traceSteps);\n\n\t\t\tconst vectors = [];\n\t\t\tfor(let i = 1; i < dots.length; i++) {\n\t\t\t\tvectors.push({\n\t\t\t\t\tx: dots[i].x - dots[i - 1].x,\n\t\t\t\t\ty: dots[i].y - dots[i - 1].y\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst resultVector = {x:0, y:0};\n\n\t\t\tvectors.forEach((vector) => {\n\t\t\t\tresultVector.x += vector.x;\n\t\t\t\tresultVector.y += vector.y;\n\t\t\t});\n\n\t\t\tconst magnitude = Math.sqrt(resultVector.x*resultVector.x + resultVector.y*resultVector.y);\n\t\t\tconst angleDegrees = Math.atan2(Math.abs(resultVector.y), Math.abs(resultVector.x)) * 180 / Math.PI;\n\n\t\t\treturn {\n\t\t\t\tmagnitude,\n\t\t\t\tangleDegrees\n\t\t\t};\n\n\t\t}\n\t\treturn null;\n\t};\n\n\tprivate _applyDndReadyStyles = (): void => {\n\t\tthis._timeline.$task.classList.add(\"gantt_timeline_move_available\");\n\t};\n\n\tprivate _clearDndReadyStyles = (): void => {\n\t\tthis._timeline.$task.classList.remove(\"gantt_timeline_move_available\");\n\t};\n\n\tprivate _getScrollPosition = (timeline: any): IPoint => {\n\t\tconst gantt = this._gantt;\n\t\treturn {\n\t\t\tx: gantt.$ui.getView(timeline.$config.scrollX).getScrollState().position,\n\t\t\ty: gantt.$ui.getView(timeline.$config.scrollY).getScrollState().position\n\t\t};\n\t};\n\tprivate _countNewScrollPosition = (coords: IPoint): IPoint => {\n\t\tconst vector = this._calculateDirectionVector();\n\t\tlet shiftX = this._startPoint.x - coords.x;\n\t\tlet shiftY = this._startPoint.y - coords.y;\n\t\tif(vector){\n\t\t\tif(vector.angleDegrees < 15){\n\t\t\t\tshiftY = 0;\n\t\t\t} else if(vector.angleDegrees > 75){\n\t\t\t\tshiftX = 0;\n\t\t\t}\n\t\t}\n\n\t\tconst result = {\n\t\t\tx: this._scrollState.x + shiftX,\n\t\t\ty: this._scrollState.y + shiftY\n\t\t};\n\t\treturn result;\n\t};\n\tprivate _setScrollPosition = (timeline: any, coords: IPoint): void => {\n\t\tconst gantt = this._gantt;\n\t\trequestAnimationFrame(() => {\n\t\t\tgantt.scrollLayoutCell(timeline.$id, coords.x, coords.y);\n\t\t});\n\t};\n\tprivate _stopDrag = (event: Event): void => {\n\t\tconst gantt = this._gantt;\n\t\tthis._trace = [];\n\t\tgantt.$root.classList.remove(\"gantt_noselect\");\n\n\t\t// We need to set the readonly mode because with the key modifiers, \n\t\t// users may expect to start dragging the timeline on the task and link coordinates\n\t\tif(this._originalReadonly !== undefined){\n\t\t\tgantt.config.readonly = this._originalReadonly;\n\t\t\tif(this._mouseDown && gantt.config.drag_timeline && gantt.config.drag_timeline.render){\n\t\t\t\tgantt.render();\n\t\t\t}\n\t\t}\n\n\t\tif(this._originAutoscroll !== undefined){\n\t\t\tgantt.config.autoscroll = this._originAutoscroll;\n\t\t}\n\n\t\tif(gantt.config.drag_timeline){\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] !== true) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis._mouseDown = false;\n\t\t_dragInProgress = false;\n\t};\n\n\tprivate _startDrag = (event: any) : void => {\n\t\tconst gantt = this._gantt;\n\t\tthis._originAutoscroll = gantt.config.autoscroll;\n\t\tgantt.config.autoscroll = false;\n\t\t_dragInProgress = true;\n\n\t\tgantt.$root.classList.add(\"gantt_noselect\");\n\t\tthis._originalReadonly = gantt.config.readonly;\n\t\tgantt.config.readonly = true;\n\n\t\tif(gantt.config.drag_timeline && gantt.config.drag_timeline.render){\n\t\t\tgantt.render();\n\t\t}\n\n\t\tthis._trace = [];\n\t\tthis._mouseDown = true;\n\t\tconst { x, y } = this._getScrollPosition(this._timeline);\n\t\tthis._scrollState = { x, y };\n\t\tthis._startPoint = { x: event.clientX, y: event.clientY };\n\t\tthis._trace.push(this._startPoint);\n\t};\n}","export default function(gantt) {\n\n\t(function () {\n\t\tvar modalsStack = [];\n\n\t\tfunction isModal() {\n\t\t\treturn !!modalsStack.length;\n\t\t}\n\n\t\tfunction afterPopup(box) {\n\t\t\tsetTimeout(function () {\n\t\t\t\tif (!isModal()){\n\t\t\t\t\tif(!gantt.$destroyed){\n\t\t\t\t\t\tgantt.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 1);\n\t\t}\n\n\t\tfunction startModal(box) {\n\t\t\tgantt.eventRemove(box, \"keydown\", trapFocus);\n\t\t\tgantt.event(box, \"keydown\", trapFocus);\n\t\t\tmodalsStack.push(box);\n\t\t\t//gantt.$keyboardNavigation.dispatcher.disable();\n\t\t}\n\n\t\tfunction endModal() {\n\t\t\tvar box = modalsStack.pop();\n\t\t\tif (box) {\n\t\t\t\tgantt.eventRemove(box, \"keydown\", trapFocus);\n\t\t\t}\n\t\t\tafterPopup(box);\n\n\t\t}\n\n\n\t\tfunction isTopModal(box) {\n\t\t\treturn box == modalsStack[modalsStack.length - 1];\n\t\t}\n\n\t\tfunction trapFocus(event) {\n\t\t\tvar target = event.currentTarget;\n\t\t\tif (!isTopModal(target)) return;\n\n\t\t\tgantt.$keyboardNavigation.trapFocus(target, event);\n\t\t}\n\n\t\tfunction traceLightbox() {\n\t\t\tstartModal(gantt.getLightbox());\n\t\t}\n\n\t\tgantt.attachEvent(\"onLightbox\", traceLightbox);\n\t\tgantt.attachEvent(\"onAfterLightbox\", endModal);\n\t\tgantt.attachEvent(\"onLightboxChange\", function () {\n\t\t\tendModal();\n\t\t\ttraceLightbox();\n\t\t});\n\n\n\t\tgantt.attachEvent(\"onAfterQuickInfo\", function () {\n\t\t\tafterPopup();\n\t\t});\n\n\t\tgantt.attachEvent(\"onMessagePopup\", function (box) {\n\t\t\tsaveFocus();\n\t\t\tstartModal(box);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterMessagePopup\", function () {\n\t\t\tendModal();\n\t\t\trestoreFocus();\n\t\t});\n\n\t\tvar focusElement = null;\n\n\t\tfunction saveFocus() {\n\t\t\tfocusElement = gantt.utils.dom.getActiveElement();\n\t\t}\n\n\t\tfunction restoreFocus() {\n\t\t\tsetTimeout(function () {\n\t\t\t\tif (focusElement) {\n\t\t\t\t\tfocusElement.focus();\n\t\t\t\t\tfocusElement = null;\n\t\t\t\t}\n\t\t\t}, 1);\n\t\t}\n\n\t\tgantt.$keyboardNavigation.isModal = isModal;\n\n\n\t})();\n\n};","\ninterface IQuickInfoContainer{\n\tparent: HTMLElement;\n\txViewport: HTMLElement;\n\tyViewport: HTMLElement;\n}\n\nexport class QuickInfo {\n\tprivate _quickInfoTask: TaskID;\n\tprivate _quickInfoBoxId: number | string;\n\tprivate _quickInfoBox: HTMLElement;\n\tprivate _quickInfoReadonly: boolean | null;\n\tprivate _container: HTMLElement;\n\tprivate _gantt: any;\n\n\tconstructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t}\n\n\t// show at coordinates:\n\t// show(x: number, y: number)\n\t// show for a task:\n\t// show(id: TaskID)\n\tshow : {\n\t\t(x: number, y: number) : void;\n\t\t(id: TaskID) : void;\n\t} = (id: TaskID | number, y? : number) : void => {\n\t\tif (y === undefined) {\n\t\t\tthis._showForTask(id);\n\t\t} else {\n\t\t\tthis._showAtCoordinates(id as number, y);\n\t\t}\n\t};\n\n\thide = (forced?: boolean) : any => {\n\t\tconst gantt = this._gantt;\n\t\tconst qi = this._quickInfoBox;\n\t\tthis._quickInfoBoxId = 0;\n\t\tconst taskId = this._quickInfoTask;\n\t\tthis._quickInfoTask = null;\n\n\t\tif (qi && qi.parentNode){\n\n\t\t\tif (gantt.config.quick_info_detached) {\n\t\t\t\tgantt.callEvent(\"onAfterQuickInfo\", [taskId]);\n\t\t\t\treturn qi.parentNode.removeChild(qi);\n\t\t\t}\n\n\t\t\tqi.className += \" gantt_qi_hidden\";\n\t\t\tif (qi.style.right === \"auto\"){\n\t\t\t\tqi.style.left = \"-350px\";\n\t\t\t} else {\n\t\t\t\tqi.style.right = \"-350px\";\n\t\t\t}\n\n\t\t\tif (forced) {\n\t\t\t\tqi.style.left = qi.style.right = \"\";\n\t\t\t\tqi.parentNode.removeChild(qi);\n\t\t\t}\n\t\t\tgantt.callEvent(\"onAfterQuickInfo\", [taskId]);\n\t\t}\n\t};\n\n\tgetNode = (): HTMLElement => {\n\t\tif(this._quickInfoBox) {\n\t\t\treturn this._quickInfoBox;\n\t\t}\n\t\treturn null;\n\t};\n\n\tsetContainer = (container: string|HTMLElement): void => {\n\t\tif(container){\n\t\t\tthis._container = typeof container === \"string\" ? document.getElementById(container) : container;\n\t\t}\n\t};\n\n\tsetContent = (content?: IQuickInfoContent) => {\n\t\tconst gantt = this._gantt;\n\n\t\tconst defaultContent = {\n\t\t\ttaskId: null,\n\t\t\theader: {\n\t\t\t\ttitle: \"\",\n\t\t\t\tdate: \"\"\n\t\t\t},\n\t\t\tcontent: \"\",\n\t\t\tbuttons: gantt.config.quickinfo_buttons\n\t\t};\n\n\t\tif(!content){\n\t\t\tcontent = defaultContent;\n\t\t}\n\n\t\tif(!content.taskId){\n\t\t\tcontent.taskId = defaultContent.taskId;\n\t\t}\n\n\t\tif(!content.header){\n\t\t\tcontent.header = defaultContent.header;\n\t\t}\n\n\t\tif(!content.header.title){\n\t\t\tcontent.header.title = defaultContent.header.title;\n\t\t}\n\t\tif(!content.header.date){\n\t\t\tcontent.header.date = defaultContent.header.date;\n\t\t}\n\t\tif(!content.content){\n\t\t\tcontent.content = defaultContent.content;\n\t\t}\n\t\tif(!content.buttons){\n\t\t\tcontent.buttons = defaultContent.buttons;\n\t\t}\n\n\n\t\tlet qi = this.getNode();\n\t\tif(!qi){\n\t\t\tqi = this._createQuickInfoElement();\n\t\t}\n\n\t\tif(content.taskId){\n\t\t\tthis._quickInfoBoxId = content.taskId;\n\t\t}\n\n\t\tconst titleBox = qi.querySelector(\".gantt_cal_qi_title\") as HTMLElement;\n\t\tconst titleContent = titleBox.querySelector(\".gantt_cal_qi_tcontent\");\n\t\tconst titleDate = titleBox.querySelector(\".gantt_cal_qi_tdate\");\n\t\tconst main = qi.querySelector(\".gantt_cal_qi_content\");\n\t\tconst controls = qi.querySelector(\".gantt_cal_qi_controls\") as HTMLElement;\n\n\t\tgantt._waiAria.quickInfoHeader(qi, [content.header.title, content.header.date].join(\" \"));\n\n\t\ttitleContent.innerHTML = content.header.title;\n\t\ttitleDate.innerHTML = content.header.date;\n\n\t\tif(!content.header.title && !content.header.date){\n\t\t\ttitleBox.style.display = \"none\";\n\t\t}else{\n\t\t\ttitleBox.style.display = \"\";\n\t\t}\n\t\tmain.innerHTML = content.content;\n\n\t\tconst buttons = content.buttons;\n\t\tif(!buttons.length){\n\t\t\tcontrols.style.display = \"none\";\n\t\t}else{\n\t\t\tcontrols.style.display = \"\";\n\t\t}\n\t\tlet html = \"\";\n\t\tfor (let i = 0; i < buttons.length; i++){\n\n\t\t\tconst ariaAttr = gantt._waiAria.quickInfoButtonAttrString(gantt.locale.labels[buttons[i]]);\n\n\t\t\thtml += `<div class=\"gantt_qi_big_icon ${buttons[i]} dhx_gantt_${buttons[i]}\" title=\"${gantt.locale.labels[buttons[i]]}\" ${ariaAttr}>\n            <div class='dhx_menu_icon dhx_gantt_icon ${buttons[i]} gantt_menu_icon dhx_gantt_${buttons[i]}'></div>\n            <div>${gantt.locale.labels[buttons[i]]}</div>\n         </div>`;\n\t\t}\n\t\tcontrols.innerHTML = html;\n\n\t\tgantt.eventRemove(qi, \"click\", this._qiButtonClickHandler);\n\t\tgantt.eventRemove(qi, \"keypress\", this._qiKeyPressHandler);\n\n\t\tgantt.event(qi, \"click\", this._qiButtonClickHandler);\n\t\tgantt.event(qi, \"keypress\", this._qiKeyPressHandler);\n\t};\n\n\tprivate _qiButtonClickHandler = (ev) => {\n\t\tthis._qi_button_click(ev.target);\n\t};\n\n\tprivate _qiKeyPressHandler = (e) => {\n\n\t\tconst code = e.which;\n\t\tif (code === 13 || code === 32){\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis._qi_button_click(e.target);\n\t\t\t},1);\n\t\t}\n\t};\n\n\tprivate _showAtCoordinates(x: number, y: number) : void {\n\t\tthis.hide(true);\n\t\tthis._quickInfoBoxId = 0;\n\t\tthis._quickInfoTask = null;\n\t\tif(!this._quickInfoBox){\n\t\t\tthis._createQuickInfoElement();\n\t\t\tthis.setContent();\n\t\t}\n\n\t\tthis._appendAtCoordinates(x, y);\n\t\tthis._gantt.callEvent(\"onQuickInfo\", [null]);\n\t}\n\n\tprivate _showForTask(id: TaskID) : void {\n\t\tconst gantt = this._gantt;\n\t\tif ((\n\t\t\tid === this._quickInfoBoxId &&\n\t\t\tgantt.utils.dom.isChildOf(this._quickInfoBox, document.body)\n\t\t) || !gantt.config.show_quick_info) {\n\t\t\t// not show if the quick info is already displayed for this task, or if it shouldn't be displayed\n\t\t\treturn;\n\t\t}\n\t\tthis.hide(true);\n\t\tconst offset = 6; // offset TASK <> QI-BOX in 'px'\n\t\tconst container = this._getContainer();\n\t\tconst pos = this._get_event_counter_part(id, offset, container.xViewport, container.yViewport);\n\n\t\tif (pos){\n\t\t\tthis._quickInfoBox = this._init_quick_info(id);\n\t\t\tthis._quickInfoTask = id;\n\t\t\tthis._quickInfoBox.className = this._prepare_quick_info_classname(id);\n\n\t\t\tthis._fill_quick_data(id);\n\t\t\tthis._show_quick_info(pos, offset);\n\t\t\tgantt.callEvent(\"onQuickInfo\", [id]);\n\t\t}\n\t}\n\n\tprivate _get_event_counter_part(id: TaskID, offset: number, xViewport: HTMLElement, yViewport: HTMLElement) : any {\n\t\tconst gantt = this._gantt;\n\t\tlet domEv = gantt.getTaskNode(id);\n\t\tif (!domEv) {\n\t\t\tdomEv = gantt.getTaskRowNode(id);\n\t\t\tif (!domEv) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\tlet left = 0;\n\t\tconst top = offset + domEv.offsetTop + domEv.offsetHeight;\n\n\t\tlet node = domEv;\n\n\t\tif (gantt.utils.dom.isChildOf(node, xViewport)) {\n\t\t\twhile (node && node !== xViewport){\n\t\t\t\tleft += node.offsetLeft;\n\t\t\t\tnode = node.offsetParent;\n\t\t\t}\n\t\t}\n\n\t\tconst scroll = gantt.getScrollState();\n\n\t\tif(node){\n\t\t\tconst dx = (left + domEv.offsetWidth/2) - scroll.x > (xViewport.offsetWidth/2) ? 1 : 0;\n\t\t\tconst dy = (top + domEv.offsetHeight/2) - scroll.y > (yViewport.offsetHeight/2) ? 1 : 0;\n\n\t\t\treturn { left, top, dx, dy, width:domEv.offsetWidth, height:domEv.offsetHeight };\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate _createQuickInfoElement() : HTMLElement {\n\t\tconst gantt = this._gantt;\n\t\tconst qi = document.createElement(\"div\");\n\t\tqi.className += \"gantt_cal_quick_info\";\n\t\tgantt._waiAria.quickInfoAttr(qi);\n\n\t\t// title\n\t\tconst ariaAttr = gantt._waiAria.quickInfoHeaderAttrString();\n\t\tvar html = `\n\t\t<div class=\"gantt_cal_qi_tcontrols\">\n\t\t\t<a class=\"gantt_cal_qi_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\n\t\t</div>\n\t\t<div class=\"gantt_cal_qi_title\" ${ariaAttr}>\n\t\t\t\t\n\t\t\t\t<div class=\"gantt_cal_qi_tcontent\"></div>\n\t\t\t\t<div class=\"gantt_cal_qi_tdate\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"gantt_cal_qi_content\"></div>`;\n\n\t\t//buttons\n\t\thtml += \"<div class=\\\"gantt_cal_qi_controls\\\">\";\n\n\t\thtml += \"</div>\";\n\n\t\tqi.innerHTML = html;\n\n\n\t\tif (gantt.config.quick_info_detached) {\n\t\t\tconst container = this._getContainer();\n\t\t\tgantt.event(container.parent, \"scroll\", () => { this.hide(); });\n\t\t}\n\n\t\tthis._quickInfoBox = qi;\n\t\treturn qi;\n\t}\n\n\tprivate _init_quick_info(id: TaskID) : HTMLElement {\n\t\tconst gantt = this._gantt;\n\t\tconst task = gantt.getTask(id);\n\t\t\n\n\t\tif(typeof this._quickInfoReadonly === \"boolean\"){\n\t\t\tif(gantt.isReadonly(task) !== this._quickInfoReadonly){\n\t\t\t\tthis.hide(true);\n\t\t\t\tthis._quickInfoBox = null;\n\t\t\t}\n\t\t}\n\n\t\tthis._quickInfoReadonly = gantt.isReadonly(task);\n\n\t\tif (!this._quickInfoBox){\n\t\t\tthis._quickInfoBox = this._createQuickInfoElement();\n\t\t}\n\n\t\treturn this._quickInfoBox;\n\t}\n\n\tprivate _prepare_quick_info_classname(id: TaskID) : string {\n\t\tconst gantt = this._gantt;\n\t\tconst task = gantt.getTask(id);\n\t\tconst taskType = gantt.getTaskType(task);\n\n\t\tlet css = `gantt_cal_quick_info gantt_${taskType}`;\n\t\tconst template = gantt.templates.quick_info_class(task.start_date, task.end_date, task);\n\n\t\tif(template){\n\t\t\tcss += \" \" + template;\n\t\t}\n\t\treturn css;\n\t}\n\n\tprivate _fill_quick_data(id: TaskID) : void {\n\t\tconst gantt = this._gantt;\n\t\tconst ev = gantt.getTask(id);\n\n\t\tthis._quickInfoBoxId = id;\n\n\t\tlet allowedButtons = [];\n\t\tif (this._quickInfoReadonly){\n\t\t\tconst buttons = gantt.config.quickinfo_buttons;\n\t\t\tconst isEditor = {icon_delete: true, icon_edit: true};\n\t\t\tfor (let i = 0; i < buttons.length; i++){\n\t\t\t\tif(this._quickInfoReadonly && isEditor[buttons[i]]){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tallowedButtons.push(buttons[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tallowedButtons = gantt.config.quickinfo_buttons;\n\t\t}\n\n\t\tthis.setContent({\n\t\t\theader: {\n\t\t\t\ttitle: gantt.templates.quick_info_title(ev.start_date, ev.end_date, ev),\n\t\t\t\tdate: gantt.templates.quick_info_date(ev.start_date, ev.end_date, ev)\n\t\t\t},\n\t\t\tcontent: gantt.templates.quick_info_content(ev.start_date, ev.end_date, ev),\n\t\t\tbuttons: allowedButtons\n\t\t});\n\t}\n\n\tprivate _appendAtCoordinates(x: number, y: number): void {\n\t\tconst qi = this._quickInfoBox;\n\t\tconst container = this._getContainer();\n\t\tif (!qi.parentNode ||\n\t\t\tqi.parentNode.nodeName.toLowerCase() === \"#document-fragment\"){ // IE8\n\t\t\tcontainer.parent.appendChild(qi);\n\t\t}\n\n\t\tqi.style.left = x + \"px\";\n\t\tqi.style.top = y + \"px\";\n\t}\n\n\tprivate _show_quick_info(pos: any, offset: number) : void {\n\t\tconst gantt = this._gantt;\n\t\tconst qi = this._quickInfoBox;\n\t\tif (gantt.config.quick_info_detached) {\n\t\t\tconst container = this._getContainer();\n\t\t\tif (!qi.parentNode ||\n\t\t\t\tqi.parentNode.nodeName.toLowerCase() === \"#document-fragment\"){ // IE8\n\t\t\t\tcontainer.parent.appendChild(qi);\n\t\t\t}\n\t\t\tconst width = qi.offsetWidth;\n\t\t\tconst popupHeight = qi.offsetHeight;\n\n\t\t\tconst scrolls = gantt.getScrollState();\n\t\t\tconst xViewport = container.xViewport;\n\t\t\tconst yViewport = container.yViewport;\n\t\t\tconst screenWidth = xViewport.offsetWidth + scrolls.x - width;\n\n\t\t\tconst relativePopupTop = pos.top - scrolls.y;\n\t\t\tconst relativePopupBottom = relativePopupTop + popupHeight;\n\n\t\t\tlet top = pos.top;\n\t\t\tif(relativePopupBottom > yViewport.offsetHeight / 2){\n\t\t\t\ttop = pos.top - (popupHeight + pos.height + 2*offset);\n\t\t\t\tif(top < scrolls.y && relativePopupBottom <= yViewport.offsetHeight){\n\t\t\t\t\ttop = pos.top;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (top < scrolls.y) {\n\t\t\t\ttop = scrolls.y;\n\t\t\t}\n\n\t\t\tconst x = Math.min(Math.max(scrolls.x, pos.left - pos.dx*(width - pos.width)), screenWidth);\n\t\t\tconst y = top;\n\n\t\t\tthis._appendAtCoordinates(x, y);\n\t\t} else {\n\t\t\tqi.style.top = 20 + \"px\";\n\t\t\tif (pos.dx === 1){\n\t\t\t\tqi.style.right = \"auto\";\n\t\t\t\tqi.style.left = \"-300px\";\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tqi.style.left = \"10px\";\n\t\t\t\t},1);\n\t\t\t} else {\n\t\t\t\tqi.style.left = \"auto\";\n\t\t\t\tqi.style.right = \"-300px\";\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tqi.style.right = \"10px\";\n\t\t\t\t},1);\n\t\t\t}\n\t\t\tqi.className += \" gantt_qi_\"+(pos.dx === 1 ? \"left\" : \"right\");\n\t\t\tgantt.$root.appendChild(qi);\n\t\t}\n\t}\n\n\tprivate _qi_button_click(node: any) : void {\n\t\tconst gantt = this._gantt;\n\t\tconst box = this._quickInfoBox;\n\t\tif (!node || node === box){\n\t\t\treturn;\n\t\t}\n\t\tif(node.closest(\".gantt_cal_qi_close_btn\")){\n\t\t\tthis.hide();\n\t\t\treturn;\n\t\t}\n\n\t\tconst mask = node.className;\n\t\tif (mask.indexOf(\"_icon\") !== -1){\n\t\t\tconst id = this._quickInfoBoxId;\n\t\t\tgantt.$click.buttons[mask.split(\" \")[1].replace(\"icon_\",\"\")](id);\n\t\t} else {\n\t\t\tthis._qi_button_click(node.parentNode);\n\t\t}\n\t}\n\n\tprivate _getContainer(): IQuickInfoContainer{\n\t\tconst gantt = this._gantt;\n\t\tlet container = this._container ? this._container : gantt.$task_data;\n\t\tif (container && container.offsetHeight && container.offsetWidth) {\n\t\t\treturn {\n\t\t\t\tparent: container,\n\t\t\t\txViewport: gantt.$task,\n\t\t\t\tyViewport: gantt.$task_data\n\t\t\t};\n\t\t}\n\t\tcontainer = this._container ? this._container : gantt.$grid_data;\n\t\tif (container && container.offsetHeight && container.offsetWidth) {\n\t\t\treturn {\n\t\t\t\tparent: container,\n\t\t\t\txViewport: gantt.$grid,\n\t\t\t\tyViewport: gantt.$grid_data\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tparent: this._container ? this._container : gantt.$layout,\n\t\t\txViewport: gantt.$layout,\n\t\t\tyViewport: gantt.$layout\n\t\t};\n\t}\n}\n","import * as helpers from \"./helpers\";\n\nvar plainObjectConstructor = ({}).constructor.toString();\nfunction isCustomType(object){\n\tvar constructorString = object.constructor.toString();\n\n\treturn constructorString !== plainObjectConstructor;\n}\n\nfunction copy(object) {\n\tvar i, result; // iterator, types array, result\n\n\tif (object && typeof object == \"object\") {\n\n\t\tswitch (true){\n\t\t\tcase (helpers.isDate(object)):\n\t\t\t\tresult = new Date(object);\n\t\t\t\tbreak;\n\t\t\tcase (helpers.isArray(object)):\n\t\t\t\tresult = new Array(object.length);\n\t\t\t\tfor(i = 0; i < object.length; i++){\n\t\t\t\t\tresult[i] = copy(object[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t/*\t\tcase (helpers.isStringObject(object)):\n\t\t\t\tresult = new String(object);\n\t\t\t\tbreak;\n\t\t\tcase (helpers.isNumberObject(object)):\n\t\t\t\tresult = new Number(object);\n\t\t\t\tbreak;\n\t\t\tcase (helpers.isBooleanObject(object)):\n\t\t\t\tresult = new Boolean(object);\n\t\t\t\tbreak;*/\n\t\t\tdefault:\n\t\t\t\tif(isCustomType(object)){\n\t\t\t\t\tresult = Object.create(object);\n\t\t\t\t}else{\n\t\t\t\t\tresult = {};\n\t\t\t\t}\n\n\t\t\t\tfor (i in object) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.apply(object, [i]))\n\t\t\t\t\t\tresult[i] = copy(object[i]);\n\t\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn result || object;\n}\n\nfunction mixin (target, source, force){\n\tfor (var f in source)\n\t\tif (((target[f] === undefined) || force)) target[f]=source[f];\n\treturn target;\n}\n\nfunction defined(obj) {\n\treturn typeof(obj) != \"undefined\";\n}\n\nvar seed;\nfunction uid() {\n\tif (!seed)\n\t\tseed = (new Date()).valueOf();\n\n\tseed++;\n\treturn seed;\n}\n\n//creates function with specified \"this\" pointer\nfunction bind(functor, object){\n\tif(functor.bind)\n\t\treturn functor.bind(object);\n\telse\n\t\treturn function(){ return functor.apply(object,arguments); };\n}\n\nfunction event(el, event, handler, capture){\n\tif (el.addEventListener)\n\t\tel.addEventListener(event, handler, capture === undefined ? false : capture);\n\n\telse if (el.attachEvent)\n\t\tel.attachEvent(\"on\"+event, handler);\n}\n\nfunction eventRemove(el, event, handler, capture){\n\tif (el.removeEventListener)\n\t\tel.removeEventListener(event, handler, capture === undefined ? false : capture);\n\n\telse if (el.detachEvent)\n\t\tel.detachEvent(\"on\"+event, handler);\n}\n\nexport {\n\tcopy,\n\tdefined,\n\tmixin,\n\tuid,\n\tbind,\n\tevent,\n\teventRemove\n};","import * as utils from \"../../../utils/utils\";\n\nfunction createScope(addEvent, removeEvent) {\n\taddEvent = addEvent || utils.event;\n\tremoveEvent = removeEvent || utils.eventRemove;\n\n\tvar handlers = [];\n\n\tvar eventScope = {\n\t\tattach: function(el, event, callback, capture){\n\t\t\thandlers.push({element: el, event:event, callback: callback, capture: capture});\n\t\t\taddEvent(el, event, callback, capture);\n\t\t},\n\t\tdetach: function(el, event, callback, capture){\n\t\t\tremoveEvent(el, event, callback, capture);\n\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\tvar handler = handlers[i];\n\t\t\t\tif (handler.element === el && handler.event === event && handler.callback === callback && handler.capture === capture) {\n\t\t\t\t\thandlers.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdetachAll: function () {\n\t\t\tvar staticArray = handlers.slice();\n\t\t\t// original handlers array can be spliced on every iteration\n\t\t\tfor (var i = 0; i < staticArray.length; i++){\n\t\t\t\tvar handler = staticArray[i];\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, handler.capture);\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, undefined);\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, false);\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, true);\n\t\t\t}\n\t\t\thandlers.splice(0, handlers.length);\n\t\t},\n\t\textend: function(){\n\t\t\treturn createScope(this.event, this.eventRemove);\n\t\t}\n\t};\n\n\treturn eventScope;\n}\n\nexport default createScope;","import * as domHelpers from \"../../core/ui/utils/dom_helpers\";\n\n/* eslint-disable no-restricted-globals */\n\ninterface IViewPosition{\n\ttop: number;\n\tleft: number;\n}\n\ninterface IViewBox extends IViewPosition{\n\twidth: number;\n\theight: number;\n\tbottom: number;\n\tright: number;\n}\n\nexport class Tooltip {\n\tprivate _root: HTMLElement;\n\tprivate _tooltipNode: HTMLElement;\n\tprivate _gantt: any;\n\n\tconstructor(gantt: any){\n\t\tthis._gantt = gantt;\n\t}\n\n\tgetNode() : HTMLElement {\n\t\tconst gantt = this._gantt;\n\t\tif (!this._tooltipNode){\n\t\t\tthis._tooltipNode = document.createElement(\"div\");\n\t\t\tthis._tooltipNode.className = \"gantt_tooltip\";\n\t\t\tgantt._waiAria.tooltipAttr(this._tooltipNode);\n\t\t}\n\t\treturn this._tooltipNode;\n\t}\n\n\tsetViewport(node: HTMLElement):Tooltip{\n\t\tthis._root = node;\n\t\treturn this;\n\t}\n\n\tshow(left: number, top: number): Tooltip;\n\tshow(event: MouseEvent): Tooltip;\n\tshow(left: number | MouseEvent, top?: number): Tooltip {\n\t\tconst gantt = this._gantt;\n\t\tconst container = document.body;\n\t\tconst node = this.getNode();\n\n\t\tif(!domHelpers.isChildOf(node, container)){\n\t\t\tthis.hide();\n\t\t\t// GS-2463. Don't put the node beyond the body coordinates\n\t\t\t// as it may trigger the resize event\n\t\t\tnode.style.top = node.style.top || \"0px\";\n\t\t\tnode.style.left = node.style.left || \"0px\";\n\t\t\tcontainer.appendChild(node);\n\t\t}\n\n\t\tif (this._isLikeMouseEvent(left)) {\n\t\t\tconst position = this._calculateTooltipPosition(left as MouseEvent);\n\t\t\ttop = position.top;\n\t\t\tleft = position.left;\n\t\t}\n\n\t\tnode.style.top = top + \"px\";\n\t\tnode.style.left = left + \"px\";\n\n\t\tgantt._waiAria.tooltipVisibleAttr(node);\n\t\treturn this;\n\t}\n\thide() : Tooltip{\n\t\tconst gantt = this._gantt;\n\t\tconst node = this.getNode();\n\t\tif(node && node.parentNode){\n\t\t\tnode.parentNode.removeChild(node);\n\t\t}\n\t\tgantt._waiAria.tooltipHiddenAttr(node);\n\t\treturn this;\n\t}\n\n\tsetContent(html: string) : Tooltip{\n\t\tconst node = this.getNode();\n\t\tnode.innerHTML = html;\n\t\treturn this;\n\t}\n\n\t// it is for salesforce, because it proxies event to it own events\n\tprivate _isLikeMouseEvent(event: any): boolean {\n\t\tif (!event || typeof event !== \"object\") {\n\t\t\treturn false;\n\t\t}\n\t\treturn \"clientX\" in event && \"clientY\" in event;\n\t}\n\n\tprivate _getViewPort() : HTMLElement {\n\t\treturn this._root || document.body;\n\t}\n\n\n\tprivate _calculateTooltipPosition(event: MouseEvent): IViewPosition{\n\t\tconst gantt = this._gantt;\n\t\t// top/left coordinates inside the viewport by mouse position\n\t\tconst viewport =  this._getViewPortSize();\n\t\tconst tooltipNode = this.getNode();\n\t\tconst tooltip: IViewBox = {\n\t\t\ttop:0,\n\t\t\tleft: 0,\n\t\t\twidth: tooltipNode.offsetWidth,\n\t\t\theight: tooltipNode.offsetHeight,\n\t\t\tbottom: 0,\n\t\t\tright: 0\n\t\t};\n\n\t\tconst offsetX = gantt.config.tooltip_offset_x;\n\t\tconst offsetY = gantt.config.tooltip_offset_y;\n\n\t\tconst container = document.body;\n\t\tconst mouse = domHelpers.getRelativeEventPosition(event, container);\n\t\tconst containerPos = domHelpers.getNodePosition(container);\n\t\tmouse.y += containerPos.y; // to fix margin collapsing\n\n\t\ttooltip.top = mouse.y;\n\t\ttooltip.left = mouse.x;\n\t\ttooltip.top += offsetY;\n\t\ttooltip.left += offsetX;\n\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\ttooltip.right = tooltip.left + tooltip.width;\n\n\t\tconst scrollTop = window.scrollY + container.scrollTop; // to fix margin collapsing\n\t\t// edge cases when the tooltip element can be partially hidden by edges of the viewport\n\t\tif(tooltip.top < viewport.top - scrollTop){\n\t\t\ttooltip.top = viewport.top;\n\t\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\t}else if(tooltip.bottom > viewport.bottom){\n\t\t\ttooltip.bottom = viewport.bottom;\n\t\t\ttooltip.top = tooltip.bottom - tooltip.height;\n\t\t}\n\n\t\tif(tooltip.left < viewport.left){\n\t\t\ttooltip.left = viewport.left;\n\t\t\ttooltip.right = viewport.left + tooltip.width;\n\t\t}else if(tooltip.right > viewport.right){\n\t\t\ttooltip.right = viewport.right;\n\t\t\ttooltip.left = tooltip.right - tooltip.width;\n\t\t}\n\n\t\tif(mouse.x >= tooltip.left && mouse.x <= tooltip.right) {\n\t\t\ttooltip.left = mouse.x - tooltip.width - offsetX;\n\t\t\ttooltip.right = tooltip.left + tooltip.width;\n\t\t}\n\n\t\tif(mouse.y >= tooltip.top && mouse.y <= tooltip.bottom) {\n\t\t\ttooltip.top = mouse.y - tooltip.height - offsetY;\n\t\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\t}\n\n\t\treturn tooltip;\n\t}\n\n\tprivate _getViewPortSize() : IViewBox {\n\t\tconst gantt = this._gantt;\n\t\tconst container = this._getViewPort();\n\t\tlet viewport = container;\n\t\tlet scrollTop = window.scrollY + document.body.scrollTop;\n\t\tlet scrollLeft = window.scrollX + document.body.scrollLeft;\n\t\tlet pos;\n\t\t// support for the initial tooltip mode where the tooltip element was attached to the data area of gantt\n\t\tif(container === gantt.$task_data){\n\t\t\tviewport = gantt.$task;\n\t\t\tscrollTop = 0;\n\t\t\tscrollLeft = 0;\n\t\t\tpos = domHelpers.getNodePosition(gantt.$task);\n\t\t}else{\n\t\t\tpos = domHelpers.getNodePosition(viewport);\n\t\t}\n\t\treturn {\n\t\t\tleft:pos.x + scrollLeft,\n\t\t\ttop: pos.y + scrollTop,\n\t\t\twidth: pos.width,\n\t\t\theight: pos.height,\n\t\t\tbottom: pos.y + pos.height + scrollTop,\n\t\t\tright: pos.x + pos.width + scrollLeft\n\t\t};\n\t}\n}\n","import domEventsScope from \"../../core/ui/utils/dom_event_scope\";\nimport * as domHelpers from \"../../core/ui/utils/dom_helpers\";\nimport * as helpers from \"../../utils/helpers\";\nimport { Tooltip } from \"./tooltip\";\n\ninterface ITrackerTarget {\n\tselector: string;\n\tonmouseenter: (event: MouseEvent, node: HTMLElement) => void;\n\tonmousemove: (event: MouseEvent, node: HTMLElement) => void;\n\tonmouseleave: (event: MouseEvent, node: HTMLElement) => void;\n\tglobal: boolean;\n}\n\ninterface ITooltipConfig {\n\tselector: string;\n\thtml: (event: MouseEvent, node: HTMLElement) => string;\n\tglobal: boolean;\n}\n\nexport class TooltipManager{\n\ttooltip: Tooltip;\n\tprotected _domEvents: any;\n\tprivate _listeners: object = {};\n\tprivate _gantt: any;\n\tprivate delayShow: any;\n\tprivate delayHide: any;\n\n\tconstructor(gantt: any) {\n\t\tthis.tooltip = new Tooltip(gantt);\n\t\tthis._gantt = gantt;\n\t\tthis._domEvents = domEventsScope();\n\t\tthis._initDelayedFunctions();\n\t}\n\n\tdestructor(): void{\n\t\tthis.tooltip.hide();\n\t\tthis._domEvents.detachAll();\n\t}\n\thideTooltip(): void{\n\t\tthis.delayHide();\n\t}\n\tattach(config: ITrackerTarget): void {\n\t\tlet root = document.body;\n\t\tconst gantt = this._gantt;\n\t\tif(!config.global){\n\t\t\troot = gantt.$root;\n\t\t}\n\n\t\tlet watchableTarget = null;\n\t\tconst handler = (event) => {\n\t\t\tconst eventTarget = domHelpers.getTargetNode(event);\n\t\t\tconst targetNode = domHelpers.closest(eventTarget, config.selector);\n\t\t\tif(domHelpers.isChildOf(eventTarget, this.tooltip.getNode())){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst doOnMouseEnter = () => {\n\t\t\t\twatchableTarget = targetNode;\n\t\t\t\tconfig.onmouseenter(event, targetNode);\n\t\t\t};\n\n\t\t\tif(watchableTarget){\n\t\t\t\tif(targetNode && targetNode === watchableTarget){\n\t\t\t\t\tconfig.onmousemove(event, targetNode);\n\t\t\t\t}else{\n\t\t\t\t\tconfig.onmouseleave(event, watchableTarget);\n\t\t\t\t\twatchableTarget = null;\n\n\t\t\t\t\tif(targetNode && targetNode !== watchableTarget){\n\t\t\t\t\t\tdoOnMouseEnter();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(targetNode){\n\t\t\t\t\tdoOnMouseEnter();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.detach(config.selector);\n\t\tthis._domEvents.attach(root, \"mousemove\", handler);\n\t\tthis._listeners[config.selector] = {\n\t\t\tnode: root,\n\t\t\thandler\n\t\t};\n\t}\n\n\tdetach(selector: string): void {\n\t\tconst listener = this._listeners[selector];\n\t\tif(listener){\n\t\t\tthis._domEvents.detach(listener.node, \"mousemove\", listener.handler);\n\t\t}\n\t}\n\n\ttooltipFor(config: ITooltipConfig): void {\n\t\tconst cloneDomEvent = (event: MouseEvent) => {\n\t\t\tlet clone = event;\n\t\t\t// making events survive timeout in ie\n\t\t\t// tslint:disable-next-line no-string-literal\n\t\t\tif(document[\"createEventObject\"] && !document.createEvent){\n\t\t\t\t// tslint:disable-next-line no-string-literal\n\t\t\t\tclone = document[\"createEventObject\"](event);\n\t\t\t}\n\t\t\treturn clone;\n\t\t};\n\t\tthis._initDelayedFunctions();\n\t\tthis.attach({\n\t\t\tselector: config.selector,\n\t\t\tglobal: config.global,\n\t\t\tonmouseenter:(event: MouseEvent, node: HTMLElement) => {\n\t\t\t\tconst html = config.html(event, node);\n\t\t\t\tif(html){\n\t\t\t\t\tthis.delayShow(cloneDomEvent(event), html);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonmousemove:(event: MouseEvent, node: HTMLElement) => {\n\t\t\t\tconst html = config.html(event, node);\n\t\t\t\tif(html){\n\t\t\t\t\tthis.delayShow(cloneDomEvent(event), html);\n\t\t\t\t}else{\n\t\t\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\t\t\tthis.delayHide();\n\t\t\t\t}\n\t\t\t},\n\t\t\tonmouseleave:() => {\n\t\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\t\tthis.delayHide();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _initDelayedFunctions(){\n\t\tconst gantt = this._gantt;\n\t\t// reset delayed functions in order to apply current values of tooltip_timeout\n\t\tif(this.delayShow){\n\t\t\tthis.delayShow.$cancelTimeout();\n\t\t}\n\t\tif(this.delayHide){\n\t\t\tthis.delayHide.$cancelTimeout();\n\t\t}\n\t\tthis.tooltip.hide();\n\n\t\tthis.delayShow = helpers.delay((event: MouseEvent, html: string) => {\n\t\t\tif(gantt.callEvent(\"onBeforeTooltip\", [event]) === false) {\n\t\t\t\tthis.tooltip.hide();\n\t\t\t} else {\n\t\t\t\tthis.tooltip.setContent(html);\n\t\t\t\tthis.tooltip.show(event);\n\t\t\t}\n\t\t}, gantt.config.tooltip_timeout || 1);\n\n\t\tthis.delayHide = helpers.delay(() => {\n\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\tthis.tooltip.hide();\n\t\t}, gantt.config.tooltip_hide_timeout || 1);\n\t}\n\n}","import { IInlineEditState, IMonitor, IUndo, IUndoCommand, TActionType, TEntityType, TUndoValue } from \"./types\";\n\nconst noTrack = {\n\tonBeforeUndo: \"onAfterUndo\",\n\tonBeforeRedo: \"onAfterRedo\"\n};\n\nconst batchActions = [\n\t\"onTaskDragStart\",\n\t\"onAfterTaskUpdate\",\n\t\"onAfterParentExpand\",\n\t\"onAfterTaskDelete\",\n\t\"onBeforeBatchUpdate\"\n];\n\nexport class Monitor implements IMonitor {\n\tprivate _batchAction = null;\n\tprivate _batchMode = false;\n\tprivate _ignore = false;\n\tprivate _ignoreMoveEvents = false;\n\tprivate _initialTasks = {};\n\tprivate _initialLinks = {};\n\tprivate _nestedTasks =  {};\n\tprivate _nestedLinks = {};\n\tprivate _timeout;\n\tprivate _gantt: any;\n\tprivate _undo: IUndo;\n\n\tconstructor(undo: IUndo, gantt: any) {\n\t\tthis._undo = undo;\n\t\tthis._gantt = gantt;\n\t\tthis._attachEvents();\n\t}\n\n\tstore(id: TaskID | LinkID, type: TEntityType, overwrite: boolean = false) {\n\t\tif (type === this._gantt.config.undo_types.task) {\n\t\t\treturn this._storeTask(id, overwrite);\n\t\t}\n\t\tif (type === this._gantt.config.undo_types.link) {\n\t\t\treturn this._storeLink(id, overwrite);\n\t\t}\n\t\treturn false;\n\t}\n\tisMoveEventsIgnored() {\n\t\treturn this._ignoreMoveEvents;\n\t}\n\ttoggleIgnoreMoveEvents(newValue?: boolean) {\n\t\tthis._ignoreMoveEvents = newValue || false;\n\t}\n\tstartIgnore() {\n\t\tthis._ignore = true;\n\t}\n\tstopIgnore() {\n\t\tthis._ignore = false;\n\t}\n\tstartBatchAction() {\n\t\t// try catching updates made from event handlers using timeout\n\t\tif (!this._timeout){\n\t\t\tthis._timeout = setTimeout(() => {\n\t\t\t\tthis.stopBatchAction();\n\t\t\t\tthis._timeout = null;\n\t\t\t}, 10);\n\t\t}\n\n\n\t\tif (this._ignore || this._batchMode) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._batchMode = true;\n\t\tthis._batchAction = this._undo.action.create();\n\t}\n\tstopBatchAction() {\n\t\tif (this._ignore) {\n\t\t\treturn;\n\t\t}\n\t\tconst undo = this._undo;\n\t\tif (this._batchAction) {\n\t\t\tundo.logAction(this._batchAction);\n\t\t}\n\t\tthis._batchMode = false;\n\t\tthis._batchAction = null;\n\t}\n\tonTaskAdded(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.add);\n\t\t}\n\t}\n\tonTaskUpdated(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.update);\n\t\t}\n\t}\n\tonTaskMoved(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\t(task as any).$local_index = this._gantt.getTaskIndex(task.id);\n\t\t\tthis._storeEntityCommand(\n\t\t\t\ttask,\n\t\t\t\tthis.getInitialTask(task.id),\n\t\t\t\tthis._undo.command.type.move,\n\t\t\t\tthis._undo.command.entity.task\n\t\t\t);\n\t\t}\n\t}\n\tonTaskDeleted(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.remove);\n\t\t\tif (this._nestedTasks[task.id]) {\n\t\t\t\tconst children = this._nestedTasks[task.id];\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\t\tthis._storeTaskCommand(children[i], this._undo.command.type.remove);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._nestedLinks[task.id]) {\n\t\t\t\tconst childrenLinks = this._nestedLinks[task.id];\n\t\t\t\tfor (let i = 0; i < childrenLinks.length; i++) {\n\t\t\t\t\tthis._storeLinkCommand(childrenLinks[i], this._undo.command.type.remove);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tonLinkAdded(link: ILink) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.add);\n\t\t}\n\t}\n\tonLinkUpdated(link: ILink) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.update);\n\t\t}\n\t}\n\tonLinkDeleted(link: ILink) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.remove);\n\t\t}\n\t}\n\tsetNestedTasks(id: TaskID, taskIds: TaskID[]) {\n\t\tconst gantt = this._gantt;\n\t\tlet task = null;\n\t\tconst tasks = [];\n\t\tlet\tlinkIds = this._getLinks(gantt.getTask(id));\n\n\t\tfor (let i = 0; i < taskIds.length; i++) {\n\t\t\ttask = this.setInitialTask(taskIds[i]);\n\t\t\tlinkIds = linkIds.concat(this._getLinks(task));\n\t\t\ttasks.push(task);\n\t\t}\n\n\t\tconst uniqueLinks = {};\n\t\tfor (let i = 0; i < linkIds.length; i++) {\n\t\t\tuniqueLinks[linkIds[i]] = true;\n\t\t}\n\t\tconst links = [];\n\t\tfor (const i in uniqueLinks) {\n\t\t\tlinks.push(this.setInitialLink(i));\n\t\t}\n\t\tthis._nestedTasks[id] = tasks;\n\t\tthis._nestedLinks[id] = links;\n\t}\n\tsetInitialTask(id: TaskID, overwrite?: boolean) {\n\t\tconst gantt = this._gantt;\n\t\tif (overwrite || (!this._initialTasks[id] || !this._batchMode)) {\n\t\t\tconst task = gantt.copy(gantt.getTask(id));\n\t\t\ttask.$index = gantt.getGlobalTaskIndex(id);\n\t\t\ttask.$local_index = gantt.getTaskIndex(id);\n\t\t\tthis.setInitialTaskObject(id, task);\n\t\t}\n\t\treturn this._initialTasks[id];\n\t}\n\tgetInitialTask(id: TaskID) {\n\t\treturn this._initialTasks[id];\n\t}\n\tclearInitialTasks() {\n\t\tthis._initialTasks = {};\n\t}\n\tsetInitialTaskObject(id: TaskID, object: ITask) {\n\t\tthis._initialTasks[id] = object;\n\t}\n\tsetInitialLink(id: LinkID, overwrite?: boolean) {\n\t\tif (!this._initialLinks[id] || !this._batchMode) {\n\t\t\tthis._initialLinks[id] = this._gantt.copy(this._gantt.getLink(id));\n\t\t}\n\t\treturn this._initialLinks[id];\n\t}\n\tgetInitialLink(id: LinkID) {\n\t\treturn this._initialLinks[id];\n\t}\n\tclearInitialLinks() {\n\t\tthis._initialLinks = {};\n\t}\n\tprivate _attachEvents() {\n\t\tlet deleteCacheCooldown = null;\n\t\tconst gantt = this._gantt;\n\n\t\tconst saveInitialAll = () => {\n\t\t\tif (!deleteCacheCooldown) {\n\t\t\t\tdeleteCacheCooldown = setTimeout(() => {\n\t\t\t\t\tdeleteCacheCooldown = null;\n\t\t\t\t});\n\n\t\t\t\tthis.clearInitialTasks();\n\t\t\t\tgantt.eachTask((task: ITask) => {\n\t\t\t\t\tthis.setInitialTask(task.id);\n\t\t\t\t});\n\n\t\t\t\tthis.clearInitialLinks();\n\t\t\t\tgantt.getLinks().forEach((link: ILink) => {\n\t\t\t\t\tthis.setInitialLink(link.id);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tconst getMoveObjectByTaskId = (id: TaskID) => {\n\t\t\treturn gantt.copy(gantt.getTask(id));\n\t\t};\n\n\t\tfor (const i in noTrack) {\n\t\t\tgantt.attachEvent(i, () => {\n\t\t\t\tthis.startIgnore();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(noTrack[i], () => {\n\t\t\t\tthis.stopIgnore();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tfor (let i  = 0; i < batchActions.length; i++) {\n\t\t\tgantt.attachEvent(batchActions[i], () => {\n\t\t\t\tthis.startBatchAction();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tgantt.attachEvent(\"onParse\", () => {\n\t\t\tthis._undo.clearUndoStack();\n\t\t\tthis._undo.clearRedoStack();\n\t\t\tsaveInitialAll();\n\t\t});\n\t\tgantt.attachEvent(\"onAfterTaskAdd\", (id: TaskID, task: ITask) => {\n\t\t\tthis.setInitialTask(id, true);\n\t\t\tthis.onTaskAdded(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", (id: TaskID, task: ITask) => {\n\t\t\tthis.onTaskUpdated(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterParentExpand\", (id: TaskID, task: ITask) => {\n\t\t\tthis.onTaskUpdated(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterTaskDelete\", (id: TaskID, task: ITask) => {\n\t\t\tthis.onTaskDeleted(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterLinkAdd\", (id: LinkID, link: ILink) => {\n\t\t\tthis.setInitialLink(id, true);\n\t\t\tthis.onLinkAdded(link);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterLinkUpdate\", (id: LinkID, link: ILink) => {\n\t\t\tthis.onLinkUpdated(link);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterLinkDelete\", (id: LinkID, link: ILink) => {\n\t\t\tthis.onLinkDeleted(link);\n\t\t});\n\t\tgantt.attachEvent(\"onRowDragEnd\", (id: TaskID, target: TaskID) => {\n\t\t\tthis.onTaskMoved(getMoveObjectByTaskId(id));\n\t\t\tthis.toggleIgnoreMoveEvents();\n\t\t\treturn true;\n\t\t});\n\t\tgantt.attachEvent(\"onBeforeTaskDelete\", (id: TaskID) => {\n\t\t\tthis.store(id, gantt.config.undo_types.task);\n\t\t\tconst nested = [];\n\n\t\t\t// remember task indexes in case their being deleted in a loop, so they could be restored in the correct order\n\t\t\tsaveInitialAll();\n\n\t\t\tgantt.eachTask((task: ITask) => {\n\t\t\t\tnested.push(task.id);\n\t\t\t}, id);\n\t\t\tthis.setNestedTasks(id, nested);\n\t\t\treturn true;\n\t\t});\n\t\tconst datastore = gantt.getDatastore(\"task\");\n\n\t\tdatastore.attachEvent(\"onBeforeItemMove\", (id: TaskID, parent: TaskID, tindex: number) => {\n\t\t\tif (!this.isMoveEventsIgnored()) {\n\t\t\t\tsaveInitialAll();\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tdatastore.attachEvent(\"onAfterItemMove\", (id: TaskID, parent: TaskID, tindex: number) => {\n\t\t\tif (!this.isMoveEventsIgnored()) {\n\t\t\t\tthis.onTaskMoved(getMoveObjectByTaskId(id));\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onRowDragStart\", (id: TaskID, target: TaskID, e: Event) => {\n\t\t\tthis.toggleIgnoreMoveEvents(true);\n\t\t\tsaveInitialAll();\n\t\t\treturn true;\n\t\t});\n\n\t\tlet dragId = null;\n\t\tlet projectDrag = false;\n\t\tgantt.attachEvent(\"onBeforeTaskDrag\", (taskId: TaskID) => {\n\t\t\tdragId = gantt.getState().drag_id;\n\t\t\tif (dragId === taskId){\n\t\t\t\tconst task = gantt.getTask(taskId);\n\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project){\n\t\t\t\t\tprojectDrag = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// GS-99. Store the initial task dates before multiple drag\n\t\t\tif (gantt.plugins().multiselect){\n\t\t\t\tconst selectedIds = gantt.getSelectedTasks();\n\t\t\t\tif (selectedIds.length > 1){\n\t\t\t\t\tselectedIds.forEach((id)=>{\n\t\t\t\t\t\tthis.store(id, gantt.config.undo_types.task, true);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.store(taskId, gantt.config.undo_types.task);\n\t\t});\n\n\t\tgantt.attachEvent(\"onAfterTaskDrag\", (taskId: TaskID) => {\n\t\t\t// if we drag multiple tasks and other tasks move to another date after that,\n\t\t\t// auto-scheduling/correct work time should occur in anoher command.\n\t\t\t// otherwise, when we undo the changes, the task constraint is not restored correctly\n\t\t\tconst multipleDrag = projectDrag || (gantt.plugins().multiselect && gantt.getSelectedTasks().length > 1);\n\t\t\tif (multipleDrag && dragId === taskId){\n\t\t\t\tprojectDrag = false;\n\t\t\t\tdragId = null;\n\t\t\t\tthis.stopBatchAction();\n\t\t\t}\n\t\t\t// GS-99. When dragging multiple tasks, we need to store the initial tasks\n\t\t\tthis.store(taskId, gantt.config.undo_types.task, true);\n\t\t});\n\n\t\tgantt.attachEvent(\"onLightbox\", (taskId: TaskID) => this.store(taskId, gantt.config.undo_types.task));\n\n\t\tgantt.attachEvent(\"onBeforeTaskAutoSchedule\", (task: ITask) => {\n\t\t\tthis.store(task.id, gantt.config.undo_types.task, true);\n\t\t\treturn true;\n\t\t});\n\n\t\tif (gantt.ext.inlineEditors) {\n\t\t\t// remove the onGanttLayoutReady wrapper when GS-1288 is merged\n\t\t\tlet onBeforeEditStartId = null;\n\t\t\tlet onEditStart = null;\n\t\t\tgantt.attachEvent(\"onGanttLayoutReady\", () => {\n\t\t\t\tif (onBeforeEditStartId) {\n\t\t\t\t\tgantt.ext.inlineEditors.detachEvent(onBeforeEditStartId);\n\t\t\t\t}\n\t\t\t\tif (onEditStart) {\n\t\t\t\t\tgantt.ext.inlineEditors.detachEvent(onEditStart);\n\t\t\t\t}\n\n\t\t\t\tonEditStart = gantt.ext.inlineEditors.attachEvent(\"onEditStart\", (state: IInlineEditState) => {\n\t\t\t\t\tthis.store(state.id, gantt.config.undo_types.task);\n\t\t\t\t});\n\n\t\t\t\t// GS-99. If another inline editor is opened and we open a new inline editor,\n\t\t\t\t// we shouldn't use the batchAction\n\t\t\t\tonBeforeEditStartId = gantt.ext.inlineEditors.attachEvent(\"onBeforeEditStart\", (state: IInlineEditState) => {\n\t\t\t\t\tthis.stopBatchAction();\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate _storeCommand(command: IUndoCommand) {\n\t\tconst undo = this._undo;\n\t\tundo.updateConfigs();\n\n\t\tif (!undo.undoEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._batchMode) {\n\t\t\tthis._batchAction.commands.push(command);\n\t\t} else {\n\t\t\tconst action = undo.action.create([command]);\n\t\t\tundo.logAction(action);\n\t\t}\n\t}\n\tprivate _storeEntityCommand(obj: TUndoValue, old: TUndoValue, actionType: TActionType, entityType: TEntityType) {\n\t\tconst undo = this._undo;\n\t\tconst command = undo.command.create(obj, old, actionType, entityType);\n\t\tthis._storeCommand(command);\n\t}\n\tprivate _storeTaskCommand(obj: ITask, type: TActionType) {\n\t\tif(this._gantt.isTaskExists(obj.id)){\n\t\t\t(obj as any).$local_index = this._gantt.getTaskIndex(obj.id);\n\t\t}\n\n\t\tthis._storeEntityCommand(obj, this.getInitialTask(obj.id), type, this._undo.command.entity.task);\n\t}\n\tprivate _storeLinkCommand(obj: ILink, type: TActionType) {\n\t\tthis._storeEntityCommand(obj, this.getInitialLink(obj.id), type, this._undo.command.entity.link);\n\t}\n\tprivate _getLinks(task: ITask) {\n\t\treturn task.$source.concat(task.$target);\n\t}\n\tprivate _storeTask(taskId: TaskID, overwrite: boolean = false) {\n\t\tconst gantt = this._gantt;\n\t\tthis.setInitialTask(taskId, overwrite);\n\t\tgantt.eachTask((child: ITask) => {\n\t\t\tthis.setInitialTask(child.id);\n\t\t}, taskId);\n\t\treturn true;\n\t}\n\tprivate _storeLink(linkId: LinkID, overwrite: boolean = false) {\n\t\tthis.setInitialLink(linkId, overwrite);\n\t\treturn true;\n\t}\n}","import { IUndo, IUndoCommand, IUndoCommands, IUndoPropAction, IUndoPropCommand, TActionType, TEntityType, TUndoStack, TUndoValue } from \"./types\";\n\nconst MAX_UNDO_STEPS = 100;\n\nexport class Undo implements IUndo {\n\n\tmaxSteps = MAX_UNDO_STEPS;\n\tundoEnabled = true;\n\tredoEnabled = true;\n\taction: IUndoPropAction = {\n\t\tcreate: (commands?: IUndoCommand[]): IUndoCommands => {\n\t\t\treturn { commands: (commands ? commands.slice() : []) };\n\t\t},\n\t\tinvert: (action: IUndoCommands): IUndoCommands => {\n\t\t\tconst gantt = this._gantt;\n\t\t\tconst revert = gantt.copy(action);\n\t\t\tconst commands = this.command;\n\t\t\tfor (let i = 0; i < action.commands.length; i++) {\n\t\t\t\tconst command = revert.commands[i] = commands.invert(revert.commands[i]);\n\t\t\t\tif (command.type === commands.type.update || command.type === commands.type.move) {\n\t\t\t\t\t[command.value, command.oldValue] = [command.oldValue, command.value];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn revert as IUndoCommands;\n\t\t}\n\t};\n\tcommand: IUndoPropCommand = {\n\t\t// entities that require different processing for undoing-redoing changes (gantt.config.undo_types)\n\t\tentity: null,\n\n\t\t// types of traced actions (gantt.config.undo_actions)\n\t\ttype: null,\n\n\t\tcreate: (value: TUndoValue, oldValue: TUndoValue, type: TActionType, entity: TEntityType): IUndoCommand => {\n\t\t\tconst gantt = this._gantt;\n\t\t\treturn {\n\t\t\t\tentity,\n\t\t\t\ttype,\n\t\t\t\tvalue: gantt.copy(value),\n\t\t\t\toldValue: gantt.copy(oldValue || value)\n\t\t\t};\n\t\t},\n\t\tinvert: (command: IUndoCommand): IUndoCommand => {\n\t\t\tconst gantt = this._gantt;\n\t\t\tconst revert = gantt.copy(command);\n\t\t\trevert.type = this.command.inverseCommands(command.type);\n\t\t\treturn revert;\n\t\t},\n\t\tinverseCommands: (command: TActionType): TActionType => {\n\t\t\tconst gantt = this._gantt;\n\t\t\tconst types = this.command.type;\n\t\t\tswitch (command) {\n\t\t\t\tcase types.update:\n\t\t\t\t\treturn types.update;\n\t\t\t\tcase types.remove:\n\t\t\t\t\treturn types.add;\n\t\t\t\tcase types.add:\n\t\t\t\t\treturn types.remove;\n\t\t\t\tcase types.move:\n\t\t\t\t\treturn types.move;\n\t\t\t\tdefault:\n\t\t\t\t\tgantt.assert(false, \"Invalid command \"+ command);\n\t\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t};\n\n\tprivate _undoStack = [];\n\tprivate _redoStack = [];\n\tprivate _gantt: any;\n\n\tconstructor(gantt: any){\n\t\tthis._gantt = gantt;\n\t}\n\tgetUndoStack() {\n\t\treturn this._undoStack;\n\t}\n\tsetUndoStack(stack: []) {\n\t\tthis._undoStack = stack;\n\t}\n\n\tgetRedoStack() {\n\t\treturn this._redoStack;\n\t}\n\tsetRedoStack(stack: []) {\n\t\tthis._redoStack = stack;\n\t}\n\n\tclearUndoStack() {\n\t\tthis._undoStack = [];\n\t}\n\n\tclearRedoStack() {\n\t\tthis._redoStack = [];\n\t}\n\n\tupdateConfigs() {\n\t\tconst gantt = this._gantt;\n\t\tthis.maxSteps = gantt.config.undo_steps || MAX_UNDO_STEPS;\n\t\tthis.command.entity = gantt.config.undo_types;\n\t\tthis.command.type = gantt.config.undo_actions;\n\t\tthis.undoEnabled = !!gantt.config.undo;\n\t\tthis.redoEnabled = !!gantt.config.redo; // GS-873, Redo should work even when the `gantt.config.undo` is disabled.\n\t}\n\n\tundo() {\n\t\tconst gantt = this._gantt;\n\t\tthis.updateConfigs();\n\t\tif (!this.undoEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = this._pop(this._undoStack);\n\t\tif (action) {\n\t\t\tthis._reorderCommands(action);\n\t\t}\n\t\tif (gantt.callEvent(\"onBeforeUndo\", [action]) !== false) {\n\t\t\tif (action) {\n\t\t\t\tthis._applyAction(this.action.invert(action));\n\t\t\t\tthis._push(this._redoStack, gantt.copy(action));\n\t\t\t\tgantt.callEvent(\"onAfterUndo\", [action]);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tgantt.callEvent(\"onAfterUndo\", [null]);\n\t}\n\n\tredo() {\n\t\tconst gantt = this._gantt;\n\t\tthis.updateConfigs();\n\t\tif (!this.redoEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = this._pop(this._redoStack);\n\t\tif (action) {\n\t\t\tthis._reorderCommands(action);\n\t\t}\n\n\t\tif (gantt.callEvent(\"onBeforeRedo\", [action]) !== false) {\n\t\t\tif (action) {\n\t\t\t\tthis._applyAction(action);\n\t\t\t\tthis._push(this._undoStack, gantt.copy(action));\n\t\t\t\tgantt.callEvent(\"onAfterRedo\", [action]);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tgantt.callEvent(\"onAfterRedo\", [null]);\n\t}\n\n\t// storeUndo:\n\tlogAction(action: IUndoCommands) {\n\t\tthis._push(this._undoStack, action);\n\t\tthis._redoStack = [];\n\t}\n\n\tprivate _push(stack: TUndoStack, action: IUndoCommands): IUndoCommands {\n\t\tconst gantt = this._gantt;\n\t\tif (!action.commands.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = stack === this._undoStack ? \"onBeforeUndoStack\" : \"onBeforeRedoStack\";\n\t\tif (gantt.callEvent(event, [action]) === false){\n\t\t\treturn;\n\t\t}\n\t\t// commands can be removed from event handler\n\t\tif (!action.commands.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tstack.push(action);\n\t\twhile (stack.length > this.maxSteps) {\n\t\t\tstack.shift();\n\t\t}\n\t\treturn action;\n\t}\n\n\tprivate _pop(stack: TUndoStack): IUndoCommands {\n\t\treturn stack.pop();\n\t}\n\n\tprivate _reorderCommands(action) {\n\t\t// firstly process tasks and only then links\n\t\t// in order to ensure links are added not earlier than their tasks\n\t\t// firstly to 'move' actions and only then updates\n\t\tconst weights = { any: 0, link:1, task:2 };\n\t\tconst actionWeights = { move: 1, any:0 };\n\t\taction.commands.sort(function(a, b) {\n\t\t\tif (a.entity === \"task\" && b.entity === \"task\") {\n\t\t\t\tif (a.type !== b.type) {\n\t\t\t\t\treturn (actionWeights[b.type] || 0) - (actionWeights[a.type] || 0);\n\t\t\t\t} else if (a.type === \"move\" && a.oldValue && b.oldValue && b.oldValue.parent === a.oldValue.parent) {\n\t\t\t\t\treturn a.oldValue.$index - b.oldValue.$index;\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst weightA = weights[a.entity] || weights.any;\n\t\t\t\tconst weightB = weights[b.entity] || weights.any;\n\t\t\t\treturn weightB - weightA;\n\t\t\t}\n\n\t\t});\n\t}\n\n\tprivate _applyAction(action: IUndoCommands) {\n\t\tlet command = null;\n\t\tconst entities = this.command.entity;\n\t\tconst actions = this.command.type;\n\t\tconst gantt = this._gantt;\n\t\tconst methods = {};\n\t\tmethods[entities.task] = {\n\t\t\tadd: \"addTask\",\n\t\t\tget: \"getTask\",\n\t\t\tupdate: \"updateTask\",\n\t\t\tremove: \"deleteTask\",\n\t\t\tmove: \"moveTask\",\n\t\t\tisExists: \"isTaskExists\"\n\t\t};\n\t\tmethods[entities.link] = {\n\t\t\tadd: \"addLink\",\n\t\t\tget: \"getLink\",\n\t\t\tupdate: \"updateLink\",\n\t\t\tremove: \"deleteLink\",\n\t\t\tisExists: \"isLinkExists\"\n\t\t};\n\n\t\tgantt.batchUpdate(function() {\n\t\t\t// it is logical to undo actions from the last one to the first one\n\t\t\t// but we have to do it from the first one because the order\n\t\t\t// of tasks ($index and $local_index) depends on the existing tasks\n\t\t\tfor (let i = 0; i < action.commands.length; i++) {\n\t\t\t\tcommand = action.commands[i];\n\t\t\t\tconst method = methods[command.entity][command.type];\n\t\t\t\tconst getMethod = methods[command.entity].get;\n\t\t\t\tconst check = methods[command.entity].isExists;\n\n\t\t\t\tif (command.type === actions.add) {\n\t\t\t\t\tgantt[method](command.oldValue, command.oldValue.parent, command.oldValue.$local_index);\n\t\t\t\t} else if (command.type === actions.remove) {\n\t\t\t\t\tif (gantt[check](command.value.id)) {\n\t\t\t\t\t\tgantt[method](command.value.id);\n\t\t\t\t\t}\n\t\t\t\t} else if (command.type === actions.update) {\n\t\t\t\t\tconst item = gantt[getMethod](command.value.id);\n\t\t\t\t\tfor(const prop in command.value){\n\t\t\t\t\t\tconst internalProperty = prop.startsWith(\"$\") || prop.startsWith(\"_\");\n\t\t\t\t\t\tconst whitelist = [\"$open\"];\n\t\t\t\t\t\tlet copyProperty = !internalProperty;\n\t\t\t\t\t\tif (whitelist.indexOf(prop) > -1){\n\t\t\t\t\t\t\tcopyProperty = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(copyProperty){\n\t\t\t\t\t\t\titem[prop] = command.value[prop];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tgantt[method](command.value.id);\n\t\t\t\t} else if (command.type === actions.move) {\n\t\t\t\t\tgantt[method](command.value.id, command.value.$local_index, command.value.parent);\n\t\t\t\t\t// GS-680: We should send the changes to the server after we undo vertical reorder\n\t\t\t\t\tgantt.callEvent(\"onRowDragEnd\", [command.value.id]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}","import auto_scheduling from \"./auto_scheduling\";\nimport click_drag from \"./click_drag\";\nimport critical_path from \"./critical_path\";\nimport drag_timeline from \"./drag_timeline\";\nimport export_api from \"./export_api\";\nimport fullscreen from \"./fullscreen\";\nimport grouping from \"./grouping\";\nimport keyboard_navigation from \"./keyboard_navigation\";\nimport marker from \"./marker\";\nimport multiselect from \"./multiselect\";\nimport overlay from \"./overlay\";\nimport quick_info from \"./quick_info\";\nimport tooltip from \"./tooltip\";\nimport undo from \"./undo\";\n\nexport default {\n\tauto_scheduling,\n\tclick_drag,\n\tcritical_path,\n\tdrag_timeline,\n\tfullscreen,\n\tkeyboard_navigation,\n\tquick_info,\n\ttooltip,\n\tundo,\n\tgrouping,\n\tmarker,\n\tmultiselect,\n\toverlay,\n\texport_api\n};","\nimport auto_scheduling_configs from \"./auto_scheduling_configs\";\nimport links_common from \"../core/relations/links_common\";\nimport graph_helper from \"../core/relations/graph_helper\";\n\nimport LinksBuilder from \"../core/relations/links_builder\";\nimport {ConstraintTypes} from \"./auto_scheduling/constraint_types\";\nimport {ConstraintsHelper} from \"./auto_scheduling/constraints\";\nimport {AutoSchedulingPlanner} from \"./auto_scheduling/planner\";\nimport {ConnectedGroupsHelper} from \"./auto_scheduling/connected_groups\";\nimport {LoopsFinder} from \"./auto_scheduling/loops_finder\";\n\nimport {attachUIHandlers} from \"./auto_scheduling/ui_handlers\";\n\nexport default function(gantt){\n\n\tauto_scheduling_configs(gantt);\n\tlinks_common(gantt);\n\nvar linksBuilder = LinksBuilder(gantt);\nvar graphHelper = graph_helper(gantt);\n\n\nvar constraintsHelper = ConstraintsHelper.Create(\n\tgantt\n);\n\n\nvar planner = new AutoSchedulingPlanner(gantt, graphHelper, constraintsHelper);\n\nvar connectedGroups = new ConnectedGroupsHelper(gantt, linksBuilder);\n\nvar loopsFinder = new LoopsFinder(\n\tgantt,\n\tgraphHelper,\n\tlinksBuilder\n);\n\ngantt.getConnectedGroup = connectedGroups.getConnectedGroup;\ngantt.getConstraintType = constraintsHelper.getConstraintType;\ngantt.getConstraintLimitations = function (task) {\n\tvar plan = constraintsHelper.processConstraint(task, null);\n\tif (plan) {\n\t\treturn {\n\t\t\tearliestStart: plan.earliestStart || null,\n\t\t\tearliestEnd: plan.earliestEnd || null,\n\t\t\tlatestStart: plan.latestStart || null,\n\t\t\tlatestEnd: plan.latestEnd || null\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tearliestStart: null,\n\t\t\tearliestEnd: null,\n\t\t\tlatestStart: null,\n\t\t\tlatestEnd: null\n\t\t};\n\t}\n};\n\ngantt.isCircularLink = loopsFinder.isCircularLink;\ngantt.findCycles = loopsFinder.findCycles;\n\ngantt.config.constraint_types = ConstraintTypes;\ngantt.config.auto_scheduling = false;\ngantt.config.auto_scheduling_descendant_links = false;\ngantt.config.auto_scheduling_initial = true;\ngantt.config.auto_scheduling_strict = false;\ngantt.config.auto_scheduling_move_projects = true;\ngantt.config.project_start = null;\ngantt.config.project_end = null;\ngantt.config.schedule_from_end = false;\n\nfunction preferInitialTaskDates(startTask, relations) {\n\t// TODO: remove in 7.0\n\tif (!gantt.config.auto_scheduling_compatibility) {\n\t\treturn;\n\t}\n\n\t// .preferredStart still exists only to emulate pre 6.1 auto scheduling behavior\n\t// will be removed in future versions\n\tfor (var i = 0; i < relations.length; i++) {\n\t\tvar rel = relations[i];\n\t\tvar task = gantt.getTask(rel.target);\n\n\t\tif (!gantt.config.auto_scheduling_strict || rel.target == startTask) {\n\t\t\trel.preferredStart = new Date(task.start_date);\n\t\t}\n\t}\n}\n\nvar afterRenderBeforeFirstRepaint = false;\ngantt.attachEvent(\"onParse\", function(){\n\tafterRenderBeforeFirstRepaint = true;\n\treturn true;\n});\n\ngantt.attachEvent(\"onBeforeGanttRender\", function(){\n\tafterRenderBeforeFirstRepaint = false;\n\treturn true;\n});\n\nfunction updateParentsAndCallEvents(updatedTasks) {\n\tif(!updatedTasks.length){\n\t\treturn;\n\t}\n\n\tgantt.batchUpdate(function payload() {\n\t\tfor (var i = 0; i < updatedTasks.length; i++) {\n\t\t\tgantt.updateTask(updatedTasks[i]);\n\t\t}\n\t}, afterRenderBeforeFirstRepaint); // don't call repaint if auto scheduling on parse before initial repain\n}\n\ngantt._autoSchedule = function (id, relations) {\n\tif (gantt.callEvent(\"onBeforeAutoSchedule\", [id]) === false) {\n\t\treturn;\n\t}\n\tgantt._autoscheduling_in_progress = true;\n\n\tvar constraints = constraintsHelper.getConstraints(\n\t\tid,\n\t\tgantt.isTaskExists(id) ? relations : null\n\t);\n\n\tvar updatedTasks = [];\n\n\tvar cycles = graphHelper.findLoops(relations);\n\tif (cycles.length) {\n\t\tgantt.callEvent(\"onAutoScheduleCircularLink\", [cycles]);\n\t} else {\n\t\tpreferInitialTaskDates(id, relations);\n\n\t\t// GS-2427. Auto-schedule twice when there are links with project tasks\n\t\t// as we cannot be sure that the project duration doesn't change\n\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\tif (relations[i].subtaskLink){\n\t\t\t\tplanner._secondIterationRequired = true;\n\t\t\t\tplanner._secondIteration = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tvar plan = planner.generatePlan(relations, constraints);\n\t\tupdatedTasks = planner.applyProjectPlan(plan);\n\n\t\tupdateParentsAndCallEvents(updatedTasks);\n\t}\n\n\tgantt._autoscheduling_in_progress = false;\n\tgantt.callEvent(\"onAfterAutoSchedule\", [id, updatedTasks]);\n};\n\ngantt.autoSchedule = function (id, inclusive) {\n\tif (inclusive === undefined) {\n\t\tinclusive = true;\n\t} else {\n\t\tinclusive = !!inclusive;\n\t}\n\n\tvar relations;\n\tif (id !== undefined) {\n\t\tif (gantt.config.auto_scheduling_compatibility) {\n\t\t\trelations = linksBuilder.getLinkedTasks(id, inclusive);\n\t\t} else {\n\t\t\trelations = connectedGroups.getConnectedGroupRelations(id);\n\t\t}\n\t} else {\n\t\trelations = linksBuilder.getLinkedTasks();\n\t}\n\n\tgantt._autoSchedule(id, relations);\n};\n\ngantt.attachEvent(\"onTaskLoading\", function (task) {\n\tif (task.constraint_date && typeof task.constraint_date === \"string\") {\n\t\ttask.constraint_date = gantt.date.parseDate(task.constraint_date, \"parse_date\");\n\t}\n\ttask.constraint_type = gantt.getConstraintType(task);\n\treturn true;\n});\ngantt.attachEvent(\"onTaskCreated\", function (task) {\n\ttask.constraint_type = gantt.getConstraintType(task);\n\treturn true;\n});\n\nattachUIHandlers(gantt, linksBuilder, loopsFinder, connectedGroups);\n\n};","import { EventsManager } from \"./eventsManager\";\nimport { ISelectedRegionConfig, SelectedRegion } from \"./selectedRegion\";\n\nexport default function(gantt: any){\n\tif (!gantt.ext) {\n\t\tgantt.ext = {};\n\t}\n\n\tconst defaultConfig: ISelectedRegionConfig = {\n\t\tclassName: \"gantt_click_drag_rect\",\n\t\tuseRequestAnimationFrame: true,\n\t\tcallback: undefined,\n\t\tsingleRow: false\n\t};\n\n\tfunction setClickDrag(){\n\t\tconst config: ISelectedRegionConfig = { viewPort: gantt.$task_data, ...defaultConfig };\n\t\tif (gantt.ext.clickDrag){\n\t\t\tgantt.ext.clickDrag.destructor();\n\t\t}\n\t\tgantt.ext.clickDrag = new EventsManager(gantt);\n\t\tconst clickDrag = gantt.config.click_drag;\n\t\tconfig.render = clickDrag.render || defaultConfig.render;\n\t\tconfig.className = clickDrag.className || defaultConfig.className;\n\t\tconfig.callback = clickDrag.callback || defaultConfig.callback;\n\t\tconfig.viewPort = clickDrag.viewPort || gantt.$task_data;\n\t\tconfig.useRequestAnimationFrame = clickDrag.useRequestAnimationFrame === undefined ?\n\t\t\tdefaultConfig.useRequestAnimationFrame : clickDrag.useRequestAnimationFrame;\n\n\t\tconfig.singleRow = clickDrag.singleRow === undefined ? defaultConfig.singleRow : clickDrag.singleRow;\n\t\tconst timeline = gantt.$ui.getView(\"timeline\");\n\t\tconst selectedRegion = new SelectedRegion(config, gantt, timeline);\n\t\tgantt.ext.clickDrag.attach(selectedRegion, clickDrag.useKey, clickDrag.ignore);\n\t}\n\n\tgantt.attachEvent(\"onGanttReady\", () => {\n\t\tif (gantt.config.click_drag){\n\t\t\tsetClickDrag();\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\tif (gantt.$container && gantt.config.click_drag){\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\n\t\t\t\tsetClickDrag();\n\t\t\t}, {once:true});\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", () => {\n\t\tif (gantt.ext.clickDrag){\n\t\t\tgantt.ext.clickDrag.destructor();\n\t\t}\n\t});\n\n}","\n\nimport auto_scheduling_configs from \"./auto_scheduling_configs\";\nimport links_common from \"../core/relations/links_common\";\nimport slackPrivate from \"./critical_path/slack\";\nimport critical_path from \"./critical_path/critical_path\";\n\n\nexport default function(gantt){\n\n\tauto_scheduling_configs(gantt);\n\tlinks_common(gantt);\n\nvar _private = slackPrivate(gantt);\n_private.init();\n\ngantt.getFreeSlack = function(task) {\n\treturn _private.getFreeSlack(task);\n};\n\ngantt.getTotalSlack = function(task) {\n\treturn _private.getTotalSlack(task);\n};\n\nvar criticalPath = critical_path(gantt);\ngantt.config.highlight_critical_path = false;\ncriticalPath.init(_private);\n\ngantt.isCriticalTask = function (task) {\n\tgantt.assert(!!(task && task.id !== undefined), \"Invalid argument for gantt.isCriticalTask\");\n\treturn criticalPath.isCriticalTask(task);\n};\n\ngantt.isCriticalLink = function (link) {\n\treturn this.isCriticalTask(gantt.getTask(link.source));\n};\n\n\ngantt.getSlack = function(task1, task2) {\n\tvar minSlack = 0;\n\tvar relations = [];\n\tvar common = {};\n\n\tfor (var i = 0; i < task1.$source.length; i++) {\n\t\tcommon[task1.$source[i]] = true;\n\t}\n\tfor (var i = 0; i < task2.$target.length; i++) {\n\t\tif(common[task2.$target[i]])\n\t\t\trelations.push(task2.$target[i]);\n\t}\n\t// there is at least one link\n\tif (relations[0]){\n\t\tfor (var i = 0; i < relations.length; i++) {\n\t\t\tvar link = this.getLink(relations[i]);\n\t\t\tvar newSlack = this._getSlack(task1, task2, this._convertToFinishToStartLink(link.id, link, task1, task2, task1.parent, task2.parent));\n\n\t\t\tif (minSlack > newSlack || i === 0) {\n\t\t\t\tminSlack = newSlack;\n\t\t\t}\n\t\t}\n\t}\n\telse { // there are no links, but we still need the slack (for the children of a project task)\n\t\tminSlack = this._getSlack(task1, task2, {});\n\t}\n\treturn minSlack;\n};\n\ngantt._getSlack = function (task, next_task, relation) {\n\t// relation - link expressed as finish-to-start (gantt._convertToFinishToStartLink)\n\tvar types = this.config.types;\n\n\tvar from = null;\n\tif (this.getTaskType(task.type) == types.milestone) {\n\t\tfrom = task.start_date;\n\t} else {\n\t\tfrom = task.end_date;\n\t}\n\n\tvar to = next_task.start_date;\n\n\tvar duration = 0;\n\tif (+from > +to) {\n\t\tduration = -this.calculateDuration({start_date: to, end_date: from, task: task});\n\t} else {\n\t\tduration = this.calculateDuration({start_date: from, end_date: to, task: task});\n\t}\n\n\tvar lag = relation.lag;\n\tif (lag && lag*1 == lag) {\n\t\tduration -= lag;\n\t}\n\n\treturn duration;\n};\n\n\n};","import LinksBuilder from \"../../core/relations/links_builder\";\nimport GraphHelper from \"../../core/relations/graph_helper\";\n\nexport default function(gantt) {\n\tvar linksBuilder = LinksBuilder(gantt);\n\tvar graphHelper = GraphHelper(gantt);\n\tvar _private = {\n\t\t_freeSlack: {},\n\t\t_totalSlack: {},\n\t\t_slackNeedCalculate: true,\n\t\t_linkedTasksById: {},\n\t\t_successorsByTaskId: {},\n\t\t_projectEnd: null,\n\t\t\n\t\t_calculateSlacks: function(){\n\t\t\tvar linkedTasks = linksBuilder.getLinkedTasks();\n\t\t\t\n\t\t\tvar loops = graphHelper.findLoops(linkedTasks);\n\t\t\tif(loops.length){\n\t\t\t\tgantt.callEvent(\"onAutoScheduleCircularLink\", [loops]);\n\t\t\t\tvar loopLinks = {};\n\t\t\t\t\n\t\t\t\tloops.forEach(function(loop){\n\t\t\t\t\t// remove loop\n\t\t\t\t\tloop.linkKeys.forEach(function(key){\n\t\t\t\t\t\tloopLinks[key] = true;\n\t\t\t\t\t});\n\t\t\t\t\t//const problemLink = loop.linkKeys[0];\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tfor(var i = 0; i < linkedTasks.length; i++){\n\t\t\t\t\tif(linkedTasks[i].hashSum in loopLinks){\n\t\t\t\t\t\tlinkedTasks.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tconst reversedOrder = graphHelper.topologicalSort(linkedTasks).reverse();\n\t\t\tconst successorsByTaskId = {};\n\t\t\tlinkedTasks.forEach((entry) => {\n\n\t\t\t\t// get successors\n\t\t\t\tif (!successorsByTaskId[entry.source]) {\n\t\t\t\t\tsuccessorsByTaskId[entry.source] = {\n\t\t\t\t\t\tlinked: []\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tsuccessorsByTaskId[entry.source].linked.push({\n\t\t\t\t\ttarget: entry.target,\n\t\t\t\t\tlink: entry\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst distCalculator = {\n\t\t\t\t_cache: {},\n\t\t\t\tgetDist: function(source, target){\n\t\t\t\t\tconst key = `${source.id}_${target.id}`;\n\t\t\t\t\tif(this._cache[key]){\n\t\t\t\t\t\treturn this._cache[key];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tconst dist = gantt.calculateDuration({\n\t\t\t\t\t\t\tstart_date: source.end_date,\n\t\t\t\t\t\t\tend_date: target.start_date,\n\t\t\t\t\t\t\ttask: source});\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis._cache[key] = dist;\n\t\t\t\t\t\treturn dist;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._projectEnd = gantt.getSubtaskDates().end_date;\n\t\t\tthis._calculateFreeSlack(linkedTasks, reversedOrder, successorsByTaskId, distCalculator);\n\t\t\tthis._calculateTotalSlack(linkedTasks, reversedOrder, successorsByTaskId, distCalculator);\n\t\t},\n\t\t_isCompletedTask: function(task){\n\t\t\treturn gantt.config.auto_scheduling_use_progress && task.progress == 1;\n\t\t},\n\t\t_calculateFreeSlack: function(linkedTasks, orderedFromEnd, successorsMap, distCalculator){\n\t\t\t\n\t\t\tconst freeSlack = this._freeSlack = {};\n\t\t\tconst tasksToDo = {};\n\t\t\tgantt.eachTask(function(task){\n\t\t\t\tif(!gantt.isSummaryTask(task)){\n\t\t\t\t\ttasksToDo[task.id] = task;\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst processedTasks = {};\n\t\t\tlinkedTasks.forEach((entry) => {\n\t\t\t\tconst task = tasksToDo[entry.source];\n\t\t\t\t// GS-1995: Don't calculate slack if the task's parent is not loaded\n\t\t\t\tif (!task){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tprocessedTasks[entry.source] = true;\n\t\t\t\tlet ownSlack = distCalculator.getDist(task, gantt.getTask(entry.target));\n\t\t\t\townSlack -= entry.lag || 0;\n\n\t\t\t\tif(freeSlack[entry.source] !== undefined){\n\t\t\t\t\tfreeSlack[entry.source] = Math.min(ownSlack, freeSlack[entry.source]);\n\t\t\t\t}else{\n\t\t\t\t\tfreeSlack[entry.source] = ownSlack;\n\t\t\t\t}\n\t\t\t});\n\t\t\tfor(const id in tasksToDo){\n\t\t\t\tif(processedTasks[id]){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst task = tasksToDo[id];\n\t\t\t\tif(this._isCompletedTask(task) || task.unscheduled){\n\t\t\t\t\tfreeSlack[task.id] = 0;\n\t\t\t\t}else{\n\t\t\t\t\tfreeSlack[task.id] = gantt.calculateDuration({start_date: task.end_date, end_date: this._projectEnd, task:task});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\treturn this._freeSlack;\n\n\t\t},\n\t\t_disconnectedTaskSlack(task){\n\t\t\tif(this._isCompletedTask(task)){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn Math.max(gantt.calculateDuration(task.end_date, this._projectEnd), 0);\n\t\t\t}\n\t\t},\n\t\t_calculateTotalSlack: function(linkedTasks, orderedFromEnd, successorsMap,  distCalculator) {\n\t\t\tthis._totalSlack = {};\n\t\t\tthis._slackNeedCalculate = false;\n\t\t\tvar totalSlackByTaskId = {};\n\t\t\tvar tasks = gantt.getTaskByTime();\n\n\t\t\tfor(var i = 0; i < orderedFromEnd.length; i++){\n\t\t\t\tconst task = gantt.getTask(orderedFromEnd[i]);\n\t\t\t\t\n\t\t\t\tif(this._isCompletedTask(task)){\n\t\t\t\t\ttotalSlackByTaskId[task.id] = 0;\n\t\t\t\t} else if(!successorsMap[task.id] && !gantt.isSummaryTask(task)){\n\t\t\t\t\ttotalSlackByTaskId[task.id] = this.getFreeSlack(task);\n\t\t\t\t}else{\n\t\t\t\t\tconst successorLinks = successorsMap[task.id].linked;\n\t\t\t\t\tlet totalSlack = null;\n\t\t\t\t\tfor(var j = 0; j < successorLinks.length; j++){\n\t\t\t\t\t\tconst successorLink = successorLinks[j];\n\t\t\t\t\t\tconst successor = gantt.getTask(successorLink.target);\n\t\t\t\t\t\tlet successorSlack = 0;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(totalSlackByTaskId[successor.id] !== undefined){\n\t\t\t\t\t\t\tsuccessorSlack += totalSlackByTaskId[successor.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tsuccessorSlack += distCalculator.getDist(task, successor);\n\n\t\t\t\t\t\tsuccessorSlack -= successorLink.link.lag || 0;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tif(totalSlack === null){\n\t\t\t\t\t\t\ttotalSlack = successorSlack;\n\t\t\t\t\t\t} else{\n\t\t\t\t\t\t\ttotalSlack = Math.min(totalSlack, successorSlack);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\ttotalSlackByTaskId[task.id] = totalSlack || 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\ttasks.forEach(function(task){\n\t\t\t\tif(totalSlackByTaskId[task.id] === undefined && !gantt.isSummaryTask(task)){\n\t\t\t\t\ttotalSlackByTaskId[task.id] = this.getFreeSlack(task);\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t\t\n\t\t\tthis._totalSlack = totalSlackByTaskId;\n\t\t\treturn this._totalSlack;\n\t\t},\n\n\t\t_resetTotalSlackCache: function() {\n\t\t\tthis._slackNeedCalculate = true;\n\t\t},\n\n\t\t_shouldCalculateTotalSlack: function() {\n\t\t\treturn this._slackNeedCalculate;\n\t\t},\n\n\t\tgetFreeSlack: function(task) {\n\t\t\tif (this._shouldCalculateTotalSlack()) {\n\t\t\t\tthis._calculateSlacks();\n\t\t\t}\n\t\t\tif (!gantt.isTaskExists(task.id)) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif(this._isCompletedTask(task)){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(gantt.isSummaryTask(task)){\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn this._freeSlack[task.id] || 0; \n\t\t},\n\n\t\tgetTotalSlack: function(task) {\n\t\t\tif (this._shouldCalculateTotalSlack()) {\n\t\t\t\tthis._calculateSlacks();\n\t\t\t}\n\t\t\tif (task === undefined) {\n\t\t\t\treturn this._totalSlack;\n\t\t\t}\n\t\t\t\n\t\t\tvar id;\n\t\t\tif (task.id !== undefined){\n\t\t\t\tid = task.id;\n\t\t\t}else{\n\t\t\t\tid = task;\n\t\t\t}\n\n\t\t\tif(this._isCompletedTask(task)){\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif(this._totalSlack[id] === undefined){\n\t\t\t\tif(gantt.isSummaryTask(gantt.getTask(id))){\n\t\t\t\t\tvar minSlack = null;\n\t\t\t\t\tgantt.eachTask(function(child){\n\t\t\t\t\t\tvar childSlack = this._totalSlack[child.id];\n\t\t\t\t\t\tif(childSlack !== undefined && (minSlack === null || childSlack < minSlack)){\n\t\t\t\t\t\t\tminSlack = childSlack;\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this), id);\n\t\t\t\t\t\n\t\t\t\t\tif(minSlack !== null){\n\t\t\t\t\t\tthis._totalSlack[id] = minSlack;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._totalSlack[id] = gantt.calculateDuration({\n\t\t\t\t\t\t\tstart_date: task.end_date,\n\t\t\t\t\t\t\tend_date: this._projectEnd,\n\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn this._totalSlack[id];\n\t\t\t\t\t\n\t\t\t\t}else{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\treturn this._totalSlack[id] || 0;\n\t\t\t}\n\t\t},\n\n\t\tdropCachedFreeSlack: function() {\n\t\t\tthis._freeSlack =  {};\n\t\t\tthis._resetTotalSlackCache();\n\t\t},\n\n\t\tinit: function(){\n\t\t\tfunction slackHandler(){\n\t\t\t\t_private.dropCachedFreeSlack();\n\t\t\t}\n\n\t\t\tgantt.attachEvent(\"onAfterLinkAdd\", slackHandler);\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterLinkUpdate\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterLinkDelete\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskDelete\", slackHandler);\n\t\t\tgantt.attachEvent(\"onRowDragEnd\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskMove\", slackHandler);\n\t\t\tgantt.attachEvent(\"onParse\", slackHandler);\n\t\t\tgantt.attachEvent(\"onClearAll\", slackHandler);\n\t\t}\n\t};\n\n\treturn _private;\n};","export default function(gantt){\n\tgantt._isProjectEnd = function(task) {\n\t\treturn !(this._hasDuration({\n\t\t\tstart_date: task.end_date,\n\t\t\tend_date: this._getProjectEnd(),\n\t\t\ttask: task\n\t\t}));\n\t};\n\n\treturn {\n\t\t_cache: {},\n\t\t_slackHelper: null,\n\t\treset: function(){\n\t\t\tthis._cache = {};\n\t\t},\n\t\t_calculateCriticalPath: function(){\n\t\t\tthis.reset();\n\t\t},\n\t\t\n\t\tisCriticalTask: function(task){\n\t\t\tif(!task) return false;\n\n\t\t\tif(gantt.config.auto_scheduling_use_progress && task.progress === 1){\n\t\t\t\tthis._cache[task.id] = false;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (task.unscheduled){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif(this._cache[task.id] === undefined){\n\t\t\t\tif(gantt.isSummaryTask(task)){\n\t\t\t\t\tlet hasCritical = false;\n\t\t\t\t\tgantt.eachTask((function(child){\n\t\t\t\t\t\tif(!hasCritical){\n\t\t\t\t\t\t\thasCritical = this.isCriticalTask(child);\n\t\t\t\t\t\t}\n\t\t\t\t\t}).bind(this), task.id);\n\t\t\t\t\t\n\t\t\t\t\tthis._cache[task.id] = hasCritical;\n\t\t\t\t}else{\n\t\t\t\t\tthis._cache[task.id] = this._slackHelper.getTotalSlack(task) <= 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn this._cache[task.id];\n\t\t},\n\n\t\tinit: function(slackHelper){\n\t\t\tthis._slackHelper = slackHelper;\n\t\t\tvar resetCache = gantt.bind(function(){\n\t\t\t\tthis.reset();\n\t\t\t\treturn true;\n\t\t\t}, this);\n\n\t\t\tvar handleTaskIdChange = gantt.bind(function (oldId, newId) {\n\t\t\t\tif (this._cache) {\n\t\t\t\t\tthis._cache[newId] = this._cache[oldId];\n\t\t\t\t\tdelete this._cache[oldId];\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}, this);\n\n\t\t\tgantt.attachEvent(\"onAfterLinkAdd\", resetCache);\n\t\t\tgantt.attachEvent(\"onAfterLinkUpdate\", resetCache);\n\t\t\tgantt.attachEvent(\"onAfterLinkDelete\", resetCache);\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", resetCache);\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", handleTaskIdChange);\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", resetCache);\n\t\t\tgantt.attachEvent(\"onAfterTaskDelete\", resetCache);\n\t\t\tgantt.attachEvent(\"onParse\", resetCache);\n\t\t\tgantt.attachEvent(\"onClearAll\", resetCache);\n\n\n\t\t\tvar criticalPathHandler = function(){\n\t\t\t\tif(gantt.config.highlight_critical_path && !gantt.getState(\"batchUpdate\").batch_update)\n\t\t\t\t\tgantt.render();\n\t\t\t};\n\t\t\tgantt.attachEvent(\"onAfterLinkAdd\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onAfterLinkUpdate\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onAfterLinkDelete\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function (oldId, newId) {\n\t\t\t\tif (gantt.config.highlight_critical_path && gantt.isTaskExists(newId)) {\n\t\t\t\t\tgantt.refreshTask(newId);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskDelete\", criticalPathHandler);\n\t\t}\n\t};\n};","import { EventsManager } from \"./eventsManager\";\nexport default function(gantt: any){\n\tif (!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tgantt.ext.dragTimeline = {\n\t\tcreate: () => EventsManager.create(gantt),\n\t\t_isDragInProgress: () => EventsManager._isDragInProgress\n\t};\n\n\tgantt.config.drag_timeline = {\n\t\tenabled: true,\n\t\trender: false\n\t};\n}","export default function(gantt: any){\n\ninterface IBody extends HTMLElement {\n\tmsRequestFullscreen?: () => void;\n\tmozRequestFullScreen?: () => void;\n\twebkitRequestFullscreen?: (ALLOW_KEYBOARD_INPUT: any) => void;\n}\n\n\ninterface IConsole extends Console {\n\twarning?: (str: string) => void;\n}\n\ninterface IDocument extends Document {\n\tfullscreenElement: Element;\n\tmozFullScreenElement?: Element;\n\twebkitFullscreenElement?: Element;\n\tmsFullscreenElement?: Element;\n\twebkitFullscreenEnabled?: boolean;\n\tmozFullScreenEnabled?: boolean;\n\tmsFullscreenEnabled?: boolean;\n\tmsExitFullscreen?: () => void;\n\tmozCancelFullScreen?: () => void;\n\twebkitExitFullscreen?: () => void;\n}\n\ninterface IElement extends Element {\n\tALLOW_KEYBOARD_INPUT?: boolean;\n}\n\ninterface IElementSizes extends ISizes {\n\tmodified: boolean;\n}\n\ninterface ISizes {\n\twidth: null | string;\n\theight: null | string;\n\ttop: null | string;\n\tleft: null | string;\n\tposition: null | string;\n\tzIndex: null | number;\n}\n\nfunction isExpanded() {\n\tconst element = ((document as IDocument).fullscreenElement ||\n\t\t(document as IDocument).mozFullScreenElement ||\n\t\t(document as IDocument).webkitFullscreenElement ||\n\t\t(document as IDocument).msFullscreenElement);\n\treturn !!(element && element === document.body);\n}\n\nfunction isFullscreenAvailable() {\n\ttry {\n\t\treturn (document as IDocument).fullscreenEnabled ||\n\t\t\t(document as IDocument).webkitFullscreenEnabled ||\n\t\t\t(document as IDocument).mozFullScreenEnabled ||\n\t\t\t(document as IDocument).msFullscreenEnabled;\n\t} catch (e) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error(\"Fullscreen is not available:\", e); \n\t}\n}\n\nconst state = gantt.$services.getService(\"state\");\nstate.registerProvider(\"fullscreen\", () => {\n\tif (isFullscreenAvailable()){\n\t\treturn { fullscreen: isExpanded() };\n\t} else {\n\t\treturn undefined;\n\t}\n});\n\nlet backupBodyPadding = {\n\toverflow: null,\n\tpadding: null,\n\tpaddingTop: null,\n\tpaddingRight: null,\n\tpaddingBottom: null,\n\tpaddingLeft: null\n};\n\nconst backupElementSizes: IElementSizes = {\n\twidth: null,\n\theight: null,\n\ttop: null,\n\tleft: null,\n\tposition: null,\n\tzIndex: null,\n\tmodified: false\n};\n\nlet backupPositioning = null;\nfunction resetParentPositioning(root){\n\tlet parent = root.parentNode;\n\tconst positions = [];\n\twhile(parent && parent.style){\n\t\tpositions.push({\n\t\t\telement: parent,\n\t\t\toriginalPositioning: parent.style.position\n\t\t});\n\t\tparent.style.position = \"static\";\n\t\tparent = parent.parentNode;\n\t}\n\treturn positions;\n}\n\nfunction restoreParentPositioning(positions: any[]){\n\tpositions.forEach(record => {\n\t\trecord.element.style.position = record.originalPositioning;\n\t});\n}\n\n// expand gantt root element to fullscreen automatically\nfunction setFullScreenSizes() {\n\tconst root = gantt.ext.fullscreen.getFullscreenElement();\n\tconst body = document.body;\n\tupdateSizes(root.style, backupElementSizes);\n\tbackupBodyPadding = {\n\t\toverflow: body.style.overflow,\n\t\tpadding: body.style.padding ? body.style.padding : null,\n\t\tpaddingTop: body.style.paddingTop ? body.style.paddingTop : null,\n\t\tpaddingRight: body.style.paddingRight ? body.style.paddingRight : null,\n\t\tpaddingBottom: body.style.paddingBottom ? body.style.paddingBottom : null,\n\t\tpaddingLeft: body.style.paddingLeft ? body.style.paddingLeft : null\n\t};\n\n\tif (body.style.padding) {\n\t\tbody.style.padding = \"0\";\n\t}\n\tif (body.style.paddingTop) {\n\t\tbody.style.paddingTop = \"0\";\n\t}\n\tif (body.style.paddingRight) {\n\t\tbody.style.paddingRight = \"0\";\n\t}\n\tif (body.style.paddingBottom) {\n\t\tbody.style.paddingBottom = \"0\";\n\t}\n\tif (body.style.paddingLeft) {\n\t\tbody.style.paddingLeft = \"0\";\n\t}\n\n\tbody.style.overflow = \"hidden\";\n\n\troot.style.width = \"100vw\";\n\troot.style.height = \"100vh\";\n\troot.style.top = \"0px\";\n\troot.style.left = \"0px\";\n\troot.style.position = \"absolute\";\n\troot.style.zIndex = 1;\n\tbackupElementSizes.modified = true;\n\tbackupPositioning = resetParentPositioning(root);\n}\n\nfunction restoreSizes() {\n\tconst root = gantt.ext.fullscreen.getFullscreenElement();\n\tconst body = document.body;\n\tif (backupElementSizes.modified) {\n\t\tif (backupBodyPadding.padding) {\n\t\t\tbody.style.padding = backupBodyPadding.padding;\n\t\t}\n\t\tif (backupBodyPadding.paddingTop) {\n\t\t\tbody.style.paddingTop = backupBodyPadding.paddingTop;\n\t\t}\n\t\tif (backupBodyPadding.paddingRight) {\n\t\t\tbody.style.paddingRight = backupBodyPadding.paddingRight;\n\t\t}\n\t\tif (backupBodyPadding.paddingBottom) {\n\t\t\tbody.style.paddingBottom = backupBodyPadding.paddingBottom;\n\t\t}\n\t\tif (backupBodyPadding.paddingLeft) {\n\t\t\tbody.style.paddingLeft = backupBodyPadding.paddingLeft;\n\t\t}\n\n\t\tbody.style.overflow = backupBodyPadding.overflow;\n\t\tbackupBodyPadding = {\n\t\t\toverflow: null,\n\t\t\tpadding: null,\n\t\t\tpaddingTop: null,\n\t\t\tpaddingRight: null,\n\t\t\tpaddingBottom: null,\n\t\t\tpaddingLeft: null\n\t\t};\n\t\tupdateSizes(backupElementSizes, root.style);\n\t\tbackupElementSizes.modified = false;\n\t}\n\trestoreParentPositioning(backupPositioning);\n\tbackupPositioning = null;\n}\n\nfunction updateSizes(source: ISizes, target: ISizes) {\n\ttarget.width = source.width;\n\ttarget.height = source.height;\n\ttarget.top = source.top;\n\ttarget.left = source.left;\n\ttarget.position = source.position;\n\ttarget.zIndex = source.zIndex;\n}\n\nfunction addDOMEvents() {\n\tgantt.event(document, \"webkitfullscreenchange\", onFullScreenChange);\n\tgantt.event(document, \"mozfullscreenchange\", onFullScreenChange);\n\tgantt.event(document, \"MSFullscreenChange\", onFullScreenChange);\n\t// For IE on Win 10\n\tgantt.event(document, \"fullscreenChange\", onFullScreenChange);\n\tgantt.event(document, \"fullscreenchange\", onFullScreenChange);\n}\n\nlet expandGantt = false;\nfunction onFullScreenChange() {\n\tif (!gantt.$container) {\n\t\t// do nothing if gantt is not yet initialized\n\t\treturn;\n\t}\n\tlet event: \"onExpand\" | \"onCollapse\";\n\tconst isBodyExpanded = isExpanded();\n\n\tif (isBodyExpanded) {\n\t\tif (expandGantt) {\n\t\t\tevent = \"onExpand\";\n\t\t\tsetFullScreenSizes();\n\t\t}\n\t} else if (expandGantt) {\n\t\texpandGantt = false;\n\t\tevent = \"onCollapse\";\n\t\trestoreSizes();\n\t}\n\tsetTimeout(() => {\n\t\tgantt.render();\n\t});\n\tsetTimeout(() => {\n\t\tgantt.callEvent(event, [gantt.ext.fullscreen.getFullscreenElement()]);\n\t});\n}\n\nfunction cantFullscreen() {\n\tif (!gantt.$container) { // check is gantt initialized or not\n\t\treturn true;\n\t}\n\tif (!gantt.ext.fullscreen.getFullscreenElement()) {\n\t\treturn true;\n\t}\n\tif (!isFullscreenAvailable()) {\n\t\t// eslint-disable-next-line no-console\n\t\tconst method = (console as IConsole).warning || console.log;\n\t\tmethod(\"The `fullscreen` feature not being allowed, or full-screen mode not being supported\");\n\t\treturn true;\n\t}\n\treturn false;\n}\n\ngantt.ext.fullscreen = {\n\texpand(): void {\n\t\tif (cantFullscreen()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (isExpanded()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!gantt.callEvent(\"onBeforeExpand\", [this.getFullscreenElement()])) {\n\t\t\treturn;\n\t\t}\n\t\texpandGantt = true;\n\n\t\t// we switch body to fullscreen and then expand fullscreen element to viewport\n\t\t// we do it to correct display common elements: lightboxes, tooltip etc.\n\t\tconst element = document.body as IBody;\n\t\tconst requestArguments = element.webkitRequestFullscreen ?\n\t\t\t[(Element as unknown as IElement).ALLOW_KEYBOARD_INPUT] : [];\n\n\t\tconst requestFullscreen = element.msRequestFullscreen ||\n\t\t\telement.mozRequestFullScreen ||\n\t\t\telement.webkitRequestFullscreen ||\n\t\t\telement.requestFullscreen;\n\n\t\tif (requestFullscreen) {\n\t\t\trequestFullscreen.apply(element, requestArguments);\n\t\t}\n\t},\n\tcollapse(): void {\n\t\tif (cantFullscreen()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!isExpanded()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!gantt.callEvent(\"onBeforeCollapse\", [this.getFullscreenElement()])) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst requestExitFullscreen = (document as IDocument).msExitFullscreen ||\n\t\t\t(document as IDocument).mozCancelFullScreen ||\n\t\t\t(document as IDocument).webkitExitFullscreen ||\n\t\t\t(document as IDocument).exitFullscreen;\n\n\t\tif (requestExitFullscreen) {\n\t\t\trequestExitFullscreen.apply(document);\n\t\t}\n\t},\n\ttoggle(): void {\n\t\tif (cantFullscreen()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!isExpanded()) {\n\t\t\tthis.expand();\n\t\t} else {\n\t\t\tthis.collapse();\n\t\t}\n\n\t},\n\tgetFullscreenElement(): HTMLElement {\n\t\treturn gantt.$root;\n\t}\n};\n\ngantt.expand = function() {\n\tgantt.ext.fullscreen.expand();\n};\n\ngantt.collapse = function(){\n\tgantt.ext.fullscreen.collapse();\n};\n\ngantt.attachEvent(\"onGanttReady\", addDOMEvents);\n\n}","import eventable from \"../utils/eventable\";\nimport * as domHelpers from \"../core/ui/utils/dom_helpers\";\n\nimport keyboard_shortcuts from \"./keyboard_navigation/common/keyboard_shortcuts\";\nimport eventhandler from \"./keyboard_navigation/common/eventhandler\";\nimport trap_modal_focus from \"./keyboard_navigation/common/trap_modal_focus\";\nimport gantt_node from \"./keyboard_navigation/elements/gantt_node\";\nimport nav_node from \"./keyboard_navigation/elements/nav_node\";\nimport header_cell from \"./keyboard_navigation/elements/header_cell\";\nimport task_row from \"./keyboard_navigation/elements/task_row\";\nimport task_cell from \"./keyboard_navigation/elements/task_cell\";\nimport modals from \"./keyboard_navigation/modals\";\nimport core from \"./keyboard_navigation/core\";\n\n\n\nexport default function(gantt){\n\tfunction setupKeyNav(gantt){\n\t\tgantt.config.keyboard_navigation = true;\n\t\tgantt.config.keyboard_navigation_cells = false;\n\n\t\tgantt.$keyboardNavigation = {};\n\n\t\tgantt._compose = function(){\n\t\t\tvar parts = Array.prototype.slice.call(arguments, 0);\n\t\t\tvar res = {};\n\t\t\tfor(var i = 0; i < parts.length; i++){\n\t\t\t\tvar obj = parts[i];\n\t\t\t\tif(typeof obj == \"function\"){\n\t\t\t\t\tobj = new obj();\n\t\t\t\t}\n\n\t\t\t\tfor(var p in obj){\n\t\t\t\t\tres[p] = obj[p];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res;\n\t\t};\n\n\t\tkeyboard_shortcuts(gantt);\n\t\teventhandler(gantt);\n\t\ttrap_modal_focus(gantt);\n\t\tgantt_node(gantt);\n\t\tnav_node(gantt);\n\t\theader_cell(gantt);\n\t\ttask_row(gantt);\n\t\ttask_cell(gantt);\n\t\tmodals(gantt);\n\t\tcore(gantt);\n\n\n\t\t(function(){\n\t\t\tvar dispatcher = gantt.$keyboardNavigation.dispatcher;\n\n\t\t\tdispatcher.isTaskFocused = function(id){\n\t\t\t\tvar node = dispatcher.activeNode;\n\t\t\t\tif(node instanceof gantt.$keyboardNavigation.TaskRow || node instanceof gantt.$keyboardNavigation.TaskCell) {\n\t\t\t\t\tif (node.taskId == id) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tvar keyDownHandler = function(e){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\n\t\t\t\t// GS-734 & GS-1078: we don't need keyboard navigation inside inline editors\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells && isInlineEditorCell(e)) return;\n\n\t\t\t\tif (isNoKeyboardNavigationElement(e) || isLightboxElement(e)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treturn dispatcher.keyDownHandler(e);\n\t\t\t};\n\n\t\t\tvar focusHandler = function(e){\n\t\t\t\tif(dispatcher.$preventDefault){\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tgantt.$container.blur();\n\t\t\t\t\treturn false;\n\t\t\t\t// do nothing if key-nav focus is already planned\n\t\t\t\t} else if (!dispatcher.awaitsFocus()) {\n\t\t\t\t\t// otherwise - re-focus key-nav element on gantt focus\n\t\t\t\t\tdispatcher.focusGlobalNode();\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t\tvar reFocusActiveNode = function(){\n\t\t\t\tif(!dispatcher.isEnabled())\n\t\t\t\t\treturn;\n\n\t\t\t\tconst outsideGantt = !domHelpers.isChildOf(document.activeElement, gantt.$container) && document.activeElement.localName != \"body\";\n\t\t\t\tvar activeNode = dispatcher.getActiveNode();\n\t\t\t\tif(!activeNode || outsideGantt)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar domElement = activeNode.getNode();\n\t\t\t\tvar top, left;\n\t\t\t\tif(domElement && domElement.parentNode){\n\t\t\t\t\ttop = domElement.parentNode.scrollTop;\n\t\t\t\t\tleft = domElement.parentNode.scrollLeft;\n\n\t\t\t\t}\n\n\t\t\t\tactiveNode.focus(true);\n\n\t\t\t\tif(domElement && domElement.parentNode){\n\t\t\t\t\tdomElement.parentNode.scrollTop = top;\n\t\t\t\t\tdomElement.parentNode.scrollLeft = left;\n\t\t\t\t}\n\t\t\t};\n\n\n\t\t\tgantt.attachEvent(\"onDataRender\", function(){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\n\t\t\t\treFocusActiveNode();\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\n\t\t\t\t//GS-2230: in case if `getGanttInstance` created without container\n\t\t\t\tif(!gantt.$root) return;\n\t\t\t\tgantt.eventRemove(gantt.$root, \"keydown\", keyDownHandler);\n\t\t\t\tgantt.eventRemove(gantt.$container, \"focus\", focusHandler);\n\t\t\t\tgantt.eventRemove(gantt.$container, \"mousedown\", mousedownHandler);\n\n\t\t\t\tif(gantt.config.keyboard_navigation){\n\n\t\t\t\t\tgantt.event(gantt.$root, \"keydown\", keyDownHandler);\n\t\t\t\t\tgantt.event(gantt.$container, \"focus\", focusHandler);\n\t\t\t\t\tgantt.event(gantt.$container, \"mousedown\", mousedownHandler);\n\t\t\t\t\tgantt.$container.setAttribute(\"tabindex\", \"0\");\n\n\t\t\t\t}else{\n\t\t\t\t\tgantt.$container.removeAttribute(\"tabindex\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfunction getTaskNodeConstructor(){\n\t\t\t\tif (gantt.config.keyboard_navigation_cells) {\n\t\t\t\t\treturn gantt.$keyboardNavigation.TaskCell;\n\t\t\t\t} else {\n\t\t\t\t\treturn gantt.$keyboardNavigation.TaskRow;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction isInlineEditorCell(e){\n\t\t\t\treturn !!domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\");\n\t\t\t}\n\t\t\t// GS-1445. Cancel keyboard navigation within custom elements\n\t\t\tfunction isNoKeyboardNavigationElement(e){\n\t\t\t\treturn !!domHelpers.closest(e.target, \".no_keyboard_navigation\");\n\t\t\t}\n\t\t\tfunction isLightboxElement(e){\n\t\t\t\treturn !!domHelpers.closest(e.target, \".gantt_cal_light\");\n\t\t\t}\n\n\t\t\tfunction mousedownHandler(e){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\n\t\t\t\t// GS-734 & GS-1078: we don't need keyboard navigation inside inline editors\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells && isInlineEditorCell(e)) return true;\n\n\t\t\t\tif (isNoKeyboardNavigationElement(e)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar focusNode;\n\t\t\t\tvar locateTask = dispatcher.fromDomElement(e);\n\t\t\t\tif(locateTask){\n\t\t\t\t\t//var node = getTaskNodeConstructor();\n\t\t\t\t\tif(dispatcher.activeNode instanceof gantt.$keyboardNavigation.TaskCell && domHelpers.isChildOf(e.target, gantt.$task)){\n\t\t\t\t\t\tlocateTask = new gantt.$keyboardNavigation.TaskCell(locateTask.taskId, dispatcher.activeNode.columnIndex);\n\t\t\t\t\t}\n\t\t\t\t\tfocusNode = locateTask;\n\t\t\t\t\t// GS-1541 and GS-1542. If you click on the task row element (possible with custom styles)\n\t\t\t\t\t// or the task bar element, there is no information about the target grid cell,\n\t\t\t\t\t// so we need to set focus on the first visible cell\n\t\t\t\t\tconst visibleGrid = gantt.config.show_grid && gantt.$ui.getView(\"grid\");\n\t\t\t\t\tif(visibleGrid && gantt.config.keyboard_navigation_cells){\n\t\t\t\t\t\tconst taskRow = e.target.classList.contains(\"gantt_row\");\n\t\t\t\t\t\tconst taskBar = e.target.closest(\".gantt_task_line\");\n\n\t\t\t\t\t\tconst gridLeft = gantt.utils.dom.getNodePosition(gantt.$grid).x;\n\t\t\t\t\t\tconst gridRight = gridLeft + gantt.$grid.offsetWidth;\n\t\t\t\t\t\tconst nodePosition = gantt.utils.dom.getNodePosition(document.activeElement).x;\n\t\t\t\t\t\tconst nodeHidden = nodePosition < gridLeft || gridRight < nodePosition;\n\n\t\t\t\t\t\tif (taskRow || (taskBar && nodeHidden)){\n\t\t\t\t\t\t\tlet scrollPosition = gantt.$grid.scrollLeft;\n\t\t\t\t\t\t\tconst rightPosition = scrollPosition + gantt.$grid.offsetWidth;\n\t\t\t\t\t\t\tlet positionX = 0;\n\t\t\t\t\t\t\tif (taskRow){\n\t\t\t\t\t\t\t\tscrollPosition = gantt.utils.dom.getRelativeEventPosition(e, gantt.$grid).x;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (let i = 0; i < gantt.config.columns.length; i++) {\n\t\t\t\t\t\t\t\tconst column = gantt.config.columns[i];\n\t\t\t\t\t\t\t\tif (column.hide){\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpositionX += column.width;\n\t\t\t\t\t\t\t\tif (scrollPosition < positionX){\n\t\t\t\t\t\t\t\t\tif (rightPosition < positionX){\n\t\t\t\t\t\t\t\t\t\tpositionX -= column.width;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tfocusNode.columnIndex = i;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (focusNode) {\n\t\t\t\t\tif (!dispatcher.isEnabled()) {\n\t\t\t\t\t\tdispatcher.activeNode = focusNode;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdispatcher.delay(function () {\n\t\t\t\t\t\t\tdispatcher.setActiveNode(focusNode);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// empty click should drop focus from gantt, insert of reselecting default node\n\t\t\t\t\tdispatcher.$preventDefault = true;\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\tdispatcher.$preventDefault = false;\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar onReady = gantt.attachEvent(\"onGanttReady\", function(){\n\t\t\t\t// restore focus on repainted tasks\n\t\t\t\tgantt.detachEvent(onReady);\n\n\t\t\t\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(id){\n\t\t\t\t\tif (gantt.config.keyboard_navigation && dispatcher.isEnabled()) {\n\t\t\t\t\t\tconst currentNode = dispatcher.getActiveNode();\n\t\t\t\t\t\tconst grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tif (!grid || !grid.$grid_data){\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst top = grid.getItemTop(id);\n\t\t\t\t\t\tconst gridDataTopScroll = grid.$grid_data.scrollTop;\n\t\t\t\t\t\tconst gridDataBottomScroll = gridDataTopScroll + grid.$grid_data.getBoundingClientRect().height;\n\t\t\t\t\t\tif(currentNode && currentNode.taskId == id){\n\t\t\t\t\t\t\t// GS-2539: Don't refocus the node if it is selected and outside the visible range in the grid\n\t\t\t\t\t\t\tif(gridDataTopScroll <= top && gridDataBottomScroll >= top){\n\t\t\t\t\t\t\t\treFocusActiveNode();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(gantt._smart_render){\n\t\t\t\t\tvar updateRender = gantt._smart_render._redrawTasks;\n\t\t\t\t\tgantt._smart_render._redrawTasks = function(renderers, items){\n\t\t\t\t\t\tif(gantt.config.keyboard_navigation && dispatcher.isEnabled()){\n\t\t\t\t\t\t\tvar currentNode = dispatcher.getActiveNode();\n\t\t\t\t\t\t\tif(currentNode && currentNode.taskId !== undefined){\n\t\t\t\t\t\t\t\tvar focusedItemVisible = false;\n\t\t\t\t\t\t\t\tfor(var i = 0; i < items.length; i++){\n\t\t\t\t\t\t\t\t\tif(items[i].id == currentNode.taskId && items[i].start_date){\n\t\t\t\t\t\t\t\t\t\tfocusedItemVisible = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(!focusedItemVisible){\n\t\t\t\t\t\t\t\t\titems.push(gantt.getTask(currentNode.taskId));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar res = updateRender.apply(this, arguments);\n\n\t\t\t\t\t\treturn res;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t});\n\n\n\t\t\tlet createdTaskId = null;\n\t\t\tlet keepFocusOnNewTask = false;\n\t\t\tgantt.attachEvent(\"onTaskCreated\", function (task) {\n\t\t\t\tcreatedTaskId = task.id;\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", function(id,item){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\n\t\t\t\tif(dispatcher.isEnabled()){\n\n\t\t\t\t\t// GS-1394. After adding a new task, the focus shouldn't change to the placeholder task\n\t\t\t\t\tif (id == createdTaskId) {\n\t\t\t\t\t\tkeepFocusOnNewTask = true;\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tkeepFocusOnNewTask = false;\n\t\t\t\t\t\t\tcreatedTaskId = null;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (keepFocusOnNewTask && item.type == gantt.config.types.placeholder) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar columnIndex = 0;\n\t\t\t\t\tvar node = dispatcher.activeNode;\n\t\t\t\t\tif(node instanceof gantt.$keyboardNavigation.TaskCell){\n\t\t\t\t\t\tcolumnIndex = node.columnIndex;\n\t\t\t\t\t}\n\t\t\t\t\tvar nodeConstructor = getTaskNodeConstructor();\n\n\t\t\t\t\tif (item.type == gantt.config.types.placeholder && gantt.config.placeholder_task.focusOnCreate === false) {\n\t\t\t\t\t\t// do not focus on the placeholder task\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdispatcher.setActiveNode(new nodeConstructor(id, columnIndex));\n\t\t\t\t\t}\n\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function(oldId, newId){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\n\n\t\t\t\tvar node = dispatcher.activeNode;\n\t\t\t\tif(dispatcher.isTaskFocused(oldId)){\n\t\t\t\t\tnode.taskId = newId;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\tvar interval = setInterval(function(){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\n\t\t\t\tif(!dispatcher.isEnabled()){\n\t\t\t\t\tdispatcher.enable();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}, 500);\n\n\t\t\tgantt.attachEvent(\"onDestroy\", function(){\n\t\t\t\tclearInterval(interval);\n\t\t\t});\n\n\t\t\tfunction getScopeName(obj){\n\t\t\t\tif(obj instanceof gantt.$keyboardNavigation.GanttNode){\n\t\t\t\t\treturn \"gantt\";\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.HeaderCell){\n\t\t\t\t\treturn \"headerCell\";\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.TaskRow){\n\t\t\t\t\treturn \"taskRow\";\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.TaskCell){\n\t\t\t\t\treturn \"taskCell\";\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfunction getScope(mode){\n\t\t\t\tvar scopes = {\n\t\t\t\t\t\"gantt\":gantt.$keyboardNavigation.GanttNode,\n\t\t\t\t\t\"headerCell\": gantt.$keyboardNavigation.HeaderCell,\n\t\t\t\t\t\"taskRow\": gantt.$keyboardNavigation.TaskRow,\n\t\t\t\t\t\"taskCell\": gantt.$keyboardNavigation.TaskCell\n\t\t\t\t};\n\n\t\t\t\treturn scopes[mode] || scopes.gantt;\n\t\t\t}\n\n\t\t\tfunction findVisibleColumnIndex(columnName) {\n\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\tfor (var i = 0; i < columns.length; i++){\n\t\t\t\t\tif(columns[i].name == columnName){\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tvar keyNavFacade = {};\n\t\t\teventable(keyNavFacade);\n\t\t\tgantt.mixin(keyNavFacade, {\n\t\t\t\taddShortcut: function(shortcut, handler, scope){\n\t\t\t\t\tvar scopeObject = getScope(scope);\n\t\t\t\t\tif(scopeObject){\n\t\t\t\t\t\tscopeObject.prototype.bind(shortcut, handler);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetShortcutHandler: function(shortcut, scope){\n\t\t\t\t\tvar commands = gantt.$keyboardNavigation.shortcuts.parse(shortcut);\n\t\t\t\t\tif(commands.length){\n\t\t\t\t\t\treturn keyNavFacade.getCommandHandler(commands[0], scope);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetCommandHandler: function(command, scope){\n\t\t\t\t\tvar scopeObject = getScope(scope);\n\t\t\t\t\tif(scopeObject){\n\t\t\t\t\t\tif(command){\n\t\t\t\t\t\t\treturn scopeObject.prototype.findHandler(command);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoveShortcut: function(shortcut, scope){\n\t\t\t\t\tvar scopeObject = getScope(scope);\n\t\t\t\t\tif(scopeObject){\n\t\t\t\t\t\tscopeObject.prototype.unbind(shortcut);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfocus: function(config){\n\t\t\t\t\tvar type = config ? config.type : null;\n\t\t\t\t\tvar constructor = getScope(type);\n\t\t\t\t\tvar node;\n\t\t\t\t\tswitch (type){\n\t\t\t\t\t\tcase \"taskCell\":\n\t\t\t\t\t\t\tnode = new constructor(config.id, findVisibleColumnIndex(config.column));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"taskRow\":\n\t\t\t\t\t\t\tnode = new constructor(config.id);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"headerCell\":\n\t\t\t\t\t\t\tnode = new constructor(findVisibleColumnIndex(config.column));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tdispatcher.delay(function(){\n\t\t\t\t\t\tif(node){\n\t\t\t\t\t\t\tdispatcher.setActiveNode(node);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tdispatcher.enable();\n\t\t\t\t\t\t\tif(!dispatcher.getActiveNode()){\n\n\t\t\t\t\t\t\t\tdispatcher.setDefaultNode();\n\t\t\t\t\t\t\t}else{\n\n\t\t\t\t\t\t\t\tif(!dispatcher.awaitsFocus()){\n\t\t\t\t\t\t\t\t\tdispatcher.enable();\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tgetActiveNode: function(){\n\t\t\t\t\tif(dispatcher.isEnabled()){\n\t\t\t\t\t\tvar node = dispatcher.getActiveNode();\n\t\t\t\t\t\tvar scope = getScopeName(node);\n\t\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\t\tswitch (scope){\n\t\t\t\t\t\t\tcase \"taskCell\":\n\t\t\t\t\t\t\t\treturn {type:\"taskCell\", id:node.taskId, column:columns[node.columnIndex].name};\n\t\t\t\t\t\t\tcase \"taskRow\":\n\t\t\t\t\t\t\t\treturn {type:\"taskRow\", id:node.taskId};\n\t\t\t\t\t\t\tcase \"headerCell\":\n\t\t\t\t\t\t\t\treturn {type:\"headerCell\", column:columns[node.index].name};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tgantt.$keyboardNavigation.facade = keyNavFacade;\n\n\t\t\tgantt.ext.keyboardNavigation = keyNavFacade;\n\t\t\tgantt.focus = function(){\n\t\t\t\tkeyNavFacade.focus();\n\t\t\t};\n\t\t\tgantt.addShortcut = keyNavFacade.addShortcut;\n\t\t\tgantt.getShortcutHandler = keyNavFacade.getShortcutHandler;\n\t\t\tgantt.removeShortcut = keyNavFacade.removeShortcut;\n\t\t})();\n\n\n\t}\n\n\tsetupKeyNav(gantt);\n\n\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.shortcuts = {\n\t\tcreateCommand: function () {\n\t\t\treturn {\n\t\t\t\tmodifiers: {\n\t\t\t\t\t\"shift\": false,\n\t\t\t\t\t\"alt\": false,\n\t\t\t\t\t\"ctrl\": false,\n\t\t\t\t\t\"meta\": false\n\t\t\t\t},\n\t\t\t\tkeyCode: null\n\t\t\t};\n\t\t},\n\t\tparse: function (shortcut) {\n\t\t\tvar commands = [];\n\n\t\t\tvar expr = this.getExpressions(this.trim(shortcut));\n\t\t\tfor (var i = 0; i < expr.length; i++) {\n\t\t\t\tvar words = this.getWords(expr[i]);\n\n\t\t\t\tvar command = this.createCommand();\n\n\t\t\t\tfor (var j = 0; j < words.length; j++) {\n\t\t\t\t\tif (this.commandKeys[words[j]]) {\n\t\t\t\t\t\tcommand.modifiers[words[j]] = true;\n\t\t\t\t\t} else if (this.specialKeys[words[j]]) {\n\t\t\t\t\t\tcommand.keyCode = this.specialKeys[words[j]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcommand.keyCode = words[j].charCodeAt(0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcommands.push(command);\n\t\t\t}\n\t\t\treturn commands;\n\t\t},\n\n\t\tgetCommandFromEvent: function (domEvent) {\n\t\t\tvar command = this.createCommand();\n\t\t\tcommand.modifiers.shift = !!domEvent.shiftKey;\n\t\t\tcommand.modifiers.alt = !!domEvent.altKey;\n\t\t\tcommand.modifiers.ctrl = !!domEvent.ctrlKey;\n\t\t\tcommand.modifiers.meta = !!domEvent.metaKey;\n\t\t\tcommand.keyCode = domEvent.which || domEvent.keyCode;\n\n\t\t\tif(command.keyCode >= 96 && command.keyCode <= 105){\n\t\t\t\t// numpad keys 96-105 -> 48-57\n\t\t\t\tcommand.keyCode -= 48;//convert numpad  number code to regular number code\n\t\t\t}\n\n\t\t\tvar printableKey = String.fromCharCode(command.keyCode);\n\t\t\tif (printableKey) {\n\t\t\t\tcommand.keyCode = printableKey.toLowerCase().charCodeAt(0);\n\t\t\t}\n\t\t\treturn command;\n\t\t},\n\n\t\tgetHashFromEvent: function (domEvent) {\n\t\t\treturn this.getHash(this.getCommandFromEvent(domEvent));\n\t\t},\n\n\t\tgetHash: function (command) {\n\t\t\tvar parts = [];\n\t\t\tfor (var i in command.modifiers) {\n\t\t\t\tif (command.modifiers[i]) {\n\t\t\t\t\tparts.push(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\tparts.push(command.keyCode);\n\n\t\t\treturn parts.join(this.junctionChar);\n\t\t},\n\n\t\tgetExpressions: function (shortcut) {\n\t\t\treturn shortcut.split(this.junctionChar);\n\t\t},\n\t\tgetWords: function (term) {\n\t\t\treturn term.split(this.combinationChar);\n\t\t},\n\t\ttrim: function (shortcut) {\n\t\t\treturn shortcut.replace(/\\s/g, \"\");\n\t\t},\n\t\tjunctionChar: \",\",\n\t\tcombinationChar: \"+\",\n\t\tcommandKeys: {\n\t\t\t\"shift\": 16,\n\t\t\t\"alt\": 18,\n\t\t\t\"ctrl\": 17,\n\t\t\t\"meta\": true\n\t\t},\n\t\tspecialKeys: {\n\t\t\t\"backspace\": 8,\n\t\t\t\"tab\": 9,\n\t\t\t\"enter\": 13,\n\t\t\t\"esc\": 27,\n\t\t\t\"space\": 32,\n\t\t\t\"up\": 38,\n\t\t\t\"down\": 40,\n\t\t\t\"left\": 37,\n\t\t\t\"right\": 39,\n\t\t\t\"home\": 36,\n\t\t\t\"end\": 35,\n\t\t\t\"pageup\": 33,\n\t\t\t\"pagedown\": 34,\n\t\t\t\"delete\": 46,\n\t\t\t\"insert\": 45,\n\t\t\t\"plus\": 107,\n\t\t\t\"f1\": 112,\n\t\t\t\"f2\": 113,\n\t\t\t\"f3\": 114,\n\t\t\t\"f4\": 115,\n\t\t\t\"f5\": 116,\n\t\t\t\"f6\": 117,\n\t\t\t\"f7\": 118,\n\t\t\t\"f8\": 119,\n\t\t\t\"f9\": 120,\n\t\t\t\"f10\": 121,\n\t\t\t\"f11\": 122,\n\t\t\t\"f12\": 123\n\t\t}\n\t};\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.EventHandler = {\n\t\t_handlers: null,\n\t\tfindHandler: function (command) {\n\t\t\tif (!this._handlers) this._handlers = {};\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\n\t\t\tvar hash = shortcuts.getHash(command);\n\n\t\t\treturn this._handlers[hash];\n\t\t},\n\n\t\tdoAction: function (command, e) {\n\t\t\tvar handler = this.findHandler(command);\n\t\t\tif (handler) {\n\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\n\t\t\t\tif(eventFacade.callEvent(\"onBeforeAction\", [command, e]) === false){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thandler.call(this, e);\n\n\t\t\t\tif (e.preventDefault) e.preventDefault();\n\t\t\t\telse e.returnValue = false;\n\n\t\t\t}\n\t\t},\n\t\tbind: function (shortcut, handler) {\n\t\t\tif (!this._handlers) this._handlers = {};\n\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\n\n\t\t\tvar commands = shortcuts.parse(shortcut);\n\t\t\tfor (var i = 0; i < commands.length; i++) {\n\t\t\t\tthis._handlers[shortcuts.getHash(commands[i])] = handler;\n\t\t\t}\n\t\t},\n\t\tunbind: function (shortcut) {\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\n\n\t\t\tvar commands = shortcuts.parse(shortcut);\n\t\t\tfor (var i = 0; i < commands.length; i++) {\n\t\t\t\tif (this._handlers[shortcuts.getHash(commands[i])]) {\n\t\t\t\t\tdelete this._handlers[shortcuts.getHash(commands[i])];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tbindAll: function (map) {\n\t\t\tfor (var i in map) {\n\t\t\t\tthis.bind(i, map[i]);\n\t\t\t}\n\t\t},\n\t\tinitKeys: function () {\n\t\t\tif (!this._handlers)\n\t\t\t\tthis._handlers = {};\n\t\t\tif (this.keys) {\n\t\t\t\tthis.bindAll(this.keys);\n\t\t\t}\n\t\t}\n\t};\n\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\n\nexport default function(gantt) {\n\n\t(function () {\n\t\t\n\t\tgantt.$keyboardNavigation.getFocusableNodes = domHelpers.getFocusableNodes;\n\n\t\tgantt.$keyboardNavigation.trapFocus = function trapFocus(root, e) {\n\t\t\tif (e.keyCode != 9) return false;\n\n\t\t\tvar focusable = gantt.$keyboardNavigation.getFocusableNodes(root);\n\t\t\tvar currentFocus = domHelpers.getActiveElement();\n\t\t\tvar currentIndex = -1;\n\t\t\tfor (var i = 0; i < focusable.length; i++) {\n\t\t\t\tif (focusable[i] == currentFocus) {\n\t\t\t\t\tcurrentIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (e.shiftKey) {\n\t\t\t\t// back tab\n\t\t\t\tif (currentIndex <= 0) {\n\t\t\t\t\t// go to the last element if we focused on the first\n\t\t\t\t\tvar lastItem = focusable[focusable.length - 1];\n\t\t\t\t\tif (lastItem) {\n\t\t\t\t\t\tlastItem.focus();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\t// forward tab\n\t\t\t\tif (currentIndex >= focusable.length - 1) {\n\t\t\t\t\t// forward tab from last element should go back to the first element\n\t\t\t\t\tvar firstItem = focusable[0];\n\t\t\t\t\tif (firstItem) {\n\t\t\t\t\t\tfirstItem.focus();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\t})();\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.GanttNode = function () {\n\t};\n\n\tgantt.$keyboardNavigation.GanttNode.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.EventHandler,\n\t\t{\n\n\t\t\tfocus: function () {\n\t\t\t\tgantt.focus();\n\t\t\t},\n\n\t\t\tblur: function () {\n\n\t\t\t},\n\n\t\t\tisEnabled: function () {\n\t\t\t\treturn gantt.$container.hasAttribute(\"tabindex\");\n\t\t\t},\n\n\t\t\tscrollHorizontal: function scrollHorizontal(dir) {\n\t\t\t\tvar date = gantt.dateFromPos(gantt.getScrollState().x);\n\t\t\t\tvar scale = gantt.getScale();\n\t\t\t\tvar step = dir < 0 ? -scale.step : scale.step;\n\t\t\t\tdate = gantt.date.add(date, step, scale.unit);\n\t\t\t\tgantt.scrollTo(gantt.posFromDate(date));\n\t\t\t},\n\n\t\t\tscrollVertical: function scrollVertical(dir) {\n\t\t\t\tvar top = gantt.getScrollState().y;\n\t\t\t\tvar step = gantt.config.row_height;\n\t\t\t\tgantt.scrollTo(null, top + (dir < 0 ? -1 : 1) * step);\n\t\t\t},\n\n\t\t\tkeys: {\n\t\t\t\t\"alt+left\": function (e) {\n\t\t\t\t\tthis.scrollHorizontal(-1);\n\t\t\t\t},\n\t\t\t\t\"alt+right\": function (e) {\n\t\t\t\t\tthis.scrollHorizontal(1);\n\t\t\t\t},\n\t\t\t\t\"alt+up\": function (e) {\n\t\t\t\t\tthis.scrollVertical(-1);\n\t\t\t\t},\n\t\t\t\t\"alt+down\": function (e) {\n\t\t\t\t\tthis.scrollVertical(1);\n\t\t\t\t},\n\n\t\t\t\t// undo\n\t\t\t\t\"ctrl+z\": function () {\n\t\t\t\t\tif (gantt.undo) gantt.undo();\n\t\t\t\t},\n\n\t\t\t\t// redo\n\t\t\t\t\"ctrl+r\": function () {\n\t\t\t\t\tif (gantt.redo) gantt.redo();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\tgantt.$keyboardNavigation.GanttNode.prototype.bindAll(gantt.$keyboardNavigation.GanttNode.prototype.keys);\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.KeyNavNode = function () {\n\t};\n\n\tgantt.$keyboardNavigation.KeyNavNode.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.EventHandler,\n\t\t{\n\t\t\tisValid: function () {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tfallback: function () {\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tmoveTo: function (element) {\n\t\t\t\tgantt.$keyboardNavigation.dispatcher.setActiveNode(element);\n\t\t\t},\n\n\t\t\tcompareTo: function (b) {\n\t\t\t\t// good enough comparison of two random objects\n\t\t\t\tif (!b) return false;\n\t\t\t\tfor (var i in this) {\n\t\t\t\t\tif (!!this[i] != !!b[i]) return false;\n\n\t\t\t\t\tvar canStringifyThis = !!(this[i] && this[i].toString);\n\t\t\t\t\tvar canStringifyThat = !!(b[i] && b[i].toString);\n\t\t\t\t\tif (canStringifyThat != canStringifyThis) return false;\n\t\t\t\t\tif (!(canStringifyThat && canStringifyThis)) {\n\t\t\t\t\t\tif (b[i] != this[i]) return false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (b[i].toString() != this[i].toString())\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t},\n\t\t\tfocus: function () {\n\t\t\t\tvar node = this.getNode();\n\t\t\t\tif(!node)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\n\t\t\t\tif(eventFacade.callEvent(\"onBeforeFocus\", [node]) === false){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t\tif(!node.$eventAttached){\n\t\t\t\t\t\tnode.$eventAttached = true;\n\t\t\t\t\t\tgantt.event(node, \"focus\",function(e){\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}, false);\n\t\t\t\t\t}\n\t\t\t\t\t//node.className += \" gantt_focused\";\n\t\t\t\t\tif (gantt.utils.dom.isChildOf(document.activeElement, node)){\n\t\t\t\t\t\tnode = document.activeElement;\n\t\t\t\t\t}\n\t\t\t\t\tif (node.focus) node.focus();\n\n\t\t\t\t\teventFacade.callEvent(\"onFocus\", [this.getNode()]);\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tblur: function () {\n\t\t\t\tvar node = this.getNode();\n\t\t\t\tif (node) {\n\t\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\t\t\t\t\teventFacade.callEvent(\"onBlur\", [node]);\n\t\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t\t//node.className = (node.className || \"\").replace(/ ?gantt_focused/g, \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\n\nexport default function(gantt) {\n\n\tgantt.$keyboardNavigation.HeaderCell = function (index) {\n\t\tthis.index = index || 0;\n\t};\n\n\tgantt.$keyboardNavigation.HeaderCell.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.KeyNavNode,\n\t\t{\n\t\t\t_handlers: null,\n\n\t\t\tisValid: function () {\n\t\t\t\tif (!gantt.config.show_grid) {\n\t\t\t\t\tif (gantt.getVisibleTaskCount())\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn !!gantt.getGridColumns()[this.index] || !gantt.getVisibleTaskCount();\n\t\t\t},\n\t\t\tfallback: function () {\n\t\t\t\tif (!gantt.config.show_grid) {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow();\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tvar visibleColumns = gantt.getGridColumns();\n\t\t\t\tvar index = this.index;\n\t\t\t\twhile (index >= 0) {\n\t\t\t\t\tif (visibleColumns[index])\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\tif (visibleColumns[index]) {\n\t\t\t\t\treturn new gantt.$keyboardNavigation.HeaderCell(index);\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfromDomElement: function(el){\n\t\t\t\tvar cellElement = domHelpers.locateClassName(el, \"gantt_grid_head_cell\");\n\t\t\t\tif(cellElement){\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\twhile(cellElement && cellElement.previousSibling){\n\t\t\t\t\t\tcellElement = cellElement.previousSibling;\n\t\t\t\t\t\tindex += 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn new gantt.$keyboardNavigation.HeaderCell(index);\n\t\t\t\t}else{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t\tconst scale = gantt.$grid_scale;\n\t\t\t\tif (!scale){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tconst cells = scale.childNodes;\n\t\t\t\treturn cells[this.index];\n\t\t\t},\n\n\n\t\t\tkeys: {\n\n\t\t\t\t\"left\": function () {\n\t\t\t\t\tif (this.index > 0) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(this.index - 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"right\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tif (this.index < columns.length - 1) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(this.index + 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"down\": function () {\n\t\t\t\t\tvar taskRow;\n\t\t\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\n\t\t\t\t\tif (gantt.isTaskExists(rootLevel[0])) {\n\t\t\t\t\t\ttaskRow = rootLevel[0];\n\t\t\t\t\t}\n\t\t\t\t\tif (taskRow) {\n\t\t\t\t\t\tif (gantt.config.keyboard_navigation_cells) {\n\t\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(taskRow, this.index));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(taskRow));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t\"end\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(columns.length - 1));\n\t\t\t\t},\n\t\t\t\t\"home\": function () {\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(0));\n\t\t\t\t},\n\n\n\t\t\t\t// press header button\n\t\t\t\t\"enter, space\": function () {\n\t\t\t\t\tvar node = domHelpers.getActiveElement();\n\t\t\t\t\tnode.click();\n\t\t\t\t},\n\n\t\t\t\t// add new task\n\t\t\t\t\"ctrl+enter\": function () {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.createTask({}, this.taskId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\tgantt.$keyboardNavigation.HeaderCell.prototype.bindAll(gantt.$keyboardNavigation.HeaderCell.prototype.keys);\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.TaskRow = function (taskId) {\n\t\tif (!taskId) {\n\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\n\t\t\tif (rootLevel[0]) {\n\t\t\t\ttaskId = rootLevel[0];\n\t\t\t}\n\t\t}\n\t\tthis.taskId = taskId;\n\t\tif (gantt.isTaskExists(this.taskId)) {\n\t\t\tthis.index = gantt.getTaskIndex(this.taskId);\n\t\t\tthis.globalIndex = gantt.getGlobalTaskIndex(this.taskId);\n\t\t\tthis.splitItem = !!gantt.getTask(this.taskId).$split_subtask;\n\t\t\tthis.parentId = gantt.getParent(this.taskId);\n\t\t}\n\t};\n\n\tgantt.$keyboardNavigation.TaskRow.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.KeyNavNode,\n\t\t{\n\t\t\t_handlers: null,\n\t\t\tisValid: function () {\n\t\t\t\treturn gantt.isTaskExists(this.taskId) && (gantt.getTaskIndex(this.taskId) > -1);\n\t\t\t},\n\t\t\tfallback: function () {\n\t\t\t\tif (!gantt.getVisibleTaskCount()) {\n\t\t\t\t\tvar header = new gantt.$keyboardNavigation.HeaderCell();\n\t\t\t\t\tif (!header.isValid()) return null;\n\t\t\t\t\telse return header;\n\t\t\t\t} else {\n\n\t\t\t\t\tif(!this.splitItem){\n\t\t\t\t\t\tvar nextIndex = -1;\n\t\t\t\t\t\t// GS-1393. When Gantt tries to restore the focus, it should rely on the global index\n\t\t\t\t\t\tif (gantt.getTaskByIndex(this.globalIndex - 1)) {\n\t\t\t\t\t\t\tnextIndex = this.globalIndex - 1;\n\t\t\t\t\t\t} else if (gantt.getTaskByIndex(this.globalIndex + 1)) {\n\t\t\t\t\t\t\tnextIndex = this.globalIndex + 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar globalIndex = this.globalIndex;\n\t\t\t\t\t\t\twhile (globalIndex >= 0) {\n\t\t\t\t\t\t\t\tif (gantt.getTaskByIndex(globalIndex)) {\n\t\t\t\t\t\t\t\t\tnextIndex = globalIndex;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tglobalIndex--;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (nextIndex > -1) {\n\t\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(nextIndex).id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(this.parentId);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfromDomElement: function(el){\n\t\t\t\tif(gantt.config.keyboard_navigation_cells){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tvar taskId = gantt.locate(el);\n\t\t\t\tif(gantt.isTaskExists(taskId)){\n\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(taskId);\n\t\t\t\t}else{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t\tif (gantt.isTaskExists(this.taskId) && gantt.isTaskVisible(this.taskId)) {\n\t\t\t\t\tif (gantt.config.show_grid) {\n\t\t\t\t\t\treturn gantt.$grid.querySelector(`.gantt_row[${gantt.config.task_attribute}=\"${String(this.taskId).replaceAll('\"', '\\\\\"')}\"]`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn gantt.getTaskNode(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfocus: function (keptFocus) {\n\t\t\t\tif(!keptFocus) {\n\t\t\t\t\tconst pos = gantt.getTaskPosition(gantt.getTask(this.taskId));\n\t\t\t\t\tconst height = gantt.getTaskHeight(this.taskId);\n\t\t\t\t\tconst scroll = gantt.getScrollState();\n\n\t\t\t\t\tlet viewWidth;\n\t\t\t\t\tif(gantt.$task){\n\t\t\t\t\t\tviewWidth = gantt.$task.offsetWidth;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tviewWidth = scroll.inner_width;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet viewHeight;\n\t\t\t\t\tif(gantt.$grid_data || gantt.$task_data){\n\t\t\t\t\t\tviewHeight = (gantt.$grid_data || gantt.$task_data).offsetHeight;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tviewHeight = scroll.inner_height;\n\t\t\t\t\t}\n\t\t\t\t\tconst visibleTimeline = gantt.config.show_chart && gantt.$ui.getView(\"timeline\");\n\n\t\t\t\t\tif (pos.top < scroll.y || pos.top + height > (scroll.y + viewHeight)) {\n\t\t\t\t\t\t// GS-2346: additional scrolling to be sure that the task will be in the required range\n\t\t\t\t\t\tgantt.scrollTo(null, pos.top - 20);\n\t\t\t\t\t} else if (gantt.config.scroll_on_click && visibleTimeline) {\n\t\t\t\t\t\t// horizontal scroll activated\n\t\t\t\t\t\tif (pos.left > (scroll.x + viewWidth)) { // scroll forward to the start of the task\n\t\t\t\t\t\t\tgantt.scrollTo(pos.left - gantt.config.task_scroll_offset);\n\t\t\t\t\t\t} else if (pos.left + pos.width < scroll.x) {  // scroll back to the end of the task\n\t\t\t\t\t\t\tgantt.scrollTo(pos.left + pos.width - gantt.config.task_scroll_offset);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tgantt.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this, [keptFocus]);\n\n\t\t\t\t// GS-152 if there are scrollbars with custom names, change their scroll position\n\t\t\t\tscrollGrid();\n\n\t\t\t\tfunction scrollGrid() {\n\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\tif (!grid || !grid.$grid_data){\n\t\t\t\t\t\t// GS-1805. Don't try to focus the row that doesn't exist\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar scrollPositionX = parseInt(grid.$grid.scrollLeft);\n\t\t\t\t\tvar scrollPositionY = parseInt(grid.$grid_data.scrollTop);\n\n\t\t\t\t\tvar attachedScrollbarHorizontal = grid.$config.scrollX;\n\n\t\t\t\t\tif (attachedScrollbarHorizontal && grid.$config.scrollable) {\n\t\t\t\t\t\tvar scrollbarHorizontal = gantt.$ui.getView(attachedScrollbarHorizontal);\n\t\t\t\t\t\tif (scrollbarHorizontal) {\n\t\t\t\t\t\t\tscrollbarHorizontal.scrollTo(scrollPositionX, scrollPositionY);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar attachedScrollbarVertical = grid.$config.scrollY;\n\n\t\t\t\t\tif (attachedScrollbarVertical) {\n\t\t\t\t\t\tvar scrollbarVertical = gantt.$ui.getView(attachedScrollbarVertical);\n\t\t\t\t\t\tif (scrollbarVertical) {\n\t\t\t\t\t\t\tscrollbarVertical.scrollTo(scrollPositionX, scrollPositionY);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tkeys: {\n\t\t\t\t\"pagedown\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(gantt.getVisibleTaskCount() - 1).id));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"pageup\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(0).id));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"up\": function () {\n\t\t\t\t\tvar nextElement = null;\n\t\t\t\t\tvar prevTask = gantt.getPrev(this.taskId);\n\t\t\t\t\tif (!gantt.isTaskExists(prevTask)) {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.HeaderCell();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.TaskRow(prevTask);\n\t\t\t\t\t}\n\t\t\t\t\tthis.moveTo(nextElement);\n\t\t\t\t},\n\t\t\t\t\"down\": function () {\n\t\t\t\t\tvar nextTask = gantt.getNext(this.taskId);\n\t\t\t\t\tif (gantt.isTaskExists(nextTask)) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(nextTask));\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t\"shift+down\": function(){\n\t\t\t\t\tif(gantt.hasChild(this.taskId) && !gantt.getTask(this.taskId).$open){\n\t\t\t\t\t\tgantt.open(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"shift+up\": function(){\n\t\t\t\t\tif(gantt.hasChild(this.taskId) && gantt.getTask(this.taskId).$open){\n\t\t\t\t\t\tgantt.close(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"shift+right\": function() {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar prevId = gantt.getPrevSibling(this.taskId);\n\t\t\t\t\tif(gantt.isTaskExists(prevId) && !gantt.isChildOf(this.taskId, prevId)){\n\t\t\t\t\t\tvar parent = gantt.getTask(prevId);\n\t\t\t\t\t\tparent.$open = true;\n\t\t\t\t\t\tvar result = gantt.moveTask(this.taskId, -1, prevId);\n\t\t\t\t\t\tif(result !== false)\n\t\t\t\t\t\t\tgantt.updateTask(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"shift+left\": function() {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar parent = gantt.getParent(this.taskId);\n\t\t\t\t\tif(gantt.isTaskExists(parent)){\n\t\t\t\t\t\tvar result =  gantt.moveTask(this.taskId, gantt.getTaskIndex(parent) + 1, gantt.getParent(parent));\n\t\t\t\t\t\tif(result !== false)\n\t\t\t\t\t\t\tgantt.updateTask(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// select\n\t\t\t\t\"space\": function (e) {\n\t\t\t\t\tif (!gantt.isSelectedTask(this.taskId)) {\n\t\t\t\t\t\tgantt.selectTask(this.taskId);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgantt.unselectTask(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// collapse\n\t\t\t\t\"ctrl+left\": function (e) {\n\t\t\t\t\tgantt.close(this.taskId);\n\t\t\t\t},\n\t\t\t\t// expand\n\t\t\t\t\"ctrl+right\": function (e) {\n\t\t\t\t\tgantt.open(this.taskId);\n\t\t\t\t},\n\n\t\t\t\t// delete task\n\t\t\t\t\"delete\": function (e) {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.$click.buttons[\"delete\"](this.taskId);\n\t\t\t\t},\n\n\t\t\t\t// open lightbox\n\t\t\t\t\"enter\": function () {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.showLightbox(this.taskId);\n\t\t\t\t},\n\n\t\t\t\t// add subtask\n\t\t\t\t\"ctrl+enter\": function () {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.createTask({}, this.taskId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\tgantt.$keyboardNavigation.TaskRow.prototype.bindAll(gantt.$keyboardNavigation.TaskRow.prototype.keys);\n\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\nimport {replaceValidZeroId} from \"../../../utils/helpers\";\n\nexport default function(gantt) {\n\n\n\tgantt.$keyboardNavigation.TaskCell = function (taskId, index) {\n\t\ttaskId = replaceValidZeroId(taskId, gantt.config.root_id);\n\t\tif (!taskId) {\n\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\n\t\t\tif (rootLevel[0]) {\n\t\t\t\ttaskId = rootLevel[0];\n\t\t\t}\n\t\t}\n\t\tthis.taskId = taskId;\n\t\tthis.columnIndex = index || 0;\n\t\t// provided task may not exist, in this case node will be detectes as invalid\n\t\tif (gantt.isTaskExists(this.taskId)) {\n\t\t\tthis.index = gantt.getTaskIndex(this.taskId);\n\t\t\tthis.globalIndex = gantt.getGlobalTaskIndex(this.taskId);\n\t\t}\n\t};\n\n\tgantt.$keyboardNavigation.TaskCell.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.TaskRow,\n\t\t{\n\t\t\t_handlers: null,\n\t\t\tisValid: function () {\n\n\t\t\t\treturn gantt.$keyboardNavigation.TaskRow.prototype.isValid.call(this) && !!gantt.getGridColumns()[this.columnIndex];\n\t\t\t},\n\t\t\tfallback: function () {\n\n\t\t\t\tvar node = gantt.$keyboardNavigation.TaskRow.prototype.fallback.call(this);\n\t\t\t\tvar result = node;\n\t\t\t\tif (node instanceof gantt.$keyboardNavigation.TaskRow) {\n\t\t\t\t\tvar visibleColumns = gantt.getGridColumns();\n\t\t\t\t\tvar index = this.columnIndex;\n\t\t\t\t\twhile (index >= 0) {\n\t\t\t\t\t\tif (visibleColumns[index])\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tindex--;\n\t\t\t\t\t}\n\t\t\t\t\tif (visibleColumns[index]) {\n\t\t\t\t\t\tresult = new gantt.$keyboardNavigation.TaskCell(node.taskId, index);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t},\n\n\t\t\tfromDomElement: function(el){\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tvar taskId = gantt.locate(el);\n\t\t\t\tif(gantt.isTaskExists(taskId)){\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\tvar cellElement = domHelpers.locateAttribute(el, \"data-column-index\");\n\n\t\t\t\t\tif(cellElement){\n\t\t\t\t\t\tindex = cellElement.getAttribute(\"data-column-index\")*1;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskCell(taskId, index);\n\t\t\t\t}else{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t\tif (gantt.isTaskExists(this.taskId) && (gantt.isTaskVisible(this.taskId) || gantt.config.show_tasks_outside_timescale)) {\n\t\t\t\t\tif (gantt.config.show_grid && gantt.$grid) {\n\t\t\t\t\t\tvar row = gantt.$grid.querySelector(\".gantt_row[\" + gantt.config.task_attribute + \"='\" + this.taskId + \"']\");\n\t\t\t\t\t\tif(!row)\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\treturn row.querySelector(\"[data-column-index='\"+this.columnIndex+\"']\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn gantt.getTaskNode(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tkeys: {\n\t\t\t\t\"up\": function () {\n\n\t\t\t\t\tvar nextElement = null;\n\t\t\t\t\tvar prevTask = gantt.getPrev(this.taskId);\n\t\t\t\t\tif (!gantt.isTaskExists(prevTask)) {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.HeaderCell(this.columnIndex);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.TaskCell(prevTask, this.columnIndex);\n\t\t\t\t\t}\n\t\t\t\t\tthis.moveTo(nextElement);\n\t\t\t\t},\n\t\t\t\t\"down\": function () {\n\t\t\t\t\tvar nextTask = gantt.getNext(this.taskId);\n\t\t\t\t\tif (gantt.isTaskExists(nextTask)) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(nextTask, this.columnIndex));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"left\": function () {\n\t\t\t\t\tif (this.columnIndex > 0) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex - 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"right\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tif (this.columnIndex < columns.length - 1) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex + 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t\"end\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, columns.length - 1));\n\t\t\t\t},\n\t\t\t\t\"home\": function () {\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, 0));\n\t\t\t\t},\n\t\t\t\t\"pagedown\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(gantt.getTaskByIndex(gantt.getVisibleTaskCount() - 1).id, this.columnIndex));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"pageup\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(gantt.getTaskByIndex(0).id, this.columnIndex));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\n\tgantt.$keyboardNavigation.TaskCell.prototype.bindAll(gantt.$keyboardNavigation.TaskRow.prototype.keys);\n\tgantt.$keyboardNavigation.TaskCell.prototype.bindAll(gantt.$keyboardNavigation.TaskCell.prototype.keys);\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.dispatcher = {\n\t\tisActive: false,\n\t\tactiveNode: null,\n\t\tglobalNode: new gantt.$keyboardNavigation.GanttNode(),\n\n\t\tenable: function () {\n\t\t\tthis.isActive = true;\n\t\t\tthis.setActiveNode(this.getActiveNode());\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.isActive = false;\n\t\t},\n\n\t\tisEnabled: function () {\n\t\t\treturn !!this.isActive;\n\t\t},\n\n\t\tgetDefaultNode: function () {\n\t\t\tvar node;\n\t\t\tif (gantt.config.keyboard_navigation_cells) {\n\t\t\t\tnode = new gantt.$keyboardNavigation.TaskCell();\n\t\t\t} else {\n\t\t\t\tnode = new gantt.$keyboardNavigation.TaskRow();\n\t\t\t}\n\n\t\t\tif (!node.isValid()) {\n\t\t\t\tnode = node.fallback();\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\tsetDefaultNode: function () {\n\t\t\tthis.setActiveNode(this.getDefaultNode());\n\t\t},\n\n\t\tgetActiveNode: function () {\n\t\t\tvar node = this.activeNode;\n\t\t\tif (node && !node.isValid()) {\n\t\t\t\tnode = node.fallback();\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\tfromDomElement: function(e){\n\t\t\tvar inputs = [\n\t\t\t\tgantt.$keyboardNavigation.TaskRow,\n\t\t\t\tgantt.$keyboardNavigation.TaskCell,\n\t\t\t\tgantt.$keyboardNavigation.HeaderCell\n\t\t\t];\n\t\t\tfor(var i = 0; i < inputs.length; i++){\n\t\t\t\tif(inputs[i].prototype.fromDomElement){\n\t\t\t\t\tvar node = inputs[i].prototype.fromDomElement(e);\n\t\t\t\t\tif(node) return node;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tfocusGlobalNode: function () {\n\t\t\tthis.blurNode(this.globalNode);\n\t\t\tthis.focusNode(this.globalNode);\n\t\t},\n\n\t\tsetActiveNode: function (el) {\n\t\t\t//console.trace()\n\t\t\tvar focusChanged = true;\n\t\t\tif (this.activeNode) {\n\t\t\t\tif (this.activeNode.compareTo(el)) {\n\t\t\t\t\tfocusChanged = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.isEnabled()) {\n\t\t\t\tif(focusChanged)\n\t\t\t\t\tthis.blurNode(this.activeNode);\n\n\t\t\t\tthis.activeNode = el;\n\t\t\t\tthis.focusNode(this.activeNode, !focusChanged);\n\t\t\t}\n\t\t},\n\n\t\tfocusNode: function (el, keptFocus) {\n\t\t\tif (el && el.focus) {\n\t\t\t\tel.focus(keptFocus);\n\t\t\t}\n\t\t},\n\t\tblurNode: function (el) {\n\t\t\tif (el && el.blur) {\n\t\t\t\tel.blur();\n\t\t\t}\n\t\t},\n\n\t\tkeyDownHandler: function (e) {\n\n\t\t\tif (gantt.$keyboardNavigation.isModal())\n\t\t\t\treturn;\n\n\t\t\tif (!this.isEnabled())\n\t\t\t\treturn;\n\n\t\t\tif(e.defaultPrevented){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar ganttNode = this.globalNode;\n\n\t\t\tvar command = gantt.$keyboardNavigation.shortcuts.getCommandFromEvent(e);\n\n\t\t\tvar activeElement = this.getActiveNode();\n\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\t\t\tif(eventFacade.callEvent(\"onKeyDown\", [command, e]) === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!activeElement) {\n\t\t\t\tthis.setDefaultNode();\n\t\t\t} else if (activeElement.findHandler(command)) {\n\t\t\t\tactiveElement.doAction(command, e);\n\t\t\t} else if (ganttNode.findHandler(command)) {\n\t\t\t\tganttNode.doAction(command, e);\n\t\t\t}\n\n\t\t},\n\t\t_timeout: null,\n\t\tawaitsFocus: function(){\n\t\t\treturn this._timeout !== null;\n\t\t},\n\t\tdelay: function(callback, delay){\n\n\t\t\tclearTimeout(this._timeout);\n\t\t\tthis._timeout = setTimeout(gantt.bind(function(){\n\t\t\t\tthis._timeout = null;\n\t\t\t\tcallback();\n\t\t\t}, this)  , delay || 1);\n\n\t\t},\n\t\tclearDelay: function(){\n\t\t\tclearTimeout(this._timeout);\n\t\t}\n\t};\n\n};","import { QuickInfo } from \"./quickInfo\";\n\nexport default function(gantt: any){\n\nif (!gantt.ext) {\n\tgantt.ext = {};\n}\ngantt.ext.quickInfo = new QuickInfo(gantt);\n\ngantt.config.quickinfo_buttons = [\"icon_edit\", \"icon_delete\"];\ngantt.config.quick_info_detached = true;\ngantt.config.show_quick_info = true;\n\ngantt.templates.quick_info_title = function(start, end, ev){ return ev.text.substr(0,50); };\ngantt.templates.quick_info_content = function(start, end, ev){ return ev.details || ev.text; };\ngantt.templates.quick_info_date = function(start, end, ev){\n\treturn gantt.templates.task_time(start, end, ev);\n};\ngantt.templates.quick_info_class = function(start, end, task){ return \"\"; };\n\ngantt.attachEvent(\"onTaskClick\", function(id,e){\n\t// GS-1460 Don't show Quick Info when clicking on the \"+\" button\n\tif (!gantt.utils.dom.closest(e.target, \".gantt_add\")){\n\t\tsetTimeout(function() {\n\t\t\tgantt.ext.quickInfo.show(id);\n\t\t}, 0);\n\t}\n\n\treturn true;\n});\n\nconst events = [\"onViewChange\", \"onLightbox\", \"onBeforeTaskDelete\", \"onBeforeDrag\"];\nconst hidingFunction = function(){\n\tgantt.ext.quickInfo.hide();\n\treturn true;\n};\nfor (let i=0; i<events.length; i++){\n\tgantt.attachEvent(events[i], hidingFunction);\n}\n// GS-957: We don't want to hide QuickInfo when we click on it.\ngantt.attachEvent(\"onEmptyClick\", function(e){\n\tlet hideQuickInfo = true;\n\tconst parent = document.querySelector(\".gantt_cal_quick_info\");\n\tif (parent){\n\t\tconst quickInfoClick = gantt.utils.dom.isChildOf(e.target, parent);\n\t\tif (quickInfoClick){\n\t\t\thideQuickInfo = false;\n\t\t}\n\t}\n\tif (hideQuickInfo){\n\t\thidingFunction();\n\t}\n});\nfunction clearQuickInfo() {\n\tgantt.ext.quickInfo.hide();\n\tgantt.ext.quickInfo._quickInfoBox = null;\n\treturn true;\n}\ngantt.attachEvent(\"onGanttReady\", clearQuickInfo);\ngantt.attachEvent(\"onDestroy\", clearQuickInfo);\n\n// eslint-disable-next-line no-restricted-globals\ngantt.event(window, \"keydown\", function(e){\n\tif (e.keyCode === 27){\n\t\tgantt.ext.quickInfo.hide();\n\t}\n});\n\ngantt.showQuickInfo = function(){\n\tgantt.ext.quickInfo.show.apply(gantt.ext.quickInfo, arguments);\n};\ngantt.hideQuickInfo = function(){\n\tgantt.ext.quickInfo.hide.apply(gantt.ext.quickInfo, arguments);\n};\n\n}","import {TooltipManager} from \"./tooltipManager\";\n\nexport default function(gantt: any){\n\ngantt.config.tooltip_timeout = 30;\ngantt.config.tooltip_offset_y = 20;\ngantt.config.tooltip_offset_x = 10;\ngantt.config.tooltip_hide_timeout = 30;\n\n\n\nconst tooltipManager = new TooltipManager(gantt);\n\ngantt.ext.tooltips = tooltipManager;\n\ngantt.attachEvent(\"onGanttReady\", function(){\n\t//GS-2230: in case if `getGanttInstance` created without container\n\tif(!gantt.$root) return;\n\ttooltipManager.tooltipFor({\n\t\tselector: \"[\"+gantt.config.task_attribute+\"]:not(.gantt_task_row)\",\n\t\thtml: (event: MouseEvent) => {\n\t\t\tif (gantt.config.touch && !gantt.config.touch_tooltip) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst targetTaskId = gantt.locate(event);\n\t\t\tif(gantt.isTaskExists(targetTaskId)){\n\t\t\t\tconst task = gantt.getTask(targetTaskId);\n\t\t\t\treturn gantt.templates.tooltip_text(task.start_date, task.end_date, task);\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tglobal: false\n\t});\n});\n\ngantt.attachEvent(\"onDestroy\", function() {\n\ttooltipManager.destructor();\n});\n\ngantt.attachEvent(\"onLightbox\", function() {\n\ttooltipManager.hideTooltip();\n});\nconst isLinkCreate = () => {\n\tconst state = gantt.getState();\n\treturn !!state.link_source_id;\n};\ngantt.attachEvent(\"onBeforeTooltip\", function() {\n\tif (isLinkCreate()){\n\t\treturn false;\n\t}\n});\n\ngantt.attachEvent(\"onGanttScroll\", function(){\n\ttooltipManager.hideTooltip();\n});\n\n}","import { Monitor } from \"./monitor\";\nimport { IMonitor, IUndoCommand, TEntityType, TUndoStack } from \"./types\";\nimport { Undo } from \"./undo\";\n\nexport default function(gantt: any){\n\nconst _undo = new Undo(gantt);\nconst monitor: IMonitor = new Monitor(_undo, gantt);\n\ngantt.config.undo = true;\ngantt.config.redo = true;\n\n/**\n * entities that require different processing for undoing-redoing changes\n * @type {{link: string, task: string}}\n */\ngantt.config.undo_types = {\n\tlink: \"link\",\n\ttask: \"task\"\n};\n\n/**\n * types of traced actions\n * @type {{update: string, remove: string, add: string}}\n */\ngantt.config.undo_actions = {\n\tupdate: \"update\",\n\tremove: \"remove\", // remove item from datastore\n\tadd: \"add\",\n\tmove: \"move\" // move task in grid\n};\n\nif (!gantt.ext) {\n\tgantt.ext = {};\n}\n\ngantt.ext.undo = {\n\tundo: () => _undo.undo(),\n\tredo: () => _undo.redo(),\n\tgetUndoStack: () => _undo.getUndoStack(),\n\tsetUndoStack: (stack:[]) => _undo.setUndoStack(stack),\n\tgetRedoStack: () => _undo.getRedoStack(),\n\tsetRedoStack: (stack:[]) => _undo.setRedoStack(stack),\n\tclearUndoStack: () => _undo.clearUndoStack(),\n\tclearRedoStack: () => _undo.clearRedoStack(),\n\tsaveState: (id: TaskID | LinkID, type: TEntityType) => monitor.store(id, type, true),\n\tgetInitialState: (id: TaskID | LinkID, type: TEntityType) => {\n\t\tif(type === gantt.config.undo_types.link){\n\t\t\treturn monitor.getInitialLink(id);\n\t\t}else{\n\t\t\treturn monitor.getInitialTask(id);\n\t\t}\n\t}\n};\n\ngantt.undo = gantt.ext.undo.undo;\ngantt.redo = gantt.ext.undo.redo;\ngantt.getUndoStack = gantt.ext.undo.getUndoStack;\ngantt.getRedoStack = gantt.ext.undo.getRedoStack;\ngantt.clearUndoStack = gantt.ext.undo.clearUndoStack;\ngantt.clearRedoStack = gantt.ext.undo.clearRedoStack;\n\nfunction isEqualIds(first: TaskID, second: TaskID){\n\treturn String(first) === String(second);\n};\n\nfunction updTask(task: ITask, oldId: TaskID, newId: TaskID) {\n\tif (!task) { return; }\n\n\tif (isEqualIds(task.id, oldId)) {\n\t\ttask.id = newId;\n\t}\n\n\tif (isEqualIds(task.parent, oldId)) {\n\t\ttask.parent = newId;\n\t}\n}\n\nfunction changeTaskCommandId(command: IUndoCommand, oldId: TaskID, newId: TaskID) {\n\tupdTask(command.value, oldId, newId);\n\tupdTask(command.oldValue, oldId, newId);\n}\n\nfunction updLink(link: ILink, oldTaskId: TaskID, newTaskId: TaskID) {\n\tif (!link) { return; }\n\tif (isEqualIds(link.source, oldTaskId)) {\n\t\tlink.source = newTaskId;\n\t}\n\tif (isEqualIds(link.target, oldTaskId)) {\n\t\tlink.target = newTaskId;\n\t}\n}\n\nfunction changeLinkCommandId(command: IUndoCommand, oldId: LinkID, newId: LinkID) {\n\tupdLink(command.value, oldId, newId);\n\tupdLink(command.oldValue, oldId, newId);\n}\n\nfunction updateTasksIds(log: TUndoStack, oldId: TaskID, newId: TaskID) {\n\tconst undo = _undo;\n\n\tfor (let i = 0; i < log.length; i++) {\n\t\tconst entry = log[i];\n\t\tfor (let j = 0; j < entry.commands.length; j++) {\n\t\t\tif (entry.commands[j].entity === undo.command.entity.task) {\n\t\t\t\tchangeTaskCommandId(entry.commands[j], oldId, newId);\n\t\t\t} else if (entry.commands[j].entity === undo.command.entity.link) {\n\t\t\t\tchangeLinkCommandId(entry.commands[j], oldId, newId);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction updateLinksIds(log: TUndoStack, oldId: LinkID, newId: LinkID) {\n\tconst undo = _undo;\n\n\tfor (let i = 0; i < log.length; i++) {\n\t\tconst entry = log[i];\n\t\tfor (let j = 0; j < entry.commands.length; j++) {\n\t\t\tconst command = entry.commands[j];\n\t\t\tif (command.entity === undo.command.entity.link) {\n\t\t\t\tif (command.value && command.value.id === oldId) {\n\t\t\t\t\tcommand.value.id = newId;\n\t\t\t\t}\n\t\t\t\tif (command.oldValue && command.oldValue.id === oldId) {\n\t\t\t\t\tcommand.oldValue.id = newId;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\ngantt.attachEvent(\"onTaskIdChange\", (oldId: TaskID, newId: TaskID) => {\n\tconst undo = _undo;\n\tupdateTasksIds(undo.getUndoStack(), oldId, newId);\n\tupdateTasksIds(undo.getRedoStack(), oldId, newId);\n});\n\ngantt.attachEvent(\"onLinkIdChange\", (oldId: LinkID, newId: LinkID) => {\n\tconst undo = _undo;\n\tupdateLinksIds(undo.getUndoStack(), oldId, newId);\n\tupdateLinksIds(undo.getRedoStack(), oldId, newId);\n});\n\ngantt.attachEvent(\"onGanttReady\", () => {\n\t_undo.updateConfigs();\n});\n\n}","import * as helpers from \"../utils/helpers\";\n\nexport default function(gantt){\n\ngantt._groups = {\n\trelation_property: null,\n\trelation_id_property: '$group_id',\n\tgroup_id: null,\n\tgroup_text: null,\n\tloading: false,\n\tloaded: 0,\n\tdynamicGroups: false,\n\tset_relation_value: undefined,\n\t_searchCache: null,\n\tinit: function(gantt){\n\t\tvar self = this;\n\n\t\tgantt.attachEvent(\"onClear\", function(){\n\t\t\tself.clear();\n\t\t});\n\t\tself.clear();\n\n\t\tvar originalGetParent = gantt.$data.tasksStore.getParent; // gantt._get_parent_id;\n\t\tthis._searchCache = null;\n\t\tgantt.attachEvent(\"onBeforeTaskMove\", function(id, parent, tindex) {\n\t\t\t// GS-504: If we allow several owners/resources, the task should be moved to \n\t\t\t// a new position only if there is the function that handles that logic\n\t\t\tvar invalidParent = parent === this.config.root_id;\n\t\t\tvar noRelationValueFunction = this._groups.dynamicGroups && !(this._groups.set_relation_value instanceof Function);\n\n\t\t\tif (self.is_active() && (invalidParent || noRelationValueFunction)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar task = gantt.getTask(id);\n\t\t\t// to allow reordering from regular task to virtual task in the group mode\n\t\t\tif (this._groups.save_tree_structure && gantt.isTaskExists(task.parent) && gantt.isTaskExists(parent)) {\n\t\t\t\tvar oldParentTask = gantt.getTask(task.parent);\n\t\t\t\tvar newParentTask = gantt.getTask(parent);\n\t\t\t\tif (newParentTask.$virtual && gantt.isChildOf(oldParentTask.id, newParentTask.id)) {\n\t\t\t\t\ttask.parent = gantt.config.root_id;\n\t\t\t\t}\n\t\t\t\t// avoid cyclic tree:\n\t\t\t\tlet cyclicTree = false;\n\t\t\t\tlet parentTask = newParentTask;\n\t\t\t\twhile (parentTask) {\n\t\t\t\t\tif (id == parentTask.parent) {\n\t\t\t\t\t\tcyclicTree = true;\n\t\t\t\t\t}\n\t\t\t\t\tif (gantt.isTaskExists(parentTask.parent)) {\n\t\t\t\t\t\tparentTask = gantt.getTask(parentTask.parent);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparentTask = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cyclicTree) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\t// restore initial parent if the task is moved to a different group on the root level\n\t\tgantt.attachEvent(\"onRowDragStart\", function (id, target) {\n\t\t\tvar task = gantt.getTask(id);\n\t\t\tif (this._groups.save_tree_structure && gantt.isTaskExists(task.parent) && gantt.config.order_branch && gantt.config.order_branch != \"marker\") {\n\t\t\t\ttask.$initial_parent = task.parent;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onRowDragEnd\", function (id, target) {\n\t\t\tif (gantt.config.order_branch && gantt.config.order_branch != \"marker\") {\n\t\t\t\tvar task = gantt.getTask(id);\n\t\t\t\tif (task.$initial_parent) {\n\t\t\t\t\tif (task.parent == gantt.config.root_id) {\n\t\t\t\t\t\tvar renderedParent = gantt.getTask(task.$rendered_parent);\n\t\t\t\t\t\tvar initialParent = gantt.getTask(task.$initial_parent);\n\t\t\t\t\t\tvar restoreParent = false;\n\t\t\t\t\t\tif (this._groups.dynamicGroups && renderedParent[this._groups.group_id] != initialParent[this._groups.group_id]) {\n\t\t\t\t\t\t\trestoreParent = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!this._groups.dynamicGroups && renderedParent[this._groups.group_id] != initialParent[this._groups.relation_property]) {\n\t\t\t\t\t\t\trestoreParent = true;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (restoreParent) {\n\t\t\t\t\t\t\ttask.parent = task.$initial_parent;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdelete task.$initial_parent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tgantt.$data.tasksStore._listenerToDrop = gantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", gantt.bind(_initBeforeDataRender, gantt));\n\n\t\tgantt.$data.tasksStore.getParent = function(task) {\n\t\t\tif (self.is_active()) {\n\t\t\t\treturn self.get_parent(gantt, task);\n\t\t\t} else {\n\t\t\t\treturn originalGetParent.apply(this, arguments);\n\t\t\t}\n\t\t};\n\n\t\tvar originalSetParent = gantt.$data.tasksStore.setParent;\n\n\t\tgantt.$data.tasksStore.setParent = function(task, new_pid) {\n\t\t\tif (!self.is_active()) {\n\t\t\t\treturn originalSetParent.apply(this, arguments);\n\t\t\t} else if (self.set_relation_value instanceof Function && gantt.isTaskExists(new_pid)) {\n\t\t\t\tvar parent = gantt.getTask(new_pid);\n\t\t\t\tvar groupIds = parent[self.relation_id_property];\n\t\t\t\tif (!parent.$virtual) {\n\t\t\t\t\tvar groupId = _getGroupId(parent, self.relation_property);\n\t\t\t\t\tif (!self._searchCache) {\n\t\t\t\t\t\tself._buildCache();\n\t\t\t\t\t}\n\t\t\t\t\tvar virtualParentId = self._searchCache[groupId];\n\t\t\t\t\tvar virtualParent = gantt.getTask(virtualParentId);\n\t\t\t\t\tgroupIds = virtualParent[self.relation_id_property];\n\t\t\t\t}\n\t\t\t\tif (task[self.group_id] === undefined) {\n\t\t\t\t\t// to avoid nulling of relation_property if the group is not set\n\t\t\t\t\ttask[self.group_id] = groupIds;\n\t\t\t\t}\n\n\t\t\t\tif (self.save_tree_structure && task[self.group_id] != groupIds) {\n\t\t\t\t\ttask[self.group_id] = groupIds;\n\t\t\t\t}\n\n\t\t\t\tif (groupIds){\n\t\t\t\t\tif (typeof groupIds == \"string\"){\n\t\t\t\t\t\tgroupIds = groupIds.split(\",\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgroupIds = [groupIds];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// GS-504: This is a way to save the relation_property and customize the logic\n\t\t\t\ttask[self.relation_property] = self.set_relation_value(groupIds, task.id, task[self.relation_property]) || groupIds;\n\n\t\t\t} else if (gantt.isTaskExists(new_pid)) {\n\t\t\t\tvar parent = gantt.getTask(new_pid);\n\n\t\t\t\tif (!self.dynamicGroups) {\n\t\t\t\t\tif (parent.$virtual) {\n\t\t\t\t\t\ttask[self.relation_property] = parent[self.relation_id_property];\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttask[self.relation_property] = parent[self.relation_property];\n\t\t\t\t\t}\n\t\t\t\t\t// task[self.group_id] = parent[self.group_id] || task[self.group_id];\n\t\t\t\t}\n\n\t\t\t\tthis._setParentInner.apply(this, arguments);\n\t\t\t} else if(self.dynamicGroups) {\n\t\t\t\tif (task[self.group_id] === undefined || (!task.$virtual && task[self.relation_property][0] === [][0])) {\n\t\t\t\t\tif(task[self.relation_property] !== self.group_id){\n\t\t\t\t\t\t// GS:2547 dynamically added tasks could have relation_property\n\t\t\t\t\t\ttask[self.relation_property] = task[self.relation_property] || 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// GS-1332 the tasks without the group should be moved to the default group:\n\t\t\t\t\t\ttask[self.relation_property] = 0;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t\t// GS-1449. Update the parent when it was changed in the group mode\n\t\t\tif (gantt.isTaskExists(new_pid)) {\n\t\t\t\ttask.$rendered_parent = new_pid;\n\t\t\t\tif (!gantt.getTask(new_pid).$virtual) {\n\t\t\t\t\treturn originalSetParent.apply(this, arguments) || new_pid;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tgantt.attachEvent(\"onBeforeTaskDisplay\", function(id, task){\n\t\t\tif(self.is_active()){\n\t\t\t\tif(task.type == gantt.config.types.project && !task.$virtual)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onBeforeParse\", function(){\n\t\t\tself.loading = true;\n\t\t\tself._clearCache();\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskLoading\", function(){\n\t\t\tif(self.is_active()){\n\t\t\t\tself.loaded--;\n\t\t\t\tif(self.loaded <= 0){\n\t\t\t\t\tself.loading = false;\n\t\t\t\t\tself._clearCache();\n\t\t\t\t\tgantt.eachTask(gantt.bind(function(t){\n\t\t\t\t\t\tthis.get_parent(gantt, t);\n\t\t\t\t\t}, self));\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\n\t\t});\n\t\tgantt.attachEvent(\"onParse\", function(){\n\t\t\tself.loading = false;\n\t\t\tself.loaded = 0;\n\t\t});\n\t},\n\n\t_clearCache: function(){\n\t\tthis._searchCache = null;\n\t},\n\t_buildCache: function(){\n\t\tthis._searchCache = {};\n\t\tvar items = gantt.$data.tasksStore.getItems();\n\t\tfor(var i = 0; i < items.length; i++){\n\t\t\tthis._searchCache[items[i][this.relation_id_property]] = items[i].id;\n\t\t}\n\n\t},\n\tget_parent: function(gantt, task, tasks) {\n\t\tif (task.id === undefined) {\n\t\t\ttask = gantt.getTask(task);\n\t\t}\n\n\t\tvar group_id = _getGroupId(task, this.relation_property);\n\n\t\tif (this.save_tree_structure && gantt.isTaskExists(task.parent)) {\n\t\t\tlet parentTask = gantt.getTask(task.parent);\n\n\t\t\tconst parent_group_id = _getGroupId(parentTask, this.relation_property);\n\n\t\t\tif (parentTask.type != \"project\" && group_id == parent_group_id) {\n\t\t\t\treturn task.parent;\n\t\t\t}\n\t\t}\n\n\t\tif (this._groups_pull[group_id] === task.id){\n\t\t\treturn gantt.config.root_id;\n\t\t}\n\t\tif (this._groups_pull[group_id] !== undefined) {\n\t\t\treturn this._groups_pull[group_id];\n\t\t}\n\n\t\tvar parent_id = gantt.config.root_id;\n\n\t\tif (!this.loading && group_id !== undefined) {\n\n\t\t\tif(!this._searchCache){\n\t\t\t\tthis._buildCache();\n\t\t\t}\n\t\t\tvar parent = this._searchCache[group_id];\n\t\t\tif(gantt.isTaskExists(parent) && parent != task.id){\n\t\t\t\tparent_id = this._searchCache[group_id];\n\t\t\t}\n\n\t\t\tthis._groups_pull[group_id] = parent_id;\n\t\t}\n\n\t\treturn parent_id;\n\t},\n\n\tclear: function(){\n\t\tthis._groups_pull = {};\n\t\tthis.relation_property = null;\n\t\tthis.group_id = null;\n\t\tthis.group_text = null;\n\t\tthis._clearCache();\n\t},\n\tis_active: function(){\n\t\treturn !!(this.relation_property);\n\t},\n\tgenerate_sections: function(list, groups_type){\n\t\tvar groups = [];\n\t\tfor(var i = 0; i < list.length; i++){\n\t\t\tvar group = gantt.copy(list[i]);\n\t\t\tgroup.type = groups_type;\n\t\t\tif(group.open === undefined){\n\t\t\t\tgroup.open = true;\n\t\t\t}\n\t\t\tgroup.$virtual = true;\n\t\t\tgroup.readonly = true;\n\t\t\tgroup[this.relation_id_property] = group[this.group_id];\n\t\t\tgroup.text = group[this.group_text];\n\t\t\tgroups.push(group);\n\t\t}\n\t\treturn groups;\n\n\t},\n\tclear_temp_tasks: function(tasks){\n\t\tfor(var i =0; i < tasks.length; i++){\n\t\t\tif(tasks[i].$virtual){\n\t\t\t\ttasks.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t},\n\n\tgenerate_data: function(gantt, groups){\n\t\tvar links = gantt.getLinks();\n\t\tvar tasks = gantt.getTaskByTime();\n\n\t\tthis.clear_temp_tasks(tasks);\n\n\t\ttasks.forEach(function(task){\n\t\t\ttask.$calculate_duration = false;// no need to recalculate durations of tasks after group by\n\t\t});\n\n\t\tvar categories = [];\n\t\tif(this.is_active() && groups && groups.length){\n\t\t\tcategories = this.generate_sections(groups, gantt.config.types.project);\n\t\t}\n\n\t\tvar data = {links: links};\n\t\tdata.data = categories.concat(tasks);\n\n\t\treturn data;\n\t},\n\tupdate_settings: function(relation, group_id, group_text){\n\t\tthis.clear();\n\t\tthis.relation_property = relation;\n\t\tthis.group_id = group_id;\n\t\tthis.group_text = group_text;\n\t},\n\tgroup_tasks: function (gantt, groups_array, relation_property, group_id, group_text){\n\t\tthis.update_settings(relation_property, group_id, group_text);\n\t\tvar data = this.generate_data(gantt, groups_array);\n\t\tthis.loaded = data.data.length;\n\n\t\t// save task selection before grouping tasks\n\t\t// We need to iterate selected tasks with the \"isSelectedTask\" method\n\t\t// because it will work with and without the multiselect extension\n\t\tvar selectedTasks = [];\n\t\tgantt.eachTask(function(task){\n\t\t\tif (gantt.isSelectedTask(task.id)){\n\t\t\t\tselectedTasks.push(task.id);\n\t\t\t}\n\t\t});\n\n\t\tgantt._clear_data();\n\t\tvar schedulingOnParse = gantt.config.auto_scheduling_initial;\n\t\tgantt.config.auto_scheduling_initial = false;\n\t\tgantt.parse(data);\n\n\t\t// restore task selection after grouping tasks\n\t\tselectedTasks.forEach(function(taskId){\n\t\t\tif (gantt.isTaskExists(taskId)){\n\t\t\t\tgantt.selectTask(taskId);\n\t\t\t}\n\t\t});\n\n\t\tgantt.config.auto_scheduling_initial = schedulingOnParse;\n\t}\n};\n\ngantt._groups.init(gantt);\n\nfunction setRelationValueForAssignmentsArray(newGroupValues, id, oldRelationProperty) {\n\tif (!newGroupValues) {\n\t\treturn 0;\n\t}\n\n\tif (Array.isArray(oldRelationProperty) && !oldRelationProperty[0]) {\n\t\treturn 0;\n\t}\n\n\tif (newGroupValues && !Array.isArray(oldRelationProperty)) {\n\t\tconst resources = [];\n\t\tnewGroupValues.map(function(id){\n\t\t\tresources.push({ resource_id: id, value: 8 });\n\t\t});\n\t\treturn resources;\n\t}\n\tif (!oldRelationProperty[0].resource_id) {\n\t\toldRelationProperty = [{ resource_id: oldRelationProperty, value: 8 }];\n\t}\n\n\tif (typeof newGroupValues == \"string\") {\n\t\tnewGroupValues = newGroupValues.split(',');\n\t}\n\n\tif (newGroupValues.length == 1) {\n\t\toldRelationProperty[0].resource_id = newGroupValues[0];\n\t\treturn [oldRelationProperty[0]];\n\t}\n\n\tconst newRelationProperty = [];\n\t// GS-2493: need to take into account that task could have assigments on different dates\n\t// with the same resource\n\tif (newGroupValues.length > 1) {\n\t\tnewGroupValues = [...new Set(newGroupValues)]; // need to remove repeated ids if they exist\n\t}\n\t\n\tfor (let i = 0; i < newGroupValues.length; i++) {\n\t\tlet new_value = newGroupValues[i];\n\t\tlet arrOfResourceIds = oldRelationProperty.map(function (e) { return e.resource_id; });\n\t\t// need to get the positions of the resources\n\t\tlet pos = arrOfResourceIds.reduce(function(resourceAssignmentIndexes, resourceId, index) {\n\t\t\tif (resourceId === new_value)\n\t\t\t\tresourceAssignmentIndexes.push(index);\n\t\t\treturn resourceAssignmentIndexes;\n\t\t}, []);\n\t\t\n\t\tif (pos.length > 0) {\n\t\t\tpos.forEach((assignmentIndex) => {\n\t\t\t\toldRelationProperty[assignmentIndex].resource_id = new_value;\n\t\t\t\tnewRelationProperty.push(oldRelationProperty[assignmentIndex]);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tlet copy = gantt.copy(oldRelationProperty[0]);\n\t\t\tcopy.resource_id = new_value;\n\t\t\tnewRelationProperty.push(copy);\n\t\t}\n\t}\n\treturn newRelationProperty;\n}\n\nfunction setRelationValueForPrimitivesArray(newGroupValues, id, oldRelationProperty) {\n\treturn newGroupValues;\n}\n\nfunction inspectRelationProperty(tasks, relationProperty){\n\tvar resourceAssignments = false;\n\tvar arrays = false;\n\tfor(var i = 0; i < tasks.length; i++){\n\t\tvar value = tasks[i][relationProperty];\n\t\tif(Array.isArray(value)){\n\t\t\tarrays = true;\n\t\t\tif(value.length) {\n\t\t\t\tif(value[0].resource_id !== undefined){\n\t\t\t\t\tresourceAssignments = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\thaveArrays: arrays,\n\t\thaveResourceAssignments: resourceAssignments\n\t};\n}\n\nfunction selectRelationFunction(relationInfo){\n\tif(relationInfo.haveResourceAssignments){\n\t\treturn setRelationValueForAssignmentsArray;\n\t}else if(relationInfo.haveArrays){\n\t\treturn setRelationValueForPrimitivesArray;\n\t}\n\treturn null;\n}\n\ngantt.groupBy = function(config) {\n\tvar _this = this;\n\tvar tasks = gantt.getTaskByTime();\n\n\tthis._groups.set_relation_value = config.set_relation_value;\n\tthis._groups.dynamicGroups = false;\n\tthis._groups.save_tree_structure = config.save_tree_structure;\n\n\tvar relationInfo = inspectRelationProperty(tasks, config.relation_property);\n\n\tif(relationInfo.haveArrays){\n\t\tthis._groups.dynamicGroups = true;\n\t}\n\n\tif(!this._groups.set_relation_value) {\n\t\tthis._groups.set_relation_value = selectRelationFunction(relationInfo);\n\t}\n\n\tconfig = config || {};\n\tconfig.default_group_label = config.default_group_label || this.locale.labels.default_group || \"None\";\n\n\tvar relation_property = config.relation_property || null;\n\tvar group_id = config.group_id || \"key\";\n\tvar group_text = config.group_text || \"label\";\n\n\tthis._groups.regroup = function() {\n\t\tvar tasks = gantt.getTaskByTime();\n\t\tvar groupOpenCloseState = {};\n\t\tvar restoreOpenCloseState = false;\n\t\ttasks.forEach(function(task){\n\t\t\tif(task.$virtual && task.$open !== undefined){\n\t\t\t\tgroupOpenCloseState[task[group_id]] = task.$open;\n\t\t\t\trestoreOpenCloseState = true;\n\t\t\t}\n\t\t});\n\t\tvar groups = _initGroups(config, tasks, gantt);\n\t\tif(groups && restoreOpenCloseState){\n\t\t\tgroups.forEach(function(group){\n\t\t\t\tif(groupOpenCloseState[group[group_id]] !== undefined){\n\t\t\t\t\tgroup.open = groupOpenCloseState[group[group_id]];\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t_this._groups.group_tasks(_this, groups, relation_property, group_id, group_text);\n\t\treturn true;\n\t};\n\tthis._groups.regroup();\n};\n\nfunction _initGroups(config, tasks, gantt) {\n\tvar groups;\n\tif (config.groups) {\n\t\tif (gantt._groups.dynamicGroups) {\n\t\t\tgroups = _getGroupForMultiItems(tasks, config);\n\t\t} else {\n\t\t\tgroups = config.groups;\n\t\t}\n\n\t} else {\n\t\tgroups = null;\n\t}\n\treturn groups;\n}\n\nfunction _getResourcesIds(resources){\n\treturn resources.map(_getEntryId).sort().join(\",\");\n}\n\nfunction _getEntryId(entry){\n\tif(entry && typeof entry == \"object\"){\n\t\treturn String(entry.resource_id);\n\t}else{\n\t\treturn String(entry);\n\t}\n}\n\nfunction _getGroupId(task, relationProperty) {\n\tvar group_id;\n\tif (task[relationProperty] instanceof Array) {\n\t\t// GS-1332 We want to assign tasks with the empty relationProperty to a default group\n\t\tif (!task[relationProperty].length) {\n\t\t\tgroup_id = 0;\n\t\t}\n\t\telse {\n\t\t\tgroup_id = _getResourcesIds(task[relationProperty]);\n\t\t}\n\t} else {\n\t\tgroup_id = task[relationProperty];\n\t}\n\treturn group_id;\n}\n\nfunction _getGroupForMultiItems(tasks, config) {\n\tvar resultObj = {};\n\tvar result = [];\n\tvar itemsByKey = {};\n\tvar property = config.relation_property;\n\tvar delimiter = config.delimiter || \",\";\n\n\tvar hasDefaultGroup = false;\n\tvar defaultGroupId = 0;\n\n\thelpers.forEach(config.groups, function(entry) {\n\t\tif(entry.default){\n\t\t\thasDefaultGroup = true;\n\t\t\tdefaultGroupId = entry.group_id;\n\t\t}\n\t\titemsByKey[entry.key || entry[config.group_id]] = entry;\n\t});\n\n\tfor (var i=0; i < tasks.length; i++) {\n\t\tvar key;\n\t\tvar label;\n\t\tvar task = tasks[i];\n\t\tvar taskGroupValue = task[property];\n\n\t\tif (helpers.isArray(taskGroupValue)) {\n\t\t\tif(taskGroupValue.length > 0) {\n\t\t\t\tkey = _getResourcesIds(taskGroupValue);\n\t\t\t\tlabel = taskGroupValue.map(function(entry, index) {\n\t\t\t\t\tvar key;\n\t\t\t\t\tif (entry && typeof entry == \"object\") {\n\t\t\t\t\t\tkey = entry.resource_id;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tkey = entry;\n\t\t\t\t\t}\n\t\t\t\t\tentry = itemsByKey[key];\n\t\t\t\t\treturn entry.label || entry.text;\n\t\t\t\t}).sort();\n\t\t\t\t// GS-2493: need to take into account that task could have assigments on different dates\n\t\t\t\t// with the same resource\n\t\t\t\tlabel = [...new Set(label)].join(delimiter);\n\t\t\t} else {\n\t\t\t\tif(hasDefaultGroup)\n\t\t\t\t\tcontinue;\n\t\t\t\tkey = 0;\n\t\t\t\tlabel = config.default_group_label;\n\t\t\t}\n\t\t} else if (taskGroupValue) {\n\t\t\tkey = taskGroupValue;\n\t\t\tlabel = itemsByKey[key].label || itemsByKey[key].text;\n\t\t} else {\n\t\t\tif(hasDefaultGroup)\n\t\t\t\tcontinue;\n\t\t\tkey = 0;\n\t\t\tlabel = config.default_group_label;\n\t\t}\n\t\tif (key === undefined || resultObj[key] !== undefined) {\n\t\t\tcontinue;\n\t\t}\n\t\tresultObj[key] = { key: key, label: label };\n\t\tif(key === defaultGroupId){\n\t\t\tresultObj[key].default = true;\n\t\t}\n\t\tresultObj[key][config.group_text] = label;\n\t\tresultObj[key][config.group_id] = key;\n\t}\n\tresult = helpers.hashToArray(resultObj);\n\tresult.forEach(function(group){\n\t\tif(group.key == defaultGroupId){\n\t\t\tgroup.default = true;\n\t\t}\n\t});\n\treturn result;\n}\n\nvar state = gantt.$services.getService(\"state\");\nstate.registerProvider(\"groupBy\", function () {\n\treturn {\n\t\tgroup_mode: gantt._groups.is_active() ? gantt._groups.relation_property : null\n\t};\n});\n\nfunction _initBeforeDataRender() {\n\tvar _this = this;\n\tif (this.$data.tasksStore._listenerToDrop) {\n\t\tthis.$data.tasksStore.detachEvent(this.$data.tasksStore._listenerToDrop);\n\t}\n\n\t// updateTask can be called many times from batchUpdate or autoSchedule,\n\t// add a delay in order to perform grouping only once when everything is done\n\tvar delayedFunction = helpers.delay(function() {\n\t\tif (!_this._groups.dynamicGroups) {\n\t\t\treturn true;\n\t\t}\n\t\tif (_this._groups.regroup) {\n\t\t\tvar scrollState = gantt.getScrollState();\n\t\t\t_this._groups.regroup();\n\t\t\tif(scrollState){\n\t\t\t\tgantt.scrollTo(scrollState.x, scrollState.y);\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\n\tthis.$data.tasksStore.attachEvent(\"onAfterUpdate\", function(){\n\t\t// do not reset delayed function each time since onAfterUpdate can be called huge number of times and clearTimeout/setTimeout gets expensive\n\t\tif(!delayedFunction.$pending){\n\t\t\tdelayedFunction();\n\t\t}\n\t\treturn true;\n\t});\n\t// GS:2547 dynamically added tasks need to regroup\n\tgantt.attachEvent(\"onParse\", function(){\n\t\tif(!delayedFunction.$pending){\n\t\t\tif(_this._groups.is_active()){\n\t\t\t\tdelayedFunction();\n\t\t\t}\n\t\t}\n\t});\n}\n\n};\n","\nexport default function(gantt){\n\nif(!gantt._markers) {\n\tgantt._markers = gantt.createDatastore({\n\t\tname: \"marker\",\n\t\tinitItem: function (marker) {\n\t\t\tmarker.id = marker.id || gantt.uid();\n\t\t\treturn marker;\n\t\t}\n\t});\n}\n\ngantt.config.show_markers = true;\n\nfunction render_marker(marker){\n\tif(!gantt.config.show_markers)\n\t\treturn false;\n\n\tif(!marker.start_date)\n\t\treturn false;\n\n\tvar state = gantt.getState();\n\tif(+marker.start_date > +state.max_date)\n\t\treturn;\n\tif((!marker.end_date || +marker.end_date < +state.min_date) && +marker.start_date < +state.min_date)\n\t\treturn;\n\n\tvar div = document.createElement(\"div\");\n\n\tdiv.setAttribute(\"data-marker-id\", marker.id);\n\n\tvar css = \"gantt_marker\";\n\tif(gantt.templates.marker_class)\n\t\tcss += \" \" + gantt.templates.marker_class(marker);\n\n\tif(marker.css){\n\t\tcss += \" \" + marker.css;\n\t}\n\n\tif(gantt.templates.marker_class)\n\t\tcss += \" \" + gantt.templates.marker_class(marker);\n\n\tif(marker.title){\n\t\tdiv.title = marker.title;\n\t}\n\tdiv.className = css;\n\n\tvar start = gantt.posFromDate(marker.start_date);\n\tdiv.style.left = start + \"px\";\n\tlet markerHeight = Math.max(gantt.getRowTop(gantt.getVisibleTaskCount()), 0) + \"px\";\n\tif (gantt.config.timeline_placeholder && gantt.$task_data){\n\t\tmarkerHeight = gantt.$task_data.scrollHeight + \"px\";\n\t}\n\tdiv.style.height = markerHeight;\n\tif(marker.end_date){\n\t\tvar end = gantt.posFromDate(marker.end_date);\n\t\tdiv.style.width = Math.max((end - start), 0) + \"px\";\n\n\t}\n\n\tif(marker.text){\n\t\tdiv.innerHTML = \"<div class='gantt_marker_content' >\" + marker.text + \"</div>\";\n\t}\n\n\treturn div;\n}\n\nfunction initMarkerArea(){\n\t// GS-481. Reset $marker_area if there is no timeline\n\tif(!gantt.$task_data || !gantt.$root.contains(gantt.$task_data)){\n\t\tgantt.$marker_area = null;\n\t\treturn;\n\t}\n\n\t// GS-2084. Don't add $marker_area when it already exists\n\tif(gantt.$marker_area && gantt.$task_data.contains(gantt.$marker_area)){\n\t\treturn;\n\t}\n\n\tvar markerArea = document.createElement(\"div\");\n\tmarkerArea.className = \"gantt_marker_area\";\n\tgantt.$task_data.appendChild(markerArea);\n\tgantt.$marker_area = markerArea;\n}\n\ngantt.attachEvent(\"onBeforeGanttRender\", function(){\n\tif(!gantt.$marker_area)\n\t\tinitMarkerArea();\n});\n\ngantt.attachEvent(\"onDataRender\", function(){\n\tif(!gantt.$marker_area){\n\t\tinitMarkerArea();\n\t\tgantt.renderMarkers();\n\t}\n});\n\ngantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t// GS-1304 - markers should attach when layout is initialized, both on gantt.init and gantt.resetLayout\n\t// wait for \"onBeforeGanttRender\", so all layout elements will be in DOM\n\tgantt.attachEvent(\"onBeforeGanttRender\", function(){\n\t\t// GS-882. If markers are rendered in the onDataRender handler, \n\t\t// they are not attached to the layer, so we need to remove the DOM elements\n\t\tif (gantt.$marker_area) {\n\t\t\tgantt.$marker_area.innerHTML = \"\";\n\t\t}\n\t\tinitMarkerArea();\n\n\t\tvar layers = gantt.$services.getService(\"layers\");\n\t\tvar markerRenderer = layers.createDataRender({\n\t\t\tname: \"marker\",\n\t\t\tdefaultContainer: function(){ return gantt.$marker_area;}\n\t\t});\n\t\tmarkerRenderer.addLayer(render_marker);\n\t}, {once: true});\n});\n\ngantt.getMarker = function(id){\n\tif(!this._markers) return null;\n\n\treturn this._markers.getItem(id);\n};\n\ngantt.addMarker = function(marker){\n\treturn this._markers.addItem(marker);\n};\n\ngantt.deleteMarker = function(id){\n\tif(!this._markers.exists(id))\n\t\treturn false;\n\n\tthis._markers.removeItem(id);\n\treturn true;\n};\ngantt.updateMarker = function(id){\n\tthis._markers.refresh(id);\n};\n\ngantt._getMarkers = function(){\n\treturn this._markers.getItems();\n};\n\ngantt.renderMarkers = function () {\n\tthis._markers.refresh();\n};\n\n};","import {replaceValidZeroId} from \"../utils/helpers\";\n\nexport default function(gantt){\n\ngantt.config.multiselect = true;\ngantt.config.multiselect_one_level = false;\n\ngantt._multiselect = {\n\t_selected: {},\n\t_one_level: false,\n\t_active: true,\n\t_first_selected_when_shift: null,\n\tgetDefaultSelected: function() {\n\t\tvar selected = this.getSelected();\n\t\treturn selected.length ? selected[selected.length - 1] : null;\n\t},\n\tsetFirstSelected: function(id) {\n\t\tthis._first_selected_when_shift = id;\n\t},\n\tgetFirstSelected: function() {\n\t\treturn this._first_selected_when_shift;\n\t},\n\tisActive: function() {\n\t\tthis.updateState();\n\t\treturn this._active;\n\t},\n\tupdateState: function() {\n\t\tthis._one_level = gantt.config.multiselect_one_level;\n\t\tvar active = this._active;\n\t\tthis._active = gantt.config.select_task;\n\t\tif (this._active != active) {\n\t\t\tthis.reset();\n\t\t}\n\t},\n\treset: function () {\n\t\tthis._selected = {};\n\t},\n\tsetLastSelected: function (id) {\n\t\tgantt.$data.tasksStore.silent(function(){\n\t\t\tvar store = gantt.$data.tasksStore;\n\t\t\tif (id)\n\t\t\t\tstore.select(id+\"\");\n\t\t\telse\n\t\t\t\tstore.unselect(null);\n\t\t});\n\t},\n\tgetLastSelected: function () {\n\t\tvar last = gantt.$data.tasksStore.getSelectedId();\n\t\tif (last && gantt.isTaskExists(last))\n\t\t\treturn last;\n\t\treturn null;\n\t},\n\tselect: function (id, e) {\n\t\tif (id && gantt.callEvent(\"onBeforeTaskMultiSelect\", [id, true, e]) && gantt.callEvent(\"onBeforeTaskSelected\", [id])) {\n\t\t\tthis._selected[id] = true;\n\t\t\tthis.setLastSelected(id);\n\t\t\tthis.afterSelect(id);\n\t\t\tgantt.callEvent(\"onTaskMultiSelect\", [id, true, e]);\n\t\t\tgantt.callEvent(\"onTaskSelected\", [id]);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\ttoggle: function (id, e) {\n\t\tif (this._selected[id]) {\n\t\t\tthis.unselect(id, e);\n\t\t} else {\n\t\t\tthis.select(id, e);\n\t\t}\n\t},\n\tunselect: function (id, e) {\n\t\tif (id && gantt.callEvent(\"onBeforeTaskMultiSelect\", [id, false, e])) {\n\t\t\tthis._selected[id] = false;\n\t\t\tif (this.getLastSelected() == id)\n\t\t\t\tthis.setLastSelected(this.getDefaultSelected());\n\t\t\tthis.afterSelect(id);\n\t\t\tgantt.callEvent(\"onTaskMultiSelect\", [id, false, e]);\n\t\t\tgantt.callEvent(\"onTaskUnselected\", [id]);\n\t\t}\n\t},\n\tisSelected: function (id) {\n\t\treturn !!(gantt.isTaskExists(id) && this._selected[id]);\n\t},\n\tgetSelected: function () {\n\t\tvar res = [];\n\t\tfor (var i in this._selected) {\n\t\t\tif (this._selected[i] && gantt.isTaskExists(i)) {\n\t\t\t\tres.push(i);\n\t\t\t} else {\n\t\t\t\tthis._selected[i] = false;\n\t\t\t}\n\t\t}\n\t\tres.sort(function(a, b) {\n\t\t\treturn gantt.getGlobalTaskIndex(a) > gantt.getGlobalTaskIndex(b) ? 1 : -1;\n\t\t});\n\t\treturn res;\n\t},\n\tforSelected: function (callback) {\n\t\tvar selected = this.getSelected();\n\t\tfor (var i = 0; i < selected.length; i++) {\n\t\t\tcallback(selected[i]);\n\t\t}\n\t},\n\tisSameLevel: function(id) {\n\t\tif (!this._one_level)\n\t\t\treturn true;\n\t\tvar last = this.getLastSelected();\n\t\tif (!last)\n\t\t\treturn true;\n\t\tif (!(gantt.isTaskExists(last) && gantt.isTaskExists(id)))\n\t\t\treturn true;\n\t\treturn !!(gantt.calculateTaskLevel(gantt.getTask(last)) == gantt.calculateTaskLevel(gantt.getTask(id)));\n\t},\n\tafterSelect: function(id) {\n\t\tif (gantt.isTaskExists(id)){\n\t\t\t// FIXME: quick workaround to prevent re-filtering inside refresh on multiselect\n\t\t\tgantt._quickRefresh(function(){\n\t\t\t\tgantt.refreshTask(id);\n\t\t\t});\n\t\t}\n\t},\n\tdoSelection: function(e) {\n\t\tif (!this.isActive())\n\t\t\treturn false;\n\n\t\t// deny selection when click on 'expand' or 'collapse' icons\n\t\tif (gantt._is_icon_open_click(e))\n\t\t\treturn false;\n\n\t\tvar target_ev = gantt.locate(e);\n\t\tif (!target_ev)\n\t\t\treturn false;\n\n\t\tif (!gantt.callEvent(\"onBeforeMultiSelect\", [e]))\n\t\t\treturn false;\n\n\t\tvar selected = this.getSelected();\n\t\tvar defaultLast = this.getFirstSelected();\n\t\tvar isLast = false;\n\t\tvar last = this.getLastSelected();\n\t\tvar multiSelect = gantt.config.multiselect;\n\n\n\t\tvar singleSelection = (function () {\n\t\t\t// GS-719: If the multiselect extension is added we still need a way\n\t\t\t// to open the inline editors after clicking on the cells in the grid\n\t\t\tconst controller = gantt.ext.inlineEditors;\n\t\t\tif(controller && controller.getState){\n\t\t\t\tconst state = controller.getState();\n\t\t\t\tconst cell = controller.locateCell(e.target);\n\n\t\t\t\tif (gantt.config.inline_editors_multiselect_open && cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\t\tif (controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName) {\n\t\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.setFirstSelected(target_ev);\n\n\t\t\tif (!this.isSelected(target_ev)) {\n\t\t\t\tthis.select(target_ev, e);\n\t\t\t}\n\t\t\tselected = this.getSelected();\n\t\t\tfor (var i = 0; i < selected.length; i++) {\n\t\t\t\tif (selected[i] !== target_ev) {\n\t\t\t\t\tthis.unselect(selected[i], e);\n\t\t\t\t}\n\t\t\t}\n\t\t}).bind(this);\n\n\t\tvar blockSelection = (function(){\n\t\t\tif (!last)\n\t\t\t\tlast = target_ev;\n\t\t\telse if (target_ev) {\n\t\t\t\tvar first_indx = gantt.getGlobalTaskIndex(this.getFirstSelected());\n\t\t\t\tvar target_indx = gantt.getGlobalTaskIndex(target_ev);\n\t\t\t\tvar last_indx = gantt.getGlobalTaskIndex(last);\n\t\t\t\t// GS-1969: if the selected tasks are collapsed, need to remove them\n\t\t\t\tif(first_indx == -1 || last_indx == -1){\n\t\t\t\t\tfirst_indx = target_indx;\n\t\t\t\t\tthis.reset();\n\t\t\t\t}\n\t\t\t\t// clear prev selection\n\t\t\t\tvar tmp = last;\n\t\t\t\twhile (gantt.getGlobalTaskIndex(tmp) !== first_indx) {\n\t\t\t\t\tthis.unselect(tmp, e);\n\t\t\t\t\ttmp = (first_indx > last_indx) ? gantt.getNext(tmp) : gantt.getPrev(tmp);\n\t\t\t\t}\n\t\t\t\ttmp = target_ev;\n\t\t\t\twhile (gantt.getGlobalTaskIndex(tmp) !== first_indx) {\n\t\t\t\t\tif (this.select(tmp, e) && !isLast) {\n\t\t\t\t\t\tisLast = true;\n\t\t\t\t\t\tdefaultLast = tmp;\n\t\t\t\t\t}\n\t\t\t\t\ttmp = (first_indx > target_indx) ? gantt.getNext(tmp) : gantt.getPrev(tmp);\n\t\t\t\t}\n\t\t\t}\n\t\t}).bind(this);\n\n\n\t\tif (multiSelect && (e.ctrlKey || e.metaKey)) {\n\t\t\tif (!this.isSelected(target_ev))\n\t\t\t\tthis.setFirstSelected(target_ev);\n\n\t\t\tif (target_ev) {\n\t\t\t\tthis.toggle(target_ev, e);\n\t\t\t}\n\t\t}\n\n\t\telse if (multiSelect && e.shiftKey) {\n\t\t\tif (!gantt.isTaskExists(this.getFirstSelected()) || this.getFirstSelected() === null) {\n\t\t\t\tthis.setFirstSelected(target_ev);\n\t\t\t}\n\n\t\t\tif (selected.length) { // select a group of tasks\n\t\t\t\tblockSelection();\n\t\t\t}\n\t\t\telse { // select a task when no task is selected and Shift is pressed\n\t\t\t\tsingleSelection();\n\t\t\t}\n\t\t}\n\t\t\n\t\telse { // no key press or no multiple selection on the mouse click\n\t\t\tsingleSelection();\n\t\t}\n\n\n\t\tif (this.isSelected(target_ev)) {\n\t\t\tthis.setLastSelected(target_ev);\n\t\t} else if (defaultLast) {\n\t\t\tif (target_ev == last)\n\t\t\t\tthis.setLastSelected(e.shiftKey ? defaultLast : this.getDefaultSelected());\n\t\t} else {\n\t\t\tthis.setLastSelected(null);\n\t\t}\n\n\t\tif (!this.getSelected().length)\n\t\t\tthis.setLastSelected(null);\n\n\t\tif (!this.getLastSelected() || !this.isSelected(this.getFirstSelected()))\n\t\t\tthis.setFirstSelected(this.getLastSelected());\n\n\t\treturn true;\n\t}\n};\n\n(function(){\n\tvar old_selectTask = gantt.selectTask;\n\tgantt.selectTask = function(id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tif (!id)\n\t\t\treturn false;\n\t\tvar multiselect = gantt._multiselect;\n\t\tvar res = id;\n\t\tif (multiselect.isActive()) {\n\t\t\tif (multiselect.select(id, null)) {\n\t\t\t\tmultiselect.setLastSelected(id);\n\t\t\t}\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\n\t\t} else {\n\t\t\tres = old_selectTask.call(this, id);\n\t\t}\n\t\treturn res;\n\t};\n\n\tvar old_unselectTask = gantt.unselectTask;\n\tgantt.unselectTask = function(id) {\n\t\tvar multiselect = gantt._multiselect;\n\t\tvar isActive = multiselect.isActive();\n\t\tid = id || multiselect.getLastSelected();\n\t\tif(id && isActive) {\n\t\t\tmultiselect.unselect(id, null);\n\t\t\tif (id == multiselect.getLastSelected())\n\t\t\t\tmultiselect.setLastSelected(null);\n\t\t\tgantt.refreshTask(id);\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\n\t\t}\n\t\tvar res = id;\n\t\tif (!isActive)\n\t\t\tres = old_unselectTask.call(this, id);\n\t\treturn res;\n\t};\n\n\tgantt.toggleTaskSelection = function(id) {\n\t\tvar multiselect = gantt._multiselect;\n\t\tif (id && multiselect.isActive()) {\n\t\t\tmultiselect.toggle(id);\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\n\t\t}\n\t};\n\tgantt.getSelectedTasks = function() {\n\t\tvar multiselect = gantt._multiselect;\n\t\tmultiselect.isActive();\n\t\treturn multiselect.getSelected();\n\t};\n\tgantt.eachSelectedTask = function(callback){\n\t\treturn this._multiselect.forSelected(callback);\n\t};\n\tgantt.isSelectedTask = function(id){\n\t\treturn this._multiselect.isSelected(id);\n\t};\n\tgantt.getLastSelectedTask = function(){\n\t\treturn this._multiselect.getLastSelected();\n\t};\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tvar old_isSelected = gantt.$data.tasksStore.isSelected;\n\t\tgantt.$data.tasksStore.isSelected = function(id){\n\t\t\tif (gantt._multiselect.isActive()) {\n\t\t\t\treturn gantt._multiselect.isSelected(id);\n\t\t\t}\n\t\t\treturn old_isSelected.call(this, id);\n\t\t};\n\t});\n})();\n\ngantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\n\tvar multiselect = gantt._multiselect;\n\tif (!multiselect.isActive())\n\t\treturn true;\n\tif (gantt.isSelectedTask(id)) {\n\t\tmultiselect.unselect(id, null);\n\t\tmultiselect.select(new_id, null);\n\t}\n});\n\ngantt.attachEvent(\"onAfterTaskDelete\", function (id, item) {\n\tvar multiselect = gantt._multiselect;\n\tif (!multiselect.isActive())\n\t\treturn true;\n\n\tif (multiselect._selected[id]) {\n\t\t// GS-1057: don't unselect the task here because the task is already unselected \n\t\t// it was in the select.js file before it was deleted\n\t\t// multiselect.unselect(id, null);\n\t\tmultiselect._selected[id] = false;\n\t\tmultiselect.setLastSelected(multiselect.getDefaultSelected());\n\t}\n\n\tmultiselect.forSelected(function (task_id) {\n\t\tif (!gantt.isTaskExists(task_id))\n\t\t\tmultiselect.unselect(task_id, null);\n\t});\n});\n\ngantt.attachEvent(\"onBeforeTaskMultiSelect\", function(id, state, e){\n\tconst multiselect = gantt._multiselect;\n\tif (state && multiselect.isActive()) {\n\t\t//GS-1321: prevent unselecting task\n\t\tlet oldSelectedId = gantt.getSelectedId();\n\t\tlet oldSelectedTask = null;\n\t\tif (oldSelectedId) {\n\t\t\toldSelectedTask = gantt.getTask(oldSelectedId);\n\t\t}\n\t\tlet newSelectedTask = gantt.getTask(id);\n\t\tlet differentTreeLevel = false;\n\t\tif (oldSelectedTask && oldSelectedTask.$level != newSelectedTask.$level){\n\t\t\tdifferentTreeLevel = true;\n\t\t}\n\n\t\tif (gantt.config.multiselect_one_level && differentTreeLevel && !e.ctrlKey && !e.shiftKey) {\n\t\t\treturn true;\n\t\t}\n\t\tif (multiselect._one_level) {\n\t\t\treturn multiselect.isSameLevel(id);\n\t\t}\n\t}\n\treturn true;\n});\n\ngantt.attachEvent(\"onTaskClick\", function(id, e) {\n\tif (gantt._multiselect.doSelection(e))\n\t\tgantt.callEvent(\"onMultiSelect\", [e]);\n\treturn true;\n});\n\n};","export default function(gantt) {\n\tif (!gantt.ext) {\n\t\tgantt.ext = {};\n\t}\n\n\tgantt.ext.overlay = {};\n\n\tvar overlays = {};\n\n\tfunction createOverlay(id, render) {\n\t\tvar div = document.createElement(\"div\");\n\t\tdiv.setAttribute(\"data-overlay-id\", id);\n\t\tvar css = \"gantt_overlay\";\n\t\tdiv.className = css;\n\t\tdiv.style.display = \"none\";\n\t\treturn {\n\t\t\tid: id,\n\t\t\trender: render,\n\t\t\tisVisible: false,\n\t\t\tisAttached: false,\n\t\t\tnode: div\n\t\t};\n\t}\n\n\tfunction initOverlayArea() {\n\t\tif(!gantt.$task_data) {\n\t\t\treturn;\n\t\t}\n\t\tgantt.event(gantt.$task_data, \"scroll\", function(e){\n\t\t\tif (!gantt.ext.$overlay_area) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tgantt.ext.$overlay_area.style.top = e.target.scrollTop + \"px\";\n\t\t});\n\t\tvar overlayArea = document.createElement(\"div\");\n\t\toverlayArea.className = \"gantt_overlay_area\";\n\t\tgantt.$task_data.appendChild(overlayArea);\n\t\tgantt.ext.$overlay_area = overlayArea;\n\n\t\tattachUnnattached();\n\t}\n\n\tfunction attachUnnattached(){\n\t\tfor(var i in overlays){\n\t\t\tvar overlay = overlays[i];\n\t\t\tif(!overlay.isAttached){\n\t\t\t\tattachOverlay(overlay);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction attachOverlay(overlay){\n\t\tgantt.ext.$overlay_area.appendChild(overlay.node);\n\t\toverlay.isAttached = true;\n\t}\n\n\tfunction showOverlayArea(){\n\t\tgantt.ext.$overlay_area.style.display = \"block\";\n\t}\n\n\tfunction hideIfNoVisibleLayers(){\n\t\tvar any = false;\n\t\tfor(var i in overlays){\n\t\t\tvar overlay = overlays[i];\n\t\t\tif(overlay.isVisible){\n\t\t\t\tany = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(!any){\n\t\t\tgantt.ext.$overlay_area.style.display = \"none\";\n\t\t}\n\t}\n\n\tgantt.attachEvent(\"onBeforeGanttRender\", function() {\n\t\t//GS-2230: in case if `getGanttInstance` created without container\n\t\tif(!gantt.$root) return;\n\t\tif (!gantt.ext.$overlay_area) {\n\t\t\tinitOverlayArea();\n\t\t}\n\n\t\tif (!gantt.ext.$overlay_area.isConnected){\n\t\t\tgantt.ext.$overlay_area.innerHTML = \"\";\n\t\t\tgantt.ext.$overlay_area.remove();\n\t\t\tgantt.ext.$overlay_area = null;\n\t\t\tinitOverlayArea();\n\t\n\t\t\tfor(var i in overlays){\n\t\t\t\toverlays[i].isAttached = false;\n\t\t\t}\n\t\t}\n\n\t\tattachUnnattached();\n\t\thideIfNoVisibleLayers();\n\t});\n\n\tgantt.attachEvent(\"onGanttReady\", function() {\n\t\t//GS-2230: in case if `getGanttInstance` created without container\n\t\tif(!gantt.$root) return;\n\t\tinitOverlayArea();\n\t\tattachUnnattached();\n\t\thideIfNoVisibleLayers();\n\t});\n\n\tgantt.ext.overlay.addOverlay = function(render, id) {\n\t\tvar id = id || gantt.uid();\n\t\toverlays[id] = createOverlay(id, render);\n\t\treturn id;\n\t};\n\n\tgantt.ext.overlay.deleteOverlay = function(id) {\n\t\tif (!overlays[id])\n\t\t\treturn false;\n\n\t\tdelete overlays[id];\n\t\thideIfNoVisibleLayers();\n\t\treturn true;\n\t};\n\n\tgantt.ext.overlay.getOverlaysIds = function() {\n\t\tvar ids = [];\n\t\tfor(var i in overlays){\n\t\t\tids.push(i);\n\t\t}\n\t\treturn ids;\n\t};\n\n\tgantt.ext.overlay.refreshOverlay = function(id) {\n\t\tshowOverlayArea();\n\t\toverlays[id].isVisible = true;\n\t\toverlays[id].node.innerHTML = \"\";\n\t\toverlays[id].node.style.display = \"block\";\n\t\toverlays[id].render(overlays[id].node);\n\t};\n\n\tgantt.ext.overlay.showOverlay = function(id) {\n\t\tshowOverlayArea();\n\t\tthis.refreshOverlay(id);\n\t};\n\n\tgantt.ext.overlay.hideOverlay = function(id) {\n\n\t\toverlays[id].isVisible = false;\n\t\toverlays[id].node.style.display = \"none\";\n\t\thideIfNoVisibleLayers();\n\t};\n\tgantt.ext.overlay.isOverlayVisible = function(id) {\n\t\tif (!id) {\n\t\t\treturn false;\n\t\t}\n\t\treturn overlays[id].isVisible;\n\t};\n};","/* eslint-disable */\n\nexport default function(gantt: any) {\n\n\tgantt.ext = gantt.ext || {};\n\n\tgantt.ext.export_api = gantt.ext.export_api || {\n\n\t\t_apiUrl: \"https://export.dhtmlx.com/gantt\",\n\n\t\t_preparePDFConfigRaw(config, type){\n\t\t\tlet previousDateRage:any = null;\n\t\t\tif (config.start && config.end){\n\t\t\t\tpreviousDateRage = {\n\t\t\t\t\tstart_date: gantt.config.start_date,\n\t\t\t\t\tend_date: gantt.config.end_date,\n\t\t\t\t};\n\t\t\t\tgantt.config.start_date = gantt.date.str_to_date(gantt.config.date_format)(config.start);\n\t\t\t\tgantt.config.end_date = gantt.date.str_to_date(gantt.config.date_format)(config.end);\n\t\t\t}\n\n\t\t\tconfig = gantt.mixin(config, {\n\t\t\t\tname: \"gantt.\" + type, data: gantt.ext.export_api._serializeHtml()\n\t\t\t});\n\n\t\t\tif (previousDateRage){\n\t\t\t\tgantt.config.start_date = previousDateRage.start_date;\n\t\t\t\tgantt.config.end_date = previousDateRage.end_date;\n\t\t\t}\n\t\t},\n\n\t\t_prepareConfigPDF(config, type){\n\t\t\tconfig = gantt.mixin((config || {}), {\n\t\t\t\tname: \"gantt.\" + type,\n\t\t\t\tdata: gantt.ext.export_api._serializeAll(),\n\t\t\t\tconfig: gantt.config\n\t\t\t});\n\t\t\tgantt.ext.export_api._fixColumns(config.config.columns);\n\t\t\treturn config;\n\t\t},\n\n\t\t_pdfExportRouter(config, type){\n\t\t\tif (config && config.raw) {\n\t\t\t\tgantt.ext.export_api._preparePDFConfigRaw(config, type);\n\t\t\t} else {\n\t\t\t\tconfig = gantt.ext.export_api._prepareConfigPDF(config, type);\n\t\t\t}\n\t\t\tconfig.version = gantt.version;\n\t\t\tgantt.ext.export_api._sendToExport(config, type);\n\t\t},\n\n\t\texportToPDF(config) {\n\t\t\tgantt.ext.export_api._pdfExportRouter(config, \"pdf\");\n\t\t},\n\n\t\texportToPNG(config) {\n\t\t\tgantt.ext.export_api._pdfExportRouter(config, \"png\");\n\t\t},\n\n\n\t\texportToICal(config) {\n\t\t\tconfig = gantt.mixin((config || {}), {\n\t\t\t\tname: \"gantt.ical\",\n\t\t\t\tdata: gantt.ext.export_api._serializePlain().data,\n\t\t\t\tversion: gantt.version\n\t\t\t});\n\t\t\tgantt.ext.export_api._sendToExport(config, \"ical\");\n\t\t},\n\n\t\texportToExcel(config) {\n\t\t\tconfig = config || {};\n\n\t\t\tlet tasks;\n\t\t\tlet dates;\n\t\t\tlet state;\n\t\t\tlet scroll;\n\t\t\t// GS-2124, we need to get all task nodes to correctly obtain the colors\n\t\t\tconst smartRendering = gantt.config.smart_rendering;\n\t\t\tif (config.visual === \"base-colors\"){\n\t\t\t\tgantt.config.smart_rendering = false;\n\t\t\t}\n\n\t\t\tif (config.start || config.end) {\n\t\t\t\tstate = gantt.getState();\n\t\t\t\tdates = [gantt.config.start_date, gantt.config.end_date];\n\t\t\t\tscroll = gantt.getScrollState();\n\t\t\t\tconst convert = gantt.date.str_to_date(gantt.config.date_format);\n\t\t\t\ttasks = gantt.eachTask;\n\n\t\t\t\tif (config.start){\n\t\t\t\t\tgantt.config.start_date = convert(config.start);\n\t\t\t\t}\n\t\t\t\tif (config.end){\n\t\t\t\t\tgantt.config.end_date = convert(config.end);\n\t\t\t\t}\n\n\t\t\t\tgantt.render();\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\n\n\t\t\t\tgantt.eachTask = gantt.ext.export_api._eachTaskTimed(gantt.config.start_date, gantt.config.end_date);\n\t\t\t} else if (config.visual === \"base-colors\"){\n\t\t\t\tgantt.render();\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\n\t\t\t}\n\n\t\t\tgantt._no_progress_colors = config.visual === \"base-colors\";\n\n\t\t\tconfig = gantt.mixin(config, {\n\t\t\t\tname: \"gantt.xlsx\",\n\t\t\t\ttitle: \"Tasks\",\n\t\t\t\tdata: gantt.ext.export_api._serializeTimeline(config).data,\n\t\t\t\tcolumns: gantt.ext.export_api._serializeGrid({ rawDates: true }),\n\t\t\t\tversion: gantt.version\n\t\t\t});\n\n\t\t\tif (config.visual){\n\t\t\t\tconfig.scales = gantt.ext.export_api._serializeScales(config);\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._sendToExport(config, \"excel\");\n\n\t\t\tif (config.start || config.end) {\n\t\t\t\tgantt.config.start_date = state.min_date;\n\t\t\t\tgantt.config.end_date = state.max_date;\n\t\t\t\tgantt.eachTask = tasks;\n\n\t\t\t\tgantt.render();\n\t\t\t\tgantt.scrollTo(scroll.x, scroll.y);\n\n\t\t\t\tgantt.config.start_date = dates[0];\n\t\t\t\tgantt.config.end_date = dates[1];\n\t\t\t}\n\t\t},\n\n\t\texportToJSON(config) {\n\t\t\tconfig = gantt.mixin((config || {}), {\n\t\t\t\tname: \"gantt.json\",\n\t\t\t\tdata: gantt.ext.export_api._serializeAll(),\n\t\t\t\tconfig: gantt.config,\n\t\t\t\tcolumns: gantt.ext.export_api._serializeGrid(),\n\t\t\t\tworktime: gantt.ext.export_api._getWorktimeSettings(),\n\t\t\t\tversion: gantt.version\n\t\t\t});\n\t\t\tgantt.ext.export_api._sendToExport(config, \"json\");\n\t\t},\n\n\n\t\timportFromExcel(config) {\n\t\t\ttry {\n\t\t\t\tconst formData = config.data;\n\t\t\t\tif (formData instanceof File) {\n\t\t\t\t\tconst data = new FormData();\n\t\t\t\t\tdata.append(\"file\", formData);\n\t\t\t\t\tconfig.data = data;\n\t\t\t\t}\n\t\t\t} catch (error) {}\n\t\t\tgantt.ext.export_api._sendImportAjaxExcel(config);\n\t\t},\n\n\t\timportFromMSProject(config) {\n\t\t\tconst formData = config.data;\n\t\t\ttry {\n\t\t\t\tif (formData  instanceof File) {\n\t\t\t\t\tconst data = new FormData();\n\t\t\t\t\tdata.append(\"file\", formData);\n\t\t\t\t\tconfig.data = data;\n\t\t\t\t}\n\t\t\t} catch (error) {}\n\t\t\tgantt.ext.export_api._sendImportAjaxMSP(config);\n\t\t},\n\n\t\timportFromPrimaveraP6(config) {\n\t\t\tconfig.type = \"primaveraP6-parse\";\n\t\t\treturn gantt.importFromMSProject(config);\n\t\t},\n\n\t\texportToMSProject(config) {\n\t\t\tconfig = config || {};\n\t\t\tconfig.skip_circular_links = config.skip_circular_links === undefined ? true : !!config.skip_circular_links;\n\n\t\t\tconst oldXmlFormat = gantt.templates.xml_format;\n\t\t\tconst oldFormatDate = gantt.templates.format_date;\n\t\t\tconst oldXmlDate = gantt.config.xml_date;\n\t\t\tconst oldDateFormat = gantt.config.date_format;\n\n\t\t\tconst exportServiceDateFormat = \"%d-%m-%Y %H:%i:%s\";\n\n\t\t\tgantt.config.xml_date = exportServiceDateFormat;\n\t\t\tgantt.config.date_format = exportServiceDateFormat;\n\t\t\tgantt.templates.xml_format = gantt.date.date_to_str(exportServiceDateFormat);\n\t\t\tgantt.templates.format_date = gantt.date.date_to_str(exportServiceDateFormat);\n\t\t\tconst data = gantt.ext.export_api._serializeAll();\n\n\t\t\tgantt.ext.export_api._customProjectProperties(data, config);\n\n\t\t\tgantt.ext.export_api._customTaskProperties(data, config);\n\n\t\t\tif (config.skip_circular_links) {\n\t\t\t\tgantt.ext.export_api._clearRecLinks(data);\n\t\t\t}\n\n\t\t\tconfig = gantt.ext.export_api._exportConfig(data, config);\n\n\t\t\tgantt.ext.export_api._sendToExport(config, config.type || \"msproject\");\n\t\t\tgantt.config.xml_date = oldXmlDate;\n\t\t\tgantt.config.date_format = oldDateFormat;\n\t\t\tgantt.templates.xml_format = oldXmlFormat;\n\t\t\tgantt.templates.format_date = oldFormatDate;\n\n\t\t\tgantt.config.$custom_data = null;\n\t\t\tgantt.config.custom = null;\n\t\t},\n\n\t\texportToPrimaveraP6(config) {\n\t\t\tconfig = config || {};\n\t\t\tconfig.type = \"primaveraP6\";\n\t\t\treturn gantt.exportToMSProject(config);\n\t\t},\n\n\t\t_fixColumns(columns) {\n\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\tcolumns[i].label = columns[i].label || gantt.locale.labels[\"column_\" + columns[i].name];\n\t\t\t\tif (typeof columns[i].width === \"string\") {\n\t\t\t\t\tcolumns[i].width = columns[i].width * 1;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_xdr(url, pack, cb) {\n\t\t\tgantt.ajax.post(url, pack, cb);\n\t\t},\n\n\t\t_markColumns(base) {\n\t\t\tconst columns = base.config.columns;\n\t\t\tif (columns){\n\t\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\t\tif (columns[i].template){\n\t\t\t\t\t\tcolumns[i].$template = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t_sendImportAjaxExcel(config) {\n\t\t\tconst url = config.server || gantt.ext.export_api._apiUrl;\n\t\t\tconst store = config.store || 0;\n\t\t\tconst formData = config.data;\n\t\t\tconst callback = config.callback;\n\n\t\t\tformData.append(\"type\", \"excel-parse\");\n\t\t\tformData.append(\"data\", JSON.stringify({\n\t\t\t\tsheet: config.sheet || 0\n\t\t\t}));\n\n\t\t\tif (store){\n\t\t\t\tformData.append(\"store\", store);\n\t\t\t}\n\n\t\t\tconst xhr = new XMLHttpRequest();\n\t\t\txhr.onreadystatechange = function(e) {\n\t\t\t\tif (xhr.readyState === 4 && xhr.status === 0) {// network error\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.onload = function() {\n\t\t\t\tconst fail = xhr.status > 400;\n\t\t\t\tlet info = null;\n\n\t\t\t\tif (!fail) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinfo = JSON.parse(xhr.responseText);\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}\n\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback(info);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.open(\"POST\", url, true);\n\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\t\t\txhr.send(formData);\n\t\t},\n\n\n\t\t_ajaxToExport(data, type, callback) {\n\t\t\tdelete data.callback;\n\n\t\t\tconst url = data.server || gantt.ext.export_api._apiUrl;\n\t\t\tconst pack = \"type=\" + type + \"&store=1&data=\" + encodeURIComponent(JSON.stringify(data));\n\n\t\t\tconst cb = function(loader) {\n\t\t\t\tconst xdoc = loader.xmlDoc || loader;\n\t\t\t\tconst fail = xdoc.status > 400;\n\t\t\t\tlet info = null;\n\n\t\t\t\tif (!fail) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinfo = JSON.parse(xdoc.responseText);\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}\n\t\t\t\tcallback(info);\n\t\t\t};\n\n\t\t\tgantt.ext.export_api._xdr(url, pack, cb);\n\t\t},\n\t\t_serializableGanttConfig(config) {\n\t\t\tconst result = gantt.mixin({}, config);\n\n\t\t\tif (result.columns) {\n\t\t\t\tresult.columns = result.columns.map(function(col) {\n\t\t\t\t\tconst copy = gantt.mixin({}, col);\n\t\t\t\t\tdelete copy.editor;\n\t\t\t\t\treturn copy;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tdelete result.editor_types;\n\t\t\treturn result;\n\t\t},\n\n\t\t_sendToExport(data, type) {\n\t\t\tconst convert = gantt.date.date_to_str(gantt.config.date_format || gantt.config.xml_date);\n\t\t\tif(!data.skin){\n\t\t\t\tdata.skin = gantt.skin;\n\t\t\t}\n\t\t\tif (data.config) {\n\t\t\t\tdata.config = gantt.copy(gantt.ext.export_api._serializableGanttConfig(data.config));\n\t\t\t\tgantt.ext.export_api._markColumns(data, type);\n\n\t\t\t\tif (data.config.start_date && data.config.end_date) {\n\t\t\t\t\tif (data.config.start_date instanceof Date) {\n\t\t\t\t\t\tdata.config.start_date = convert(data.config.start_date);\n\t\t\t\t\t}\n\t\t\t\t\tif (data.config.end_date instanceof Date) {\n\t\t\t\t\t\tdata.config.end_date = convert(data.config.end_date);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (data.callback) {\n\t\t\t\treturn gantt.ext.export_api._ajaxToExport(data, type, data.callback);\n\t\t\t}\n\n\t\t\tconst form = gantt.ext.export_api._createHiddenForm();\n\t\t\tform.firstChild.action = data.server || gantt.ext.export_api._apiUrl;\n\t\t\tform.firstChild.childNodes[0].value = JSON.stringify(data);\n\t\t\tform.firstChild.childNodes[1].value = type;\n\t\t\tform.firstChild.submit();\n\t\t},\n\n\t\t_createHiddenForm() {\n\t\t\tif (!gantt.ext.export_api._hidden_export_form) {\n\t\t\t\tconst t = gantt.ext.export_api._hidden_export_form = document.createElement(\"div\");\n\t\t\t\tt.style.display = \"none\";\n\t\t\t\tt.innerHTML = \"<form method='POST' target='_blank'><textarea name='data' style='width:0px; height:0px;' readonly='true'></textarea><input type='hidden' name='type' value=''></form>\";\n\t\t\t\tdocument.body.appendChild(t);\n\t\t\t}\n\t\t\treturn gantt.ext.export_api._hidden_export_form;\n\t\t},\n\n\n\t\t_copyObjectBase(obj) {\n\t\t\tconst copy = {\n\t\t\t\tstart_date: undefined,\n\t\t\t\tend_date: undefined,\n\t\t\t\tconstraint_date: undefined,\n\t\t\t\tdeadline: undefined\n\t\t\t};\n\t\t\tfor (const key in obj) {\n\t\t\t\tif (key.charAt(0) === \"$\" || key === \"baselines\"){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tcopy[key] = obj[key];\n\t\t\t}\n\t\t\tconst formatDate = gantt.templates.xml_format || gantt.templates.format_date;\n\n\t\t\tcopy.start_date = formatDate(copy.start_date);\n\t\t\tif (copy.end_date){\n\t\t\t\tcopy.end_date = formatDate(copy.end_date);\n\t\t\t}\n\t\t\tif (copy.constraint_date){\n\t\t\t\tcopy.constraint_date = formatDate(copy.constraint_date);\n\t\t\t}\n\t\t\tif (copy.deadline){\n\t\t\t\tcopy.deadline = formatDate(copy.deadline);\n\t\t\t}\n\n\t\t\treturn copy;\n\t\t},\n\n\n\t\t_color_box: null,\n\t\t_color_hash: {},\n\n\t\t_getStyles(css) {\n\t\t\tif (!gantt.ext.export_api._color_box) {\n\t\t\t\tgantt.ext.export_api._color_box = document.createElement(\"DIV\");\n\t\t\t\tgantt.ext.export_api._color_box.style.cssText = \"position:absolute; display:none;\";\n\t\t\t\tdocument.body.appendChild(gantt.ext.export_api._color_box);\n\t\t\t}\n\t\t\tif (gantt.ext.export_api._color_hash[css]){\n\t\t\t\treturn gantt.ext.export_api._color_hash[css];\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._color_box.className = css;\n\t\t\tconst color = gantt.ext.export_api._getColor(gantt.ext.export_api._color_box, \"color\");\n\t\t\tconst backgroundColor = gantt.ext.export_api._getColor(gantt.ext.export_api._color_box, \"backgroundColor\");\n\t\t\treturn (gantt.ext.export_api._color_hash[css] = color + \";\" + backgroundColor);\n\t\t},\n\n\n\t\t_getMinutesWorktimeSettings(parsedRanges) {\n\t\t\tconst minutes:any = [];\n\t\t\tparsedRanges.forEach(function(range) {\n\t\t\t\tminutes.push(range.startMinute);\n\t\t\t\tminutes.push(range.endMinute);\n\t\t\t});\n\t\t\treturn minutes;\n\t\t},\n\n\t\t_getWorktimeSettings() {\n\n\t\t\tconst defaultWorkTimes = {\n\t\t\t\thours: [0, 24],\n\t\t\t\tminutes: null,\n\t\t\t\tdates: { 0: true, 1: true, 2: true, 3: true, 4: true, 5: true, 6: true }\n\t\t\t};\n\n\t\t\tlet time;\n\t\t\tif (!gantt.config.work_time) {\n\t\t\t\ttime = defaultWorkTimes;\n\t\t\t} else {\n\t\t\t\tconst wTime = gantt._working_time_helper;\n\t\t\t\tif (wTime && wTime.get_calendar) {\n\t\t\t\t\ttime = wTime.get_calendar();\n\t\t\t\t} else if (wTime) {\n\t\t\t\t\ttime = {\n\t\t\t\t\t\thours: wTime.hours,\n\t\t\t\t\t\tminutes: null,\n\t\t\t\t\t\tdates: wTime.dates\n\t\t\t\t\t};\n\t\t\t\t} else if (gantt.config.worktimes && gantt.config.worktimes.global) {\n\t\t\t\t\tconst settings = gantt.config.worktimes.global;\n\n\t\t\t\t\tif (settings.parsed) {\n\t\t\t\t\t\tconst minutes = gantt.ext.export_api._getMinutesWorktimeSettings(settings.parsed.hours);\n\t\t\t\t\t\ttime = {\n\t\t\t\t\t\t\thours: null,\n\t\t\t\t\t\t\tminutes,\n\t\t\t\t\t\t\tdates: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tfor (const i in settings.parsed.dates) {\n\t\t\t\t\t\t\tif (Array.isArray(settings.parsed.dates[i])) {\n\t\t\t\t\t\t\t\ttime.dates[i] = gantt.ext.export_api._getMinutesWorktimeSettings(settings.parsed.dates[i]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttime.dates[i] = settings.parsed.dates[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttime = {\n\t\t\t\t\t\t\thours: settings.hours,\n\t\t\t\t\t\t\tminutes: null,\n\t\t\t\t\t\t\tdates: settings.dates\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\ttime = defaultWorkTimes;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn time;\n\t\t},\n\n\n\t\t_eachTaskTimed(start, end) {\n\t\t\treturn function(code, parent, master) {\n\t\t\t\tparent = parent || gantt.config.root_id;\n\t\t\t\tmaster = master || gantt;\n\n\t\t\t\tconst branch = gantt.getChildren(parent);\n\t\t\t\tif (branch){\n\t\t\t\t\tfor (let i = 0; i < branch.length; i++) {\n\t\t\t\t\t\tconst item = gantt._pull[branch[i]];\n\t\t\t\t\t\tif ((!start || item.end_date > start) && (!end || item.start_date < end)){\n\t\t\t\t\t\t\tcode.call(master, item);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (gantt.hasChild(item.id)){\n\t\t\t\t\t\t\tgantt.eachTask(code, item.id, master);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\n\t\t// patch broken json serialization in gantt 2.1\n\t\t_originalCopyObject: gantt.json._copyObject,\n\n\n\t\t_copyObjectPlain(obj) {\n\t\t\tconst text = gantt.templates.task_text(obj.start_date, obj.end_date, obj);\n\n\t\t\tconst copy = gantt.ext.export_api._copyObjectBase(obj);\n\t\t\tcopy.text = text || copy.text;\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_getColor(node, style) {\n\t\t\tconst value = node.currentStyle ? node.currentStyle[style] : getComputedStyle(node, null)[style];\n\t\t\tconst rgb = value.replace(/\\s/g, \"\").match(/^rgba?\\((\\d+),(\\d+),(\\d+)/i);\n\t\t\treturn ((rgb && rgb.length === 4) ?\n\t\t\t\t(\"0\" + parseInt(rgb[1], 10).toString(16)).slice(-2) +\n\t\t\t\t(\"0\" + parseInt(rgb[2], 10).toString(16)).slice(-2) +\n\t\t\t\t(\"0\" + parseInt(rgb[3], 10).toString(16)).slice(-2) : value).replace(\"#\", \"\");\n\t\t},\n\n\n\t\t// excel serialization\n\t\t_copyObjectTable(obj) {\n\t\t\t// Excel interprets UTC time as local time in every timezone, send local time instead of actual UTC time.\n\t\t\t// https://github.com/SheetJS/js-xlsx/issues/126#issuecomment-60531614\n\t\t\tconst toISOstring = gantt.date.date_to_str(\"%Y-%m-%dT%H:%i:%s.000Z\");\n\n\t\t\tconst copy = gantt.ext.export_api._copyObjectColumns(obj, gantt.ext.export_api._copyObjectPlain(obj));\n\t\t\tif (copy.start_date){\n\t\t\t\tcopy.start_date = toISOstring(obj.start_date);\n\t\t\t}\n\t\t\tif (copy.end_date){\n\t\t\t\tcopy.end_date = toISOstring(obj.end_date);\n\t\t\t}\n\n\t\t\t// private gantt._day_index_by_date was replaced by public gantt.columnIndexByDate in gantt 5.0\n\t\t\tconst getDayIndex = gantt._day_index_by_date ? gantt._day_index_by_date : gantt.columnIndexByDate;\n\n\t\t\tcopy.$start = getDayIndex.call(gantt, obj.start_date);\n\t\t\tcopy.$end = getDayIndex.call(gantt, obj.end_date);\n\n\t\t\t// GS-2100. Correct bar position considering hidden cells\n\t\t\tlet hiddenCells = 0;\n\t\t\tconst scaleCellsWidth = gantt.getScale().width;\n\t\t\tif (scaleCellsWidth.indexOf(0) > -1) {\n\t\t\t\tlet i = 0;\n\t\t\t\tfor (i; i < copy.$start; i++) {\n\t\t\t\t\tif (!scaleCellsWidth[i]) {\n\t\t\t\t\t\thiddenCells++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcopy.$start -= hiddenCells;\n\n\t\t\t\tfor (i; i < copy.$end; i++) {\n\t\t\t\t\tif (!scaleCellsWidth[i]) {\n\t\t\t\t\t\thiddenCells++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcopy.$end -= hiddenCells;\n\t\t\t}\n\n\t\t\tcopy.$level = obj.$level;\n\t\t\tcopy.$type = obj.$rendered_type;\n\n\t\t\tconst tmps = gantt.templates;\n\t\t\tcopy.$text = tmps.task_text(obj.start, obj.end_date, obj);\n\t\t\tcopy.$left = tmps.leftside_text ? tmps.leftside_text(obj.start, obj.end_date, obj) : \"\";\n\t\t\tcopy.$right = tmps.rightside_text ? tmps.rightside_text(obj.start, obj.end_date, obj) : \"\";\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_copyObjectColors(obj) {\n\t\t\tconst copy = gantt.ext.export_api._copyObjectTable(obj);\n\n\t\t\tconst node = gantt.getTaskNode(obj.id);\n\t\t\tif (node && node.firstChild) {\n\t\t\t\tlet color = gantt.ext.export_api._getColor((gantt._no_progress_colors ? node : node.firstChild), \"backgroundColor\");\n\t\t\t\tif (color === \"363636\"){\n\t\t\t\t\tcolor = gantt.ext.export_api._getColor(node, \"backgroundColor\");\n\t\t\t\t}\n\n\t\t\t\tcopy.$color = color;\n\t\t\t} else if (obj.color){\n\t\t\t\tcopy.$color = obj.color;\n\t\t\t}\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_copyObjectColumns(obj, copy) {\n\t\t\tfor (let i = 0; i < gantt.config.columns.length; i++) {\n\t\t\t\tconst ct = gantt.config.columns[i].template;\n\t\t\t\tif (ct) {\n\t\t\t\t\tlet val = ct(obj);\n\t\t\t\t\tif (val instanceof Date){\n\t\t\t\t\t\tval = gantt.templates.date_grid(val, obj);\n\t\t\t\t\t}\n\t\t\t\t\tcopy[\"_\" + i] = val;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn copy;\n\t\t},\n\n\t\t_copyObjectAll(obj) {\n\t\t\tconst copy = gantt.ext.export_api._copyObjectBase(obj);\n\n\t\t\tconst templates = [\n\t\t\t\t\"leftside_text\",\n\t\t\t\t\"rightside_text\",\n\t\t\t\t\"task_text\",\n\t\t\t\t\"progress_text\",\n\t\t\t\t\"task_class\"\n\t\t\t];\n\n\t\t\t// serialize all text templates\n\t\t\tfor (let i = 0; i < templates.length; i++) {\n\t\t\t\tconst template = gantt.templates[templates[i]];\n\t\t\t\tif (template){\n\t\t\t\t\tcopy[\"$\" + i] = template(obj.start_date, obj.end_date, obj);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._copyObjectColumns(obj, copy);\n\t\t\tcopy.open = obj.$open;\n\t\t\treturn copy;\n\t\t},\n\n\n\t\t_serializeHtml() {\n\t\t\tconst smartScales = gantt.config.smart_scales;\n\t\t\tconst smartRendering = gantt.config.smart_rendering;\n\t\t\tif (smartScales || smartRendering) {\n\t\t\t\tgantt.config.smart_rendering = false;\n\t\t\t\tgantt.config.smart_scales = false;\n\t\t\t\tgantt.render();\n\t\t\t}\n\n\t\t\tconst html = gantt.$container.parentNode.innerHTML;\n\n\t\t\tif (smartScales || smartRendering) {\n\t\t\t\tgantt.config.smart_scales = smartScales;\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\n\t\t\t\tgantt.render();\n\t\t\t}\n\n\t\t\treturn html;\n\t\t},\n\n\t\t_serializeAll() {\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._copyObjectAll;\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\n\t\t\treturn data;\n\t\t},\n\n\t\t_serializePlain() {\n\t\t\tconst oldXmlFormat = gantt.templates.xml_format;\n\t\t\tconst oldFormatDate = gantt.templates.format_date;\n\t\t\tgantt.templates.xml_format = gantt.date.date_to_str(\"%Y%m%dT%H%i%s\", true);\n\t\t\tgantt.templates.format_date = gantt.date.date_to_str(\"%Y%m%dT%H%i%s\", true);\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._copyObjectPlain;\n\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\n\n\t\t\tgantt.templates.xml_format = oldXmlFormat;\n\t\t\tgantt.templates.format_date = oldFormatDate;\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\n\n\t\t\tdelete data.links;\n\t\t\treturn data;\n\t\t},\n\n\t\t_getRaw() {\n\t\t\t// support Gantt < 5.0\n\t\t\tif (gantt._scale_helpers) {\n\t\t\t\tconst scales = gantt._get_scales();\n\t\t\t\tconst\tminWidth = gantt.config.min_column_width;\n\t\t\t\tconst\tautosizeMinWidth = gantt._get_resize_options().x ? Math.max(gantt.config.autosize_min_width, 0) : gantt.config.$task.offsetWidth;\n\t\t\t\tconst\theight = gantt.config.config.scale_height - 1;\n\t\t\t\treturn gantt._scale_helpers.prepareConfigs(scales, minWidth, autosizeMinWidth, height);\n\t\t\t} else { // Gantt >= 5.0\n\t\t\t\tconst timeline = gantt.$ui.getView(\"timeline\");\n\t\t\t\tif (timeline) {\n\t\t\t\t\tlet availWidth = timeline.$config.width;\n\t\t\t\t\tif (gantt.config.autosize === \"x\" || gantt.config.autosize === \"xy\") {\n\t\t\t\t\t\tavailWidth = Math.max(gantt.config.autosize_min_width, 0);\n\t\t\t\t\t}\n\t\t\t\t\tconst state = gantt.getState();\n\t\t\t\t\tconst\tscales = timeline._getScales();\n\t\t\t\t\tconst\tminWidth = gantt.config.min_column_width;\n\t\t\t\t\tconst\theight = gantt.config.scale_height - 1;\n\t\t\t\t\tconst\trtl = gantt.config.rtl;\n\t\t\t\t\treturn timeline.$scaleHelper.prepareConfigs(scales, minWidth, availWidth, height, state.min_date, state.max_date, rtl);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_serializeTimeline(config) {\n\t\t\tgantt.json._copyObject = config.visual ? gantt.ext.export_api._copyObjectColors : gantt.ext.export_api._copyObjectTable;\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\n\n\t\t\tdelete data.links;\n\n\t\t\tif (config.cellColors) {\n\t\t\t\tconst css = gantt.templates.timeline_cell_class || gantt.templates.task_cell_class;\n\t\t\t\tif (css) {\n\t\t\t\t\tconst raw = gantt.ext.export_api._getRaw();\n\t\t\t\t\tlet steps = raw[0].trace_x;\n\t\t\t\t\tfor (let i = 1; i < raw.length; i++){\n\t\t\t\t\t\tif (raw[i].trace_x.length > steps.length){\n\t\t\t\t\t\t\tsteps = raw[i].trace_x;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let i = 0; i < data.data.length; i++) {\n\t\t\t\t\t\tdata.data[i].styles = [];\n\t\t\t\t\t\tconst task = gantt.getTask(data.data[i].id);\n\t\t\t\t\t\tfor (let j = 0; j < steps.length; j++) {\n\t\t\t\t\t\t\tconst date = steps[j];\n\t\t\t\t\t\t\tconst cellCss = css(task, date);\n\t\t\t\t\t\t\tif (cellCss){\n\t\t\t\t\t\t\t\tdata.data[i].styles.push({ index: j, styles: gantt.ext.export_api._getStyles(cellCss) });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn data;\n\t\t},\n\n\t\t_serializeScales(config) {\n\t\t\tconst scales:any = [];\n\t\t\tconst raw = gantt.ext.export_api._getRaw();\n\n\t\t\tlet min = Infinity;\n\t\t\tlet max = 0;\n\t\t\tfor (let i = 0; i < raw.length; i++) {\n\t\t\t\tmin = Math.min(min, raw[i].col_width);\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < raw.length; i++) {\n\t\t\t\tlet start = 0;\n\t\t\t\tlet end = 0;\n\t\t\t\tconst row:any = [];\n\n\t\t\t\tscales.push(row);\n\t\t\t\tconst step = raw[i];\n\t\t\t\tmax = Math.max(max, step.trace_x.length);\n\t\t\t\tconst template = step.format || step.template || (step.date ? gantt.date.date_to_str(step.date) : gantt.config.date_scale);\n\n\t\t\t\tfor (let j = 0; j < step.trace_x.length; j++) {\n\t\t\t\t\tconst date = step.trace_x[j];\n\t\t\t\t\tend = start + Math.round(step.width[j] / min);\n\n\t\t\t\t\tconst scaleCell = { text: template(date), start, end, styles: \"\" };\n\n\t\t\t\t\tif (config.cellColors) {\n\t\t\t\t\t\tconst css = step.css || gantt.templates.scaleCell_class;\n\t\t\t\t\t\tif (css) {\n\t\t\t\t\t\t\tconst scaleCss = css(date);\n\t\t\t\t\t\t\tif (scaleCss){\n\t\t\t\t\t\t\t\tscaleCell.styles = gantt.ext.export_api._getStyles(scaleCss);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\trow.push(scaleCell);\n\t\t\t\t\tstart = end;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { width: max, height: scales.length, data: scales };\n\t\t},\n\n\t\t_serializeGrid(config) {\n\t\t\tgantt.exportMode = true;\n\n\t\t\tconst columns:any = [];\n\t\t\tconst cols = gantt.config.columns;\n\n\t\t\tlet ccount = 0;\n\t\t\tfor (let i = 0; i < cols.length; i++) {\n\t\t\t\tif (cols[i].name === \"add\" || cols[i].name === \"buttons\") {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tcolumns[ccount] = {\n\t\t\t\t\tid: ((cols[i].template) ? (\"_\" + i) : cols[i].name),\n\t\t\t\t\theader: cols[i].label || gantt.locale.labels[\"column_\" + cols[i].name],\n\t\t\t\t\twidth: (cols[i].width ? Math.floor(cols[i].width / 4) : \"\"),\n\t\t\t\t\ttree: cols[i].tree || false\n\t\t\t\t};\n\n\t\t\t\tif (cols[i].name === \"duration\"){\n\t\t\t\t\tcolumns[ccount].type = \"number\";\n\t\t\t\t}\n\t\t\t\tif (cols[i].name === \"start_date\" || cols[i].name === \"end_date\") {\n\t\t\t\t\tcolumns[ccount].type = \"date\";\n\t\t\t\t\tif (config && config.rawDates){\n\t\t\t\t\t\tcolumns[ccount].id = cols[i].name;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tccount++;\n\t\t\t}\n\n\t\t\tgantt.exportMode = false;\n\t\t\treturn columns;\n\t\t},\n\n\t\t_exportSerialize() {\n\t\t\tgantt.exportMode = true;\n\n\t\t\tconst xmlFormat = gantt.templates.xml_format;\n\t\t\tconst formatDate = gantt.templates.format_date;\n\n\t\t\t// use configuration date format for serialization so date could be parsed on the export\n\t\t\t// required when custom format date function is defined\n\t\t\tgantt.templates.xml_format =\n\t\t\t\tgantt.templates.format_date =\n\t\t\t\tgantt.date.date_to_str(gantt.config.date_format || gantt.config.xml_date);\n\n\t\t\tconst data = gantt.serialize();\n\n\t\t\tgantt.templates.xml_format = xmlFormat;\n\t\t\tgantt.templates.format_date = formatDate;\n\t\t\tgantt.exportMode = false;\n\t\t\treturn data;\n\t\t},\n\n\n\t\t_setLevel(data) {\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\tif (data[i].parent == 0) {\n\t\t\t\t\tdata[i]._lvl = 1;\n\t\t\t\t}\n\t\t\t\tfor (let j = i + 1; j < data.length; j++) {\n\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t\tif (data[i].id == data[j].parent) {\n\t\t\t\t\t\tdata[j]._lvl = data[i]._lvl + 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_clearLevel(data) {\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\tdelete data[i]._lvl;\n\t\t\t}\n\t\t},\n\n\t\t_clearRecLinks(data) {\n\t\t\tgantt.ext.export_api._setLevel(data.data);\n\t\t\tconst tasks = {};\n\t\t\tfor (let i = 0; i < data.data.length; i++) {\n\t\t\t\ttasks[data.data[i].id] = data.data[i];\n\t\t\t}\n\n\t\t\tconst links = {};\n\n\t\t\tfor (let i = 0; i < data.links.length; i++) {\n\t\t\t\tconst link = data.links[i];\n\t\t\t\tif (gantt.isTaskExists(link.source) && gantt.isTaskExists(link.target) &&\n\t\t\t\t\ttasks[link.source] && tasks[link.target]) {\n\t\t\t\t\tlinks[link.id] = link;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const j in links) {\n\t\t\t\tgantt.ext.export_api._makeLinksSameLevel(links[j], tasks);\n\t\t\t}\n\n\t\t\tconst skippedLinks = {};\n\t\t\tfor (const j in tasks) {\n\t\t\t\tgantt.ext.export_api._clearCircDependencies(tasks[j], links, tasks, {}, skippedLinks, null);\n\t\t\t}\n\n\t\t\tif (Object.keys(links)) {\n\t\t\t\tgantt.ext.export_api._clearLinksSameLevel(links, tasks);\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < data.links.length; i++) {\n\t\t\t\tif (!links[data.links[i].id]) {\n\t\t\t\t\tdata.links.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._clearLevel(data.data);\n\t\t},\n\n\t\t_clearCircDependencies(task, links, tasks, usedTasks, skippedLinks, prevLink) {\n\t\t\tconst sources = task.$_source;\n\t\t\tif (!sources) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (usedTasks[task.id]) {\n\t\t\t\tgantt.ext.export_api._onCircDependencyFind(prevLink, links, usedTasks, skippedLinks);\n\t\t\t}\n\n\t\t\tusedTasks[task.id] = true;\n\n\t\t\tconst targets = {};\n\n\t\t\tfor (let i = 0; i < sources.length; i++) {\n\t\t\t\tif (skippedLinks[sources[i]]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst curLink = links[sources[i]];\n\t\t\t\tconst targetTask = tasks[curLink._target];\n\t\t\t\tif (targets[targetTask.id]) { // two link from one task to another\n\t\t\t\t\tgantt.ext.export_api._onCircDependencyFind(curLink, links, usedTasks, skippedLinks);\n\t\t\t\t}\n\t\t\t\ttargets[targetTask.id] = true;\n\t\t\t\tgantt.ext.export_api._clearCircDependencies(targetTask, links, tasks, usedTasks, skippedLinks, curLink);\n\t\t\t}\n\t\t\tusedTasks[task.id] = false;\n\t\t},\n\n\t\t_onCircDependencyFind(link, links, usedTasks, skippedLinks) {\n\t\t\tif (link) {\n\t\t\t\tif (gantt.callEvent(\"onExportCircularDependency\", [link.id, link])) {\n\t\t\t\t\tdelete links[link.id];\n\t\t\t\t}\n\n\t\t\t\tdelete usedTasks[link._source];\n\t\t\t\tdelete usedTasks[link._target];\n\t\t\t\tskippedLinks[link.id] = true;\n\t\t\t}\n\t\t},\n\n\t\t_makeLinksSameLevel(link, tasks) {\n\t\t\tlet task;\n\t\t\tlet targetLvl;\n\t\t\tconst linkT = {\n\t\t\t\ttarget: tasks[link.target],\n\t\t\t\tsource: tasks[link.source]\n\t\t\t};\n\t\t\t// tslint:disable-next-line triple-equals\n\t\t\tif (linkT.target._lvl != linkT.source._lvl) {\n\t\t\t\tif (linkT.target._lvl < linkT.source._lvl) {\n\t\t\t\t\ttask = \"source\";\n\t\t\t\t\ttargetLvl = linkT.target._lvl;\n\t\t\t\t} else {\n\t\t\t\t\ttask = \"target\";\n\t\t\t\t\ttargetLvl = linkT.source._lvl;\n\t\t\t\t}\n\n\t\t\t\tdo {\n\t\t\t\t\tconst parent = tasks[linkT[task].parent];\n\t\t\t\t\tif (!parent) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tlinkT[task] = parent;\n\t\t\t\t} while (linkT[task]._lvl < targetLvl);\n\n\t\t\t\tlet sourceParent = tasks[linkT.source.parent];\n\t\t\t\tlet\ttargetParent = tasks[linkT.target.parent];\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\twhile (sourceParent && targetParent && sourceParent.id != targetParent.id) {\n\t\t\t\t\tlinkT.source = sourceParent;\n\t\t\t\t\tlinkT.target = targetParent;\n\t\t\t\t\tsourceParent = tasks[linkT.source.parent];\n\t\t\t\t\ttargetParent = tasks[linkT.target.parent];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlink._target = linkT.target.id;\n\t\t\tlink._source = linkT.source.id;\n\n\t\t\tif (!linkT.target.$_target){\n\t\t\t\tlinkT.target.$_target = [];\n\t\t\t}\n\t\t\tlinkT.target.$_target.push(link.id);\n\n\t\t\tif (!linkT.source.$_source){\n\t\t\t\tlinkT.source.$_source = [];\n\t\t\t}\n\t\t\tlinkT.source.$_source.push(link.id);\n\t\t},\n\n\t\t_clearLinksSameLevel(links, tasks) {\n\t\t\tfor (const link in links) {\n\t\t\t\tdelete links[link]._target;\n\t\t\t\tdelete links[link]._source;\n\t\t\t}\n\n\t\t\tfor (const task in tasks) {\n\t\t\t\tdelete tasks[task].$_source;\n\t\t\t\tdelete tasks[task].$_target;\n\t\t\t}\n\t\t},\n\n\n\t\t_customProjectProperties(data, config) {\n\t\t\tif (config && config.project) {\n\t\t\t\tfor (const i in config.project) {\n\t\t\t\t\tif (!gantt.config.$custom_data){\n\t\t\t\t\t\tgantt.config.$custom_data = {};\n\t\t\t\t\t}\n\t\t\t\t\tgantt.config.$custom_data[i] = typeof config.project[i] === \"function\" ? config.project[i](gantt.config) : config.project[i];\n\t\t\t\t}\n\t\t\t\tdelete config.project;\n\t\t\t}\n\t\t},\n\n\t\t_customTaskProperties(data, config) {\n\t\t\tif (config && config.tasks) {\n\t\t\t\tdata.data.forEach(function(el) {\n\t\t\t\t\tfor (const i in config.tasks) {\n\t\t\t\t\t\tif (!el.$custom_data){\n\t\t\t\t\t\t\tel.$custom_data = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tel.$custom_data[i] = typeof config.tasks[i] === \"function\" ? config.tasks[i](el, gantt.config) : config.tasks[i];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tdelete config.tasks;\n\t\t\t}\n\t\t},\n\n\t\t_exportConfig(data, config) {\n\t\t\tconst projectName = config.name || \"gantt.xml\";\n\t\t\tdelete config.name;\n\n\t\t\tgantt.config.custom = config;\n\n\t\t\tconst time = gantt.ext.export_api._getWorktimeSettings();\n\n\t\t\tconst projectDates = gantt.getSubtaskDates();\n\t\t\tif (projectDates.start_date && projectDates.end_date) {\n\t\t\t\tconst formatDate = gantt.templates.format_date || gantt.templates.xml_format;\n\t\t\t\tgantt.config.start_end = {\n\t\t\t\t\tstart_date: formatDate(projectDates.start_date),\n\t\t\t\t\tend_date: formatDate(projectDates.end_date)\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst manual = config.auto_scheduling === undefined ? false : !!config.auto_scheduling;\n\n\t\t\tconst res = {\n\t\t\t\tcallback: config.callback || null,\n\t\t\t\tconfig: gantt.config,\n\t\t\t\tdata,\n\t\t\t\tmanual,\n\t\t\t\tname: projectName,\n\t\t\t\tworktime: time\n\t\t\t};\n\t\t\tfor (const i in config) {\n\t\t\t\tres[i] = config[i];\n\t\t\t}\n\t\t\treturn res;\n\t\t},\n\n\n\t\t_sendImportAjaxMSP(config) {\n\t\t\tconst url = config.server || gantt.ext.export_api._apiUrl;\n\t\t\tconst store = config.store || 0;\n\t\t\tconst formData = config.data;\n\t\t\tconst callback = config.callback;\n\n\t\t\tconst settings = {\n\t\t\t\tdurationUnit: config.durationUnit || undefined,\n\t\t\t\tprojectProperties: config.projectProperties || undefined,\n\t\t\t\ttaskProperties: config.taskProperties || undefined\n\t\t\t};\n\n\t\t\tformData.append(\"type\", config.type || \"msproject-parse\");\n\t\t\tformData.append(\"data\", JSON.stringify(settings));\n\n\t\t\tif (store){\n\t\t\t\tformData.append(\"store\", store);\n\t\t\t}\n\n\t\t\tconst xhr = new XMLHttpRequest();\n\t\t\txhr.onreadystatechange = function(e) {\n\t\t\t\tif (xhr.readyState === 4 && xhr.status === 0) {// network error\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.onload = function(){\n\t\t\t\tconst fail = xhr.status > 400;\n\t\t\t\tlet info = null;\n\n\t\t\t\tif (!fail) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinfo = JSON.parse(xhr.responseText);\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}\n\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback(info);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.open(\"POST\", url, true);\n\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\t\t\txhr.send(formData);\n\t\t}\n\n\t};\n\n\n\tgantt.exportToPDF = gantt.ext.export_api.exportToPDF;\n\tgantt.exportToPNG = gantt.ext.export_api.exportToPNG;\n\tgantt.exportToICal = gantt.ext.export_api.exportToICal;\n\tgantt.exportToExcel = gantt.ext.export_api.exportToExcel;\n\tgantt.exportToJSON = gantt.ext.export_api.exportToJSON;\n\tgantt.importFromExcel = gantt.ext.export_api.importFromExcel;\n\tgantt.importFromMSProject = gantt.ext.export_api.importFromMSProject;\n\tgantt.exportToMSProject = gantt.ext.export_api.exportToMSProject;\n\tgantt.importFromPrimaveraP6 = gantt.ext.export_api.importFromPrimaveraP6;\n\tgantt.exportToPrimaveraP6 = gantt.ext.export_api.exportToPrimaveraP6;\n\n\n\treturn gantt.ext.export_api;\n}\n","export default {\n\tKEY_CODES: {\n\t\tUP: 38,\n\t\tDOWN: 40,\n\t\tLEFT: 37,\n\t\tRIGHT: 39,\n\t\tSPACE: 32,\n\t\tENTER: 13,\n\t\tDELETE: 46,\n\t\tESC: 27,\n\t\tTAB: 9\n\t}\n};","export default class ExtensionsManager{\n\tprivate _extensions:{[key:string]: GanttPlugin };\n\n\tconstructor(config: {[key:string]: GanttPlugin }){\n\t\tthis._extensions = {};\n\t\tfor(const i in config){\n\t\t\tthis._extensions[i] = config[i];\n\t\t}\n\t}\n\n\taddExtension = (name: string, ext: GanttPlugin) => {\n\t\tthis._extensions[name] = ext;\n\t};\n\n\tgetExtension = (name: string): GanttPlugin => {\n\t\treturn this._extensions[name];\n\t};\n}","type DurationUnits = \"minute\" | \"hour\" | \"day\" | \"week\" | \"month\" | \"year\";\ntype Align = \"left\" | \"center\" | \"right\";\ntype SectionType = \"textarea\"\n\t\t\t\t\t| \"time\"\n\t\t\t\t\t| \"duration\"\n\t\t\t\t\t| \"select\"\n\t\t\t\t\t| \"typeselect\"\n\t\t\t\t\t| \"parent\"\n\t\t\t\t\t| \"template\"\n\t\t\t\t\t| \"checkbox\"\n\t\t\t\t\t| \"radio\"\n\t\t\t\t\t| \"resources\"\n\t\t\t\t\t| \"constraint\";\n\ntype LightboxSection = Array<ILightboxSection\n\t| ILightboxTimeAndDurationSection\n\t| ILightboxInputControl\n\t| ILightboxSelectControl\n\t| ILightboxParentControl\n\t| ILightboxTypeselectControl>;\n\ntype LayoutView = \"grid\"\n\t| \"timeline\"\n\t| \"resizer\"\n\t| \"scrollbar\"\n\t| \"resourceGrid\"\n\t| \"resourceTimeline\";\n\ninterface IColumnItem {\n\tname: string;\n\tlabel?: string;\n\ttree?: boolean;\n\talign?: Align;\n\thide?: boolean;\n\tmax_width?: number;\n\tmin_width?: number;\n\tresize?: boolean;\n\ttemplate?: (obj: any) => string;\n\twidth?: number | \"*\";\n}\n\nexport type TModifierKeys = \"metaKey\" | \"ctrlKey\" | \"altKey\" | \"shiftKey\" | false | undefined;\n\nexport interface IScale {\n\tcss?: () => string;\n\tdate?: string;\n\tstep: number;\n\ttemplate?: (date: Date) => string;\n\tunit: DurationUnits;\n}\n\ninterface ILightboxSection {\n\tname: string;\n\tmap_to: string;\n\ttype: SectionType;\n\theight?: number;\n\tfocus?: boolean;\n}\n\ninterface ILightboxTimeAndDurationSection extends ILightboxSection {\n\treadonly: boolean;\n\tyear_range: number[] | number;\n\tsingle_date: boolean;\n\ttime_format: string;\n}\n\ninterface ILightboxInputControl extends ILightboxSection {\n\tdefault_value?: any;\n\toptions?: Array<{key: string, label: string}>;\n}\n\ninterface ILightboxSelectControl extends ILightboxInputControl {\n\tonchange: () => boolean | undefined;\n}\n\ninterface ILightboxParentControl extends ILightboxSection {\n\tallow_root: boolean;\n\troot_label: string;\n\tsort?: (a: any, b: any) => -1 | 0 | 1;\n\tfilter?: (task: string | number | object) => boolean;\n\ttemplate?: (start: Date, end: Date, ev: object) => string;\n}\n\ninterface ILightboxTypeselectControl extends ILightboxSection {\n\tfilter?: (typeName: string) => boolean;\n}\n\n\ninterface ILayoutScrollbar {\n\tview: \"scrollbar\";\n\tscroll?: \"x\" | \"y\";\n\tid: string;\n\theight?: number;\n\twidth?: number;\n}\n\ninterface ILayoutView {\n\tview: LayoutView;\n\tid?: string;\n\tscrollX?: string;\n\tscrollY?: string;\n\tconfig?: object;\n}\n\ninterface ILayoutGrid extends ILayoutView {\n\tview: \"grid\";\n\tbind?: string;\n}\n\ninterface ILayoutTimeline extends ILayoutView {\n\tview: \"timeline\";\n\tbindLinks?: string;\n\tlayers?: any[];\n}\n\ninterface ILayoutResizer {\n\tview?: undefined;\n\tresizer: boolean;\n\twidth: number;\n}\n\ninterface ILayoutResourceGrid extends ILayoutView {\n\tview: \"resourceGrid\";\n\twidth: number;\n\tgroup: \"string\";\n}\n\ninterface ILayoutResourceTimeline extends ILayoutView {\n\tview: \"resourceTimeline\";\n\twidth: number;\n\tgroup: \"string\";\n}\n\ninterface ILayoutHtml {\n\thtml: string;\n\tcss: string;\n\twidth: number;\n}\n\ntype LayoutRow = ILayoutGrid\n\t| ILayoutTimeline\n\t| ILayoutResizer\n\t| ILayoutResourceGrid\n\t| ILayoutResourceTimeline\n\t| ILayoutHtml\n\t| ILayoutScrollbar\n\t| { cols: LayoutCol[] };\n\ntype LayoutCol = ILayoutGrid\n\t| ILayoutTimeline\n\t| ILayoutResizer\n\t| ILayoutResourceGrid\n\t| ILayoutResourceTimeline\n\t| ILayoutHtml\n\t| ILayoutScrollbar\n\t| { rows: LayoutRow[] };\n\ninterface ILayout {\n\tcss: string;\n\trows?: LayoutRow[];\n\tcols?: LayoutCol[];\n}\n\ntype TCsp = boolean | \"auto\";\n\ninterface IResourceConfig {\n\tdataprocessor_assignments?: boolean;\n\tdataprocessor_resources?: boolean;\n\teditable_resource_diagram?: boolean;\n\tresource_store?: {\n\t\ttype?: \"treeDataStore\"|\"dataStore\"|string;\n\t\tfetchTasks?: boolean;\n\t\tinitItem?: (item: any) => any;\n\t};\n\tlightbox_resources?: (resources: any[]) => any[];\n\n}\n\ninterface IGanttConfig {\n\tlayout: ILayout;\n\tlinks: {\n\t\tfinish_to_start: \"0\";\n\t\tstart_to_start: \"1\";\n\t\tfinish_to_finish: \"2\";\n\t\tstart_to_finish: \"3\";\n\t};\n\ttypes: {\n\t\ttask: string;\n\t\tproject: string;\n\t\tmilestone: string;\n\t};\n\tauto_types: boolean;\n\tduration_unit: DurationUnits;\n\twork_time: boolean;\n\tcorrect_work_time: boolean;\n\tdeadlines: boolean;\n\tskip_off_time: boolean;\n\tcascade_delete: boolean;\n\tautosize: boolean | string;\n\tautoscroll: boolean;\n\tshow_links: boolean;\n\tshow_task_cells: boolean;\n\tautosize_min_width: number;\n\tautoscroll_speed: number;\n\tdeepcopy_on_parse: boolean;\n\tstatic_background: boolean;\n\tstatic_background_cells: boolean;\n\tbranch_loading: boolean;\n\tbranch_loading_property: string;\n\tshow_loading: boolean;\n\tshow_chart: boolean;\n\tshow_grid: boolean;\n\tmin_duration: number;\n\tdate_format: string; // use instead xml_date\n\txml_date?: string; // deprecated\n\tstart_on_monday: boolean;\n\tserver_utc: boolean;\n\tshow_progress: boolean;\n\tfit_tasks: boolean;\n\tselect_task: boolean;\n\tscroll_on_click: boolean;\n\tsmart_rendering: boolean;\n\tpreserve_scroll: boolean;\n\treadonly: boolean;\n\tcontainer_resize_timeout: number;\n\n\t/*grid */\n\tdate_grid: string;\n\n\tdrag_links: boolean;\n\tdrag_progress: boolean;\n\tdrag_resize: boolean;\n\tdrag_project: boolean;\n\tdrag_move: boolean;\n\tdrag_mode: {\n\t\tresize: \"resize\",\n\t\tprogress: \"progress\",\n\t\tmove: \"move\",\n\t\tignore: \"ignore\"\n\t};\n\tround_dnd_dates: boolean;\n\tlink_wrapper_width: number;\n\troot_id: string | number;\n\n\tlink_arrow_size:number;\n\n\tautofit: boolean;\n\tcolumns: IColumnItem[];\n\n\t/* scale*/\n\t/* it will be deprecated */\n\tdate_scale?: string;\n\tstep?: number;\n\tscale_unit?: DurationUnits;\n\tsubscales?: IScale[];\n\t/* it will be deprecated end */\n\n\tscales: IScale[];\n\n\tscale_offset_minimal: boolean;\n\n\tinherit_scale_class: boolean;\n\n\n\ttime_step: number;\n\tduration_step: number;\n\n\n\ttask_date: string;\n\ttime_picker: string;\n\ttask_attribute: string;\n\tlink_attribute: string;\n\tlayer_attribute: string;\n\tbuttons_left: string[];\n\t_migrate_buttons: {\n\t\tdhx_save_btn: \"gantt_save_btn\",\n\t\tdhx_cancel_btn: \"gantt_cancel_btn\",\n\t\tdhx_delete_btn: \"gantt_delete_btn\"\n\t};\n\n\tbuttons_right: string[];\n\n\n\tlightbox: {\n\t\tsections?: LightboxSection,\n\t\tproject_sections?: LightboxSection,\n\t\tmilestone_sections?: LightboxSection\n\t};\n\tdrag_lightbox: boolean;\n\tsort: boolean;\n\tdetails_on_create: boolean;\n\tdetails_on_dblclick: boolean;\n\tinitial_scroll: boolean;\n\ttask_scroll_offset: number;\n\n\torder_branch: boolean;\n\torder_branch_free: boolean;\n\n\t// task_height is deprecated, use 'bar_height` instead\n\ttask_height: number | \"full\" | undefined;\n\tbar_height: number | \"full\";\n\tmin_column_width: number;\n\tbar_height_padding: number,\n\trow_height: number,\n\n\t// min width for grid column (when resizing)\n\tmin_grid_column_width: number;\n\t// name of the attribute with column index for resize element\n\tgrid_resizer_column_attribute: string;\n\t// name of the attribute with column index for resize element\n\t// grid_resizer_attribute: string; // usage of this parameter is not found\n\n\t// grid width can be increased after the column has been resized\n\tkeep_grid_width: boolean;\n\n\t// grid width can be adjusted\n\tgrid_resize: boolean;\n\tgrid_elastic_columns: boolean;\n\tshow_tasks_outside_timescale: boolean;\n\tshow_unscheduled: boolean;\n\treadonly_property: string;\n\teditable_property: string;\n\tcalendar_property: string;\n\tresource_calendars: object;\n\tdynamic_resource_calendars: boolean;\n\tinherit_calendar: boolean;\n\ttype_renderers: object;\n\n\tresize_rows: boolean;\n\t// name of the attribute with row index for resize element\n\ttask_grid_row_resizer_attribute: string;\n\t// min height for row (when resizing)\n\tmin_task_grid_row_height: number;\n\n\topen_tree_initially: boolean;\n\toptimize_render: boolean;\n\tprevent_default_scroll: boolean;\n\tshow_errors: boolean;\n\twai_aria_attributes: boolean;\n\tsmart_scales: boolean;\n\trtl: boolean;\n\tplaceholder_task: boolean | object;\n\thorizontal_scroll_key: TModifierKeys;\n\tdrag_timeline: {\n\t\tuseKey: TModifierKeys;\n\t\tignore: string;\n\t\trender?: boolean;\n\t};\n\tdrag_multiple: boolean;\n\tcsp: TCsp;\n\n\tresources?: IResourceConfig;\n}\n\nexport default () => {\n\tconst result: IGanttConfig = {\n\t\tlayout: {\n\t\t\tcss: \"gantt_container\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{view: \"grid\", scrollX: \"scrollHor\", scrollY: \"scrollVer\"},\n\t\t\t\t\t\t{resizer: true, width: 1},\n\t\t\t\t\t\t{view: \"timeline\", scrollX: \"scrollHor\", scrollY: \"scrollVer\"},\n\t\t\t\t\t\t{view: \"scrollbar\", id: \"scrollVer\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{view: \"scrollbar\", id: \"scrollHor\", height: 20}\n\t\t\t]\n\t\t},\n\t\tlinks: {\n\t\t\tfinish_to_start: \"0\",\n\t\t\tstart_to_start: \"1\",\n\t\t\tfinish_to_finish: \"2\",\n\t\t\tstart_to_finish: \"3\"\n\t\t},\n\t\ttypes: {\n\t\t\ttask: \"task\",\n\t\t\tproject: \"project\",\n\t\t\tmilestone: \"milestone\"\n\t\t},\n\t\tauto_types: false,\n\t\tduration_unit: \"day\",\n\t\twork_time: false,\n\t\tcorrect_work_time: false,\n\t\tskip_off_time: false,\n\n\t\tcascade_delete: true,\n\n\t\tautosize: false,\n\t\tautosize_min_width: 0,\n\t\tautoscroll: true,\n\t\tautoscroll_speed: 30,\n\t\tdeepcopy_on_parse: false,\n\t\tshow_links: true,\n\t\tshow_task_cells: true,\n\t\t// replace backgroung of the task area with a canvas img\n\t\tstatic_background: false,\n\t\tstatic_background_cells: true,\n\t\tbranch_loading: false,\n\t\tbranch_loading_property: \"$has_child\",\n\t\tshow_loading: false,\n\t\tshow_chart: true,\n\t\tshow_grid: true,\n\t\tmin_duration: 60 * 60 * 1000,\n\t\tdate_format: \"%d-%m-%Y %H:%i\", // use instead xml_date\n\t\txml_date: undefined, // \"%d-%m-%Y %H:%i\", // deprecated\n\t\tstart_on_monday: true,\n\t\tserver_utc: false,\n\t\tshow_progress: true,\n\t\tfit_tasks: false,\n\t\tselect_task: true,\n\t\tscroll_on_click: true,\n\t\tsmart_rendering: true,\n\t\tpreserve_scroll: true,\n\t\treadonly: false,\n\t\tcontainer_resize_timeout: 20,\n\t\tdeadlines: true,\n\n\t\t/*grid */\n\t\tdate_grid: \"%Y-%m-%d\",\n\n\t\tdrag_links: true,\n\t\tdrag_progress: true,\n\t\tdrag_resize: true,\n\t\tdrag_project: false,\n\t\tdrag_move: true,\n\t\tdrag_mode: {\n\t\t\tresize: \"resize\",\n\t\t\tprogress: \"progress\",\n\t\t\tmove: \"move\",\n\t\t\tignore: \"ignore\"\n\t\t},\n\t\tround_dnd_dates: true,\n\t\tlink_wrapper_width: 20,\n\t\tlink_arrow_size:12,\n\t\troot_id: 0,\n\n\t\tautofit: false, // grid column automatic fit grid_width config\n\t\tcolumns: [\n\t\t\t{name: \"text\", tree: true, width: \"*\", resize: true},\n\t\t\t{name: \"start_date\", align: \"center\", resize: true},\n\t\t\t{name: \"duration\", align: \"center\"},\n\t\t\t{name: \"add\", width: 44}\n\t\t],\n\n\t\t/*scale*/\n\n\t\tscale_offset_minimal: true,\n\t\tinherit_scale_class: false,\n\n\t\tscales: [\n\t\t\t{\n\t\t\t\tunit: \"day\",\n\t\t\t\tstep: 1,\n\t\t\t\tdate: \"%d %M\"\n\t\t\t}\n\t\t],\n// \t\tdate_scale: \"%d %M\",\n\n\t\ttime_step: 60,\n\t\tduration_step: 1,\n\t\ttask_date: \"%d %F %Y\",\n\t\ttime_picker: \"%H:%i\",\n\t\ttask_attribute: \"data-task-id\",\n\t\tlink_attribute: \"data-link-id\",\n\t\tlayer_attribute: \"data-layer\",\n\t\tbuttons_left: [\n\t\t\t\"gantt_save_btn\",\n\t\t\t\"gantt_cancel_btn\"\n\t\t],\n\t\t_migrate_buttons: {\n\t\t\tdhx_save_btn: \"gantt_save_btn\",\n\t\t\tdhx_cancel_btn: \"gantt_cancel_btn\",\n\t\t\tdhx_delete_btn: \"gantt_delete_btn\"\n\t\t},\n\t\tbuttons_right: [\n\t\t\t\"gantt_delete_btn\"\n\t\t],\n\t\tlightbox: {\n\t\t\tsections: [\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t\t{name: \"time\", type: \"duration\", map_to: \"auto\"}\n\t\t\t],\n\t\t\tproject_sections: [\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t\t{name: \"type\", type: \"typeselect\", map_to: \"type\"},\n\t\t\t\t{name: \"time\", type: \"duration\", readonly: true, map_to: \"auto\"}\n\t\t\t],\n\t\t\tmilestone_sections: [\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t\t{name: \"type\", type: \"typeselect\", map_to: \"type\"},\n\t\t\t\t{name: \"time\", type: \"duration\", single_date: true, map_to: \"auto\"}\n\t\t\t]\n\t\t},\n\t\tdrag_lightbox: true,\n\t\tsort: false,\n\t\tdetails_on_create: true,\n\t\tdetails_on_dblclick: true,\n\t\tinitial_scroll: true,\n\t\ttask_scroll_offset: 100,\n\n\t\torder_branch: false,\n\t\torder_branch_free: false,\n\n\t\t// task height is deprecated, use 'bar_height' instead\n\t\ttask_height: undefined,// number px of 'full' for row height\n\t\tbar_height: \"full\",\n\t\tbar_height_padding:9,\n\t\tmin_column_width: 70,\n\n\t\t// min width for grid column (when resizing)\n\t\tmin_grid_column_width: 70,\n\t\t// name of the attribute with column index for resize element\n\t\tgrid_resizer_column_attribute: \"data-column-index\",\n\t\t// name of the attribute with column index for resize element\n\t\t// grid_resizer_attribute: \"grid_resizer\", // - usage of this parameter is not found in code\n\n\t\t// grid width can be increased after the column has been resized\n\t\tkeep_grid_width: false,\n\n\t\t// grid width can be adjusted\n\t\tgrid_resize: false,\n\t\tgrid_elastic_columns: false,\n\t\tshow_tasks_outside_timescale: false,\n\t\tshow_unscheduled: true,\n\n\t\tresize_rows: false,\n\t\t// name of the attribute with row index for resize element\n\t\ttask_grid_row_resizer_attribute: \"data-row-index\",\n\t\t// min height for row (when resizing)\n\t\tmin_task_grid_row_height: 30,\n\t\trow_height: 36,\n\n\t\t//\n\t\treadonly_property: \"readonly\",\n\t\teditable_property: \"editable\",\n\t\tcalendar_property: \"calendar_id\",\n\t\tresource_calendars: {},\n\t\tdynamic_resource_calendars: false,\n\t\tinherit_calendar: false,\n\t\ttype_renderers: {},\n\n\t\topen_tree_initially: false,\n\t\toptimize_render: true,\n\t\tprevent_default_scroll: false,\n\t\tshow_errors: true,\n\t\twai_aria_attributes: true,\n\t\tsmart_scales: true,\n\t\trtl:false,\n\t\tplaceholder_task: false,\n\t\thorizontal_scroll_key: \"shiftKey\",\n\t\tdrag_timeline: {\n\t\t\tuseKey: undefined,\n\t\t\tignore: \".gantt_task_line, .gantt_task_link\",\n\t\t\trender: false\n\t\t},\n\t\tdrag_multiple: true,\n\t\tcsp: \"auto\"\n\t};\n\treturn result;\n};\n","/* eslint-disable no-restricted-globals */\nvar isWindowAwailable = typeof window !== \"undefined\";\n\n/* eslint-enable no-restricted-globals */\n\nexport default {\n\tisIE: isWindowAwailable && (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0),\n\tisIE6: isWindowAwailable && (!XMLHttpRequest && navigator.userAgent.indexOf(\"MSIE\") >= 0),\n\tisIE7: isWindowAwailable && (navigator.userAgent.indexOf(\"MSIE 7.0\") >= 0 && navigator.userAgent.indexOf(\"Trident\") < 0),\n\tisIE8: isWindowAwailable && (navigator.userAgent.indexOf(\"MSIE 8.0\") >= 0 && navigator.userAgent.indexOf(\"Trident\") >= 0),\n\tisOpera: isWindowAwailable && (navigator.userAgent.indexOf(\"Opera\") >= 0),\n\tisChrome: isWindowAwailable && (navigator.userAgent.indexOf(\"Chrome\") >= 0),\n\tisKHTML: isWindowAwailable && (navigator.userAgent.indexOf(\"Safari\") >= 0 || navigator.userAgent.indexOf(\"Konqueror\") >= 0),\n\tisFF: isWindowAwailable && (navigator.userAgent.indexOf(\"Firefox\") >= 0),\n\tisIPad: isWindowAwailable && (navigator.userAgent.search(/iPad/gi) >= 0),\n\tisEdge: isWindowAwailable && (navigator.userAgent.indexOf(\"Edge\")!=-1),\n\tisNode: (!isWindowAwailable || typeof navigator == \"undefined\" || (typeof PRODUCTION !== \"undefined\" && PRODUCTION === \"test\"))\n};\n","export default function serialize(data: object | string) {\n\tif (typeof data === \"string\" || typeof data === \"number\") {\n\t\treturn data;\n\t}\n\n\tlet result = \"\";\n\n\tfor (const key in data) {\n\t\tlet serialized = \"\";\n\t\tif (data.hasOwnProperty(key)) {\n\t\t\tif (typeof data[key] === \"string\") {\n\t\t\t\tserialized = encodeURIComponent(data[key]);\n\t\t\t} else if (typeof data[key] === \"number\") {\n\t\t\t\tserialized = String(data[key]);\n\t\t\t} else {\n\t\t\t\tserialized = encodeURIComponent(JSON.stringify(data[key]));\n\t\t\t}\n\t\t\tserialized = key + \"=\" + serialized;\n\n\t\t\tif (result.length) {\n\t\t\t\tserialized = \"&\" + serialized;\n\t\t\t}\n\t\t\tresult += serialized;\n\t\t}\n\t}\n\treturn result;\n}\n","import env from \"../../utils/env\";\nimport global from \"../../utils/global\";\nimport serialize from \"./serialize\";\n\nfunction createConfig(method, args) {\n\tvar result = {\n\t\tmethod: method\n\t};\n\n\tif (args.length === 0) {\n\t\tthrow new Error(\"Arguments list of query is wrong.\");\n\t}\n\tif (args.length === 1) {\n\t\tif (typeof args[0] === \"string\") {\n\t\t\tresult.url = args[0];\n\t\t\tresult.async = true;\n\t\t} else {\n\t\t\tresult.url = args[0].url;\n\t\t\tresult.async = (args[0].async || true);\n\t\t\tresult.callback = args[0].callback;\n\t\t\tresult.headers = args[0].headers;\n\t\t}\n\t\tif (method === \"POST\" || \"PUT\") {\n\t\t\tif (args[0].data) {\n\t\t\t\tif (typeof args[0].data !== \"string\") {\n\t\t\t\t\tresult.data = serialize(args[0].data);\n\t\t\t\t} else {\n\t\t\t\t\tresult.data = args[0].data;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.data = \"\";\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tresult.url = args[0];\n\tswitch(method) {\n\t\tcase \"GET\":\n\t\tcase \"DELETE\":\n\t\t\tresult.callback = args[1];\n\t\t\tresult.headers = args[2];\n\t\tbreak;\n\t\tcase \"POST\":\n\t\tcase \"PUT\":\n\t\t\tif (args[1]) {\n\t\t\t\tif (typeof args[1] !== \"string\") {\n\t\t\t\t\tresult.data = serialize(args[1]);\n\t\t\t\t} else {\n\t\t\t\t\tresult.data = args[1];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.data = \"\";\n\t\t\t}\n\t\t\tresult.callback = args[2];\n\t\t\tresult.headers = args[3];\n\t\tbreak;\n\t}\n\treturn result;\n}\n\nexport default function(gantt) {\n\treturn {\n\n\t\t// if false - dhxr param will added to prevent caching on client side (default),\n\t\t// if true - do not add extra params\n\t\tcache: true,\n\n\t\t// default method for load/loadStruct, post/get allowed\n\t\t// get - since 4.1.1, this should fix 412 error for macos safari\n\t\tmethod: \"get\",\n\n\t\tparse: function(data) {\n\t\t\tif (typeof data !== \"string\") return data;\n\n\t\t\tvar obj;\n\t\t\tdata = data.replace(/^[\\s]+/,\"\");\n\t\t\tif (typeof DOMParser !== \"undefined\" && !env.isIE) { // ff,ie9\n\t\t\t\tobj = (new DOMParser()).parseFromString(data, \"text/xml\");\n\t\t\t} else if (typeof global.ActiveXObject !== \"undefined\") {\n\t\t\t\tobj = new global.ActiveXObject(\"Microsoft.XMLDOM\");\n\t\t\t\tobj.async = \"false\";\n\t\t\t\tobj.loadXML(data);\n\t\t\t}\n\t\t\treturn obj;\n\t\t},\n\t\txmltop: function(tagname, xhr, obj) {\n\t\t\tif (typeof xhr.status == \"undefined\" || xhr.status < 400) {\n\t\t\t\tvar xml = (!xhr.responseXML) ? this.parse(xhr.responseText || xhr) : (xhr.responseXML || xhr);\n\t\t\t\tif (xml && xml.documentElement !== null && !xml.getElementsByTagName(\"parsererror\").length) {\n\t\t\t\t\treturn xml.getElementsByTagName(tagname)[0];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (obj !== -1) gantt.callEvent(\"onLoadXMLError\",[\"Incorrect XML\", arguments[1], obj]);\n\t\t\treturn document.createElement(\"DIV\");\n\t\t},\n\t\txpath: function(xpathExp, docObj) {\n\t\t\tif (!docObj.nodeName) docObj = docObj.responseXML || docObj;\n\t\t\tif (env.isIE) {\n\t\t\t\treturn docObj.selectNodes(xpathExp)||[];\n\t\t\t} else {\n\t\t\t\tvar rows = [];\n\t\t\t\tvar first;\n\t\t\t\tvar col = (docObj.ownerDocument||docObj).evaluate(xpathExp, docObj, null, XPathResult.ANY_TYPE, null);\n\n\t\t\t\twhile (true){\n\t\t\t\t\tfirst = col.iterateNext();\n\t\t\t\t\tif(first){\n\t\t\t\t\t\trows.push(first);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn rows;\n\t\t\t}\n\t\t},\n\t\tquery: function(config) {\n\t\t\treturn this._call(\n\t\t\t\t(config.method || \"GET\"),\n\t\t\t\tconfig.url,\n\t\t\t\tconfig.data || \"\",\n\t\t\t\t(config.async || true),\n\t\t\t\tconfig.callback,\n\t\t\t\tconfig.headers\n\t\t\t);\n\t\t},\n\t\tget: function(url, onLoad, headers) {\n\t\t\tvar config = createConfig(\"GET\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tgetSync: function(url, headers) {\n\t\t\tvar config = createConfig(\"GET\", arguments);\n\t\t\tconfig.async = false;\n\t\t\treturn this.query(config);\n\t\t},\n\t\tput: function(url, postData, onLoad, headers) {\n\t\t\tvar config = createConfig(\"PUT\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tdel: function(url, onLoad, headers) {\n\t\t\t/**\n\t\t\t * https://tools.ietf.org/html/rfc7231#section-4.3.5\n\t\t\t * A payload within a DELETE request message has no defined semantics;\n\t\t\t * sending a payload body on a DELETE request might cause some existing\n\t\t\t * implementations to reject the request.\n\t\t\t */\n\t\t\tvar config = createConfig(\"DELETE\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tpost: function(url, postData, onLoad, headers) {\n\t\t\tif (arguments.length == 1) {\n\t\t\t\tpostData = \"\";\n\t\t\t} else if (arguments.length == 2 && typeof(postData) == \"function\") {\n\t\t\t\tonLoad = postData;\n\t\t\t\tpostData = \"\";\n\t\t\t}\n\t\t\tvar config = createConfig(\"POST\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tpostSync: function(url, postData, headers) {\n\t\t\tpostData = (postData === null ? \"\" : String(postData));\n\n\t\t\tvar config = createConfig(\"POST\", arguments);\n\t\t\tconfig.async = false;\n\t\t\treturn this.query(config);\n\t\t},\n\t\t_call: function(method, url, postData, async, onLoad, headers) {\n\t\t\treturn new gantt.Promise(function(resolve, reject) {\n\t\t\t\tvar t = (typeof XMLHttpRequest !== undefined ? new XMLHttpRequest() : new global.ActiveXObject(\"Microsoft.XMLHTTP\"));\n\t\t\t\tvar isQt = (navigator.userAgent.match(/AppleWebKit/) !== null && navigator.userAgent.match(/Qt/) !== null && navigator.userAgent.match(/Safari/) !== null);\n\n\t\t\t\tif (!!async) {\n\t\t\t\t\tt.onreadystatechange = function() {\n\t\t\t\t\t\tif ((t.readyState == 4) || (isQt && t.readyState == 3)) { // what for long response and status 404?\n\t\t\t\t\t\t\tif (t.status != 200 || t.responseText === \"\")\n\t\t\t\t\t\t\t\tif (!gantt.callEvent(\"onAjaxError\", [t])) return;\n\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tif (typeof(onLoad) == \"function\") {\n\t\t\t\t\t\t\t\t\tonLoad.apply(global, [{xmlDoc:t, filePath:url}]); // dhtmlx-compat, response.xmlDoc.responseXML/responseText\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tresolve(t);\n\t\t\t\t\t\t\t\tif (typeof(onLoad) == \"function\") {\n\t\t\t\t\t\t\t\t\tonLoad = null;\n\t\t\t\t\t\t\t\t\tt = null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar noCache = !this || !this.cache;\n\t\t\t\tif (method == \"GET\" && noCache) {\n\t\t\t\t\turl += (url.indexOf(\"?\")>=0?\"&\":\"?\")+\"dhxr\"+new Date().getTime()+\"=1\";\n\t\t\t\t}\n\n\t\t\t\tt.open(method, url, async);\n\n\t\t\t\tif (headers){\n\t\t\t\t\tfor (var key in headers)\n\t\t\t\t\t\tt.setRequestHeader(key, headers[key]);\n\t\t\t\t} else if (method.toUpperCase() == \"POST\" || method == \"PUT\" || method == \"DELETE\") {\n\t\t\t\t\tt.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n\t\t\t\t} else if (method == \"GET\") {\n\t\t\t\t\tpostData = null;\n\t\t\t\t}\n\n\t\t\t\tt.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\n\t\t\t\tt.send(postData);\n\n\t\t\t\tif (!async) return {xmlDoc:t, filePath:url}; // dhtmlx-compat, response.xmlDoc.responseXML/responseText\n\t\t\t});\n\t\t},\n\t\turlSeparator: function(str){\n\t\t\tif (str.indexOf(\"?\") != -1)\n\t\t\t\treturn \"&\";\n\t\t\telse\n\t\t\t\treturn \"?\";\n\t\t}\n\t};\n};\n","const dateToStr = (format: string, utc: boolean, gantt) => {\n\tformat = format.replace(/%[a-zA-Z]/g, (a) => {\n\t\tswitch (a) {\n\t\t\tcase \"%d\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Date())+\"`;\n\t\t\tcase \"%m\":\n\t\t\t\treturn `\"+to_fixed((date.get${utc?\"UTC\":\"\"}Month()+1))+\"`;\n\t\t\tcase \"%j\":\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}Date()+\"`;\n\t\t\tcase \"%n\":\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Month()+1)+\"`;\n\t\t\tcase \"%y\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}FullYear()%100)+\"`;\n\t\t\tcase \"%Y\":\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}FullYear()+\"`;\n\t\t\tcase \"%D\":\n\t\t\t\treturn `\"+locale.date.day_short[date.get${utc?\"UTC\":\"\"}Day()]+\"`;\n\t\t\tcase \"%l\":\n\t\t\t\treturn `\"+locale.date.day_full[date.get${utc?\"UTC\":\"\"}Day()]+\"`;\n\t\t\tcase \"%M\":\n\t\t\t\treturn `\"+locale.date.month_short[date.get${utc?\"UTC\":\"\"}Month()]+\"`;\n\t\t\tcase \"%F\":\n\t\t\t\treturn `\"+locale.date.month_full[date.get${utc?\"UTC\":\"\"}Month()]+\"`;\n\t\t\tcase \"%h\":\n\t\t\t\treturn `\"+to_fixed((date.get${utc?\"UTC\":\"\"}Hours()+11)%12+1)+\"`;\n\t\t\tcase \"%g\":\n\t\t\t\treturn `\"+((date.get${utc?\"UTC\":\"\"}Hours()+11)%12+1)+\"`;\n\t\t\tcase \"%G\":\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}Hours()+\"`;\n\t\t\tcase \"%H\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Hours())+\"`;\n\t\t\tcase \"%i\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Minutes())+\"`;\n\t\t\tcase \"%a\":\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Hours()>11?\"pm\":\"am\")+\"`;\n\t\t\tcase \"%A\":\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Hours()>11?\"PM\":\"AM\")+\"`;\n\t\t\tcase \"%s\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Seconds())+\"`;\n\t\t\tcase \"%W\":\n\t\t\t\treturn `\"+to_fixed(getISOWeek(date))+\"`;\n\t\t\tcase \"%w\":\n\t\t\t\treturn `\"+to_fixed(getWeek(date))+\"`;\n\t\t\tdefault:\n\t\t\t\treturn a;\n\t\t}\n\t});\n\n\t// tslint:disable-next-line: function-constructor\n\tconst dateToStrFn = new Function(\"date\", \"to_fixed\", \"locale\", \"getISOWeek\", \"getWeek\", `return \"${format}\";`);\n\n\treturn (date: Date) => {\n\t\treturn dateToStrFn(date, gantt.date.to_fixed, gantt.locale, gantt.date.getISOWeek, gantt.date.getWeek);\n\t};\n};\n\n\nconst strToDate = (format: string, utc: boolean, gantt:any) => {\n\tlet splt = \"var temp=date.match(/[a-zA-Z]+|[0-9]+/g);\";\n\tconst mask = format.match(/%[a-zA-Z]/g);\n\tfor (let i = 0; i < mask.length; i++) {\n\t\tswitch (mask[i]) {\n\t\t\tcase \"%j\":\n\t\t\tcase \"%d\":\n\t\t\t\tsplt += `set[2]=temp[${i}]||1;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%n\":\n\t\t\tcase \"%m\":\n\t\t\t\tsplt += `set[1]=(temp[${i}]||1)-1;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%y\":\n\t\t\t\tsplt += `set[0]=temp[${i}]*1+(temp[${i}]>50?1900:2000);`;\n\t\t\t\tbreak;\n\t\t\tcase \"%g\":\n\t\t\tcase \"%G\":\n\t\t\tcase \"%h\":\n\t\t\tcase \"%H\":\n\t\t\t\tsplt += `set[3]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%i\":\n\t\t\t\tsplt += `set[4]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%Y\":\n\t\t\t\tsplt += `set[0]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%a\":\n\t\t\tcase \"%A\":\n\t\t\t\tsplt += `set[3]=set[3]%12+((temp[${i}]||'').toLowerCase()=='am'?0:12);`;\n\t\t\t\tbreak;\n\t\t\tcase \"%s\":\n\t\t\t\tsplt += `set[5]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%M\":\n\t\t\t\tsplt += `set[1]=locale.date.month_short_hash[temp[${i}]]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%F\":\n\t\t\t\tsplt += `set[1]=locale.date.month_full_hash[temp[${i}]]||0;`;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tlet code = \"set[0],set[1],set[2],set[3],set[4],set[5]\";\n\tif (utc) { code = ` Date.UTC(${code})`; }\n\t// tslint:disable-next-line: function-constructor\n\tconst strToDateFn = new Function(\"date\", \"locale\", `var set=[0,0,1,0,0,0]; ${splt} return new Date(${code});`);\n\n\treturn (dateString) => {\n\t\treturn strToDateFn(dateString, gantt.locale);\n\t};\n};\n\nconst fastVersion = {\n\tdate_to_str: dateToStr,\n\tstr_to_date: strToDate\n};\n\nexport default fastVersion;","const dateToStr = (format: string, utc: boolean, gantt) => {\n\treturn (date) => {\n\t\treturn format.replace(/%[a-zA-Z]/g, (a) => {\n\t\t\tswitch (a) {\n\t\t\t\tcase \"%d\": return utc ? gantt.date.to_fixed(date.getUTCDate()) : gantt.date.to_fixed(date.getDate());\n\t\t\t\tcase \"%m\": return utc ? gantt.date.to_fixed((date.getUTCMonth() + 1)) : gantt.date.to_fixed((date.getMonth() + 1));\n\t\t\t\tcase \"%j\": return utc ? date.getUTCDate() : date.getDate();\n\t\t\t\tcase \"%n\": return utc ? (date.getUTCMonth() + 1) : (date.getMonth() + 1);\n\t\t\t\tcase \"%y\": return utc ? gantt.date.to_fixed(date.getUTCFullYear() % 100) : gantt.date.to_fixed(date.getFullYear() % 100);\n\t\t\t\tcase \"%Y\": return utc ? date.getUTCFullYear() : date.getFullYear();\n\t\t\t\tcase \"%D\": return utc ? gantt.locale.date.day_short[date.getUTCDay()] : gantt.locale.date.day_short[date.getDay()];\n\t\t\t\tcase \"%l\": return utc ? gantt.locale.date.day_full[date.getUTCDay()] : gantt.locale.date.day_full[date.getDay()];\n\t\t\t\tcase \"%M\": return utc ? gantt.locale.date.month_short[date.getUTCMonth()] : gantt.locale.date.month_short[date.getMonth()];\n\t\t\t\tcase \"%F\": return utc ? gantt.locale.date.month_full[date.getUTCMonth()] : gantt.locale.date.month_full[date.getMonth()];\n\t\t\t\tcase \"%h\": return utc ? gantt.date.to_fixed((date.getUTCHours() + 11) % 12 + 1) : gantt.date.to_fixed((date.getHours() + 11) % 12 + 1);\n\t\t\t\tcase \"%g\": return utc ? ((date.getUTCHours() + 11) % 12 + 1) : ((date.getHours() + 11) % 12 + 1);\n\t\t\t\tcase \"%G\": return utc ? date.getUTCHours() : date.getHours();\n\t\t\t\tcase \"%H\": return utc ? gantt.date.to_fixed(date.getUTCHours()) : gantt.date.to_fixed(date.getHours());\n\t\t\t\tcase \"%i\": return utc ? gantt.date.to_fixed(date.getUTCMinutes()) : gantt.date.to_fixed(date.getMinutes());\n\t\t\t\tcase \"%a\": return utc ? (date.getUTCHours() > 11 ? \"pm\" : \"am\") : (date.getHours() > 11 ? \"pm\" : \"am\");\n\t\t\t\tcase \"%A\": return utc ? (date.getUTCHours() > 11 ? \"PM\" : \"AM\") : (date.getHours() > 11 ? \"PM\" : \"AM\");\n\t\t\t\tcase \"%s\": return utc ? gantt.date.to_fixed(date.getUTCSeconds()) : gantt.date.to_fixed(date.getSeconds());\n\t\t\t\tcase \"%W\": return utc ? gantt.date.to_fixed(gantt.date.getUTCISOWeek(date)) : gantt.date.to_fixed(gantt.date.getISOWeek(date));\n\t\t\t\tdefault: return a;\n\t\t\t}\n\t\t});\n\t};\n};\nconst strToDate = (format: string, utc: boolean, gantt:any) => {\n\treturn (date: string) => {\n\t\tconst set: Array<string|number> = [0, 0, 1, 0, 0, 0];\n\t\tconst temp = date.match(/[a-zA-Z]+|[0-9]+/g);\n\t\tconst mask = format.match(/%[a-zA-Z]/g);\n\n\t\tfor (let i = 0; i < mask.length; i++) {\n\t\t\tswitch (mask[i]) {\n\t\t\t\tcase \"%j\":\n\t\t\t\tcase \"%d\":\n\t\t\t\t\tset[2] = temp[i] as unknown as number || 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%n\":\n\t\t\t\tcase \"%m\":\n\t\t\t\t\tset[1] = (temp[i] as unknown as number || 1) - 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%y\":\n\t\t\t\t\tset[0] = temp[i] as unknown as number * 1 + ((temp[i] as unknown as number) > 50 ? 1900 : 2000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%g\":\n\t\t\t\tcase \"%G\":\n\t\t\t\tcase \"%h\":\n\t\t\t\tcase \"%H\":\n\t\t\t\t\tset[3] = temp[i] as unknown as number || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%i\":\n\t\t\t\t\tset[4] = temp[i] as unknown as number || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%Y\":\n\t\t\t\t\tset[0] = temp[i] as unknown as number || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%a\":\n\t\t\t\tcase \"%A\":\n\t\t\t\t\tset[3] = set[3] as number % 12 + ((temp[i] || \"\").toLowerCase() === \"am\" ? 0 : 12);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%s\":\n\t\t\t\t\tset[5] = temp[i] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%M\":\n\t\t\t\t\tset[1] = gantt.locale.date.month_short_hash[temp[i]] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%F\":\n\t\t\t\t\tset[1] = gantt.locale.date.month_full_hash[temp[i]] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (utc) {\n\t\t\treturn new Date(Date.UTC(\n\t\t\t\tset[0] as number,\n\t\t\t\tset[1] as number,\n\t\t\t\tset[2] as number,\n\t\t\t\tset[3] as number,\n\t\t\t\tset[4] as number,\n\t\t\t\tset[5] as number\n\t\t\t));\n\t\t}\n\t\treturn new Date(\n\t\t\tset[0] as number,\n\t\t\tset[1] as number,\n\t\t\tset[2] as number,\n\t\t\tset[3] as number,\n\t\t\tset[4] as number,\n\t\t\tset[5] as number\n\t\t);\n\t};\n\n};\n\n\nconst cspVersion = {\n\tdate_to_str: dateToStr,\n\tstr_to_date: strToDate\n};\n\nexport default cspVersion;","/*\n %d - the day as a number with a leading zero ( 01 to 31 );\n %j - the day as a number without a leading zero ( 1 to 31 );\n %D - the day as an abbreviation ( Sun to Sat );\n %l - the day as a full name ( Sunday to Saturday );\n %W - the ISO-8601 week number of the year. Weeks start on Monday; 1)\n %m - the month as a number without a leading zero ( 1 to 12 );\n %n - the month as a number with a leading zero ( 01 to 12);\n %M - the month as an abbreviation ( Jan to Dec );\n %F - the month as a full name ( January to December );\n %y - the year as a two-digit number ( 00 to 99 );\n %Y - the year as a four-digit number ( 1900–9999 );\n %h - the hour based on the 12-hour clock ( 00 to 11 );\n %H - the hour based on the 24-hour clock ( 00 to 23 );\n %i - the minute as a number with a leading zero ( 00 to 59 );\n %s - the second as a number without a leading zero ( 00 to 59 ); 2)\n %a - displays am (for times from midnight until noon) and pm (for times from noon until midnight);\n %A - displays AM (for times from midnight until noon) and PM (for times from noon until midnight).\n*/\n\nimport fastVersion from \"./date_parsers/fast_version\";\nimport cspCompliantVersion from \"./date_parsers/csp_compliant_version\";\n\nexport default function(gantt) {\n\tvar canUseCsp = null;\n\tfunction cspAutoCheck() {\n\t\ttry {\n\t\t\tnew Function(\"canUseCsp = false;\");\n\t\t} catch(e) {\n\t\t\tcanUseCsp = true;\n\t\t}\n\t}\n\tfunction useCsp() {\n\t\tvar result = false;\n\t\tif (gantt.config.csp === \"auto\") {\n\t\t\tif(canUseCsp === null) {\n\t\t\t\tcspAutoCheck();\n\t\t\t}\n\t\t\tresult = canUseCsp;\n\t\t} else {\n\t\t\tresult = gantt.config.csp;\n\t\t}\n\t\treturn result;\n\t}\n\n\tvar dateHelper = {\n\t\tinit: function () {\n\t\t\tvar locale = gantt.locale;\n\n\t\t\tvar s = locale.date.month_short;\n\t\t\tvar t = locale.date.month_short_hash = {};\n\t\t\tfor (var i = 0; i < s.length; i++)\n\t\t\t\tt[s[i]] = i;\n\n\t\t\tvar s = locale.date.month_full;\n\t\t\tvar t = locale.date.month_full_hash = {};\n\t\t\tfor (var i = 0; i < s.length; i++)\n\t\t\t\tt[s[i]] = i;\n\t\t},\n\t\tdate_part: function (date) {\n\t\t\tvar old = new Date(date);\n\t\t\tdate.setHours(0);\n\t\t\tthis.hour_start(date);\n\t\t\tif (date.getHours() && //shift to yesterday on dst\n\t\t\t\t(date.getDate() < old.getDate() || date.getMonth() < old.getMonth() || date.getFullYear() < old.getFullYear()))\n\t\t\t\tdate.setTime(date.getTime() + 60 * 60 * 1000 * (24 - date.getHours()));\n\t\t\treturn date;\n\t\t},\n\t\ttime_part: function (date) {\n\t\t\treturn (date.valueOf() / 1000 - date.getTimezoneOffset() * 60) % 86400;\n\t\t},\n\t\tweek_start: function (date) {\n\t\t\tvar shift = date.getDay();\n\t\t\tif (gantt.config.start_on_monday) {\n\t\t\t\tif (shift === 0) shift = 6;\n\t\t\t\telse shift--;\n\t\t\t}\n\t\t\treturn this.date_part(this.add(date, -1 * shift, \"day\"));\n\t\t},\n\t\tmonth_start: function (date) {\n\t\t\tdate.setDate(1);\n\t\t\treturn this.date_part(date);\n\t\t},\n\t\tquarter_start: function (date) {\n\t\t\tthis.month_start(date);\n\t\t\tvar m = date.getMonth(),\n\t\t\t\tres_month;\n\n\t\t\tif (m >= 9) {\n\t\t\t\tres_month = 9;\n\t\t\t} else if (m >= 6) {\n\t\t\t\tres_month = 6;\n\t\t\t} else if (m >= 3) {\n\t\t\t\tres_month = 3;\n\t\t\t} else {\n\t\t\t\tres_month = 0;\n\t\t\t}\n\n\t\t\tdate.setMonth(res_month);\n\t\t\treturn date;\n\t\t},\n\t\tyear_start: function (date) {\n\t\t\tdate.setMonth(0);\n\t\t\treturn this.month_start(date);\n\t\t},\n\t\tday_start: function (date) {\n\t\t\treturn this.date_part(date);\n\t\t},\n\t\thour_start: function (date) {\n\t\t\tif (date.getMinutes())\n\t\t\t\tdate.setMinutes(0);\n\t\t\tthis.minute_start(date);\n\n\t\t\treturn date;\n\t\t},\n\t\tminute_start: function (date) {\n\t\t\tif (date.getSeconds())\n\t\t\t\tdate.setSeconds(0);\n\t\t\tif (date.getMilliseconds())\n\t\t\t\tdate.setMilliseconds(0);\n\t\t\treturn date;\n\t\t},\n\t\t_add_days: function (modifiedDate, inc, originalDate) {\n\n\t\t\tmodifiedDate.setDate(modifiedDate.getDate() + inc);\n\t\t\tvar incCondition = inc >= 0;\n\t\t\tvar getHoursCondition = !originalDate.getHours() && modifiedDate.getHours(); //shift to yesterday on dst\n\t\t\tvar getDateCondition = (modifiedDate.getDate() <= originalDate.getDate() || modifiedDate.getMonth() < originalDate.getMonth() || modifiedDate.getFullYear() < originalDate.getFullYear());\n\t\t\tif (incCondition && getHoursCondition && getDateCondition){\n\t\t\t\tmodifiedDate.setTime(modifiedDate.getTime() + 60 * 60 * 1000 * (24 - modifiedDate.getHours()));\n\t\t\t}\n\t\t\tvar worktimeCalculation = inc > 1;\n\t\t\tif (worktimeCalculation && getHoursCondition){\n\t\t\t\t// try to shift the modified Date to 00:00\n\t\t\t\tmodifiedDate.setHours(0);\n\t\t\t}\n\t\t\treturn modifiedDate;\n\t\t},\n\n\t\tadd: function (date, inc, mode) {\n\t\t\t/*jsl:ignore*/\n\t\t\tvar ndate = new Date(date.valueOf());\n\t\t\tswitch (mode) {\n\t\t\t\tcase \"day\":\n\t\t\t\t\tndate = this._add_days(ndate, inc, date);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"week\":\n\t\t\t\t\tndate = this._add_days(ndate, inc * 7, date);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"month\":\n\t\t\t\t\tndate.setMonth(ndate.getMonth() + inc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"year\":\n\t\t\t\t\tndate.setYear(ndate.getFullYear() + inc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hour\":\n\t\t\t\t\t/*\n\t\t\t\t\t\tadding hours/minutes via setHour(getHour() + inc) gives weird result when\n\t\t\t\t\t\tadding one hour to the time before switch to a Daylight Saving time\n\n\t\t\t\t\t\texample: //Sun Mar 30 2014 01:00:00 GMT+0100 (W. Europe Standard Time)\n\t\t\t\t\t\tnew Date(2014, 02, 30, 1).setHours(2)\n\t\t\t\t\t\t>>Sun Mar 30 2014 01:00:00 GMT+0100 (W. Europe Standard Time)\n\n\t\t\t\t\t\tsetTime seems working as expected\n\t\t\t\t\t */\n\t\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 60 * 1000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"minute\":\n\n\t\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 1000);\n\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn this[\"add_\" + mode](date, inc, mode);\n\t\t\t}\n\t\t\treturn ndate;\n\t\t\t/*jsl:end*/\n\t\t},\n\t\tadd_quarter: function (date, inc) {\n\t\t\treturn this.add(date, inc * 3, \"month\");\n\t\t},\n\n\t\tto_fixed: function (num) {\n\t\t\tif (num < 10) return \"0\" + num;\n\t\t\treturn num;\n\t\t},\n\t\tcopy: function (date) {\n\t\t\treturn new Date(date.valueOf());\n\t\t},\n\t\tdate_to_str: function (format, utc) {\n\t\t\tvar result = fastVersion;\n\t\t\tif (useCsp()) {\n\t\t\t\tresult = cspCompliantVersion;\n\t\t\t}\n\t\t\treturn result.date_to_str(format, utc, gantt);\n\t\t},\n\t\tstr_to_date: function (format, utc) {\n\t\t\tvar result = fastVersion;\n\t\t\tif (useCsp()) {\n\t\t\t\tresult = cspCompliantVersion;\n\t\t\t}\n\t\t\treturn result.str_to_date(format, utc, gantt);\n\t\t},\n\t\tgetISOWeek: function (ndate) {\n\t\t\treturn gantt.date._getWeekNumber(ndate, true);\n\t\t},\n\t\t_getWeekNumber: function(ndate, isoWeek){\n\t\t\tif (!ndate) return false;\n\t\t\tvar nday = ndate.getDay();\n\t\t\tif(isoWeek){\n\t\t\t\tif (nday === 0) {\n\t\t\t\t\tnday = 7;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar first_thursday = new Date(ndate.valueOf());\n\t\t\tfirst_thursday.setDate(ndate.getDate() + (4 - nday));\n\t\t\tvar year_number = first_thursday.getFullYear(); // year of the first Thursday\n\t\t\tvar ordinal_date = Math.round((first_thursday.getTime() - new Date(year_number, 0, 1).getTime()) / 86400000); //ordinal date of the first Thursday - 1 (so not really ordinal date)\n\t\t\tvar week_number = 1 + Math.floor(ordinal_date / 7);\n\t\t\treturn week_number;\n\t\t},\n\n\t\tgetWeek: function(ndate){\n\t\t\treturn gantt.date._getWeekNumber(ndate, gantt.config.start_on_monday);\n\t\t},\n\t\tgetUTCISOWeek: function (ndate) {\n\t\t\treturn gantt.date.getISOWeek(ndate);\n\t\t},\n\t\tconvert_to_utc: function (date) {\n\t\t\treturn new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\n\t\t},\n\t\tparseDate: function (date, format) {\n\t\t\t// raw date may be of type string, number (timestamp) or something else\n\t\t\t// do not check for instanceof Date explicitly, since we may swap native date with different date implementation at some point\n\t\t\tif (date && !date.getFullYear) {\n\t\t\t\tif (typeof(format) !== \"function\") {\n\t\t\t\t\tif (typeof(format) === \"string\") {\n\t\t\t\t\t\tif (format === \"parse_date\" || format === \"xml_date\") {\n\t\t\t\t\t\t\tformat = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date : gantt.templates.parse_date;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tformat = gantt.defined(gantt.templates[format]) ? gantt.templates[format] : gantt.date.str_to_date(format);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tformat = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date : gantt.templates.parse_date;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (date) {\n\t\t\t\t\tdate = format(date);\n\t\t\t\t} else {\n\t\t\t\t\tdate = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn date;\n\t\t}\n\t};\n\treturn dateHelper;\n};","class t{constructor(t){const{url:e,token:s}=t;this._url=e,this._token=s,this._mode=1,this._seed=1,this._queue=[],this.data={},this.api={},this._events={}}headers(){return{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Remote-Token\":this._token}}fetch(t,e){const s={credentials:\"include\",headers:this.headers()};return e&&(s.method=\"POST\",s.body=e),fetch(t,s).then(t=>t.json())}load(t){return t&&(this._url=t),this.fetch(this._url).then(t=>this.parse(t))}parse(t){const{key:e,websocket:s}=t;e&&(this._token=t.key);for(const e in t.data)this.data[e]=t.data[e];for(const e in t.api){const s=this.api[e]={},i=t.api[e];for(const t in i)s[t]=this._wrapper(e+\".\"+t)}return s&&this.connect(),this}connect(){const t=this._socket;t&&(this._socket=null,t.onclose=function(){},t.close()),this._mode=2,this._socket=function(t,e,s,i){let n=e;\"/\"===n[0]&&(n=document.location.protocol+\"//\"+document.location.host+e);n=n.replace(/^http(s|):/,\"ws$1:\");const o=-1!=n.indexOf(\"?\")?\"&\":\"?\";n=`${n}${o}token=${s}&ws=1`;const r=new WebSocket(n);return r.onclose=()=>setTimeout(()=>t.connect(),2e3),r.onmessage=e=>{const s=JSON.parse(e.data);switch(s.action){case\"result\":t.result(s.body,[]);break;case\"event\":t.fire(s.body.name,s.body.value);break;case\"start\":i();break;default:t.onError(s.data)}},r}(this,this._url,this._token,()=>(this._mode=3,this._send(),this._resubscribe(),this))}_wrapper(t){return function(){const e=[].slice.call(arguments);let s=null;const i=new Promise((i,n)=>{s={data:{id:this._uid(),name:t,args:e},status:1,resolve:i,reject:n},this._queue.push(s)});return this.onCall(s,i),3===this._mode?this._send(s):setTimeout(()=>this._send(),1),i}.bind(this)}_uid(){return(this._seed++).toString()}_send(t){if(2==this._mode)return void setTimeout(()=>this._send(),100);const e=t?[t]:this._queue.filter(t=>1===t.status);if(!e.length)return;const s=e.map(t=>(t.status=2,t.data));3!==this._mode?this.fetch(this._url,JSON.stringify(s)).catch(t=>this.onError(t)).then(t=>this.result(t,s)):this._socket.send(JSON.stringify({action:\"call\",body:s}))}result(t,e){const s={};if(t)for(let e=0;e<t.length;e++)s[t[e].id]=t[e];else for(let t=0;t<e.length;t++)s[e[t].id]={id:e[t].id,error:\"Network Error\",data:null};for(let t=this._queue.length-1;t>=0;t--){const e=this._queue[t],i=s[e.data.id];i&&(this.onResponse(e,i),i.error?e.reject(i.error):e.resolve(i.data),this._queue.splice(t,1))}}on(t,e){const s=this._uid();let i=this._events[t];const n=!!i;return n||(i=this._events[t]=[]),i.push({id:s,handler:e}),n||3!=this._mode||this._socket.send(JSON.stringify({action:\"subscribe\",name:t})),{name:t,id:s}}_resubscribe(){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:\"subscribe\",name:t}))}detach(t){if(!t){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:\"unsubscribe\",key:t}));return void(this._events={})}const{id:e,name:s}=t,i=this._events[s];if(i){const t=i.filter(t=>t.id!=e);t.length?this._events[s]=t:(delete this._events[s],3==this._mode&&this._socket.send(JSON.stringify({action:\"unsubscribe\",name:s})))}}fire(t,e){const s=this._events[t];if(s)for(let t=0;t<s.length;t++)s[t].handler(e)}onError(t){return null}onCall(t,e){}onResponse(t,e){}}export{t as Client};\n//# sourceMappingURL=remote.es6.js.map\n","import * as remote_client from \"remote-client\";\nexport const remoteEvents = function(url, token) {\n    const remote = new remote_client.Client({\n      url,\n      token\n    });\n\n    // temporary patch, as we do not want credentials\n    remote.fetch = function (url, body) {\n      const req = {\n        headers: this.headers()\n      };\n      if (body) {\n        req.method = \"POST\";\n        req.body = body;\n      }\n\n      return fetch(url, req).then((res) => res.json());\n    };\n\n    this._ready = remote.load().then((back) => (this._remote = back));\n\n    function ready() {\n      return this._ready;\n    }\n  \n    function on(name, handler) {\n      this.ready().then((back) => {\n        if (typeof name === \"string\") back.on(name, handler);\n        else {\n          for (const key in name) {\n            back.on(key, name[key]);\n          }\n        }\n      });\n    }\n\n    this.ready = ready;\n    this.on = on;\n  };\n\n","function checkTimeout(host, updPerSecond){\n\tif (!updPerSecond)\n\t\treturn true;\n\t\n\tif (host._on_timeout)\n\t\treturn false;\n\t\n\tvar timeout = Math.ceil(1000/updPerSecond);\n\tif (timeout < 2) return true;\n\n\tsetTimeout(function(){\n\t\tdelete host._on_timeout;\n\t}, timeout);\n\n\thost._on_timeout = true;\n\treturn true;\n}\n\nexport default checkTimeout;","import * as utils from \"../../utils/utils\";\n\nvar StateService = (function(){\n\tvar stateProviders = {};\n\n\tfunction getState(name){\n\t\tvar provider = stateProviders[name];\n\t\tif(provider){\n\t\t\treturn stateProviders[name].method();\n\t\t}else{\n\t\t\tvar res = {};\n\t\t\tfor(var i in stateProviders){\n\t\t\t\tif(!stateProviders[i].internal)\n\t\t\t\t\tutils.mixin(res, stateProviders[i].method(), true);\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\t}\n\n\tfunction registerProvider(name, provider, internal){\n\t\tstateProviders[name] = { method: provider, internal: internal};\n\t}\n\n\tfunction unregisterProvider(name){\n\t\tdelete stateProviders[name];\n\t}\n\n\treturn {\n\t\tgetState: getState,\n\t\tregisterProvider: registerProvider,\n\t\tunregisterProvider: unregisterProvider\n\t};\n});\n\nexport default StateService;\n\n","// eslint-disable-next-line no-restricted-globals\nexport default Promise;","import * as utils from \"../../utils/utils\";\nimport {replaceValidZeroId} from \"../../utils/helpers\";\n\nvar createTasksDatastoreFacade = function(){\n\treturn {\n\tgetTask: function (id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tthis.assert(id, \"Invalid argument for gantt.getTask\");\n\t\tvar task = this.$data.tasksStore.getItem(id);\n\t\tthis.assert(task, \"Task not found id=\" + id);\n\t\treturn task;\n\t},\n\tgetTaskByTime: function (from, to) {\n\t\tvar p = this.$data.tasksStore.getItems();\n\n\t\tvar res = [];\n\n\t\tif (!(from || to)) {\n\t\t\tres = p;\n\t\t} else {\n\t\t\tfrom = +from || -Infinity;\n\t\t\tto = +to || Infinity;\n\t\t\tfor (var t = 0; t < p.length; t++){\n\t\t\t\tvar task = p[t];\n\t\t\t\tif (+task.start_date < to && +task.end_date > from)\n\t\t\t\t\tres.push(task);\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t},\n\tisTaskExists: function (id) {\n\t\tif(!this.$data || !this.$data.tasksStore){\n\t\t\treturn false;\n\t\t}\n\t\treturn this.$data.tasksStore.exists(id);\n\t},\n\tupdateTask: function (id, item) {\n\t\tif (!utils.defined(item)) item = this.getTask(id);\n\t\tthis.$data.tasksStore.updateItem(id, item);\n\t\tif(this.isTaskExists(id))\n\t\t\tthis.refreshTask(id);\n\t},\n\taddTask: function (item, parent, index) {\n\t\tif (!utils.defined(item.id))\n\t\t\titem.id = utils.uid();\n\n\t\t//GS-761: assert unique ID\n\t\tif (this.isTaskExists(item.id)){\n\t\t\tvar task = this.getTask(item.id);\n\t\t\tif (task.$index != item.$index) {\n\t\t\t\t// Someone may try to mistakenly add a task with the same ID, and most likely\n\t\t\t\t// use the string format for the dates. Gantt shouldn't break in this scenario\n\t\t\t\tif (item.start_date && typeof item.start_date === \"string\"){\n\t\t\t\t\titem.start_date = this.date.parseDate(item.start_date, \"parse_date\");\n\t\t\t\t}\n\t\t\t\tif (item.end_date && typeof item.end_date === \"string\"){\n\t\t\t\t\titem.end_date = this.date.parseDate(item.end_date, \"parse_date\");\n\t\t\t\t}\n\n\t\t\t\treturn this.$data.tasksStore.updateItem(item.id, item);\n\t\t\t}\n\t\t}\n\n\n\t\tif (!utils.defined(parent)) parent = this.getParent(item) || 0;\n\t\tif (!this.isTaskExists(parent)) parent = this.config.root_id;\n\t\tthis.setParent(item, parent);\n\n\t\t// GS-1583. Save the $open state to the Undo Stack\n\t\tif (this.getState().lightbox && this.isTaskExists(parent)) {\n\t\t\tvar parentObj = this.getTask(parent);\n\t\t\tthis.callEvent(\"onAfterParentExpand\", [parent, parentObj]);\n\t\t}\n\t\treturn this.$data.tasksStore.addItem(item, index, parent);\n\t},\n\tdeleteTask: function (id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\treturn this.$data.tasksStore.removeItem(id);\n\t},\n\tgetTaskCount: function () {\n\t\treturn this.$data.tasksStore.count();\n\t},\n\tgetVisibleTaskCount: function () {\n\t\treturn this.$data.tasksStore.countVisible();\n\t},\n\tgetTaskIndex: function (id) {\n\t\treturn this.$data.tasksStore.getBranchIndex(id);\n\t},\n\tgetGlobalTaskIndex: function (id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tthis.assert(id, \"Invalid argument\");\n\t\treturn this.$data.tasksStore.getIndexById(id);\n\t},\n\teachTask: function (code, parent, master) {\n\t\treturn this.$data.tasksStore.eachItem(utils.bind(code, master||this), parent);\n\t},\n\teachParent: function (callback, startTask, master) {\n\t\treturn this.$data.tasksStore.eachParent(utils.bind(callback, master || this), startTask);\n\t},\n\tchangeTaskId: function (oldid, newid) {\n\t\tthis.$data.tasksStore.changeId(oldid, newid);\n\t\tvar task = this.$data.tasksStore.getItem(newid);\n\n\t\tvar links = [];\n\n\t\tif (task.$source) {\n\t\t\tlinks = links.concat(task.$source);\n\t\t}\n\t\tif (task.$target) {\n\t\t\tlinks = links.concat(task.$target);\n\t\t}\n\n\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\tvar link = this.getLink(links[i]);\n\t\t\tif (link.source == oldid) {\n\t\t\t\tlink.source = newid;\n\t\t\t}\n\t\t\tif (link.target == oldid) {\n\t\t\t\tlink.target = newid;\n\t\t\t}\n\t\t}\n\t},\n\tcalculateTaskLevel: function (item) {\n\t\treturn this.$data.tasksStore.calculateItemLevel(item);\n\t},\n\tgetNext: function (id) {\n\t\treturn this.$data.tasksStore.getNext(id);\n\t},\n\tgetPrev: function (id) {\n\t\treturn this.$data.tasksStore.getPrev(id);\n\t},\n\tgetParent: function (id) {\n\t\treturn this.$data.tasksStore.getParent(id);\n\t},\n\tsetParent: function (task, new_pid, silent) {\n\t\treturn this.$data.tasksStore.setParent(task, new_pid, silent);\n\t},\n\tgetSiblings: function (id) {\n\t\treturn this.$data.tasksStore.getSiblings(id).slice();\n\t},\n\tgetNextSibling: function (id) {\n\t\treturn this.$data.tasksStore.getNextSibling(id);\n\t},\n\tgetPrevSibling: function (id) {\n\t\treturn this.$data.tasksStore.getPrevSibling(id);\n\t},\n\tgetTaskByIndex: function(index){\n\t\tvar id = this.$data.tasksStore.getIdByIndex(index);\n\t\tif(this.isTaskExists(id)){\n\t\t\treturn this.getTask(id);\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t},\n\tgetChildren: function (id) {\n\t\tif(!this.hasChild(id)){\n\t\t\treturn [];\n\t\t}else{\n\t\t\treturn this.$data.tasksStore.getChildren(id).slice();\n\t\t}\n\t},\n\thasChild: function (id) {\n\t\treturn this.$data.tasksStore.hasChild(id);\n\t},\n\topen: function (id) {\n\t\tthis.$data.tasksStore.open(id);\n\t},\n\tclose: function (id) {\n\t\tthis.$data.tasksStore.close(id);\n\t},\n\tmoveTask: function (sid, tindex, parent) {\n\t\tparent = replaceValidZeroId(parent, this.config.root_id);\n\t\treturn this.$data.tasksStore.move.apply(this.$data.tasksStore, arguments);\n\t},\n\tsort: function(field, desc, parent, silent) {\n\t\tvar render = !silent;//4th argument to cancel redraw after sorting\n\n\t\tthis.$data.tasksStore.sort(field, desc, parent);\n\t\tthis.callEvent(\"onAfterSort\", [field, desc, parent]);\n\n\t\tif (render) {\n\t\t\tthis.render();\n\t\t}\n\t}\n};\n};\n\nexport default createTasksDatastoreFacade;\n\n\n","import * as utils from \"../../utils/utils\";\n\nvar $powerArray  = {\n\t$create: function(array){\n\t\treturn utils.mixin(array || [], this);\n\t},\n\t//remove element at specified position\n\t$removeAt:function(pos,len){\n\t\tif (pos>=0) this.splice(pos,(len||1));\n\t},\n\t//find element in collection and remove it\n\t$remove:function(value){\n\t\tthis.$removeAt(this.$find(value));\n\t},\n\t//add element to collection at specific position\n\t$insertAt:function(data,pos){\n\t\tif (!pos && pos!==0) \t//add to the end by default\n\t\t\tthis.push(data);\n\t\telse {\n\t\t\tvar b = this.splice(pos,(this.length-pos));\n\t\t\tthis[pos] = data;\n\t\t\tthis.push.apply(this,b); //reconstruct array without loosing this pointer\n\t\t}\n\t},\n\t//return index of element, -1 if it doesn't exists\n\t$find:function(data){\n\t\tfor (var i=0; i<this.length; i++)\n\t\t\tif (data==this[i]) return i;\n\t\treturn -1;\n\t},\n\t//execute some method for each element of array\n\t$each:function(functor,master){\n\t\tfor (var i=0; i < this.length; i++)\n\t\t\tfunctor.call((master||this),this[i]);\n\t},\n\t//create new array from source, by using results of functor\n\t$map:function(functor,master){\n\t\tfor (var i=0; i < this.length; i++)\n\t\t\tthis[i]=functor.call((master||this),this[i]);\n\t\treturn this;\n\t},\n\t$filter:function(functor, master){\n\t\tfor (var i=0; i < this.length; i++)\n\t\t\tif (!functor.call((master||this),this[i])){\n\t\t\t\tthis.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}\n\t\treturn this;\n\t}\n};\n\nexport default $powerArray;","/**\n * Check the over task or draggble task is placeholder task\n */\n\nexport default function isPlaceholderTask(id, gantt, store, config) {\n\t// return false;\n\tvar config = gantt ? gantt.config : config;\n\tif (config && config.placeholder_task) {\n\t\tif (store.exists(id)){\n\t\t\tvar item = store.getItem(id);\n\t\t\treturn item.type === config.types.placeholder;\n\t\t}\n\t}\n\treturn false;\n};","import powerArray from \"./power_array\";\nimport * as utils from \"../../utils/utils\";\nimport eventable from \"../../utils/eventable\";\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\n\nvar DataStore = function(config){\n\tthis.pull = {};\n\tthis.$initItem = config.initItem;\n\tthis.visibleOrder = powerArray.$create();\n\tthis.fullOrder = powerArray.$create();\n\tthis._skip_refresh = false;\n\tthis._filterRule = null;\n\tthis._searchVisibleOrder = {};\n\tthis._indexRangeCache = {};\n\tthis._getItemsCache = null;\n\tthis.$config = config;\n\teventable(this);\n\n\tthis._attachDataChange(function(){\n\t\tthis._indexRangeCache = {};\n\t\tthis._getItemsCache = null;\n\t\treturn true;\n\t});\n\treturn this;\n};\nDataStore.prototype = {\n\n\t_attachDataChange: function(callback){\n\t\tthis.attachEvent(\"onClearAll\", callback);\n\t\tthis.attachEvent(\"onBeforeParse\", callback);\n\t\tthis.attachEvent(\"onBeforeUpdate\", callback);\n\t\tthis.attachEvent(\"onBeforeDelete\", callback);\n\t\tthis.attachEvent(\"onBeforeAdd\", callback);\n\t\tthis.attachEvent(\"onParse\", callback);\n\t\tthis.attachEvent(\"onBeforeFilter\", callback);\n\t},\n\t_parseInner: function(data){\n\t\tvar item = null,\n\t\t\tloaded = [];\n\t\tfor(var i = 0, len = data.length; i< len; i++){\n\t\t\titem = data[i];\n\t\t\tif(this.$initItem){\n\t\t\t\tif(this.$config.copyOnParse()){\n\t\t\t\t\titem = utils.copy(item);\n\t\t\t\t}\n\t\t\t\titem = this.$initItem(item);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.callEvent(\"onItemLoading\", [item])){\n\t\t\t\tif (!this.pull.hasOwnProperty(item.id)) {\n\t\t\t\t\tthis.fullOrder.push(item.id);\n\t\t\t\t}\n\t\t\t\tloaded.push(item);\n\t\t\t\tthis.pull[item.id] = item;\n\t\t\t}\n\t\t}\n\t\treturn loaded;\n\t},\n\tparse: function(data){\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onBeforeParse\", [data]);\n\t\t}\n\t\tvar loaded = this._parseInner(data);\n\t\tif (!this.isSilent()) {\n\t\t\tthis.refresh();\n\t\t\tthis.callEvent(\"onParse\", [loaded]);\n\t\t}\n\t},\n\tgetItem: function(id){\n\t\treturn this.pull[id];\n\t},\n\n\t_updateOrder: function(code){\n\t\tcode.call(this.visibleOrder);\n\t\tcode.call(this.fullOrder);\n\t},\n\tupdateItem: function(id, item){\n\t\tif (!utils.defined(item)) item = this.getItem(id);\n\n\t\tif (!this.isSilent()) {\n\t\t\tif (this.callEvent(\"onBeforeUpdate\", [item.id, item]) === false) return false;\n\t\t}\n\t\t// This is how it worked before updating the properties:\n\t\t// this.pull[id]=item;\n\t\tutils.mixin(this.pull[id],item, true);\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onAfterUpdate\", [item.id, item]);\n\t\t\tthis.callEvent(\"onStoreUpdated\", [item.id, item, \"update\"]);\n\t\t}\n\t},\n\n\t_removeItemInner: function(id){\n\t\t//clear from collections\n\t\t//this.visibleOrder.$remove(id);\n\t\tthis._updateOrder(function(){ this.$remove(id);});\n\t\tdelete this.pull[id];\n\t},\n\n\tremoveItem: function(id){\n\t\t//utils.assert(this.exists(id), \"Not existing ID in remove command\"+id);\n\n\t\tvar obj = this.getItem(id);\t//save for later event\n\t\tif (!this.isSilent()) {\n\t\t\tif (this.callEvent(\"onBeforeDelete\", [obj.id, obj]) === false) return false;\n\t\t}\n\n\t\tthis.callEvent(\"onAfterDeleteConfirmed\", [obj.id, obj]);\n\t\tthis._removeItemInner(id);\n\t\t\n\t\tif (this.isSilent()) {\n\t\t\tthis.callEvent(\"onAfterSilentDelete\", [obj.id, obj]);\n\t\t}\n\n\t\tif (!this.isSilent()) {\n\t\t\tthis.filter();\n\t\t\tthis.callEvent(\"onAfterDelete\", [obj.id, obj]);\n\t\t\t//repaint signal\n\t\t\tthis.callEvent(\"onStoreUpdated\", [obj.id, obj, \"delete\"]);\n\t\t}\n\t},\n\n\t_addItemInner: function(item, index){\n\t\t//in case of treetable order is sent as 3rd parameter\n\t\t//var order = index;\n\n\t\tif(this.exists(item.id)){\n\t\t\tthis.silent(function(){this.updateItem(item.id, item);});\n\t\t}else{\n\t\t\tvar order = this.visibleOrder;\n\n\t\t\t//by default item is added to the end of the list\n\t\t\tvar data_size = order.length;\n\n\t\t\tif (!utils.defined(index) || index < 0)\n\t\t\t\tindex = data_size;\n\t\t\t//check to prevent too big indexes\n\t\t\tif (index > data_size){\n\t\t\t\t//dhx.log(\"Warning\",\"DataStore:add\",\"Index of out of bounds\");\n\t\t\t\tindex = Math.min(order.length,index);\n\t\t\t}\n\t\t}\n\n\n\t\t//gantt.assert(!this.exists(id), \"Not unique ID\");\n\n\t\tthis.pull[item.id]=item;\n\t\tthis._updateOrder(function(){\n\t\t\tif(this.$find(item.id) === -1)\n\t\t\t\tthis.$insertAt(item.id,index);\n\t\t});\n\t\tthis.filter();\n\t\t//order.$insertAt(item.id,index);\n\t},\n\n\n\tisVisible: function(id){\n\t\treturn this.visibleOrder.$find(id) > -1;\n\t},\n\tgetVisibleItems: function(){\n\t\treturn this.getIndexRange();\n\t},\n\n\taddItem: function(item, index){\n\t\tif (!utils.defined(item.id))\n\t\t\titem.id = utils.uid();\n\n\t\tif(this.$initItem){\n\t\t\titem = this.$initItem(item);\n\t\t}\n\n\t\tif (!this.isSilent()){\n\t\t\tif (this.callEvent(\"onBeforeAdd\", [item.id, item]) === false) return false;\n\t\t}\n\n\n\t\tthis._addItemInner(item, index);\n\n\t\tif (!this.isSilent()){\n\t\t\tthis.callEvent(\"onAfterAdd\",[item.id, item]);\n\t\t\t//repaint signal\n\t\t\tthis.callEvent(\"onStoreUpdated\",[item.id,item,\"add\"]);\n\t\t}\n\t\treturn item.id;\n\t},\n\n\t_changeIdInner: function(oldId, newId){\n\t\tif(this.pull[oldId])\n\t\t\tthis.pull[newId] = this.pull[oldId];\n\n\t\tvar visibleOrder = this._searchVisibleOrder[oldId];\n\t\tthis.pull[newId].id = newId;\n\t\tthis._updateOrder(function(){\n\t\t\tthis[this.$find(oldId)] = newId;\n\t\t});\n\t\tthis._searchVisibleOrder[newId] = visibleOrder;\n\t\tdelete this._searchVisibleOrder[oldId];\n\n\t\t//this.visibleOrder[this.visibleOrder.$find(oldId)]=newId;\n\t\tdelete this.pull[oldId];\n\t},\n\tchangeId: function(oldId, newId){\n\t\tthis._changeIdInner(oldId, newId);\n\n\t\tthis.callEvent(\"onIdChange\", [oldId, newId]);\n\n\t},\n\texists: function(id){\n\t\treturn !!(this.pull[id]);\n\t},\n\n\t_moveInner: function(sindex, tindex){\n\t\tvar id = this.getIdByIndex(sindex);\n\n\t\tthis._updateOrder(function(){\n\t\t\tthis.$removeAt(sindex);\n\t\t\tthis.$insertAt(id,Math.min(this.length, tindex));\n\t\t});\n\t\t//this.visibleOrder.$removeAt(sindex);\t//remove at old position\n\t\t//if (sindex<tindex) tindex--;\t//correct shift, caused by element removing\n\t\t//this.visibleOrder.$insertAt(id,Math.min(this.visibleOrder.length, tindex));\t//insert at new position\n\t},\n\n\tmove: function(sindex, tindex){\n\t\t//gantt.assert(sindex>=0 && tindex>=0, \"DataStore::move\",\"Incorrect indexes\");\n\n\t\tvar id = this.getIdByIndex(sindex);\n\t\tvar obj = this.getItem(id);\n\t\tthis._moveInner(sindex, tindex);\n\n\t\tif (!this.isSilent()) {\n\t\t\t//repaint signal\n\t\t\tthis.callEvent(\"onStoreUpdated\", [obj.id, obj, \"move\"]);\n\t\t}\n\t},\n\tclearAll: function(){\n\t\tif(this.$destroyed){\n\t\t\treturn;\n\t\t}\n\t\t// GS-956 We need to unselect the resource as its ID is cached\n\t\tthis.silent(function(){\n\t\t\tthis.unselect();\n\t\t});\n\t\tthis.pull = {};\n\t\tthis.visibleOrder = powerArray.$create();\n\t\tthis.fullOrder = powerArray.$create();\n\t\tif (this.isSilent()) return;\n\t\tthis.callEvent(\"onClearAll\",[]);\n\t\tthis.refresh();\n\t},\n\n\tsilent:function(code, master){\n\t\tvar alreadySilent = false;\n\t\tif(this.isSilent()) {\n\t\t\talreadySilent = true;\n\t\t}\n\t\tthis._skip_refresh = true;\n\t\tcode.call(master||this);\n\t\t\n\t\tif (!alreadySilent) {\n\t\t\tthis._skip_refresh = false;\n\t\t}\n\t},\n\tisSilent: function(){\n\t\treturn !!this._skip_refresh;\n\t},\n\n\tarraysEqual: function (arr1, arr2) {\n\t\tif(arr1.length !== arr2.length)\n\t\t\treturn false;\n\t\tfor(var i = 0; i < arr1.length; i++) {\n\t\t\tif(arr1[i] !== arr2[i])\n\t\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\trefresh: function(id, quick){\n\t\tif (this.isSilent()) return;\n\n\t\tvar item;\n\t\tif(id){\n\t\t\titem = this.getItem(id);\n\t\t}\n\n\t\tvar args;\n\t\tif (id){\n\t\t\targs = [id, item, \"paint\"];\n\t\t}else{\n\t\t\targs = [null,null,null];\n\t\t}\n\n\t\tif(this.callEvent(\"onBeforeStoreUpdate\", args) === false){\n\t\t\treturn;\n\t\t}\n\n\t\tvar skipFilter = this._quick_refresh && !this._mark_recompute;\n\t\tthis._mark_recompute = false;\n\t\tif(id){\n\t\t\t// if item changes visible order (e.g. expand-collapse branch) - do a complete repaint\n\t\t\tif(!quick && !skipFilter){\n\t\t\t\tvar oldOrder = this.visibleOrder;\n\t\t\t\tthis.filter();\n\t\t\t\tif(!this.arraysEqual(oldOrder, this.visibleOrder)){\n\t\t\t\t\tid = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}else if(!skipFilter){\n\t\t\tthis.filter();\n\t\t}\n\n\t\tif (id){\n\t\t\targs = [id, item, \"paint\"];\n\t\t}else{\n\t\t\targs = [null,null,null];\n\t\t}\n\n\t\tthis.callEvent(\"onStoreUpdated\",args);\n\t},\n\n\tcount: function(){\n\t\treturn this.fullOrder.length;\n\t},\n\tcountVisible: function(){\n\t\treturn this.visibleOrder.length;\n\t},\n\n\tsort: function(sort){},\n\n\tserialize: function(){},\n\n\teachItem: function(code){\n\t\tfor (var i=0; i<this.fullOrder.length; i++) {\n\t\t\tvar item = this.getItem(this.fullOrder[i]);\n\t\t\tcode.call(this, item);\n\t\t}\n\t},\n\n\tfind: function(filter) {\n\t\tvar result = [];\n\t\tthis.eachItem(function(item) {\n\t\t\tif(filter(item)){\n\t\t\t\tresult.push(item);\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t},\n\n\tfilter: function(rule){\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onBeforeFilter\", []);\n\t\t}\n\t\tthis.callEvent(\"onPreFilter\", []);\n\t\tvar filteredOrder = powerArray.$create();\n\t\tvar placeholderIds = [];\n\t\tthis.eachItem(function(item){\n\t\t\tif(this.callEvent(\"onFilterItem\", [item.id, item])){\n\t\t\t\tif(isPlaceholderTask(item.id, null, this, this._ganttConfig)){\n\t\t\t\t\tplaceholderIds.push(item.id);\n\t\t\t\t} else {\n\t\t\t\t\tfilteredOrder.push(item.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tfor(var i = 0; i < placeholderIds.length; i++){\n\t\t\tfilteredOrder.push(placeholderIds[i]);\n\t\t}\n\n\t\tthis.visibleOrder = filteredOrder;\n\t\tthis._searchVisibleOrder = {};\n\t\tfor(var i = 0; i < this.visibleOrder.length; i++){\n\t\t\tthis._searchVisibleOrder[this.visibleOrder[i]] = i;\n\t\t}\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onFilter\", []);\n\t\t}\n\t},\n\n\tgetIndexRange: function(from, to){\n\t\tvar max = Math.min((to||Infinity),this.countVisible()-1);\n\t\tvar min = from||0;\n\n\t\tvar cacheKey = min + '-' + max;\n\t\tif(this._indexRangeCache[cacheKey]){\n\t\t\treturn this._indexRangeCache[cacheKey].slice();\n\t\t}\n\n\t\tvar ret= [];\n\t\tfor (var i=min; i <= max; i++)\n\t\t\tret.push(this.getItem(this.visibleOrder[i]));\n\n\t\tthis._indexRangeCache[cacheKey] = ret.slice();\n\t\treturn ret;\n\t},\n\tgetItems: function(){\n\t\tif(this._getItemsCache){\n\t\t\treturn this._getItemsCache.slice();\n\t\t}\n\n\t\tvar res = [];\n\t\tfor(var i in this.pull){\n\t\t\tres.push(this.pull[i]);\n\t\t}\n\t\tthis._getItemsCache = res.slice();\n\n\t\treturn res;\n\t},\n\n\tgetIdByIndex: function(index){\n\t\treturn this.visibleOrder[index];\n\t},\n\tgetIndexById: function(id){\n\t\tvar res = this._searchVisibleOrder[id];\n\t\tif(res === undefined){\n\t\t\tres = -1;\n\t\t}\n\t\treturn res;\n\t},\n\t_getNullIfUndefined: function(value){\n\t\tif(value === undefined){\n\t\t\treturn null;\n\t\t}else{\n\t\t\treturn value;\n\t\t}\n\t},\n\tgetFirst: function(){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[0]);\n\t},\n\tgetLast: function(){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.visibleOrder.length-1]);\n\t},\n\tgetNext: function(id){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.getIndexById(id) + 1]);\n\t},\n\tgetPrev: function(id){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.getIndexById(id) - 1]);\n\t},\n\tdestructor: function(){\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\t\tthis.$destroyed = true;\n\t\tthis.pull = null;\n\t\tthis.$initItem = null;\n\t\tthis.visibleOrder = null;\n\t\tthis.fullOrder = null;\n\t\tthis._skip_refresh = null;\n\t\tthis._filterRule = null;\n\t\tthis._searchVisibleOrder = null;\n\t\tthis._indexRangeCache = {};\n\t}\n};\n\nexport default DataStore;","import powerArray from \"./power_array\";\nimport * as utils from \"../../utils/utils\";\nimport * as helpers from \"../../utils/helpers\";\nimport DataStore from \"./datastore\";\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\nimport {replaceValidZeroId} from \"../../utils/helpers\";\n\nvar TreeDataStore = function(config){\n\tDataStore.apply(this, [config]);\n\tthis._branches = {};\n\n\tthis.pull = {};\n\t//GS-761 Update existing item instead of adding it to the new position\n\tthis.$initItem = function (item){\n\t\tvar loadedItem = item;\n\t\tif(config.initItem){\n\t\t\tloadedItem = config.initItem(loadedItem);\n\t\t}\n\t\tvar existingItem = this.getItem(item.id);\n\t\tif(existingItem && !isEqualIds(existingItem.parent,loadedItem.parent)){\n\t\t\tthis.move(loadedItem.id, loadedItem.$index || -1, loadedItem.parent || this._ganttConfig.root_id);\n\t\t}\n\t\treturn loadedItem;\n\t};\n\tthis.$parentProperty = config.parentProperty || \"parent\";\n\n\tif(typeof config.rootId !== \"function\"){\n\t\tthis.$getRootId = (function(val){\n\t\t\treturn function(){return val;};\n\t\t})(config.rootId || 0);\n\t}else{\n\t\tthis.$getRootId = config.rootId;\n\t}\n\n\t// TODO: replace with live reference to gantt config\n\tthis.$openInitially = config.openInitially;\n\n\tthis.visibleOrder = powerArray.$create();\n\tthis.fullOrder = powerArray.$create();\n\tthis._searchVisibleOrder = {};\n\tthis._indexRangeCache = {};\n\tthis._eachItemMainRangeCache = null;\n\tthis._getItemsCache = null;\n\tthis._skip_refresh = false;\n\n\tthis._ganttConfig = null;\n\tif(config.getConfig){\n\t\tthis._ganttConfig = config.getConfig();\n\t}\n\n\tvar splitParents = {};\n\tvar splitItems = {};\n\n\tvar taskOpenState = {};\n\tvar taskVisibility = {};\n\tvar haveSplitItems = false;\n\n\tthis._attachDataChange(function(){\n\t\tthis._indexRangeCache = {};\n\t\tthis._eachItemMainRangeCache = null;\n\t\tthis._getItemsCache = null;\n\t\treturn true;\n\t});\n\n\tthis.attachEvent(\"onPreFilter\", function(){\n\t\tthis._indexRangeCache = {};\n\t\tthis._eachItemMainRangeCache = null;\n\n\t\tsplitParents = {};\n\t\tsplitItems = {};\n\t\ttaskOpenState = {};\n\t\ttaskVisibility = {};\n\t\thaveSplitItems = false;\n\n\t\tthis.eachItem(function(item){\n\t\t\tvar parent = this.getParent(item.id);\n\t\t\tif(item.$open && taskOpenState[parent] !== false){\n\t\t\t\ttaskOpenState[item.id] = true;\n\t\t\t}else{\n\t\t\t\ttaskOpenState[item.id] = false;\n\t\t\t}\n\n\t\t\tif(this._isSplitItem(item)){\n\t\t\t\thaveSplitItems = true;\n\t\t\t\tsplitParents[item.id] = true;\n\t\t\t\tsplitItems[item.id] = true;\n\t\t\t}\n\n\n\t\t\tif(haveSplitItems && splitItems[parent]){\n\t\t\t\tsplitItems[item.id] = true;\n\t\t\t}\n\n\n\t\t\tif(taskOpenState[parent] || taskOpenState[parent] === undefined){\n\t\t\t\ttaskVisibility[item.id] = true;\n\t\t\t}else{\n\t\t\t\ttaskVisibility[item.id] = false;\n\t\t\t}\n\t\t});\n\t});\n\n\tthis.attachEvent(\"onFilterItem\", function(id, item){\n\n\t\tvar canOpenSplitTasks = false;\n\t\tif(this._ganttConfig){\n\t\t\tvar canOpenSplitTasks = this._ganttConfig.open_split_tasks;\n\t\t}\n\n\t\tvar open = taskVisibility[item.id];\n\n\t\tif(haveSplitItems){\n\t\t\tif(open && splitItems[item.id] && !splitParents[item.id]){\n\t\t\t\topen = !!canOpenSplitTasks;\n\t\t\t}\n\n\t\t\tif(splitItems[item.id] && !splitParents[item.id]){\n\t\t\t\titem.$split_subtask = true;\n\t\t\t}\n\t\t}\n\n\t\titem.$expanded_branch = !!taskVisibility[item.id];\n\n\t\treturn !!open;\n\t});\n\n\tthis.attachEvent(\"onFilter\", function(){\n\t\tsplitParents = {};\n\t\tsplitItems = {};\n\n\t\ttaskOpenState = {};\n\t\ttaskVisibility = {};\n\t});\n\n\treturn this;\n};\n\nTreeDataStore.prototype = utils.mixin({\n\n\t\t_buildTree: function(data){\n\t\t\tvar item = null;\n\t\t\tvar rootId = this.$getRootId();\n\t\t\tfor (var i = 0, len = data.length; i < len; i++){\n\t\t\t\titem = data[i];\n\t\t\t\tthis.setParent(item, replaceValidZeroId(this.getParent(item), rootId) || rootId);\n\t\t\t}\n\n\t\t\t// calculating $level for each item\n\t\t\tfor (var i = 0, len = data.length; i < len; i++){\n\t\t\t\titem = data[i];\n\t\t\t\tthis._add_branch(item);\n\t\t\t\titem.$level = this.calculateItemLevel(item);\n\t\t\t\titem.$local_index = this.getBranchIndex(item.id);\n\n\t\t\t\tif (!utils.defined(item.$open)) {\n\t\t\t\t\titem.$open = utils.defined(item.open) ? item.open : this.$openInitially();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis._updateOrder();\n\t\t},\n\t\t_isSplitItem: function(item){\n\t\t\treturn (item.render == \"split\" && this.hasChild(item.id));\n\t\t},\n\t\tparse: function(data){\n\t\t\tif (!this._skip_refresh) {\n\t\t\t\tthis.callEvent(\"onBeforeParse\", [data]);\n\t\t\t}\n\t\t\tvar loaded = this._parseInner(data);\n\t\t\tthis._buildTree(loaded);\n\t\t\tthis.filter();\n\t\t\tif (!this._skip_refresh) {\n\t\t\t\tthis.callEvent(\"onParse\", [loaded]);\n\t\t\t}\n\t\t},\n\n\t\t_addItemInner: function(item, index){\n\n\t\t\tvar parent = this.getParent(item);\n\n\t\t\tif(!utils.defined(parent)){\n\t\t\t\tparent = this.$getRootId();\n\t\t\t\tthis.setParent(item, parent);\n\t\t\t}\n\n\t\t\tvar parentIndex = this.getIndexById(parent);\n\t\t\tvar targetIndex = parentIndex + Math.min(Math.max(index, 0), this.visibleOrder.length);\n\n\t\t\tif(targetIndex*1 !== targetIndex){\n\t\t\t\ttargetIndex = undefined;\n\t\t\t}\n\t\t\tDataStore.prototype._addItemInner.call(this, item, targetIndex);\n\t\t\tthis.setParent(item, parent);\n\n\t\t\tif(item.hasOwnProperty(\"$rendered_parent\")){\n\t\t\t\tthis._move_branch(item, item.$rendered_parent);\n\t\t\t}\n\t\t\tthis._add_branch(item, index);\n\t\t},\n\t\t_changeIdInner: function(oldId, newId){\n\t\t\tvar children = this.getChildren(oldId);\n\t\t\tvar visibleOrder = this._searchVisibleOrder[oldId];\n\n\t\t\tDataStore.prototype._changeIdInner.call(this, oldId, newId);\n\n\t\t\tvar parent = this.getParent(newId);\n\n\t\t\tthis._replace_branch_child(parent, oldId, newId);\n\n\t\t\tif(this._branches[oldId]){\n\t\t\t\tthis._branches[newId] = this._branches[oldId];\n\t\t\t}\n\t\t\tfor(var i = 0; i < children.length; i++){\n\t\t\t\tvar child = this.getItem(children[i]);\n\t\t\t\tchild[this.$parentProperty] = newId;\n\t\t\t\tchild.$rendered_parent = newId;\n\t\t\t}\n\n\t\t\tthis._searchVisibleOrder[newId] = visibleOrder;\n\t\t\tdelete this._branches[oldId];\n\t\t},\n\n\t\t_traverseBranches: function(code, parent){\n\t\t\tif (!utils.defined(parent)) {\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\t\t\tvar branch = this._branches[parent];\n\t\t\tif (branch) {\n\t\t\t\tfor (var i = 0; i < branch.length; i++) {\n\t\t\t\t\tvar itemId = branch[i];\n\t\t\t\t\tcode.call(this, itemId);\n\t\t\t\t\tif (this._branches[itemId])\n\t\t\t\t\t\tthis._traverseBranches(code, itemId);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_updateOrder: function(code){\n\n\t\t\tthis.fullOrder = powerArray.$create();\n\t\t\tthis._traverseBranches(function(taskId){\n\t\t\t\tthis.fullOrder.push(taskId);\n\t\t\t});\n\n\t\t\tif(code)\n\t\t\t\tDataStore.prototype._updateOrder.call(this, code);\n\t\t},\n\n\t\t_removeItemInner: function(id){\n\n\t\t\tvar items = [];\n\t\t\tthis.eachItem(function(child){\n\t\t\t\titems.push(child);\n\t\t\t}, id);\n\n\t\t\titems.push(this.getItem(id));\n\n\t\t\tfor(var i = 0; i < items.length; i++){\n\n\t\t\t\tthis._move_branch(items[i], this.getParent(items[i]), null);\n\t\t\t\tDataStore.prototype._removeItemInner.call(this, items[i].id);\n\t\t\t\tthis._move_branch(items[i], this.getParent(items[i]), null);\n\t\t\t}\n\t\t},\n\n\t\tmove: function(sid, tindex, parent){\n\t\t\t//target id as 4th parameter\n\t\t\tvar id = arguments[3];\n\t\t\tvar config = this._ganttConfig || {};\n\t\t\tvar root_id = config.root_id || 0;\n\t\t\tid = replaceValidZeroId(id, root_id);\n\t\t\tif (id) {\n\t\t\t\tif (id === sid) return;\n\n\t\t\t\tparent = this.getParent(id);\n\t\t\t\ttindex = this.getBranchIndex(id);\n\t\t\t}\n\t\t\tif(isEqualIds(sid, parent)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!utils.defined(parent)) {\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\t\t\tvar source = this.getItem(sid);\n\t\t\tvar source_pid = this.getParent(source.id);\n\n\t\t\tvar tbranch = this.getChildren(parent);\n\n\t\t\tif (tindex == -1)\n\t\t\t\ttindex = tbranch.length + 1;\n\t\t\tif (isEqualIds(source_pid, parent)) {\n\t\t\t\tvar sindex = this.getBranchIndex(sid);\n\t\t\t\tif (sindex == tindex) return;\n\t\t\t}\n\n\t\t\tif(this.callEvent(\"onBeforeItemMove\", [sid, parent, tindex]) === false)\n\t\t\t\treturn false;\n\n\t\t\tvar placeholderIds = [];\n\t\t\tfor(var i = 0; i < tbranch.length; i++){\n\t\t\t\tif (isPlaceholderTask(tbranch[i], null, this, this._ganttConfig)){\n\t\t\t\t\tplaceholderIds.push(tbranch[i]);\n\t\t\t\t\ttbranch.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._replace_branch_child(source_pid, sid);\n\t\t\ttbranch = this.getChildren(parent);\n\n\t\t\tvar tid = tbranch[tindex];\n\t\t\ttid = replaceValidZeroId(tid, root_id);\n\t\t\tif (!tid) //adding as last element\n\t\t\t\ttbranch.push(sid);\n\t\t\telse\n\t\t\t\ttbranch = tbranch.slice(0, tindex).concat([ sid ]).concat(tbranch.slice(tindex));\n\n\t\t\tif (placeholderIds.length){\n\t\t\t\ttbranch = tbranch.concat(placeholderIds);\n\t\t\t}\n\t\t\t// GS-2423 to return initial parent to the task before it will be moved\n\t\t\tif (!isEqualIds(source.$rendered_parent, source_pid) && !isEqualIds(source_pid, parent)){\n\t\t\t\tsource.$rendered_parent = source_pid;\n\t\t\t}\n\t\t\tthis.setParent(source, parent);\n\t\t\tthis._branches[parent] = tbranch;\n\n\t\t\tvar diff = this.calculateItemLevel(source) - source.$level;\n\t\t\tsource.$level += diff;\n\t\t\tthis.eachItem(function(item){\n\t\t\t\titem.$level += diff;\n\t\t\t}, source.id, this);\n\n\n\t\t\tthis._moveInner(this.getIndexById(sid), this.getIndexById(parent) + tindex);\n\n\t\t\tthis.callEvent(\"onAfterItemMove\", [sid, parent, tindex]);\n\t\t\tthis.refresh();\n\t\t},\n\n\t\tgetBranchIndex: function(id){\n\t\t\tvar branch = this.getChildren(this.getParent(id));\n\t\t\tlet index = branch.indexOf(id + \"\");\n\t\t\tif (index == -1){\n\t\t\t\tindex = branch.indexOf(+id);\n\t\t\t}\n\t\t\treturn index;\n\t\t},\n\t\thasChild: function(id){\n\t\t\tvar branch = this._branches[id];\n\t\t\treturn branch && branch.length;\n\t\t},\n\t\tgetChildren: function(id){\n\t\t\tvar branch = this._branches[id];\n\t\t\treturn branch ? branch : powerArray.$create();\n\t\t},\n\n\t\tisChildOf: function(childId, parentId){\n\t\t\tif (!this.exists(childId))\n\t\t\t\treturn false;\n\t\t\tif (parentId === this.$getRootId())\n\t\t\t\treturn true;\n\n\t\t\tif (!this.hasChild(parentId))\n\t\t\t\treturn false;\n\n\t\t\tvar item = this.getItem(childId);\n\t\t\tvar pid = this.getParent(childId);\n\n\t\t\tvar parent = this.getItem(parentId);\n\t\t\tif(parent.$level >= item.$level){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\twhile (item && this.exists(pid)) {\n\t\t\t\titem = this.getItem(pid);\n\n\t\t\t\tif (item && isEqualIds(item.id, parentId))\n\t\t\t\t\treturn true;\n\t\t\t\tpid = this.getParent(item);\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\tgetSiblings: function(id){\n\t\t\tif(!this.exists(id)){\n\t\t\t\treturn powerArray.$create();\n\t\t\t}\n\t\t\tvar parent = this.getParent(id);\n\t\t\treturn this.getChildren(parent);\n\n\t\t},\n\t\tgetNextSibling: function(id){\n\t\t\tvar siblings = this.getSiblings(id);\n\t\t\tfor(var i= 0, len = siblings.length; i < len; i++){\n\t\t\t\tif(isEqualIds(siblings[i], id)){\n\t\t\t\t\tvar nextSibling = siblings[i+1];\n\t\t\t\t\tif (nextSibling === 0 && i > 0){\n\t\t\t\t\t\tnextSibling = \"0\";\n\t\t\t\t\t}\n\t\t\t\t\treturn nextSibling || null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tgetPrevSibling: function(id){\n\t\t\tvar siblings = this.getSiblings(id);\n\t\t\tfor(var i= 0, len = siblings.length; i < len; i++){\n\t\t\t\tif(isEqualIds(siblings[i], id)){\n\t\t\t\t\tvar previousSibling = siblings[i-1];\n\t\t\t\t\tif (previousSibling === 0 && i > 0){\n\t\t\t\t\t\tpreviousSibling = \"0\";\n\t\t\t\t\t}\n\t\t\t\t\treturn previousSibling || null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tgetParent: function(id){\n\t\t\tvar item = null;\n\t\t\tif(id.id !== undefined){\n\t\t\t\titem = id;\n\t\t\t}else{\n\t\t\t\titem = this.getItem(id);\n\t\t\t}\n\n\t\t\tvar parent;\n\t\t\tif(item){\n\t\t\t\tparent = item[this.$parentProperty];\n\t\t\t}else{\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\t\t\treturn parent;\n\n\t\t},\n\n\t\tclearAll: function(){\n\t\t\tthis._branches = {};\n\t\t\tDataStore.prototype.clearAll.call(this);\n\t\t},\n\n\t\tcalculateItemLevel: function(item){\n\t\t\tvar level = 0;\n\t\t\tthis.eachParent(function(){\n\t\t\t\tlevel++;\n\t\t\t}, item);\n\t\t\treturn level;\n\t\t},\n\n\t\t_setParentInner: function(item, new_pid, silent){\n\t\t\tif(!silent){\n\t\t\t\tif(item.hasOwnProperty(\"$rendered_parent\")){\n\t\t\t\t\tthis._move_branch(item, item.$rendered_parent, new_pid);\n\t\t\t\t}else{\n\t\t\t\t\tthis._move_branch(item, item[this.$parentProperty], new_pid);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tsetParent: function(item, new_pid, silent){\n\t\t\tthis._setParentInner(item, new_pid, silent);\n\n\t\t\titem[this.$parentProperty] = new_pid;\n\t\t},\n\n\t\t_eachItemCached: function(code, cache){\n\t\t\tfor(var i = 0, len = cache.length; i < len; i++){\n\t\t\t\tcode.call(this, cache[i]);\n\t\t\t}\n\t\t},\n\t\t_eachItemIterate: function(code, startId, cache){\n\t\t\tvar itemsStack = this.getChildren(startId);\n\t\t\tif(itemsStack.length){\n\t\t\t\titemsStack = itemsStack.slice().reverse();\n\t\t\t}\n\t\t\twhile(itemsStack.length){\n\t\t\t\tvar itemId = itemsStack.pop();\n\t\t\t\tvar item = this.getItem(itemId);\n\t\t\t\tcode.call(this, item);\n\t\t\t\tif(cache){\n\t\t\t\t\tcache.push(item);\n\t\t\t\t}\n\n\t\t\t\tif(this.hasChild(item.id)){\n\t\t\t\t\tvar children = this.getChildren(item.id);\n\t\t\t\t\tvar len = children.length;\n\t\t\t\t\tfor(var i = len - 1; i >= 0; i--){\n\t\t\t\t\t\titemsStack.push(children[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\n\t\teachItem: function(code, parent){\n\t\t\tvar rootId = this.$getRootId();\n\t\t\tif (!utils.defined(parent)) {\n\t\t\t\tparent = rootId;\n\t\t\t}\n\t\t\tvar startId = replaceValidZeroId(parent, rootId) || rootId;\n\n\t\t\tvar useCache = false;\n\t\t\tvar buildCache = false;\n\t\t\tvar cache = null;\n\t\t\tif(startId === rootId){\n\t\t\t\tif(this._eachItemMainRangeCache){\n\t\t\t\t\tuseCache = true;\n\t\t\t\t\tcache = this._eachItemMainRangeCache;\n\t\t\t\t}else{\n\t\t\t\t\tbuildCache = true;\n\t\t\t\t\tcache = this._eachItemMainRangeCache = [];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(useCache){\n\t\t\t\tthis._eachItemCached(code, cache);\n\t\t\t}else{\n\t\t\t\tthis._eachItemIterate(code, startId, buildCache ? cache : null);\n\t\t\t}\n\t\t},\n\t\teachParent: function(code, startItem) {\n\t\t\tvar parentsHash = {};\n\t\t\tvar item = startItem;\n\t\t\tvar parent = this.getParent(item);\n\n\t\t\twhile (this.exists(parent)) {\n\t\t\t\tif (parentsHash[parent]) {\n\t\t\t\t\tthrow new Error(\"Invalid tasks tree. Cyclic reference has been detected on task \" + parent);\n\t\t\t\t}\n\t\t\t\tparentsHash[parent] = true;\n\t\t\t\titem = this.getItem(parent);\n\t\t\t\tcode.call(this, item);\n\t\t\t\tparent = this.getParent(item);\n\t\t\t}\n\t\t},\n\t\t_add_branch: function(item, index, parent){\n\t\t\tvar pid = parent === undefined ? this.getParent(item) : parent;\n\t\t\tif (!this.hasChild(pid))\n\t\t\t\tthis._branches[pid] = powerArray.$create();\n\t\t\tvar branch = this.getChildren(pid);\n\t\t\tvar added_already = branch.indexOf(item.id + \"\") > -1 || branch.indexOf(+item.id) > -1;\n\t\t\tif(!added_already){\n\t\t\t\tif(index*1 == index){\n\n\t\t\t\t\tbranch.splice(index, 0, item.id);\n\t\t\t\t}else{\n\t\t\t\t\tbranch.push(item.id);\n\t\t\t\t}\n\n\t\t\t\titem.$rendered_parent = pid;\n\t\t\t}\n\t\t},\n\t\t_move_branch: function(item, old_parent, new_parent){\n\t\t\tthis._eachItemMainRangeCache = null;\n\t\t\t//this.setParent(item, new_parent);\n\t\t\t//this._sync_parent(task);\n\t\t\tthis._replace_branch_child(old_parent, item.id);\n\t\t\tif(this.exists(new_parent) || isEqualIds(new_parent, this.$getRootId())){\n\n\t\t\t\tthis._add_branch(item, undefined, new_parent);\n\t\t\t}else{\n\t\t\t\tdelete this._branches[item.id];\n\t\t\t}\n\t\t\titem.$level =  this.calculateItemLevel(item);\n\t\t\tthis.eachItem(function(child){\n\t\t\t\tchild.$level = this.calculateItemLevel(child);\n\t\t\t}, item.id);\n\t\t},\n\n\t\t_replace_branch_child: function(node, old_id, new_id){\n\t\t\tvar branch = this.getChildren(node);\n\t\t\tif (branch && node !== undefined){\n\t\t\t\tvar newbranch = powerArray.$create();\n\n\t\t\t\tlet index = branch.indexOf(old_id + \"\");\n\t\t\t\tif (index == -1 && !isNaN(+old_id)){\n\t\t\t\t\tindex = branch.indexOf(+old_id);\n\t\t\t\t} \n\n\t\t\t\tif (index > -1){\n\t\t\t\t\tif (new_id){\n\t\t\t\t\t\tbranch.splice(index, 1, new_id);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbranch.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnewbranch = branch;\n\n\t\t\t\tthis._branches[node] = newbranch;\n\t\t\t}\n\n\t\t},\n\n\t\tsort: function(field, desc, parent){\n\t\t\tif (!this.exists(parent)) {\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\n\t\t\tif (!field) field = \"order\";\n\t\t\tvar criteria = (typeof(field) == \"string\") ? (function(a, b) {\n\t\t\t\tif (a[field] == b[field] ||\n\t\t\t\t\t(helpers.isDate(a[field]) && helpers.isDate(b[field]) && a[field].valueOf() == b[field].valueOf()))\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tvar result = a[field] > b[field];\n\t\t\t\treturn result ? 1 : -1;\n\t\t\t}) : field;\n\n\t\t\tif (desc) {\n\t\t\t\tvar original_criteria = criteria;\n\t\t\t\tcriteria = function (a, b) {\n\t\t\t\t\treturn original_criteria(b, a);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar els = this.getChildren(parent);\n\n\t\t\tif (els){\n\t\t\t\tvar temp = [];\n\t\t\t\tfor (var i = els.length - 1; i >= 0; i--)\n\t\t\t\t\ttemp[i] = this.getItem(els[i]);\n\n\t\t\t\ttemp.sort(criteria);\n\n\t\t\t\tfor (var i = 0; i < temp.length; i++) {\n\t\t\t\t\tels[i] = temp[i].id;\n\t\t\t\t\tthis.sort(field, desc, els[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tfilter: function(rule){\n\t\t\tfor(let i in this.pull){\n\t\t\t\tconst renderedParent = this.pull[i].$rendered_parent;\n\t\t\t\tconst actualParent = this.getParent(this.pull[i]);\n\t\t\t\t//GS-2339: could be different types of the ids\n\t\t\t\tif(!isEqualIds(renderedParent,actualParent)){\n\t\t\t\t\tthis._move_branch(this.pull[i], renderedParent, actualParent);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn DataStore.prototype.filter.apply(this, arguments);\n\t\t},\n\n\t\topen: function(id){\n\t\t\tif(this.exists(id)){\n\t\t\t\tthis.getItem(id).$open = true;\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates as they will be recalculated later\n\t\t\t\tthis._skipTaskRecalculation = true;\n\t\t\t\tthis.callEvent(\"onItemOpen\", [id]);\n\t\t\t}\n\t\t},\n\n\t\tclose: function(id){\n\t\t\tif(this.exists(id)){\n\t\t\t\tthis.getItem(id).$open = false;\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates as they will be recalculated later\n\t\t\t\tthis._skipTaskRecalculation = true;\n\t\t\t\tthis.callEvent(\"onItemClose\", [id]);\n\t\t\t}\n\t\t},\n\n\t\tdestructor: function(){\n\t\t\tDataStore.prototype.destructor.call(this);\n\t\t\tthis._branches = null;\n\t\t\tthis._indexRangeCache = {};\n\t\t\tthis._eachItemMainRangeCache = null;\n\t\t}\n\t},\n\tDataStore.prototype\n);\n\nfunction isEqualIds(first, second){\n\treturn String(first) === String(second);\n};\n\nexport default TreeDataStore;","import env from \"./env\";\n\nexport default function(gantt){\n\treturn env.isNode || !gantt.$root;\n};","import isHeadless from \"../../utils/is_headless\";\n\nconst storeRenderCreator = function(name, gantt){\n\n\tconst store = gantt.getDatastore(name);\n\n\tconst itemRepainter = {\n\t\trenderItem: function(id, renderer){\n\n\t\t\tconst renders = renderer.getLayers();\n\n\t\t\tconst item = store.getItem(id);\n\t\t\tif(item && store.isVisible(id)) {\n\t\t\t\tfor (let i = 0; i < renders.length; i++)\n\t\t\t\t\trenders[i].render_item(item);\n\t\t\t}\n\t\t},\n\t\trenderItems: function(renderer){\n\t\t\tconst renderers = renderer.getLayers();\n\t\t\tfor (let i = 0; i < renderers.length; i++) {\n\t\t\t\trenderers[i].clear();\n\t\t\t}\n\n\t\t\tlet allData = null;\n\n\t\t\tconst loadedRanges = {};\n\t\t\tfor (let i = 0; i < renderers.length; i++) {\n\t\t\t\tconst layer = renderers[i];\n\t\t\t\tlet layerData;\n\t\t\t\tif(layer.get_visible_range){\n\n\t\t\t\t\tvar range = layer.get_visible_range(store);\n\t\t\t\t\tif(range.start !== undefined && range.end !== undefined){\n\t\t\t\t\t\tvar key = range.start + \" - \" + range.end;\n\t\t\t\t\t\tif(loadedRanges[key]){\n\t\t\t\t\t\t\tlayerData = loadedRanges[key];\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tlayerData = store.getIndexRange(range.start, range.end);\n\t\t\t\t\t\t\tloadedRanges[key] = layerData;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else if(range.ids !== undefined){\n\t\t\t\t\t\tlayerData = range.ids.map(function(id){\n\t\t\t\t\t\t\treturn store.getItem(id);\n\t\t\t\t\t\t});\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthrow new Error(\"Invalid range returned from 'getVisibleRange' of the layer\");\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tif(!allData){\n\t\t\t\t\t\tallData = store.getVisibleItems();\n\t\t\t\t\t}\n\t\t\t\t\tlayerData = allData;\n\t\t\t\t}\n\n\t\t\t\tif (layer.prepare_data) {\n\t\t\t\t\t// GS-1605. Highlight timeline cells below tasks and in an empty chart\n\t\t\t\t\tlayer.prepare_data(layerData);\n\t\t\t\t}\n\n\t\t\t\trenderers[i].render_items(layerData);\n\t\t\t}\n\t\t},\n\t\tupdateItems: function(layer) {\n\t\t\tif(layer.update_items){\n\t\t\t\tlet data = [];\n\t\t\t\tif(layer.get_visible_range){\n\n\t\t\t\t\tvar range = layer.get_visible_range(store);\n\t\t\t\t\tif(range.start !== undefined && range.end !== undefined){\n\t\t\t\t\t\tdata = store.getIndexRange(range.start, range.end);\n\t\t\t\t\t}\n\t\t\t\t\tif(range.ids !== undefined){\n\t\t\t\t\t\tlet extraDataArr = range.ids.map(function(id){\n\t\t\t\t\t\t\treturn store.getItem(id);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// GS-2502: range.ids might not exist in other datastores\n\t\t\t\t\t\tif(extraDataArr.length > 0){\n\t\t\t\t\t\t\textraDataArr = extraDataArr.filter(element => element !== undefined);\n\t\t\t\t\t\t\tdata = data.concat(extraDataArr);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif((range.start == undefined || range.end == undefined) && range.ids == undefined)  {\n\t\t\t\t\t\tthrow new Error(\"Invalid range returned from 'getVisibleRange' of the layer\");\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tdata = store.getVisibleItems();\n\t\t\t\t}\n\n\t\t\t\tif (layer.prepare_data) {\n\t\t\t\t\t// GS-1605. Highlight timeline cells below tasks and in an empty chart\n\t\t\t\t\tlayer.prepare_data(data, layer);\n\t\t\t\t}\n\t\t\t\tlayer.update_items(data);\n\t\t\t}\n\t\t}\n\t};\n\n\tstore.attachEvent(\"onStoreUpdated\", function(id, item, action){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\tif(renderer){\n\t\t\trenderer.onUpdateRequest = function(layer){\n\t\t\t\titemRepainter.updateItems(layer);\n\t\t\t};\n\t\t}\n\t});\n\n\tfunction skipRepaint(gantt){\n\t\tconst state = gantt.$services.getService(\"state\");\n\t\tif(state.getState(\"batchUpdate\").batch_update){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tstore.attachEvent(\"onStoreUpdated\", function(id, item, action){\n\t\tif(skipRepaint(gantt)){\n\t\t\treturn;\n\t\t}\n\t\tif(!id || action == \"move\" || action == \"delete\"){\n\t\t\tstore.callEvent(\"onBeforeRefreshAll\", []);\n\t\t\tstore.callEvent(\"onAfterRefreshAll\", []);\n\t\t}else{\n\t\t\tstore.callEvent(\"onBeforeRefreshItem\", [item.id]);\n\t\t\tstore.callEvent(\"onAfterRefreshItem\", [item.id]);\n\t\t}\n\t});\n\n\tstore.attachEvent(\"onAfterRefreshAll\", function(){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\tif(renderer && !skipRepaint(gantt)){\n\t\t\titemRepainter.renderItems(renderer);\n\t\t}\n\t});\n\tstore.attachEvent(\"onAfterRefreshItem\", function(id){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\tif(renderer){\n\t\t\titemRepainter.renderItem(id, renderer);\n\t\t}\n\t});\n\n\t// TODO: probably can be done more in a more efficient way\n\tstore.attachEvent(\"onItemOpen\", function(){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tgantt.render();\n\t});\n\n\tstore.attachEvent(\"onItemClose\", function(){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tgantt.render();\n\t});\n\n\tfunction refreshId(renders, oldId, newId, item) {\n\t\tfor (let i = 0; i < renders.length; i++) {\n\t\t\trenders[i].change_id(oldId, newId);\n\t\t}\n\t}\n\n\tstore.attachEvent(\"onIdChange\", function(oldId, newId){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\t// in case of linked datastores (tasks <-> links), id change should recalculate something in linked datastore before any repaint\n\t\t// use onBeforeIdChange for this hook.\n\t\t// TODO: use something more reasonable instead\n\t\tstore.callEvent(\"onBeforeIdChange\", [oldId, newId]);\n\n\t\tif(skipRepaint(gantt)){\n\t\t\treturn;\n\t\t}\n\t\tif(!store.isSilent()){\n\t\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\t\tif(renderer){ // missing check for renderer GS-1814\n\t\t\t\trefreshId(renderer.getLayers(), oldId, newId, store.getItem(newId));\n\t\t\t\titemRepainter.renderItem(newId, renderer);\n\t\t\t}else{\n\t\t\t\t// GS-1814 repaint ui to apply new id when the datastore don't have own renderer\n\t\t\t\tgantt.render();\n\t\t\t}\n\t\t}\n\t});\n\n};\n\nexport default {\n\tbindDataStore: storeRenderCreator\n};","import * as utils from \"../../utils/utils\";\nimport createTasksFacade from \"./datastore_tasks\";\nimport createLinksFacade from \"./datastore_links\";\nimport DataStore from \"../datastore/datastore\";\nimport TreeDataStore from \"../datastore/treedatastore\";\nimport createDatastoreSelect from \"../datastore/select\";\nimport datastoreRender from \"../datastore/datastore_render\";\nimport isHeadless from \"../../utils/is_headless\";\nimport {replaceValidZeroId} from \"../../utils/helpers\";\n\nfunction getDatastores(){\n\tvar storeNames = this.$services.getService(\"datastores\");\n\tvar res = [];\n\tfor(var i = 0; i < storeNames.length; i++){\n\t\tvar store = this.getDatastore(storeNames[i]);\n\t\tif(!store.$destroyed){\n\t\t\tres.push(store);\n\t\t}\n\t}\n\treturn res;\n}\n\nvar createDatastoreFacade = function(){\n\treturn {\n\tcreateDatastore: function(config){\n\n\t\tvar $StoreType = (config.type || \"\").toLowerCase() == \"treedatastore\" ? TreeDataStore : DataStore;\n\n\t\tif (config) {\n\t\t\tvar self = this;\n\t\t\tconfig.openInitially = function(){ return self.config.open_tree_initially; };\n\t\t\tconfig.copyOnParse = function(){ return self.config.deepcopy_on_parse; };\n\t\t}\n\n\t\tvar store = new $StoreType(config);\n\t\tthis.mixin(store, createDatastoreSelect(store));\n\n\t\tif (config.name) {\n\t\t\tvar servicePrefix = \"datastore:\";\n\t\t\tvar storeAccessName = servicePrefix + config.name;\n\n\t\t\tstore.attachEvent(\"onDestroy\", function(){\n\t\t\t\tthis.$services.dropService(storeAccessName);\n\t\t\t\tvar storeList = this.$services.getService(\"datastores\");\n\t\t\t\tfor(var i = 0; i < storeList.length; i++){\n\t\t\t\t\tif(storeList[i] === config.name){\n\t\t\t\t\t\tstoreList.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}.bind(this));\n\n\t\t\tthis.$services.dropService(storeAccessName);\n\t\t\tthis.$services.setService(storeAccessName, function() { return store; } );\n\n\t\t\tvar storeList = this.$services.getService(\"datastores\");\n\t\t\tif (!storeList) {\n\t\t\t\tstoreList = [];\n\t\t\t\tthis.$services.setService(\"datastores\", function() { return storeList; });\n\t\t\t\tstoreList.push(config.name);\n\t\t\t} else if (storeList.indexOf(config.name) < 0) {\n\t\t\t\tstoreList.push(config.name);\n\t\t\t}\n\n\t\t\tdatastoreRender.bindDataStore(config.name, this);\n\n\t\t}\n\n\t\treturn store;\n\t},\n\tgetDatastore: function(name){\n\t\treturn this.$services.getService(\"datastore:\" + name);\n\t},\n\t_getDatastores: getDatastores,\n\n\trefreshData: function () {\n\t\tvar scrollState;\n\t\tif(!isHeadless(this)){\n\t\t\tscrollState = this.getScrollState();\n\t\t}\n\n\t\tthis.callEvent(\"onBeforeDataRender\", []);\n\n\t\tvar stores = getDatastores.call(this);\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i].refresh();\n\t\t}\n\n\t\tif(this.config.preserve_scroll && !isHeadless(this) && (scrollState.x || scrollState.y)){\n\t\t\tthis.scrollTo(scrollState.x, scrollState.y);\n\t\t}\n\t\tthis.callEvent(\"onDataRender\", []);\n\n\t},\n\n\tisChildOf: function(childId, parentId){\n\t\treturn this.$data.tasksStore.isChildOf(childId, parentId);\n\t},\n\n\trefreshTask: function (taskId, refresh_links) {\n\t\tvar task = this.getTask(taskId);\n\t\tvar self = this;\n\t\tfunction refreshLinks(){\n\t\t\tif (refresh_links !== undefined && !refresh_links)\n\t\t\t\treturn;\n\t\t\tfor (var i = 0; i < task.$source.length; i++) {\n\t\t\t\tself.refreshLink(task.$source[i]);\n\t\t\t}\n\t\t\tfor (var i = 0; i < task.$target.length; i++) {\n\t\t\t\tself.refreshLink(task.$target[i]);\n\t\t\t}\n\t\t}\n\n\t\tif (task && this.isTaskVisible(taskId)) {\n\t\t\tthis.$data.tasksStore.refresh(taskId, !!this.getState(\"tasksDnd\").drag_id || refresh_links === false);// do quick refresh during drag and drop\n\t\t\trefreshLinks();\n\t\t}else if(this.isTaskExists(taskId) && this.isTaskExists(this.getParent(taskId)) && !this._bulk_dnd){\n\t\t\tthis.refreshTask(this.getParent(taskId));\n\n\t\t\tvar hasSplitParent = false;\n\t\t\tthis.eachParent(function(parent){\n\t\t\t\tif(hasSplitParent || this.isSplitTask(parent)){\n\t\t\t\t\thasSplitParent = true;\n\t\t\t\t}\n\t\t\t}, taskId);\n\t\t\tif(hasSplitParent){\n\t\t\t\trefreshLinks();\n\t\t\t}\n\t\t}\n\n\t},\n\trefreshLink: function (linkId) {\n\t\tthis.$data.linksStore.refresh(linkId, !!this.getState(\"tasksDnd\").drag_id);// do quick refresh during drag and drop\n\t},\n\n\tsilent: function(code){\n\t\tvar gantt = this;\n\t\tgantt.$data.tasksStore.silent(function(){\n\t\t\tgantt.$data.linksStore.silent(function(){\n\t\t\t\tcode();\n\t\t\t});\n\t\t});\n\t},\n\n\tclearAll: function () {\n\t\tvar stores = getDatastores.call(this);\n\t\t\n\t\t// clear all stores without invoking clearAll event\n\t\t// in order to prevent calling handlers when only some stores are cleared\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i].silent(function(){\n\t\t\t\tstores[i].clearAll();\t\n\t\t\t});\n\t\t}\n\t\t// run clearAll again to invoke events\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i].clearAll();\t\n\t\t}\n\n\t\tthis._update_flags();\n\t\tthis.userdata = {};\n\t\tthis.callEvent(\"onClear\", []);\n\t\tthis.render();\n\t},\n\t_clear_data: function () {\n\t\tthis.$data.tasksStore.clearAll();\n\t\tthis.$data.linksStore.clearAll();\n\t\tthis._update_flags();\n\t\tthis.userdata = {};\n\t},\n\n\tselectTask: function(id){\n\t\tvar store = this.$data.tasksStore;\n\t\tif(!this.config.select_task)\n\t\t\treturn false;\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tif (id){\n\t\t\tlet oldSelectId = this.getSelectedId();\n\t\t\t// Don't repaint the resource panel as the data didn't change\n\t\t\tstore._skipResourceRepaint = true;\n\t\t\tstore.select(id);\n\t\t\tstore._skipResourceRepaint = false;\n\t\t\t// GS-730. Split task is not included in the tree, \n\t\t\t// so the datastore renderer will think that the task is not visible\n\t\t\tif (oldSelectId && store.pull[oldSelectId].$split_subtask && oldSelectId != id) {\n\t\t\t\tthis.refreshTask(oldSelectId);\n\t\t\t}\n\t\t\tif (store.pull[id].$split_subtask && oldSelectId != id) {// GS-1850. Do not repaint split task after double click\n\t\t\t\tthis.refreshTask(id);\n\t\t\t}\n\t\t}\n\t\treturn store.getSelectedId();\n\t},\n\tunselectTask: function(id){\n\t\tvar store = this.$data.tasksStore;\n\t\tstore.unselect(id);\n\t\t// GS-730. Split task is not included in the tree, \n\t\t// so the datastore renderer will think that the task is not visible\n\t\tif (id && store.pull[id].$split_subtask) {\n\t\t\tthis.refreshTask(id);\n\t\t}\n\t},\n\tisSelectedTask: function(id){\n\t\treturn this.$data.tasksStore.isSelected(id);\n\t},\n\tgetSelectedId: function() {\n\t\treturn this.$data.tasksStore.getSelectedId();\n\t}\n};\n};\n\nfunction createFacade(){\n\tvar res = utils.mixin({}, createDatastoreFacade());\n\tutils.mixin(res, createTasksFacade());\n\tutils.mixin(res, createLinksFacade());\n\treturn res;\n}\n\n\n\n\nexport default {create: createFacade};","function createDataStoreSelectMixin(store){\n\tvar selectedId = null;\n\n\tvar deleteItem = store._removeItemInner;\n\t\n\tfunction unselect(id){\n\t\tselectedId = null;\n\t\tthis.callEvent(\"onAfterUnselect\", [id]);\n\t}\n\n\tstore._removeItemInner = function(id){\n\t\tif(selectedId == id){\n\t\t\tunselect.call(this, id);\n\t\t}\n\n\t\tif(selectedId && this.eachItem){\n\t\t\tthis.eachItem(function(subItem){\n\t\t\t\tif(subItem.id == selectedId){\n\t\t\t\t\tunselect.call(this, subItem.id);\n\t\t\t\t}\n\t\t\t}, id);\n\t\t}\n\n\t\treturn deleteItem.apply(this, arguments);\n\t};\n\n\tstore.attachEvent(\"onIdChange\", function(oldId, newId) {\n\t\tif (store.getSelectedId() == oldId) {\n\t\t\tstore.silent(function () {\n\t\t\t\tstore.unselect(oldId);\n\t\t\t\tstore.select(newId);\n\t\t\t});\n\t\t}\n\t});\n\n\treturn {\n\t\tselect: function(id){\n\t\t\tif (id){\n\n\t\t\t\tif(selectedId == id)\n\t\t\t\t\treturn selectedId;\n\n\t\t\t\tif(!this._skip_refresh) {\n\t\t\t\t\tif (!this.callEvent(\"onBeforeSelect\", [id])) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.unselect();\n\n\t\t\t\tselectedId = id;\n\n\t\t\t\tif(!this._skip_refresh) {\n\t\t\t\t\tthis.refresh(id);\n\t\t\t\t\tthis.callEvent(\"onAfterSelect\", [id]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn selectedId;\n\t\t},\n\t\tgetSelectedId: function(){\n\t\t\treturn selectedId;\n\t\t},\n\t\tisSelected: function(id){\n\t\t\treturn id == selectedId;\n\t\t},\n\t\tunselect: function(id){\n\t\t\tvar id = id || selectedId;\n\t\t\tif(!id)\n\t\t\t\treturn;\n\t\t\tselectedId = null;\n\t\t\tif(!this._skip_refresh){\n\t\t\t\tthis.refresh(id);\n\t\t\t\tunselect.call(this, id);\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default createDataStoreSelectMixin;","import * as utils from \"../../utils/utils\";\n\n\nvar createLinksStoreFacade = function(){\n\treturn {\n\tgetLinkCount: function () {\n\t\treturn this.$data.linksStore.count();\n\t},\n\n\tgetLink : function (id) {\n\t\treturn this.$data.linksStore.getItem(id);\n\t},\n\n\tgetLinks : function () {\n\t\treturn this.$data.linksStore.getItems();\n\t},\n\n\tisLinkExists : function (id) {\n\t\treturn this.$data.linksStore.exists(id);\n\t},\n\n\taddLink : function (link) {\n\t\tconst newLink = this.$data.linksStore.addItem(link);\n\t\t// GS-1222. Update fullOrder otherwise the link won't appear after render\n\t\tif (this.$data.linksStore.isSilent()){\n\t\t\tthis.$data.linksStore.fullOrder.push(newLink);\n\t\t}\n\t\treturn newLink;\n\t},\n\n\tupdateLink : function (id, data) {\n\t\tif (!utils.defined(data))\n\t\t\tdata = this.getLink(id);\n\t\tthis.$data.linksStore.updateItem(id, data);\n\t},\n\n\tdeleteLink : function (id) {\n\t\treturn this.$data.linksStore.removeItem(id);\n\t},\n\n\tchangeLinkId : function (oldid, newid) {\n\t\treturn this.$data.linksStore.changeId(oldid, newid);\n\t}\n};\n};\n\nexport default createLinksStoreFacade;","import * as utils from \"../../../utils/utils\";\n\nfunction ScaleHelper(gantt){\n\tvar dateHelper = gantt.date;\n\tvar services = gantt.$services;\n\n\treturn {\n\t\tgetSum: function (sizes, from, to) {\n\t\t\tif (to === undefined)\n\t\t\t\tto = sizes.length - 1;\n\t\t\tif (from === undefined)\n\t\t\t\tfrom = 0;\n\n\t\t\tvar summ = 0;\n\t\t\tfor (var i = from; i <= to; i++)\n\t\t\t\tsumm += sizes[i];\n\n\t\t\treturn summ;\n\t\t},\n\t\tsetSumWidth: function (sum_width, scale, from, to) {\n\t\t\tvar parts = scale.width;\n\n\t\t\tif (to === undefined)\n\t\t\t\tto = parts.length - 1;\n\t\t\tif (from === undefined)\n\t\t\t\tfrom = 0;\n\t\t\tvar length = to - from + 1;\n\n\t\t\tif (from > parts.length - 1 || length <= 0 || to > parts.length - 1)\n\t\t\t\treturn;\n\n\t\t\tvar oldWidth = this.getSum(parts, from, to);\n\n\t\t\tvar diff = sum_width - oldWidth;\n\n\t\t\tthis.adjustSize(diff, parts, from, to);\n\t\t\tthis.adjustSize(-diff, parts, to + 1);\n\n\t\t\tscale.full_width = this.getSum(parts);\n\t\t},\n\t\tsplitSize: function (width, count) {\n\t\t\tvar arr = [];\n\t\t\tfor (var i = 0; i < count; i++) arr[i] = 0;\n\n\t\t\tthis.adjustSize(width, arr);\n\t\t\treturn arr;\n\n\t\t},\n\t\tadjustSize: function (width, parts, from, to) {\n\t\t\tif (!from)\n\t\t\t\tfrom = 0;\n\t\t\tif (to === undefined)\n\t\t\t\tto = parts.length - 1;\n\n\t\t\tvar length = to - from + 1;\n\n\t\t\tvar full = this.getSum(parts, from, to);\n\n\t\t\tfor (var i = from; i <= to; i++) {\n\t\t\t\tvar share = Math.floor(width * (full ? (parts[i] / full) : (1 / length)));\n\n\t\t\t\tfull -= parts[i];\n\t\t\t\twidth -= share;\n\t\t\t\tlength--;\n\n\t\t\t\tparts[i] += share;\n\t\t\t}\n\t\t\tparts[parts.length - 1] += width;\n\t\t},\n\t\tsortScales: function (scales) {\n\t\t\tfunction cellSize(unit, step) {\n\t\t\t\tvar d = new Date(1970, 0, 1);\n\t\t\t\treturn dateHelper.add(d, step, unit) - d;\n\t\t\t}\n\n\t\t\tscales.sort(function (a, b) {\n\t\t\t\tif (cellSize(a.unit, a.step) < cellSize(b.unit, b.step)) {\n\t\t\t\t\treturn 1;\n\t\t\t\t} else if (cellSize(a.unit, a.step) > cellSize(b.unit, b.step)) {\n\t\t\t\t\treturn -1;\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfor (var i = 0; i < scales.length; i++) {\n\t\t\t\tscales[i].index = i;\n\t\t\t}\n\t\t},\n\t\t_isLegacyMode: function(config){\n\t\t\tvar scaleConfig = config || gantt.config;\n\t\t\treturn scaleConfig.scale_unit || scaleConfig.date_scale || scaleConfig.subscales;\n\t\t},\n\t\t_prepareScaleObject: function(scale){\n\t\t\tvar format = scale.format;\n\t\t\tif(!format){\n\t\t\t\tformat = scale.template || scale.date || \"%d %M\";\n\t\t\t}\n\n\t\t\tif(typeof format === \"string\"){\n\t\t\t\tformat = gantt.date.date_to_str(format);\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tunit: scale.unit || \"day\",\n\t\t\t\tstep: scale.step || 1,\n\t\t\t\tformat: format,\n\t\t\t\tcss: scale.css\n\t\t\t};\n\t\t},\n\t\tprimaryScale: function(config) {\n\t\t\tvar templates = services.getService(\"templateLoader\");\n\t\t\tvar legacyMode = this._isLegacyMode(config);\n\n\t\t\tvar scaleConfig = config || gantt.config;\n\n\t\t\tvar result;\n\t\t\tif(legacyMode){\n\t\t\t\ttemplates.initTemplate(\"date_scale\", undefined, undefined, scaleConfig, gantt.config.templates);\n\t\t\t\tresult = {\n\t\t\t\t\tunit: gantt.config.scale_unit,\n\t\t\t\t\tstep: gantt.config.step,\n\t\t\t\t\ttemplate: gantt.templates.date_scale,\n\t\t\t\t\tdate: gantt.config.date_scale,\n\t\t\t\t\tcss: gantt.templates.scale_cell_class\n\t\t\t\t};\n\t\t\t}else{\n\t\t\t\tvar primaryScale = scaleConfig.scales[0];\n\t\t\t\tresult = {\n\t\t\t\t\tunit: primaryScale.unit,\n\t\t\t\t\tstep: primaryScale.step,\n\t\t\t\t\ttemplate: primaryScale.template,\n\t\t\t\t\tformat: primaryScale.format,\n\t\t\t\t\tdate: primaryScale.date,\n\t\t\t\t\tcss: primaryScale.css || gantt.templates.scale_cell_class\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn this._prepareScaleObject(result);\n\t\t},\n\t\tgetSubScales: function(config) {\n\t\t\tvar legacyMode = this._isLegacyMode(config);\n\t\t\tvar scaleConfig = config || gantt.config;\n\t\t\tvar scales;\n\t\t\tif(legacyMode){\n\t\t\t\tlet docLink = \"https://docs.dhtmlx.com/gantt/migrating.html#:~:text=%3D%20false%3B-,Time%20scale%20settings,-Configuration%20of%20time\";\n\t\t\t\tif (gantt.env.isFF){\n\t\t\t\t\tdocLink = \"https://docs.dhtmlx.com/gantt/migrating.html#6162\";\n\t\t\t\t}\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.warn(`You are using the obsolete scale configuration.\nIt will stop working in the future versions.\nPlease migrate the configuration to the newer version:\n${docLink}`);\n\t\t\t\tscales = scaleConfig.subscales || [];\n\t\t\t}else{\n\t\t\t\tscales = scaleConfig.scales.slice(1);\n\t\t\t}\n\t\t\t\n\t\t\treturn scales.map(function(scale){\n\t\t\t\treturn this._prepareScaleObject(scale);\n\t\t\t}.bind(this));\n\t\t},\n\n\t\tprepareConfigs: function (scales, min_coll_width, container_width, scale_height, minDate, maxDate, rtl) {\n\t\t\tvar heights = this.splitSize(scale_height, scales.length);\n\t\t\tvar full_width = container_width;\n\n\t\t\tvar configs = [];\n\t\t\tfor (var i = scales.length - 1; i >= 0; i--) {\n\t\t\t\tvar main_scale = (i == scales.length - 1);\n\t\t\t\tvar cfg = this.initScaleConfig(scales[i], minDate, maxDate);\n\t\t\t\tif (main_scale) {\n\t\t\t\t\tthis.processIgnores(cfg);\n\t\t\t\t}\n\n\t\t\t\tthis.initColSizes(cfg, min_coll_width, full_width, heights[i]);\n\t\t\t\tthis.limitVisibleRange(cfg);\n\n\t\t\t\tif (main_scale) {\n\t\t\t\t\tfull_width = cfg.full_width;\n\t\t\t\t}\n\n\t\t\t\tconfigs.unshift(cfg);\n\t\t\t}\n\n\n\t\t\tfor (var i = 0; i < configs.length - 1; i++) {\n\t\t\t\tthis.alineScaleColumns(configs[configs.length - 1], configs[i]);\n\t\t\t}\n\t\t\tfor (var i = 0; i < configs.length; i++) {\n\n\t\t\t\tif(rtl){\n\t\t\t\t\tthis.reverseScale(configs[i]);\n\t\t\t\t}\n\t\t\t\tthis.setPosSettings(configs[i]);\n\t\t\t}\n\t\t\treturn configs;\n\n\t\t},\n\n\t\treverseScale: function(scale){\n\t\t\tscale.width = scale.width.reverse();\n\t\t\tscale.trace_x = scale.trace_x.reverse();\n\n\t\t\tvar indexes = scale.trace_indexes;\n\t\t\tscale.trace_indexes = {};\n\t\t\tscale.trace_index_transition = {};\n\t\t\tscale.rtl = true;\n\t\t\tfor(var i = 0; i < scale.trace_x.length; i++){\n\t\t\t\tscale.trace_indexes[scale.trace_x[i].valueOf()] = i;\n\t\t\t\tscale.trace_index_transition[indexes[scale.trace_x[i].valueOf()]] = i;\n\t\t\t}\n\t\t\treturn scale;\n\t\t},\n\n\t\tsetPosSettings: function (config) {\n\t\t\tfor (var i = 0, len = config.trace_x.length; i < len; i++) {\n\t\t\t\tconfig.left.push((config.width[i - 1] || 0) + (config.left[i - 1] || 0));\n\t\t\t}\n\t\t},\n\n\t\t_ignore_time_config: function (date, scale) {\n\n\t\t\tif (gantt.config.skip_off_time) {\n\t\t\t\tvar skip = true;\n\t\t\t\tvar probe = date;\n\n\t\t\t\t// check dates in case custom scale unit, e.g. {unit: \"month\", step: 3}\n\t\t\t\tfor (var i = 0; i < scale.step; i++) {\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\tprobe = dateHelper.add(date, i, scale.unit);\n\t\t\t\t\t}\n\n\t\t\t\t\tskip = skip && !this.isWorkTime(probe, scale.unit);\n\t\t\t\t}\n\n\t\t\t\treturn skip;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\t//defined in an extension\n\t\tprocessIgnores: function (config) {\n\t\t\tconfig.ignore_x = {};\n\t\t\tconfig.display_count = config.count;\n\t\t},\n\t\tinitColSizes: function (config, min_col_width, full_width, line_height) {\n\t\t\tvar cont_width = full_width;\n\n\t\t\tconfig.height = line_height;\n\n\t\t\tvar column_count = config.display_count === undefined ? config.count : config.display_count;\n\n\t\t\tif (!column_count)\n\t\t\t\tcolumn_count = 1;\n\n\t\t\tconfig.col_width = Math.floor(cont_width / column_count);\n\n\t\t\tif (min_col_width) {\n\t\t\t\tif (config.col_width < min_col_width) {\n\t\t\t\t\tconfig.col_width = min_col_width;\n\t\t\t\t\tcont_width = config.col_width * column_count;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconfig.width = [];\n\t\t\tvar ignores = config.ignore_x || {};\n\t\t\tfor (var i = 0; i < config.trace_x.length; i++) {\n\t\t\t\tif (ignores[config.trace_x[i].valueOf()] || (config.display_count == config.count)) {\n\t\t\t\t\tconfig.width[i] = 0;\n\t\t\t\t} else {\n\t\t\t\t\t// width of month columns should be proportional month duration\n\t\t\t\t\tvar width = 1;\n\t\t\t\t\tif (config.unit == \"month\") {\n\t\t\t\t\t\tvar days = Math.round((dateHelper.add(config.trace_x[i], config.step, config.unit) - config.trace_x[i]) / (1000 * 60 * 60 * 24));\n\t\t\t\t\t\twidth = days;\n\t\t\t\t\t}\n\t\t\t\t\tconfig.width[i] = width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.adjustSize(cont_width - this.getSum(config.width)/* 1 width per column from the code above */, config.width);\n\t\t\tconfig.full_width = this.getSum(config.width);\n\t\t},\n\t\tinitScaleConfig: function (config, min_date, max_date) {\n\t\t\tvar cfg = utils.mixin({\n\t\t\t\tcount: 0,\n\t\t\t\tcol_width: 0,\n\t\t\t\tfull_width: 0,\n\t\t\t\theight: 0,\n\t\t\t\twidth: [],\n\t\t\t\tleft: [],\n\t\t\t\ttrace_x: [],\n\t\t\t\ttrace_indexes: {},\n\t\t\t\tmin_date: new Date(min_date),\n\t\t\t\tmax_date: new Date(max_date)\n\t\t\t}, config);\n\n\t\t\tthis.eachColumn(config.unit, config.step, min_date, max_date, function (date) {\n\t\t\t\tcfg.count++;\n\t\t\t\tcfg.trace_x.push(new Date(date));\n\t\t\t\tcfg.trace_indexes[date.valueOf()] = cfg.trace_x.length - 1;\n\t\t\t});\n\n\t\t\tcfg.trace_x_ascending = cfg.trace_x.slice();\n\t\t\treturn cfg;\n\t\t},\n\t\titerateScales: function (lower_scale, upper_scale, from, to, callback) {\n\t\t\tvar upper_dates = upper_scale.trace_x;\n\t\t\tvar lower_dates = lower_scale.trace_x;\n\n\t\t\tvar prev = from || 0;\n\t\t\tvar end = to || (lower_dates.length - 1);\n\t\t\tvar prevUpper = 0;\n\n\n\t\t\tfor (var up = 1; up < upper_dates.length; up++) {\n\t\t\t\tvar target_index = (lower_scale.trace_indexes[+upper_dates[up]]);\n\t\t\t\tif (target_index !== undefined && target_index <= end) {\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback.apply(this, [prevUpper, up, prev, target_index]);\n\t\t\t\t\t}\n\t\t\t\t\tprev = target_index;\n\t\t\t\t\tprevUpper = up;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\talineScaleColumns: function (lower_scale, upper_scale, from, to) {\n\t\t\tthis.iterateScales(lower_scale, upper_scale, from, to, function (upper_start, upper_end, lower_start, lower_end) {\n\t\t\t\tvar targetWidth = this.getSum(lower_scale.width, lower_start, lower_end - 1);\n\t\t\t\tvar actualWidth = this.getSum(upper_scale.width, upper_start, upper_end - 1);\n\t\t\t\tif (actualWidth != targetWidth) {\n\t\t\t\t\tthis.setSumWidth(targetWidth, upper_scale, upper_start, upper_end - 1);\n\t\t\t\t}\n\n\t\t\t});\n\t\t},\n\n\t\teachColumn: function (unit, step, min_date, max_date, callback) {\n\t\t\tvar start = new Date(min_date),\n\t\t\t\tend = new Date(max_date);\n\t\t\tif (dateHelper[unit + \"_start\"]) {\n\t\t\t\tstart = dateHelper[unit + \"_start\"](start);\n\t\t\t}\n\n\t\t\tvar curr = new Date(start);\n\t\t\tif (+curr >= +end) {\n\t\t\t\tend = dateHelper.add(curr, step, unit);\n\t\t\t}\n\t\t\twhile (+curr < +end) {\n\t\t\t\tcallback.call(this, new Date(curr));\n\t\t\t\tvar tzOffset = curr.getTimezoneOffset();\n\t\t\t\tcurr = dateHelper.add(curr, step, unit);\n\t\t\t\tcurr = gantt._correct_dst_change(curr, tzOffset, step, unit);\n\t\t\t\tif (dateHelper[unit + '_start'])\n\t\t\t\t\tcurr = dateHelper[unit + \"_start\"](curr);\n\t\t\t}\n\t\t},\n\t\tlimitVisibleRange: function (cfg) {\n\t\t\tvar dates = cfg.trace_x;\n\n\t\t\tvar left = 0, right = cfg.width.length - 1;\n\t\t\tvar diff = 0;\n\t\t\tif (+dates[0] < +cfg.min_date && left != right) {\n\t\t\t\tvar width = Math.floor(cfg.width[0] * ((dates[1] - cfg.min_date) / (dates[1] - dates[0])));\n\t\t\t\tdiff += cfg.width[0] - width;\n\t\t\t\tcfg.width[0] = width;\n\n\t\t\t\tdates[0] = new Date(cfg.min_date);\n\t\t\t}\n\n\t\t\tvar last = dates.length - 1;\n\t\t\tvar lastDate = dates[last];\n\t\t\tvar outDate = dateHelper.add(lastDate, cfg.step, cfg.unit);\n\t\t\tif (+outDate > +cfg.max_date && last > 0) {\n\t\t\t\tvar width = cfg.width[last] - Math.floor(cfg.width[last] * ((outDate - cfg.max_date) / (outDate - lastDate)));\n\t\t\t\tdiff += cfg.width[last] - width;\n\t\t\t\tcfg.width[last] = width;\n\t\t\t}\n\n\t\t\tif (diff) {\n\t\t\t\tvar full = this.getSum(cfg.width);\n\t\t\t\tvar shared = 0;\n\t\t\t\tfor (var i = 0; i < cfg.width.length; i++) {\n\t\t\t\t\tvar share = Math.floor(diff * (cfg.width[i] / full));\n\t\t\t\t\tcfg.width[i] += share;\n\t\t\t\t\tshared += share;\n\t\t\t\t}\n\t\t\t\tthis.adjustSize(diff - shared, cfg.width);\n\t\t\t}\n\n\t\t}\n\t};\n}\n\nexport default ScaleHelper;\n","\nimport ScaleHelper from \"./scales\";\n\nfunction ScaleIgnoreHelper(gantt){\n\tvar helper = new ScaleHelper(gantt);\n\n\thelper.processIgnores = function (config) {\n\t\tvar display_count = config.count;\n\t\tconfig.ignore_x = {};\n\t\tif (gantt.ignore_time || gantt.config.skip_off_time) {\n\t\t\tvar ignore = gantt.ignore_time || function () {\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tdisplay_count = 0;\n\n\t\t\tfor (var i = 0; i < config.trace_x.length; i++) {\n\n\t\t\t\tif (ignore.call(gantt, config.trace_x[i]) || this._ignore_time_config.call(gantt, config.trace_x[i], config)) {\n\t\t\t\t\tconfig.ignore_x[config.trace_x[i].valueOf()] = true;\n\t\t\t\t\tconfig.ignored_colls = true;\n\t\t\t\t} else {\n\t\t\t\t\tdisplay_count++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tconfig.display_count = display_count;\n\t};\n\n\treturn helper;\n}\n\nexport default ScaleIgnoreHelper;","import ScaleHelper from \"./ui/timeline/scales_ignore\";\nimport PrimaryScaleHelper from \"./ui/timeline/scales\";\n\nfunction resolveConfigRange(unit, gantt){\n\tvar range = {\n\t\tstart_date:null,\n\t\tend_date:null\n\t};\n\n\tif (gantt.config.start_date && gantt.config.end_date) {\n\t\trange.start_date = gantt.date[unit + \"_start\"](new Date(gantt.config.start_date));\n\n\t\tvar end = new Date(gantt.config.end_date);\n\t\tvar start_interval = gantt.date[unit + \"_start\"](new Date(end));\n\t\tif (+end != +start_interval) {\n\t\t\tend = gantt.date.add(start_interval, 1, unit);\n\t\t} else {\n\t\t\tend = start_interval;\n\t\t}\n\n\t\trange.end_date = end;\n\t}\n\treturn range;\n}\n\nfunction _scale_range_unit(gantt) {\n\tvar primaryScale = (new PrimaryScaleHelper(gantt)).primaryScale();\n\tvar unit = primaryScale.unit;\n\tvar step = primaryScale.step;\n\tif (gantt.config.scale_offset_minimal) {\n\n\t\tvar helper = new ScaleHelper(gantt);\n\t\tvar scales = [helper.primaryScale()].concat(helper.getSubScales());\n\n\t\thelper.sortScales(scales);\n\t\tunit = scales[scales.length - 1].unit;\n\t\tstep = scales[scales.length - 1].step || 1;\n\t}\n\treturn { unit:unit, step:step };\n}\n\nfunction _init_tasks_range(gantt) {\n\tvar cfg = _scale_range_unit(gantt);\n\tvar unit = cfg.unit,\n\t\tstep = cfg.step;\n\tvar range = resolveConfigRange(unit, gantt);\n\n\t// GS-1544: Show correct date range if we have tasks or only projects\n\tif(!(range.start_date && range.end_date)){\n\t\tvar onlyProjectTasks = true;\n\t\tvar tasks = gantt.getTaskByTime();\n\t\tfor (var i = 0; i < tasks.length; i++) {\n\t\t\tvar task = tasks[i];\n\t\t\tif (task.type !== gantt.config.types.project){\n\t\t\t\tonlyProjectTasks = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (tasks.length && onlyProjectTasks){\n\t\t\tvar start_date = tasks[0].start_date;\n\t\t\tvar end_date = gantt.date.add(start_date, 1, gantt.config.duration_unit);\n\t\t\trange = {\n\t\t\t\tstart_date: new Date(start_date),\n\t\t\t\tend_date: new Date(end_date)\n\t\t\t};\n\t\t} else{\n\t\t\trange = gantt.getSubtaskDates();\n\t\t}\n\n\t\tif(!range.start_date || !range.end_date){\n\t\t\trange = {\n\t\t\t\tstart_date: new Date(),\n\t\t\t\tend_date: new Date()\n\t\t\t};\n\t\t}\n\t\t// extend the displayed date range including the constraints, deadlines and baselines\n\t\tgantt.eachTask(function(task){\n\t\t\tif (gantt.config.deadlines && task.deadline){\n\t\t\t\textendRangeForDates(range, task.deadline, task.deadline);\n\t\t\t}\n\t\t\tif (task.constraint_date && task.constraint_type){\n\t\t\t\tif (gantt.config.constraint_types && task.constraint_type !== gantt.config.constraint_types.ASAP && task.constraint_type !== gantt.config.constraint_types.ALAP){\n\t\t\t\t\textendRangeForDates(range, task.constraint_date, task.constraint_date);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (gantt.config.baselines && task.baselines){\n\t\t\t\ttask.baselines.forEach(function(baseline){\n\t\t\t\t\textendRangeForDates(range, baseline.start_date, baseline.end_date);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\trange.start_date = gantt.date[unit + \"_start\"](range.start_date);\n\t\trange.start_date = gantt.calculateEndDate({\n\t\t\tstart_date: gantt.date[unit + \"_start\"](range.start_date),\n\t\t\tduration: -1,\n\t\t\tunit: unit,\n\t\t\tstep:step\n\t\t});//one free column before first task\n\n\t\trange.end_date = gantt.date[unit + \"_start\"](range.end_date);\n\t\trange.end_date = gantt.calculateEndDate({start_date: range.end_date, duration: 2, unit: unit, step:step});//one free column after last task\n\t}\n\n\tgantt._min_date = range.start_date;\n\tgantt._max_date = range.end_date;\n}\n\nfunction extendRangeForDates(range, start_date, end_date){\n\tif (start_date < range.start_date){\n\t\trange.start_date = new Date(start_date);\n\t}\n\tif (end_date > range.end_date){\n\t\trange.end_date = new Date(end_date);\n\t}\n}\n\nfunction _adjust_scales(gantt) {\n\tif (gantt.config.fit_tasks) {\n\t\tvar old_min = +gantt._min_date,\n\t\t\told_max = +gantt._max_date;\n\t\t//this._init_tasks_range();\n\t\tif (+gantt._min_date != old_min || +gantt._max_date != old_max) {\n\t\t\tgantt.render();\n\n\t\t\tgantt.callEvent(\"onScaleAdjusted\", []);\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nexport default function updateTasksRange(gantt){\n\t_init_tasks_range(gantt);\n\t_adjust_scales(gantt);\n};\n","function copyLinkIdsArray(gantt, linkIds, targetHash){\n\tfor(var i = 0; i < linkIds.length; i++) {\n\t\tif(gantt.isLinkExists(linkIds[i])){\n\t\t\ttargetHash[linkIds[i]] = gantt.getLink(linkIds[i]);\n\t\t}\n\t}\n}\n\nfunction copyLinkIds(gantt, task, targetHash){\n\tcopyLinkIdsArray(gantt, task.$source, targetHash);\n\tcopyLinkIdsArray(gantt, task.$target, targetHash);\n}\n\nfunction getSubtreeLinks(gantt, rootId){\n\tvar res = {};\n\n\tif(gantt.isTaskExists(rootId)){\n\t\tcopyLinkIds(gantt, gantt.getTask(rootId), res);\n\t}\n\n\tgantt.eachTask(function(child){\n\t\tcopyLinkIds(gantt, child, res);\n\t}, rootId);\n\n\treturn res;\n}\n\nfunction getSubtreeTasks(gantt, rootId){\n\tvar res = {};\n\n\tgantt.eachTask(function(child){\n\t\tres[child.id] = child;\n\t}, rootId);\n\n\treturn res;\n}\n\nexport default {\n\tgetSubtreeLinks: getSubtreeLinks,\n\tgetSubtreeTasks: getSubtreeTasks\n};","import * as helpers from \"../../utils/helpers\";\nimport treeHelper from \"../../utils/task_tree_helpers\";\n\n\nexport default class DataProcessorEvents {\n\tprotected _dataProcessorHandlers: any[];\n\tprotected $gantt: any;\n\tprotected $dp: any;\n\n\tconstructor(gantt: any, dp: any) {\n\t\tthis.$gantt = gantt;\n\t\tthis.$dp = dp;\n\t\tthis._dataProcessorHandlers = [];\n\t}\n\n\tattach() {\n\t\tconst dp = this.$dp;\n\t\tconst gantt = this.$gantt;\n\t\tconst cascadeDelete = {};\n\n\t\tconst clientSideDelete = (id) => {\n\t\t\treturn this.clientSideDelete(id, dp, gantt);\n\t\t};\n\n\t\tfunction getTaskLinks(task) {\n\t\t\tlet _links = [];\n\n\t\t\tif (task.$source) {\n\t\t\t\t_links = _links.concat(task.$source);\n\t\t\t}\n\t\t\tif (task.$target) {\n\t\t\t\t_links = _links.concat(task.$target);\n\t\t\t}\n\n\t\t\treturn _links;\n\t\t}\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskAdd\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isTaskExists(id)) {\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdated(id, true, \"inserted\");\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskUpdate\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isTaskExists(id)) {\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdated(id, true);\n\n\t\t\t\t// gantt can be destroyed/reinitialized after dp.setUpdated\n\t\t\t\tif(gantt._sendTaskOrder){\n\t\t\t\t\tgantt._sendTaskOrder(id, item);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onBeforeTaskDelete\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.config.cascade_delete) {\n\t\t\t\tcascadeDelete[id] = {\n\t\t\t\t\ttasks: treeHelper.getSubtreeTasks(gantt, id),\n\t\t\t\t\tlinks: treeHelper.getSubtreeLinks(gantt, id)\n\t\t\t\t};\n\t\t\t}\n\t\t\t// GS-631. Keep the deleted item in Gantt until we receive the successful response from the server\n\t\t\tif (dp.deleteAfterConfirmation) {\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdated(id, true, \"deleted\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskDelete\", function(id, item) { // tslint:disable-line\n\t\t\tdp.setGanttMode(\"tasks\");\n\n\t\t\t// not send delete request if item is not inserted into the db - just remove it from the client\n\t\t\tconst needDbDelete = !clientSideDelete(id);\n\t\t\tconst needCascadeDelete = gantt.config.cascade_delete && cascadeDelete[id];\n\t\t\tif (!needDbDelete && !needCascadeDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (needCascadeDelete) {\n\t\t\t\tconst dpMode = dp.updateMode;\n\t\t\t\tdp.setUpdateMode(\"off\");\n\n\t\t\t\tconst cascade = cascadeDelete[id];\n\t\t\t\tfor (const i in cascade.tasks) {\n\t\t\t\t\tif (!clientSideDelete(i)) {\n\t\t\t\t\t\tdp.storeItem(cascade.tasks[i]);\n\t\t\t\t\t\tdp.setUpdated(i, true, \"deleted\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp.setGanttMode(\"links\");\n\t\t\t\tfor (const i in cascade.links) {\n\t\t\t\t\tif (!clientSideDelete(i)) {\n\t\t\t\t\t\tdp.storeItem(cascade.links[i]);\n\t\t\t\t\t\tdp.setUpdated(i, true, \"deleted\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcascadeDelete[id] = null;\n\n\t\t\t\tif (dpMode !== \"off\") {\n\t\t\t\t\tdp.sendAllData();\n\t\t\t\t}\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdateMode(dpMode);\n\t\t\t}\n\n\t\t\tif (needDbDelete){\n\t\t\t\tdp.storeItem(item);\n\t\t\t\tif (!dp.deleteAfterConfirmation){\n\t\t\t\t\tdp.setUpdated(id, true, \"deleted\");\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tif (dp.updateMode !== \"off\" && !dp._tSend) {\n\t\t\t\tdp.sendAllData();\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkUpdate\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isLinkExists(id)) {\n\t\t\t\tdp.setGanttMode(\"links\");\n\t\t\t\tdp.setUpdated(id, true);\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkAdd\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isLinkExists(id)) {\n\t\t\t\tdp.setGanttMode(\"links\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkDelete\", function(id, item) { // tslint:disable-line\n\t\t\tdp.setGanttMode(\"links\");\n\n\t\t\tconst needDbDelete = !clientSideDelete(id);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onRowDragEnd\", function(id, target) { // tslint:disable-line\n\t\t\tgantt._sendTaskOrder(id, gantt.getTask(id));\n\t\t}));\n\n\t\tlet tasks = null;\n\t\tlet links = null;\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onTaskIdChange\", function(oldId, newId) { // tslint:disable-line\n\t\t\tif (!dp._waitMode) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst children = gantt.getChildren(newId);\n\t\t\tif (children.length) {\n\t\t\t\ttasks = tasks || {};\n\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\t\tconst ch = this.getTask(children[i]);\n\t\t\t\t\ttasks[ch.id] = ch;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst item = this.getTask(newId);\n\t\t\tconst itemLinks = getTaskLinks(item);\n\n\t\t\tif (itemLinks.length) {\n\t\t\t\tlinks = links || {};\n\n\t\t\t\tfor (let i = 0; i < itemLinks.length; i++) {\n\t\t\t\t\tconst link = this.getLink(itemLinks[i]);\n\t\t\t\t\tlinks[link.id] = link;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tdp.attachEvent(\"onAfterUpdateFinish\", function() {\n\t\t\tif (tasks || links) {\n\t\t\t\tgantt.batchUpdate(function() {\n\t\t\t\t\tfor (const id in tasks) {\n\t\t\t\t\t\tgantt.updateTask(tasks[id].id);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const id in links) {\n\t\t\t\t\t\tgantt.updateLink(links[id].id);\n\t\t\t\t\t}\n\t\t\t\t\ttasks = null;\n\t\t\t\t\tlinks = null;\n\t\t\t\t});\n\t\t\t\tif (tasks) {\n\t\t\t\t\tgantt._dp.setGanttMode(\"tasks\");\n\t\t\t\t} else {\n\t\t\t\t\tgantt._dp.setGanttMode(\"links\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tdp.attachEvent(\"onBeforeDataSending\", function() {\n\t\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tlet url = this._serverProcessor;\n\t\t\tif (this._tMode === \"REST-JSON\" || this._tMode === \"REST\") {\n\t\t\t\tconst mode = this._ganttMode;\n\n\t\t\t\turl = url.substring(0, url.indexOf(\"?\") > -1 ? url.indexOf(\"?\") : url.length);\n\t\t\t\t// editing=true&\n\t\t\t\tthis.serverProcessor = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + mode;\n\t\t\t} else {\n\t\t\t\tconst pluralizedMode = this._ganttMode + \"s\";\n\t\t\t\tthis.serverProcessor = url + gantt.ajax.urlSeparator(url) + \"gantt_mode=\" + pluralizedMode;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\n\t\tdp.attachEvent(\"insertCallback\", function insertCallback(upd, id, parent, mode) { // tslint:disable-line\n\t\t\tconst data = upd.data || gantt.xml._xmlNodeToJSON(upd.firstChild);\n\t\t\tconst methods = {\n\t\t\t\tadd: gantt.addTask,\n\t\t\t\tisExist: gantt.isTaskExists\n\t\t\t};\n\t\t\tif (mode === \"links\") {\n\t\t\t\tmethods.add = gantt.addLink;\n\t\t\t\tmethods.isExist = gantt.isLinkExists;\n\t\t\t}\n\t\t\tif (methods.isExist.call(gantt, id)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdata.id = id;\n\t\t\tmethods.add.call(gantt, data);\n\t\t});\n\n\t\tdp.attachEvent(\"updateCallback\", function updateCallback(upd, id) {\n\t\t\tconst data = upd.data || gantt.xml._xmlNodeToJSON(upd.firstChild);\n\t\t\tif (!gantt.isTaskExists(id)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst objData = gantt.getTask(id);\n\t\t\tfor (const key in data) {\n\t\t\t\tlet property = data[key];\n\t\t\t\tswitch (key) {\n\t\t\t\t\tcase \"id\":\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcase \"start_date\":\n\t\t\t\t\tcase \"end_date\":\n\t\t\t\t\t\tproperty = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date(property) : gantt.templates.parse_date(property);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"duration\":\n\t\t\t\t\t\tobjData.end_date = gantt.calculateEndDate({start_date: objData.start_date, duration: property, task:objData});\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tobjData[key] = property;\n\t\t\t}\n\t\t\tgantt.updateTask(id);\n\t\t\tgantt.refreshData();\n\t\t});\n\t\tdp.attachEvent(\"deleteCallback\", function deleteCallback(upd, id, parent, mode) { // tslint:disable-line\n\t\t\tconst methods = {\n\t\t\t\tdelete: gantt.deleteTask,\n\t\t\t\tisExist: gantt.isTaskExists\n\t\t\t};\n\t\t\tif (mode === \"links\") {\n\t\t\t\tmethods.delete = gantt.deleteLink;\n\t\t\t\tmethods.isExist = gantt.isLinkExists;\n\t\t\t} else if(mode === \"assignment\") {\n\t\t\t\tmethods.delete = function(val) {\n\t\t\t\t\tgantt.$data.assignmentsStore.remove(val);\n\t\t\t\t};\n\t\t\t\tmethods.isExist = function(val){\n\t\t\t\t\treturn gantt.$data.assignmentsStore.exists(val);\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (methods.isExist.call(gantt, id)) {\n\t\t\t\tmethods.delete.call(gantt, id);\n\t\t\t}\n\t\t});\n\n\t\tthis.handleResourceCRUD(dp, gantt);\n\t\tthis.handleResourceAssignmentCRUD(dp, gantt);\n\t\tthis.handleBaselineCRUD(dp, gantt);\n\t}\n\n\tclientSideDelete(id, dp, gantt){\n\t\tconst updated = dp.updatedRows.slice();\n\t\tlet clientOnly = false;\n\n\t\tif(gantt.getUserData(id, \"!nativeeditor_status\", dp._ganttMode) === \"true_deleted\"){\n\t\t\tclientOnly = true;\n\t\t\tdp.setUpdated(id,false);\n\t\t}\n\n\t\tfor (let i = 0; i < updated.length && !dp._in_progress[id]; i++) {\n\t\t\tif (updated[i] === id) {\n\t\t\t\tif (gantt.getUserData(id, \"!nativeeditor_status\", dp._ganttMode) === \"inserted\") {\n\t\t\t\t\tclientOnly = true;\n\t\t\t\t}\n\t\t\t\tdp.setUpdated(id,false);\n\t\t\t}\n\t\t}\n\t\treturn clientOnly;\n\t}\n\n\thandleResourceAssignmentCRUD(dp, gantt){\n\t\tif(!gantt.config.resources || gantt.config.resources.dataprocessor_assignments !== true){\n\t\t\treturn;\n\t\t}\n\n\t\tconst assignmentsStore = gantt.getDatastore(gantt.config.resource_assignment_store);\n\t\tconst insertedTasks = {};\n\t\tconst pendingAssignments = {};\n\n\t\tgantt.attachEvent(\"onBeforeTaskAdd\", function(id, task){\n\t\t\tinsertedTasks[id] = true;\n\t\t\treturn true;\n\t\t});\n\n\t\tfunction putAssignmentToQueue(item){\n\t\t\tpendingAssignments[item.id] = item;\n\t\t\tinsertedTasks[item.task_id] = true;\n\t\t}\n\n\t\tfunction insertResourceAssignment(assignment){\n\t\t\tconst id = assignment.id;\n\t\t\tif (assignmentsStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"assignment\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t\tdelete pendingAssignments[id];\n\t\t}\n\n\t\tgantt.attachEvent(\"onTaskIdChange\", function(id, newId){\n\t\t\tdelete insertedTasks[id];\n\t\t});\n\n\t\tassignmentsStore.attachEvent(\"onAfterAdd\", (id, item) => {\n\t\t\tif(insertedTasks[item.task_id]){\n\t\t\t\t// inserting assignment of new task\n\t\t\t\t// task is not saved yet, need to wait till it gets permanent id and save assigmnents after that\n\t\t\t\tputAssignmentToQueue(item);\n\t\t\t}else{\n\t\t\t\tinsertResourceAssignment(item);\n\t\t\t}\n\t\t});\n\n\t\tassignmentsStore.attachEvent(\"onAfterUpdate\", (id, item) => {\n\t\t\tif (assignmentsStore.exists(id)) {\n\t\t\t\tif(pendingAssignments[id]){\n\t\t\t\t\tinsertResourceAssignment(item);\n\t\t\t\t}else{\n\t\t\t\t\tdp.setGanttMode(\"assignment\");\n\t\t\t\t\tdp.setUpdated(id, true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tassignmentsStore.attachEvent(\"onAfterDelete\", (id, item) => {\n\t\t\tdp.setGanttMode(\"assignment\");\n\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t});\n\n\t}\n\n\thandleResourceCRUD(dp, gantt){\n\t\tif(!gantt.config.resources || gantt.config.resources.dataprocessor_resources !== true){\n\t\t\treturn;\n\t\t}\n\n\t\tconst resourcesStore = gantt.getDatastore(gantt.config.resource_store);\n\n\t\tfunction insertResource(resource){\n\t\t\tconst id = resource.id;\n\t\t\tif (resourcesStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"resource\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t}\n\n\t\tresourcesStore.attachEvent(\"onAfterAdd\", (id, item) => {\n\t\t\tinsertResource(item);\n\t\t});\n\n\t\tresourcesStore.attachEvent(\"onAfterUpdate\", (id, item) => {\n\t\t\tif (resourcesStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"resource\");\n\t\t\t\tdp.setUpdated(id, true);\n\t\t\t}\n\t\t});\n\n\t\tresourcesStore.attachEvent(\"onAfterDelete\", (id, item) => {\n\t\t\tdp.setGanttMode(\"resource\");\n\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t});\n\n\t}\n\n\thandleBaselineCRUD(dp, gantt){\n\t\tif(!gantt.config.baselines || gantt.config.baselines.dataprocessor_baselines !== true){\n\t\t\treturn;\n\t\t}\n\n\t\tconst baselineStore = gantt.getDatastore(gantt.config.baselines.datastore);\n\n\t\tfunction insertResource(resource){\n\t\t\tconst id = resource.id;\n\t\t\tif (baselineStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"baseline\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t}\n\n\t\tbaselineStore.attachEvent(\"onAfterAdd\", (id, item) => {\n\t\t\tinsertResource(item);\n\t\t});\n\n\t\tbaselineStore.attachEvent(\"onAfterUpdate\", (id, item) => {\n\t\t\tif (baselineStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"baseline\");\n\t\t\t\tdp.setUpdated(id, true);\n\t\t\t}\n\t\t});\n\n\t\tbaselineStore.attachEvent(\"onAfterDelete\", (id, item) => {\n\t\t\tdp.setGanttMode(\"baseline\");\n\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t});\n\t}\n\n\tdetach() {\n\t\thelpers.forEach(this._dataProcessorHandlers, (e) => {\n\t\t\tthis.$gantt.detachEvent(e);\n\t\t});\n\t\tthis._dataProcessorHandlers = [];\n\t}\n}\n","import * as utils from \"../../utils/utils\";\n\nexport default class SimpleStorage {\n\tpublic static create = () : SimpleStorage => {\n\t\treturn new SimpleStorage();\n\t};\n\n\tprotected _storage: { [id: string]: any; };\n\n\tprotected constructor() {\n\t\tthis._storage = {};\n\t}\n\n\tpublic clear = (): void => {\n\t\tthis._storage = {};\n\t};\n\n\tpublic storeItem = (item: any): void => {\n\t\tthis._storage[item.id] = utils.copy(item);\n\t};\n\n\tpublic getStoredItem = (id: string): any => {\n\t\treturn this._storage[id] || null;\n\t};\n}","import eventable from \"../../utils/eventable\";\nimport * as helpers from \"../../utils/helpers\";\nimport * as utils from \"../../utils/utils\";\nimport DataProcessorEvents from \"./data_processor_events\";\nimport extendGantt from \"./extend_gantt\";\nimport SimpleStorage from \"./simple_storage\";\nimport global from \"../../utils/global\";\n\nexport interface DataProcessor { // tslint:disable-line\n\t$gantt: any;\n\tdetachAllEvents: any;\n\tattachEvent: any;\n\tcallEvent: any;\n\n\tserverProcessor: string;\n\taction_param: string;\n\tupdatedRows: any[];\n\tautoUpdate: boolean;\n\tupdateMode: string;\n\tmessages: any[];\n\tstyles: object;\n\tdnd: any;\n\tdeleteAfterConfirmation?: any;\n}\n\nexport function createDataProcessor(config: any) {\n\tlet router;\n\tlet tMode;\n\tlet headers;\n\tif (config instanceof Function) {\n\t\trouter = config;\n\t} else if (config.hasOwnProperty(\"router\")) {\n\t\trouter = config.router;\n\t} else if (config.hasOwnProperty(\"assignment\") || config.hasOwnProperty(\"baseline\") || config.hasOwnProperty(\"link\") || config.hasOwnProperty(\"task\")) {\n\t\trouter = config;\n\t} else if(config.hasOwnProperty(\"headers\")){\n\t\t// GS-2312 for custom headers\n\t\theaders = config.headers;\n\t}\n\tif (router) {\n\t\ttMode = \"CUSTOM\";\n\t} else {\n\t\ttMode = config.mode || \"REST-JSON\";\n\t}\n\tconst gantt = this; // tslint:disable-line\n\tconst dp = new DataProcessor(config.url);\n\n\n\tdp.init(gantt);\n\tdp.setTransactionMode({\n\t\tmode: tMode,\n\t\trouter,\n\t\theaders\n\t}, config.batchUpdate);\n\tif(config.deleteAfterConfirmation){\n\t\tdp.deleteAfterConfirmation = config.deleteAfterConfirmation;\n\t}\n\treturn dp;\n}\n\nexport class DataProcessor {\n\tpublic modes: object;\n\tpublic serverProcessor: string;\n\tpublic action_param: string; // tslint:disable-line\n\tpublic updatedRows: any[];\n\tpublic autoUpdate: boolean;\n\tpublic updateMode: string;\n\tpublic messages: any[];\n\tpublic styles: object;\n\tpublic dnd: any;\n\n\tprotected _tMode: string;\n\tprotected _headers: any;\n\tprotected _payload: any;\n\tprotected _postDelim: string;\n\tprotected _waitMode: number;\n\tprotected _in_progress: object; // tslint:disable-line\n\tprotected _invalid: object;\n\tprotected _storage: SimpleStorage;\n\tprotected _tSend: boolean;\n\tprotected _serializeAsJson: boolean;\n\tprotected _router: any;\n\tprotected _utf: boolean;\n\tprotected _methods: any[];\n\tprotected _user: any;\n\tprotected _uActions: object;\n\tprotected _needUpdate: boolean;\n\tprotected _ganttMode: \"task\"|\"link\";\n\tprotected _routerParametersFormat: \"parameters\"|\"object\";\n\n\tprotected _silent_mode: any; // tslint:disable-line\n\tprotected _updateBusy: any;\n\tprotected _serverProcessor: any;\n\tprotected _initialized: boolean;\n\n\tconstructor(serverProcessorURL?) {\n\t\tthis.serverProcessor = serverProcessorURL;\n\t\tthis.action_param = \"!nativeeditor_status\";\n\n\t\tthis.updatedRows = []; // ids of updated rows\n\n\t\tthis.autoUpdate = true;\n\t\tthis.updateMode = \"cell\";\n\t\tthis._headers = null;\n\t\tthis._payload = null;\n\t\tthis._postDelim = \"_\";\n\t\tthis._routerParametersFormat = \"parameters\";\n\n\t\tthis._waitMode = 0;\n\t\tthis._in_progress = {}; // ?\n\t\tthis._storage = SimpleStorage.create();\n\t\tthis._invalid = {};\n\t\tthis.messages = [];\n\n\t\tthis.styles = {\n\t\t\tupdated: \"font-weight:bold;\",\n\t\t\tinserted: \"font-weight:bold;\",\n\t\t\tdeleted: \"text-decoration : line-through;\",\n\t\t\tinvalid: \"background-color:FFE0E0;\",\n\t\t\tinvalid_cell: \"border-bottom:2px solid red;\",\n\t\t\terror: \"color:red;\",\n\t\t\tclear: \"font-weight:normal;text-decoration:none;\"\n\t\t};\n\t\tthis.enableUTFencoding(true);\n\t\teventable(this);\n\t}\n\n\tsetTransactionMode(mode:any, total?:any) {\n\t\tif (typeof mode === \"object\") {\n\t\t\tthis._tMode = mode.mode || this._tMode;\n\n\t\t\tif (utils.defined(mode.headers)) {\n\t\t\t\tthis._headers = mode.headers;\n\t\t\t}\n\n\t\t\tif (utils.defined(mode.payload)) {\n\t\t\t\tthis._payload = mode.payload;\n\t\t\t}\n\t\t\tthis._tSend = !!total;\n\t\t} else {\n\t\t\tthis._tMode = mode;\n\t\t\tthis._tSend = total;\n\t\t}\n\n\t\tif (this._tMode === \"REST\") {\n\t\t\tthis._tSend = false;\n\t\t}\n\n\t\tif (this._tMode === \"JSON\" || this._tMode === \"REST-JSON\") {\n\t\t\tthis._tSend = false;\n\t\t\tthis._serializeAsJson = true;\n\t\t\tthis._headers = this._headers || {};\n\t\t\tthis._headers[\"Content-Type\"] = \"application/json\";\n\t\t}else{\n\t\t\tif(this._headers && !this._headers[\"Content-Type\"]){\n\t\t\t\tthis._headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\n\t\t\t}\n\t\t}\n\n\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\tthis._tSend = false;\n\t\t\tthis._router = mode.router;\n\t\t}\n\t}\n\n\tescape(data:any) {\n\t\tif (this._utf) {\n\t\t\treturn encodeURIComponent(data);\n\t\t} else {\n\t\t\treturn escape(data);\n\t\t}\n\t}\n\n\t/**\n\t * @desc: allows to set escaping mode\n\t * @param: true - utf based escaping, simple - use current page encoding\n\t * @type: public\n\t */\n\tenableUTFencoding(mode:boolean) {\n\t\tthis._utf = !!mode;\n\t}\n\n\t/**\n\t * @desc: get state of updating\n\t * @returns:   true - all in sync with server, false - some items not updated yet.\n\t * @type: public\n\t */\n\tgetSyncState() {\n\t\treturn !this.updatedRows.length;\n\t}\n\n\t/**\n\t * @desc: set if rows should be send to server automatically\n\t * @param: mode - \"row\" - based on row selection changed, \"cell\" - based on cell editing finished, \"off\" - manual data sending\n\t * @type: public\n\t */\n\tsetUpdateMode(mode: string, dnd: any) {\n\t\tthis.autoUpdate = (mode === \"cell\");\n\t\tthis.updateMode = mode;\n\t\tthis.dnd = dnd;\n\t}\n\n\tignore(code: any, master: any) {\n\t\tthis._silent_mode = true;\n\t\tcode.call(master || global);\n\t\tthis._silent_mode = false;\n\t}\n\n\t/**\n\t * @desc: mark row as updated/normal. check mandatory fields, initiate autoupdate (if turned on)\n\t * @param: rowId - id of row to set update-status for\n\t * @param: state - true for \"updated\", false for \"not updated\"\n\t * @param: mode - update mode name\n\t * @type: public\n\t */\n\tsetUpdated(rowId:number|string, state: boolean, mode?: string) {\n\t\tif (this._silent_mode) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst ind = this.findRow(rowId);\n\n\t\tmode = mode || \"updated\";\n\t\tconst existing = this.$gantt.getUserData(rowId, this.action_param, this._ganttMode);\n\t\tif (existing && mode === \"updated\") {\n\t\t\tmode = existing;\n\t\t}\n\t\tif (state) {\n\t\t\tthis.set_invalid(rowId, false); // clear previous error flag\n\t\t\tthis.updatedRows[ind] = rowId;\n\t\t\tthis.$gantt.setUserData(rowId, this.action_param, mode, this._ganttMode);\n\t\t\tif (this._in_progress[rowId]) {\n\t\t\t\tthis._in_progress[rowId] = \"wait\";\n\t\t\t}\n\t\t} else {\n\t\t\tif (!this.is_invalid(rowId)) {\n\t\t\t\tthis.updatedRows.splice(ind, 1);\n\t\t\t\tthis.$gantt.setUserData(rowId, this.action_param, \"\", this._ganttMode);\n\t\t\t}\n\t\t}\n\n\t\tthis.markRow(rowId, state, mode);\n\t\tif (state && this.autoUpdate) {\n\t\t\tthis.sendData(rowId);\n\t\t}\n\t}\n\n\tmarkRow(id: number | string, state: boolean, mode: string) {\n\t\tlet str = \"\";\n\t\tconst invalid = this.is_invalid(id);\n\t\tif (invalid) {\n\t\t\tstr = this.styles[invalid];\n\t\t\tstate = true;\n\t\t}\n\t\tif (this.callEvent(\"onRowMark\", [id, state, mode, invalid])) {\n\t\t\t// default logic\n\t\t\tstr = this.styles[state ? mode : \"clear\"] + \" \" + str;\n\n\t\t\tthis.$gantt[this._methods[0]](id, str);\n\n\t\t\tif (invalid && invalid.details) {\n\t\t\t\tstr += this.styles[invalid + \"_cell\"];\n\t\t\t\tfor (let i = 0; i < invalid.details.length; i++) {\n\t\t\t\t\tif (invalid.details[i]) {\n\t\t\t\t\t\tthis.$gantt[this._methods[1]](id, i, str);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetActionByState(state: string):string {\n\t\tif (state === \"inserted\") {\n\t\t\treturn \"create\";\n\t\t}\n\n\t\tif (state === \"updated\") {\n\t\t\treturn \"update\";\n\t\t}\n\n\t\tif (state === \"deleted\") {\n\t\t\treturn \"delete\";\n\t\t}\n\n\t\t// reorder\n\t\treturn \"update\";\n\t}\n\n\tgetState(id: number | string) {\n\t\treturn this.$gantt.getUserData(id, this.action_param, this._ganttMode);\n\t}\n\n\tis_invalid(id: number | string) {\n\t\treturn this._invalid[id];\n\t}\n\n\tset_invalid(id: number | string, mode: any, details?) {\n\t\tif (details) {\n\t\t\tmode = {\n\t\t\t\tvalue: mode,\n\t\t\t\tdetails,\n\t\t\t\ttoString: function() { // tslint:disable-line\n\t\t\t\t\treturn this.value.toString();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tthis._invalid[id] = mode;\n\t}\n\n\t/**\n\t * @desc: check mandatory fields and verify values of cells, initiate update (if specified). Can be redefined in order to provide custom validation\n\t * @param: rowId - id of row to set update-status for\n\t * @type: public\n\t */\n\t// tslint:disable-next-line\n\tcheckBeforeUpdate(rowId: number | string) {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @desc: send row(s) values to server\n\t * @param: rowId - id of row which data to send. If not specified, then all \"updated\" rows will be send\n\t * @type: public\n\t */\n\tsendData(rowId?: any) {\n\t\tif (this.$gantt.editStop) {\n\t\t\tthis.$gantt.editStop();\n\t\t}\n\n\t\tif (typeof rowId === \"undefined\" || this._tSend) {\n\n\t\t\tconst pendingUpdateModes = [];\n\t\t\tif(this.modes){\n\t\t\t\tconst knownModes = [\"task\", \"link\", \"assignment\", \"baseline\"];\n\t\t\t\tknownModes.forEach((mode) => {\n\t\t\t\t\tif(this.modes[mode] && this.modes[mode].updatedRows.length){\n\t\t\t\t\t\tpendingUpdateModes.push(mode);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (pendingUpdateModes.length){\n\t\t\t\tfor(let i = 0; i < pendingUpdateModes.length; i++){\n\t\t\t\t\tthis.setGanttMode(pendingUpdateModes[i]);\n\t\t\t\t\tthis.sendAllData();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\treturn this.sendAllData();\n\t\t\t}\n\t\t}\n\t\tif (this._in_progress[rowId]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messages = [];\n\t\tif (!this.checkBeforeUpdate(rowId) && this.callEvent(\"onValidationError\", [rowId, this.messages])) {\n\t\t\treturn false;\n\t\t}\n\t\tthis._beforeSendData(this._getRowData(rowId), rowId);\n\t}\n\n\tserialize(data: any, id: any) {\n\t\tif (this._serializeAsJson) {\n\t\t\treturn  this._serializeAsJSON(data);\n\t\t}\n\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\t\tif (typeof id !== \"undefined\") {\n\t\t\treturn this.serialize_one(data, \"\");\n\t\t} else {\n\t\t\tconst stack = [];\n\t\t\tconst keys = [];\n\t\t\tfor (const key in data) {\n\t\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\t\tstack.push(this.serialize_one(data[key], key + this._postDelim));\n\t\t\t\t\tkeys.push(key);\n\t\t\t\t}\n\t\t\t}\n\t\t\tstack.push(\"ids=\" + this.escape(keys.join(\",\")));\n\t\t\tif (this.$gantt.security_key) {\n\t\t\t\tstack.push(\"dhx_security=\" + this.$gantt.security_key);\n\t\t\t}\n\t\t\treturn stack.join(\"&\");\n\t\t}\n\t}\n\n\tserialize_one(data: any, pref: string) {\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\t\tconst stack = [];\n\t\tlet serialized = \"\";\n\t\tfor (const key in data)\n\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\tif ((key === \"id\" ||\n\t\t\t\t\tkey == this.action_param) && // tslint:disable-line\n\t\t\t\t\tthis._tMode === \"REST\") {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (typeof data[key] === \"string\" || typeof data[key] === \"number\") {\n\t\t\t\t\tserialized = String(data[key]);\n\t\t\t\t} else {\n\t\t\t\t\tserialized = JSON.stringify(data[key]);\n\t\t\t\t}\n\t\t\t\tstack.push(this.escape((pref || \"\") + key) + \"=\" + this.escape(serialized));\n\t\t\t}\n\t\treturn stack.join(\"&\");\n\t}\n\n\tsendAllData() {\n\t\tif (!this.updatedRows.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.messages = [];\n\t\tlet valid: any = true;\n\n\t\tthis._forEachUpdatedRow(function(rowId) {\n\t\t\tvalid = valid && this.checkBeforeUpdate(rowId);\n\t\t});\n\n\t\tif (!valid && !this.callEvent(\"onValidationError\", [\"\", this.messages])) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this._tSend) {\n\t\t\tthis._sendData(this._getAllData());\n\t\t} else {\n\t\t\t// this.updatedRows can be spliced from onBeforeUpdate via dp.setUpdated false\n\t\t\t// use an iterator instead of for(var i = 0; i < this.updatedRows; i++) then\n\t\t\tthis._forEachUpdatedRow(function(rowId) {\n\t\t\t\tif (!this._in_progress[rowId]) {\n\t\t\t\t\tif (this.is_invalid(rowId)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis._beforeSendData(this._getRowData(rowId), rowId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tfindRow(pattern: any) {\n\t\tlet i = 0;\n\t\tfor (i = 0; i < this.updatedRows.length; i++) {\n\t\t\tif (pattern == this.updatedRows[i]) { // tslint:disable-line\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn i;\n\t}\n\n\t/**\n\t * @desc: define custom actions\n\t * @param: name - name of action, same as value of action attribute\n\t * @param: handler - custom function, which receives a XMl response content for action\n\t * @type: private\n\t */\n\tdefineAction(name: string, handler: any) {\n\t\tif (!this._uActions) {\n\t\t\tthis._uActions = {};\n\t\t}\n\t\tthis._uActions[name] = handler;\n\t}\n\n\t/**\n\t * @desc: used in combination with setOnBeforeUpdateHandler to create custom client-server transport system\n\t * @param: sid - id of item before update\n\t * @param: tid - id of item after up0ate\n\t * @param: action - action name\n\t * @type: public\n\t * @topic: 0\n\t */\n\tafterUpdateCallback(sid: number | string, tid: number | string, action: string, btag: any, ganttMode: string) {\n\t\tif(!this.$gantt){\n\t\t\t// destructor has been called before the callback\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setGanttMode(ganttMode);\n\n\t\tconst marker = sid;\n\t\tconst correct = (action !== \"error\" && action !== \"invalid\");\n\t\tif (!correct) {\n\t\t\tthis.set_invalid(sid, action);\n\t\t}\n\t\tif ((this._uActions) && (this._uActions[action]) && (!this._uActions[action](btag))) {\n\t\t\treturn (delete this._in_progress[marker]);\n\t\t}\n\n\t\tif (this._in_progress[marker] !== \"wait\") {\n\t\t\tthis.setUpdated(sid, false);\n\t\t}\n\n\t\tconst originalSid = sid;\n\n\t\tswitch (action) {\n\t\t\tcase \"inserted\":\n\t\t\tcase \"insert\":\n\t\t\t\tif (tid != sid) { // tslint:disable-line\n\t\t\t\t\tthis.setUpdated(sid, false);\n\t\t\t\t\tthis.$gantt[this._methods[2]](sid, tid);\n\t\t\t\t\tsid = tid;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"delete\":\n\t\t\tcase \"deleted\":\n\t\t\t\tif(!this.deleteAfterConfirmation || this._ganttMode !== \"task\"){\n\t\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"true_deleted\", this._ganttMode);\n\t\t\t\t\tthis.$gantt[this._methods[3]](sid);\n\t\t\t\t\tdelete this._in_progress[marker];\n\t\t\t\t\treturn this.callEvent(\"onAfterUpdate\", [sid, action, tid, btag]);\n\t\t\t\t}else{\n\t\t\t\t\tif (this._ganttMode === \"task\" && this.$gantt.isTaskExists(sid)) {\n\t\t\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"true_deleted\", this._ganttMode);\n\t\t\t\t\t\tconst task = this.$gantt.getTask(sid);\n\t\t\t\t\t\tthis.$gantt.silent(() => {\n\t\t\t\t\t\t\tthis.$gantt.deleteTask(sid);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.$gantt.callEvent(\"onAfterTaskDelete\", [sid, task]);\n\t\t\t\t\t\tthis.$gantt.render();\n\t\t\t\t\t\tdelete this._in_progress[marker];\n\t\t\t\t\t}\n\t\t\t\t\treturn this.callEvent(\"onAfterUpdate\", [sid, action, tid, btag]);\n\t\t\t\t}\n\n\t\t}\n\n\t\tif (this._in_progress[marker] !== \"wait\") {\n\t\t\tif (correct) {\n\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"\", this._ganttMode);\n\t\t\t}\n\t\t\tdelete this._in_progress[marker];\n\t\t} else {\n\t\t\tdelete this._in_progress[marker];\n\t\t\tthis.setUpdated(tid, true, this.$gantt.getUserData(sid, this.action_param, this._ganttMode));\n\t\t}\n\n\t\tthis.callEvent(\"onAfterUpdate\", [originalSid, action, tid, btag]);\n\t}\n\n\t/**\n\t * @desc: response from server\n\t * @param: xml - XMLLoader object with response XML\n\t * @type: private\n\t */\n\tafterUpdate(that: any, xml: any, id?:any) {\n\t\tlet _xml;\n\t\tif (arguments.length === 3) {\n\t\t\t_xml = arguments[1];\n\t\t} else {\n\t\t\t// old dataprocessor\n\t\t\t_xml = arguments[4];\n\t\t}\n\t\tlet mode = this.getGanttMode();\n\t\tconst reqUrl = _xml.filePath || _xml.url;\n\n\t\tif (this._tMode !== \"REST\" && this._tMode !== \"REST-JSON\") {\n\t\t\tif (reqUrl.indexOf(\"gantt_mode=links\") !== -1) {\n\t\t\t\tmode = \"link\";\n\t\t\t} else if (reqUrl.indexOf(\"gantt_mode=assignments\") !== -1) {\n\t\t\t\tmode = \"assignment\";\n\t\t\t} else if (reqUrl.indexOf(\"gantt_mode=baselines\") !== -1) {\n\t\t\t\tmode = \"baseline\";\n\t\t\t} else {\n\t\t\t\tmode = \"task\";\n\t\t\t}\n\t\t} else {\n\t\t\tif (reqUrl.indexOf(\"/link\") >= 0) {\n\t\t\t\tmode = \"link\";\n\t\t\t} else if(reqUrl.indexOf(\"/assignment\") >= 0){\n\t\t\t\tmode = \"assignment\";\n\t\t\t} else if(reqUrl.indexOf(\"/baseline\") >= 0){\n\t\t\t\tmode = \"baseline\";\n\t\t\t} else {\n\t\t\t\tmode = \"task\";\n\t\t\t}\n\t\t}\n\t\tthis.setGanttMode(mode);\n\n\t\tconst ajax = this.$gantt.ajax;\n\t\t// try to use json first\n\t\tlet tag;\n\n\t\ttry {\n\t\t\ttag = JSON.parse(xml.xmlDoc.responseText);\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t} catch (e) {\n\n\t\t\t// empty response also can be processed by json handler\n\t\t\tif (!xml.xmlDoc.responseText.length) {\n\t\t\t\ttag = {};\n\t\t\t}\n\t\t}\n\n\t\tconst processCallback = (itemId: any) => {\n\t\t\tconst action = tag.action || this.getState(itemId) || \"updated\";\n\t\t\tconst sid = tag.sid || itemId[0];\n\t\t\tconst tid = tag.tid || itemId[0];\n\t\t\tthat.afterUpdateCallback(sid, tid, action, tag, mode);\n\t\t};\n\t\tif (tag) {\n\t\t\t// GS-753. When multiple tasks are updated, unhighlight all of them\n\t\t\tif (Array.isArray(id) && id.length > 1) {\n\t\t\t\tid.forEach((taskId) => processCallback(taskId));\n\t\t\t} else {\n\t\t\t\tprocessCallback(id);\n\t\t\t}\n\t\t\tthat.finalizeUpdate();\n\t\t\tthis.setGanttMode(mode);\n\t\t\treturn;\n\t\t}\n\n\t\t// xml response\n\t\tconst top = ajax.xmltop(\"data\", xml.xmlDoc); // fix incorrect content type in IE\n\t\tif (!top) {\n\t\t\treturn this.cleanUpdate(id);\n\t\t}\n\t\tconst atag = ajax.xpath(\"//data/action\", top);\n\t\tif (!atag.length) {\n\t\t\treturn this.cleanUpdate(id);\n\t\t}\n\n\t\tfor (let i = 0; i < atag.length; i++) {\n\t\t\tconst btag = atag[i];\n\t\t\tconst action = btag.getAttribute(\"type\");\n\t\t\tconst sid = btag.getAttribute(\"sid\");\n\t\t\tconst tid = btag.getAttribute(\"tid\");\n\n\t\t\tthat.afterUpdateCallback(sid, tid, action, btag, mode);\n\t\t}\n\t\tthat.finalizeUpdate();\n\t}\n\n\tcleanUpdate(id: any[]) {\n\t\tif (id) {\n\t\t\tfor (let i = 0; i < id.length; i++) {\n\t\t\t\tdelete this._in_progress[id[i]];\n\t\t\t}\n\t\t}\n\t}\n\n\tfinalizeUpdate() {\n\t\tif (this._waitMode) {\n\t\t\tthis._waitMode--;\n\t\t}\n\n\t\tthis.callEvent(\"onAfterUpdateFinish\", []);\n\t\tif (!this.updatedRows.length) {\n\t\t\tthis.callEvent(\"onFullSync\", []);\n\t\t}\n\t}\n\n\t/**\n\t * @desc: initializes data-processor\n\t * @param: gantt - dhtmlxGantt object to attach this data-processor to\n\t * @type: public\n\t */\n\tinit(gantt: any) {\n\t\tif (this._initialized) {\n\t\t\treturn;\n\t\t}\n\t\tthis.$gantt = gantt;\n\t\tif (this.$gantt._dp_init) {\n\t\t\tthis.$gantt._dp_init(this);\n\t\t}\n\n\t\tthis._setDefaultTransactionMode();\n\n\t\tthis.styles = {\n\t\t\tupdated:\"gantt_updated\",\n\t\t\torder:\"gantt_updated\",\n\t\t\tinserted:\"gantt_inserted\",\n\t\t\tdeleted:\"gantt_deleted\",\n\t\t\tdelete_confirmation:\"gantt_deleted\",\n\t\t\tinvalid:\"gantt_invalid\",\n\t\t\terror:\"gantt_error\",\n\t\t\tclear:\"\"\n\t\t};\n\n\t\tthis._methods=[\"_row_style\",\"setCellTextStyle\",\"_change_id\",\"_delete_task\"];\n\t\textendGantt(this.$gantt, this);\n\t\tconst dataProcessorEvents = new DataProcessorEvents(this.$gantt, this);\n\t\tdataProcessorEvents.attach();\n\t\tthis.attachEvent(\"onDestroy\", function() {\n\t\t\tdelete this.setGanttMode;\n\t\t\tdelete this._getRowData;\n\n\t\t\tdelete this.$gantt._dp;\n\t\t\tdelete this.$gantt._change_id;\n\t\t\tdelete this.$gantt._row_style;\n\t\t\tdelete this.$gantt._delete_task;\n\t\t\tdelete this.$gantt._sendTaskOrder;\n\t\t\tdelete this.$gantt;\n\n\t\t\tdataProcessorEvents.detach();\n\t\t});\n\t\tthis.$gantt.callEvent(\"onDataProcessorReady\", [this]);\n\t\tthis._initialized = true;\n\t}\n\n\tsetOnAfterUpdate(handler) {\n\t\tthis.attachEvent(\"onAfterUpdate\", handler);\n\t}\n\n\tsetOnBeforeUpdateHandler(handler) {\n\t\tthis.attachEvent(\"onBeforeDataSending\", handler);\n\t}\n\n\t/* starts autoupdate mode\n\t\t@param interval time interval for sending update requests\n\t*/\n\tsetAutoUpdate(interval, user) {\n\t\tinterval = interval || 2000;\n\n\t\tthis._user = user || (new Date()).valueOf();\n\t\tthis._needUpdate = false;\n\n\t\tthis._updateBusy = false;\n\n\t\tthis.attachEvent(\"onAfterUpdate\", this.afterAutoUpdate); // arguments sid, action, tid, xml_node;\n\n\t\tthis.attachEvent(\"onFullSync\", this.fullSync);\n\n\t\tsetInterval(() => {\n\t\t\tthis.loadUpdate();\n\t\t}, interval);\n\t}\n\n\t/* process updating request response\n\t\tif status == collision version is deprecated\n\t\tset flag for autoupdating immediately\n\t*/\n\tafterAutoUpdate(sid, action, tid, xml_node) { // tslint:disable-line\n\t\tif (action === \"collision\") {\n\t\t\tthis._needUpdate = true;\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\t/* callback function for onFillSync event\n\t\tcall update function if it's need\n\t*/\n\tfullSync() {\n\t\tif (this._needUpdate) {\n\t\t\tthis._needUpdate = false;\n\t\t\tthis.loadUpdate();\n\t\t}\n\t\treturn true;\n\t}\n\n\t/* sends query to the server and call callback function\n\t*/\n\tgetUpdates(url, callback) {\n\t\tconst ajax = this.$gantt.ajax;\n\t\tif (this._updateBusy) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\tthis._updateBusy = true;\n\t\t}\n\n\t\tajax.get(url, callback);\n\n\t}\n\n\t/* loads updates and processes them\n\t*/\n\tloadUpdate() {\n\t\tconst ajax = this.$gantt.ajax;\n\t\tconst version = this.$gantt.getUserData(0, \"version\", this._ganttMode);\n\t\tlet url = this.serverProcessor + ajax.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, \"dhx_version=\" + version].join(\"&\");\n\t\turl = url.replace(\"editing=true&\", \"\");\n\t\tthis.getUpdates(url, (xml) => {\n\t\t\tconst vers = ajax.xpath(\"//userdata\", xml);\n\t\t\tthis.$gantt.setUserData(0, \"version\", this._getXmlNodeValue(vers[0]), this._ganttMode);\n\n\t\t\tconst updates = ajax.xpath(\"//update\", xml);\n\t\t\tif (updates.length) {\n\t\t\t\tthis._silent_mode = true;\n\n\t\t\t\tfor (let i = 0; i < updates.length; i++) {\n\t\t\t\t\tconst status = updates[i].getAttribute(\"status\");\n\t\t\t\t\tconst id = updates[i].getAttribute(\"id\");\n\t\t\t\t\tconst parent = updates[i].getAttribute(\"parent\");\n\t\t\t\t\tswitch (status) {\n\t\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\t\tthis.callEvent(\"insertCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"updated\":\n\t\t\t\t\t\t\tthis.callEvent(\"updateCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\t\tthis.callEvent(\"deleteCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._silent_mode = false;\n\t\t\t}\n\n\t\t\tthis._updateBusy = false;\n\t\t});\n\t}\n\n\tdestructor() {\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\n\t\tthis.updatedRows = [];\n\t\tthis._in_progress = {}; // ?\n\t\tthis._invalid = {};\n\t\tthis._storage.clear();\n\t\tthis._storage = null;\n\t\tthis._headers = null;\n\t\tthis._payload = null;\n\t\tdelete this._initialized;\n\t}\n\n\tsetGanttMode(mode) {\n\t\tif (mode === \"tasks\") {\n\t\t\tmode = \"task\";\n\t\t} else if (mode === \"links\") {\n\t\t\tmode = \"link\";\n\t\t}\n\n\t\tconst modes = this.modes || {};\n\t\tconst ganttMode = this.getGanttMode();\n\t\tif (ganttMode) {\n\t\t\tmodes[ganttMode] = {\n\t\t\t\t_in_progress : this._in_progress,\n\t\t\t\t_invalid: this._invalid,\n\t\t\t\t_storage: this._storage,\n\t\t\t\tupdatedRows : this.updatedRows\n\t\t\t};\n\t\t}\n\n\t\tlet newState = modes[mode];\n\t\tif (!newState) {\n\t\t\tnewState = modes[mode] = {\n\t\t\t\t_in_progress : {},\n\t\t\t\t_invalid : {},\n\t\t\t\t_storage : SimpleStorage.create(),\n\t\t\t\tupdatedRows : []\n\t\t\t};\n\t\t}\n\t\tthis._in_progress = newState._in_progress;\n\t\tthis._invalid = newState._invalid;\n\t\tthis._storage = newState._storage;\n\t\tthis.updatedRows = newState.updatedRows;\n\t\tthis.modes = modes;\n\t\tthis._ganttMode = mode;\n\t}\n\tgetGanttMode():string {\n\t\treturn this._ganttMode;\n\t}\n\n\tstoreItem(item) {\n\t\tthis._storage.storeItem(item);\n\t}\n\n\turl(url: string) {\n\t\tthis.serverProcessor = this._serverProcessor = url;\n\t}\n\n\tprotected _beforeSendData(data: any, rowId: any) {\n\t\tif (!this.callEvent(\"onBeforeUpdate\", [rowId, this.getState(rowId), data])) {\n\t\t\treturn false;\n\t\t}\n\t\tthis._sendData(data, rowId);\n\t}\n\n\tprotected _serializeAsJSON(data: any) {\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\n\t\tconst copy = utils.copy(data);\n\t\tif (this._tMode === \"REST-JSON\") {\n\t\t\tdelete copy.id;\n\t\t\tdelete copy[this.action_param];\n\t\t}\n\n\t\treturn JSON.stringify(copy);\n\t}\n\n\tprotected _applyPayload(url: string) {\n\t\tconst ajax = this.$gantt.ajax;\n\t\tif (this._payload) {\n\t\t\tfor (const key in this._payload) {\n\t\t\t\turl = url + ajax.urlSeparator(url) + this.escape(key) + \"=\" + this.escape(this._payload[key]);\n\t\t\t}\n\t\t}\n\t\treturn url;\n\t}\n\n\t// GET/POST/JSON modes of the dataProcessor didn't send the whole data items in 'delete' requests\n\t// clear extra info from the data in order not to change the request format\n\tprotected _cleanupArgumentsBeforeSend(dataToSend: any) {\n\t\tlet processedData;\n\t\tif(dataToSend[this.action_param] === undefined){// hash of updated items, and not an individual item\n\t\t\tprocessedData = {};\n\t\t\tfor(const i in dataToSend) {\n\t\t\t\tprocessedData[i] = this._cleanupArgumentsBeforeSend(dataToSend[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tprocessedData = this._cleanupItemBeforeSend(dataToSend);\n\t\t}\n\t\treturn processedData;\n\t}\n\tprotected _cleanupItemBeforeSend(updatedItem: any) {\n\t\tlet output = null;\n\t\tif(updatedItem){\n\t\t\tif(updatedItem[this.action_param] === \"deleted\"){\n\t\t\t\toutput = {};\n\t\t\t\toutput.id = updatedItem.id;\n\t\t\t\toutput[this.action_param] = updatedItem[this.action_param];\n\t\t\t}else{\n\t\t\t\toutput = updatedItem;\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tprotected _sendData(dataToSend: any, rowId?: any) {\n\t\tif (!dataToSend) {\n\t\t\treturn; // nothing to send\n\t\t}\n\t\tif (!this.callEvent(\"onBeforeDataSending\", rowId ? [rowId, this.getState(rowId), dataToSend] : [null, null, dataToSend])) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (rowId) {\n\t\t\tthis._in_progress[rowId] = (new Date()).valueOf();\n\t\t}\n\n\t\tconst ajax = this.$gantt.ajax;\n\n\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\tconst taskState = this.getState(rowId);\n\t\t\tconst taskAction = this.getActionByState(taskState);\n\t\t\tconst ganttMode = this.getGanttMode();\n\t\t\tconst _onResolvedCreateUpdate = (tag) => {\n\t\t\t\tlet action = taskState || \"updated\";\n\t\t\t\tlet sid = rowId;\n\t\t\t\tlet tid = rowId;\n\n\t\t\t\tif (tag) {\n\t\t\t\t\taction = tag.action || taskState;\n\t\t\t\t\tsid = tag.sid || sid;\n\t\t\t\t\ttid = tag.id || tag.tid || tid;\n\t\t\t\t}\n\t\t\t\tthis.afterUpdateCallback(sid, tid, action, tag, ganttMode);\n\t\t\t};\n\n\t\t\tlet actionPromise;\n\t\t\tif (this._router instanceof Function) {\n\t\t\t\tif(this._routerParametersFormat === \"object\"){\n\t\t\t\t\tconst obj = {\n\t\t\t\t\t\tentity: ganttMode,\n\t\t\t\t\t\taction: taskAction,\n\t\t\t\t\t\tdata: dataToSend,\n\t\t\t\t\t\tid: rowId\n\t\t\t\t\t};\n\t\t\t\t\tactionPromise = this._router(obj);\n\t\t\t\t} else {\n\t\t\t\t\tactionPromise = this._router(ganttMode, taskAction, dataToSend, rowId);\n\t\t\t\t}\n\t\t\t} else if (this._router[ganttMode] instanceof Function) {\n\t\t\t\tactionPromise = this._router[ganttMode](taskAction, dataToSend, rowId);\n\t\t\t} else {\n\n\t\t\t\tconst errorMsgStart = \"Incorrect configuration of gantt.createDataProcessor\";\n\t\t\t\tconst errorMsgEnd = `\nYou need to either add missing properties to the dataProcessor router object or to use a router function.\nSee https://docs.dhtmlx.com/gantt/desktop__server_side.html#customrouting and https://docs.dhtmlx.com/gantt/api__gantt_createdataprocessor.html for details.`;\n\n\t\t\t\tif(!this._router[ganttMode]){\n\t\t\t\t\tthrow new Error(`${errorMsgStart}: router for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t}\n\t\t\t\tswitch (taskState) {\n\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\tif(!this._router[ganttMode].create){\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **create** action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].create(dataToSend);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\tif(!this._router[ganttMode].delete){\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **delete** action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].delete(rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(!this._router[ganttMode].update){\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **update**\" action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].update(dataToSend, rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(actionPromise){\n\t\t\t\t// neither promise nor {tid: newId} response object\n\t\t\t\tif(!actionPromise.then &&\n\t\t\t\t\t(actionPromise.id === undefined && actionPromise.tid === undefined && actionPromise.action === undefined)){\n\t\t\t\t\tthrow new Error(\"Incorrect router return value. A Promise or a response object is expected\");\n\t\t\t\t}\n\n\t\t\t\tif(actionPromise.then){\n\t\t\t\t\tactionPromise.then(_onResolvedCreateUpdate).catch((error) => {\n\t\t\t\t\t\tif(error && error.action){\n\t\t\t\t\t\t\t_onResolvedCreateUpdate(error);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t_onResolvedCreateUpdate({ action: \"error\", value: error});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\t// custom method may return a response object in case of sync action\n\t\t\t\t\t_onResolvedCreateUpdate(actionPromise);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t_onResolvedCreateUpdate(null);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tlet queryParams: any;\n\t\tqueryParams = {\n\t\t\tcallback: (xml) => {\n\t\t\t\tconst ids = [];\n\n\t\t\t\tif (rowId) {\n\t\t\t\t\tids.push(rowId);\n\t\t\t\t} else if (dataToSend) {\n\t\t\t\t\tfor (const key in dataToSend) {\n\t\t\t\t\t\tids.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn this.afterUpdate(this, xml, ids);\n\t\t\t},\n\t\t\theaders: this._headers\n\t\t};\n\n\t\tconst dhxVersion = \"dhx_version=\" + this.$gantt.getUserData(0, \"version\", this._ganttMode);\n\t\tconst urlParams = this.serverProcessor + (this._user ? (ajax.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, dhxVersion].join(\"&\")) : \"\");\n\t\tlet url: any = this._applyPayload(urlParams);\n\t\tlet data;\n\n\t\tswitch (this._tMode) {\n\t\t\tcase \"GET\":\n\t\t\t\tdata = this._cleanupArgumentsBeforeSend(dataToSend);\n\t\t\t\tqueryParams.url = url + ajax.urlSeparator(url) + this.serialize(data, rowId);\n\t\t\t\tqueryParams.method = \"GET\";\n\t\t\t\tbreak;\n\t\t\tcase \"POST\":\n\t\t\t\tdata = this._cleanupArgumentsBeforeSend(dataToSend);\n\t\t\t\tqueryParams.url = url;\n\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\tqueryParams.data = this.serialize(data, rowId);\n\t\t\t\tbreak;\n\t\t\tcase \"JSON\":\n\t\t\t\tdata = {};\n\t\t\t\tconst preprocessedData = this._cleanupItemBeforeSend(dataToSend);\n\t\t\t\tfor (const key in preprocessedData) {\n\t\t\t\t\tif (key === this.action_param || key === \"id\" || key === \"gr_id\") {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tdata[key] = preprocessedData[key];\n\t\t\t\t}\n\n\t\t\t\tqueryParams.url = url;\n\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\tqueryParams.data = JSON.stringify({\n\t\t\t\t\tid: rowId,\n\t\t\t\t\taction: dataToSend[this.action_param],\n\t\t\t\t\tdata\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"REST\":\n\t\t\tcase \"REST-JSON\":\n\t\t\t\turl = urlParams.replace(/(&|\\?)editing=true/, \"\");\n\t\t\t\tdata = \"\";\n\n\t\t\t\tswitch (this.getState(rowId)) {\n\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\t\t\tqueryParams.data = this.serialize(dataToSend, rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\tqueryParams.method = \"DELETE\";\n\t\t\t\t\t\turl = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + rowId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tqueryParams.method = \"PUT\";\n\t\t\t\t\t\tqueryParams.data = this.serialize(dataToSend, rowId);\n\t\t\t\t\t\turl = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + rowId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tqueryParams.url = this._applyPayload(url);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._waitMode++;\n\t\treturn ajax.query(queryParams);\n\t}\n\n\tprotected _forEachUpdatedRow(code: any) {\n\t\tconst updatedRows = this.updatedRows.slice();\n\t\tfor (let i = 0; i < updatedRows.length; i++) {\n\t\t\tconst rowId = updatedRows[i];\n\t\t\tif (this.$gantt.getUserData(rowId, this.action_param, this._ganttMode)) {\n\t\t\t\tcode.call(this, rowId);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _setDefaultTransactionMode() {\n\t\tif (this.serverProcessor) {\n\t\t\tthis.setTransactionMode(\"POST\", true);\n\t\t\tthis.serverProcessor += (this.serverProcessor.indexOf(\"?\") !== -1 ? \"&\" : \"?\") + \"editing=true\";\n\t\t\tthis._serverProcessor = this.serverProcessor;\n\t\t}\n\t}\n\n\t/* returns xml node value\n\t\t@param node\n\t\t\txml node\n\t*/\n\tprotected _getXmlNodeValue(node) {\n\t\tif (node.firstChild) {\n\t\t\treturn node.firstChild.nodeValue;\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tprotected _getAllData() {\n\t\tconst out = {};\n\t\tlet hasOne = false;\n\n\t\tthis._forEachUpdatedRow(function(id) {\n\t\t\tif (this._in_progress[id] || this.is_invalid(id)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst row = this._getRowData(id);\n\t\t\tif (!this.callEvent(\"onBeforeUpdate\", [id, this.getState(id), row])) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tout[id] = row;\n\t\t\thasOne = true;\n\t\t\tthis._in_progress[id] = (new Date()).valueOf();\n\t\t});\n\n\t\treturn hasOne ? out : null;\n\t}\n\n\tprotected _prepareDate(value: Date) : string {\n\t\treturn this.$gantt.defined(this.$gantt.templates.xml_format) ? this.$gantt.templates.xml_format(value) : this.$gantt.templates.format_date(value);\n\t}\n\n\tprotected _prepareArray(value: any[], traversedObjects: object[]) : any[] {\n\t\ttraversedObjects.push(value);\n\n\t\treturn value.map((item) => {\n\t\t\tif(helpers.isDate(item)){\n\t\t\t\treturn this._prepareDate(item);\n\t\t\t} else if (Array.isArray(item) && !helpers.arrayIncludes(traversedObjects, item)){\n\t\t\t\treturn this._prepareArray(item, traversedObjects);\n\t\t\t} else if (item && typeof item === \"object\" && !helpers.arrayIncludes(traversedObjects, item)) {\n\t\t\t\treturn this._prepareObject(item, traversedObjects);\n\t\t\t} else {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected _prepareObject(rawItem: any, traversedObjects: object[]) : any {\n\t\tconst processedItem = {};\n\t\ttraversedObjects.push(rawItem);\n\n\t\tfor (const key in rawItem) {\n\t\t\tif (key.substr(0, 1) === \"$\") {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst value = rawItem[key];\n\t\t\tif (helpers.isDate(value)) {\n\t\t\t\tprocessedItem[key] = this._prepareDate(value);\n\t\t\t} else if(value === null) {\n\t\t\t\tprocessedItem[key] = \"\";\n\t\t\t} else if (Array.isArray(value) && !helpers.arrayIncludes(traversedObjects, value)){\n\t\t\t\tprocessedItem[key] = this._prepareArray(value, traversedObjects);\n\t\t\t} else if (value && typeof value === \"object\" && !helpers.arrayIncludes(traversedObjects, value)) {\n\t\t\t\tprocessedItem[key] = this._prepareObject(value, traversedObjects);\n\t\t\t} else {\n\t\t\t\tprocessedItem[key] = value;\n\t\t\t}\n\t\t}\n\t\treturn processedItem;\n\t}\n\n\tprotected _prepareDataItem(rawItem: any): any {\n\t\tconst processedItem = this._prepareObject(rawItem, []);\n\n\t\tprocessedItem[this.action_param] = this.$gantt.getUserData(rawItem.id, this.action_param, this._ganttMode);\n\t\treturn processedItem;\n\t}\n\n\tprotected getStoredItem(id){\n\t\treturn this._storage.getStoredItem(id);\n\t}\n\n\tprotected _getRowData(id) {\n\t\tlet dataItem;\n\t\tconst gantt = this.$gantt;\n\t\tif (this.getGanttMode() === \"task\") {\n\t\t\tif(gantt.isTaskExists(id)){\n\t\t\t\tdataItem =this.$gantt.getTask(id);\n\t\t\t}\n\t\t} else if (this.getGanttMode() === \"assignment\") {\n\t\t\tif(this.$gantt.$data.assignmentsStore.exists(id)){\n\t\t\t\tdataItem =this.$gantt.$data.assignmentsStore.getItem(id);\n\t\t\t}\n\t\t} else if (this.getGanttMode() === \"baseline\") {\n\t\t\tif(this.$gantt.$data.baselineStore.exists(id)){\n\t\t\t\tdataItem =this.$gantt.$data.baselineStore.getItem(id);\n\t\t\t}\n\t\t} else {\n\t\t\tif(gantt.isLinkExists(id)){\n\t\t\t\tdataItem =this.$gantt.getLink(id);\n\t\t\t}\n\t\t}\n\n\t\tif (!dataItem) {\n\t\t\tdataItem = this.getStoredItem(id);\n\t\t}\n\n\t\tif (!dataItem) {\n\t\t\tdataItem = { id };\n\t\t}\n\n\t\treturn this._prepareDataItem(dataItem);\n\t}\n}","\nexport default function extendGantt(gantt: any, dp: any) {\n\tgantt.getUserData = function(id, name, store) {\n\t\tif (!this.userdata) {\n\t\t\tthis.userdata = {};\n\t\t}\n\t\tthis.userdata[store] = this.userdata[store] || {};\n\t\tif (this.userdata[store][id] && this.userdata[store][id][name]) {\n\t\t\treturn this.userdata[store][id][name];\n\t\t}\n\t\treturn \"\";\n\t};\n\tgantt.setUserData = function(id, name, value, store) {\n\t\tif (!this.userdata) {\n\t\t\tthis.userdata = {};\n\t\t}\n\t\tthis.userdata[store] = this.userdata[store] || {};\n\t\tthis.userdata[store][id] = this.userdata[store][id] || {};\n\t\tthis.userdata[store][id][name] = value;\n\t};\n\n\tgantt._change_id = function(oldId, newId) {\n\t\tswitch (this._dp._ganttMode) {\n\t\t\tcase \"task\":\n\t\t\t\tthis.changeTaskId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"link\":\n\t\t\t\tthis.changeLinkId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"assignment\":\n\t\t\t\tthis.$data.assignmentsStore.changeId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"resource\":\n\t\t\t\tthis.$data.resourcesStore.changeId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"baseline\":\n\t\t\t\tthis.$data.baselineStore.changeId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(`Invalid mode of the dataProcessor after database id is received: ${this._dp._ganttMode}, new id: ${newId}`);\n\t\t}\n\t};\n\n\tgantt._row_style = function(rowId, classname){\n\t\tif (this._dp._ganttMode !== \"task\") {\n\t\t\treturn;\n\t\t}\n\t\tif (!gantt.isTaskExists(rowId)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst task = gantt.getTask(rowId);\n\t\ttask.$dataprocessor_class = classname;\n\t\tgantt.refreshTask(rowId);\n\t};\n\n\t// fake method for dataprocessor\n\tgantt._delete_task = function(rowId, node) {}; // tslint:disable-line\n\n\tgantt._sendTaskOrder = function(id, item){\n\t\tif (item.$drop_target) {\n\t\t\tthis._dp.setGanttMode(\"task\");\n\t\t\tthis.getTask(id).target = item.$drop_target;\n\t\t\tthis._dp.setUpdated(id, true,\"order\");\n\t\t\tdelete this.getTask(id).$drop_target;\n\t\t}\n\t};\n\n\tgantt.setDp = function() {\n\t\tthis._dp = dp;\n\t};\n\n\tgantt.setDp();\n}","import * as DataProcessor from \"./data_processor\";\nexport default {\n\tDEPRECATED_api: function(server) {\n\t\treturn new (DataProcessor.DataProcessor)(server);\n\t},\n\tcreateDataProcessor: DataProcessor.createDataProcessor\n};","import global from \"../../utils/global\";\n\nfunction createMethod(gantt){\n\tvar methods = {};\n\tvar isActive = false;\n\tfunction disableMethod(methodName, dummyMethod){\n\t\tdummyMethod = typeof dummyMethod == \"function\" ? dummyMethod : function(){};\n\n\t\tif(!methods[methodName]){\n\t\t\tmethods[methodName] = this[methodName];\n\t\t\tthis[methodName] = dummyMethod;\n\t\t}\n\t}\n\tfunction restoreMethod(methodName){\n\t\tif(methods[methodName]){\n\t\t\tthis[methodName] = methods[methodName];\n\t\t\tmethods[methodName] = null;\n\t\t}\n\t}\n\tfunction disableMethods(methodsHash){\n\t\tfor(var i in methodsHash){\n\t\t\tdisableMethod.call(this, i, methodsHash[i]);\n\t\t}\n\t}\n\tfunction restoreMethods(){\n\t\tfor(var i in methods){\n\t\t\trestoreMethod.call(this, i);\n\t\t}\n\t}\n\n\tfunction batchUpdatePayload(callback){\n\t\ttry{\n\t\t\tcallback();\n\t\t}catch(e){\n\t\t\tglobal.console.error(e);\n\t\t}\n\t}\n\n\tvar state = gantt.$services.getService(\"state\");\n\tstate.registerProvider(\"batchUpdate\", function(){\n\t\treturn {\n\t\t\tbatch_update: isActive\n\t\t};\n\t}, false);\n\n\treturn function batchUpdate(callback, noRedraw) {\n\t\tif(isActive){\n\t\t\t// batch mode is already active\n\t\t\tbatchUpdatePayload(callback);\n\t\t\treturn;\n\t\t}\n\n\t\tvar call_dp = (this._dp && this._dp.updateMode != \"off\");\n\t\tvar dp_mode;\n\t\tif (call_dp){\n\t\t\tdp_mode = this._dp.updateMode;\n\t\t\tthis._dp.setUpdateMode(\"off\");\n\t\t}\n\n\t\t// temporary disable some methods while updating multiple tasks\n\t\tvar resetProjects = {};\n\t\tvar methods = {\n\t\t\t\"render\":true,\n\t\t\t\"refreshData\":true,\n\t\t\t\"refreshTask\":true,\n\t\t\t\"refreshLink\":true,\n\t\t\t\"resetProjectDates\":function(task){\n\t\t\t\tresetProjects[task.id] = task;\n\t\t\t}\n\t\t};\n\n\t\tdisableMethods.call(this, methods);\n\n\t\tisActive = true;\n\t\tthis.callEvent(\"onBeforeBatchUpdate\", []);\n\n\t\tbatchUpdatePayload(callback);\n\n\t\tthis.callEvent(\"onAfterBatchUpdate\", []);\n\n\t\trestoreMethods.call(this);\n\n\t\t// do required updates after changes applied\n\t\tfor(var i in resetProjects){\n\t\t\tthis.resetProjectDates(resetProjects[i]);\n\t\t}\n\n\t\tisActive = false;\n\n\t\tif(!noRedraw){\n\t\t\tthis.render();\n\t\t}\n\n\t\tif (call_dp) {\n\t\t\tthis._dp.setUpdateMode(dp_mode);\n\t\t\tthis._dp.setGanttMode(\"task\");\n\t\t\tthis._dp.sendData();\n\t\t\tthis._dp.setGanttMode(\"link\");\n\t\t\tthis._dp.sendData();\n\t\t}\n\t};\n\n\n\n}\n\nexport default function(gantt){\n\tgantt.batchUpdate = createMethod(gantt);\n};","const createWbs = (function(gantt){\n\treturn {\n\t_needRecalc: true,\n\treset: function(){\n\t\tthis._needRecalc = true;\n\t},\n\t_isRecalcNeeded: function(){\n\t\treturn (!this._isGroupSort() && this._needRecalc);\n\t},\n\t_isGroupSort: function() {\n\t\treturn !!(gantt.getState().group_mode);\n\t},\n\t_getWBSCode: function(task) {\n\t\tif(!task) return \"\";\n\n\t\tif(this._isRecalcNeeded()){\n\t\t\tthis._calcWBS();\n\t\t}\n\n\t\tif(task.$virtual) return \"\";\n\t\tif(this._isGroupSort()) return task.$wbs || \"\";\n\n\t\tif(!task.$wbs) {\n\t\t\tthis.reset();\n\t\t\tthis._calcWBS();\n\t\t}\n\t\treturn task.$wbs;\n\t},\n\t_setWBSCode: function(task, value) {\n\t\ttask.$wbs = value;\n\t},\n\tgetWBSCode: function(task) {\n\t\treturn this._getWBSCode(task);\n\t},\n\tgetByWBSCode: function(code){\n\t\tlet parts = code.split(\".\");\n\t\tlet currentNode = gantt.config.root_id;\n\t\tfor(let i = 0; i < parts.length; i++){\n\t\t\tconst children = gantt.getChildren(currentNode);\n\t\t\tlet index = parts[i]*1 - 1;\n\t\t\tif(gantt.isTaskExists(children[index])){\n\t\t\t\tcurrentNode = children[index];\n\t\t\t}else{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\tif(gantt.isTaskExists(currentNode)){\n\t\t\treturn gantt.getTask(currentNode);\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t},\n\t_calcWBS: function() {\n\t\tif(!this._isRecalcNeeded()) return;\n\n\t\tlet _isFirst = true;\n\t\tgantt.eachTask(function(ch) {\n\t\t\tif(ch.type == gantt.config.types.placeholder) return;\n\t\t\tif(_isFirst) {\n\t\t\t\t_isFirst = false;\n\t\t\t\tthis._setWBSCode(ch, \"1\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst _prevSibling = this._getPrevNonPlaceholderSibling(ch.id);\n\t\t\tif (_prevSibling !== null) {\n\t\t\t\tthis._increaseWBS(ch, _prevSibling);\n\t\t\t} else {\n\t\t\t\tlet _parent = gantt.getParent(ch.id);\n\t\t\t\tthis._setWBSCode(ch, gantt.getTask(_parent).$wbs + \".1\");\n\t\t\t}\n\t\t}, gantt.config.root_id, this);\n\n\t\tthis._needRecalc = false;\n\t},\n\t_increaseWBS: function(task, siblingiId){\n\t\tlet _wbs = gantt.getTask(siblingiId).$wbs;\n\t\tif(_wbs) {\n\t\t\t_wbs = _wbs.split(\".\");\n\t\t\t_wbs[_wbs.length-1]++;\n\t\t\tthis._setWBSCode(task, _wbs.join(\".\"));\n\t\t}\n\t},\n\t_getPrevNonPlaceholderSibling: function(childId) {\n\t\tlet prevSibling;\n\t\tlet currentId = childId;\n\t\tdo {\n\t\t\tprevSibling = gantt.getPrevSibling(currentId);\n\t\t\tcurrentId = prevSibling;\n\t\t} while (prevSibling !== null && gantt.getTask(prevSibling).type == gantt.config.types.placeholder);\n\t\treturn prevSibling;\n   }\n};\n});\n\nexport default function(gantt){\n\tconst wbs = createWbs(gantt);\n\tgantt.getWBSCode = function getWBSCode(task) {\n\t\treturn wbs.getWBSCode(task);\n\t};\n\n\tgantt.getTaskByWBSCode = function(code) {\n\t\treturn wbs.getByWBSCode(code);\n\t};\n\n\tfunction resetCache(){\n\t\twbs.reset();\n\t\treturn true;\n\t}\n\n\tgantt.attachEvent(\"onAfterTaskMove\", resetCache);\n\tgantt.attachEvent(\"onBeforeParse\", resetCache);\n\tgantt.attachEvent(\"onAfterTaskDelete\", resetCache);\n\tgantt.attachEvent(\"onAfterTaskAdd\", resetCache);\n\tgantt.attachEvent(\"onAfterSort\", resetCache);\n\n};\n","import * as helpers from \"../../utils/helpers\";\nimport * as dom_helpers from \"../ui/utils/dom_helpers\";\nfunction createResourceMethods(gantt){\n\n\tvar resourceTaskCache = {};\n\tvar singleResourceCacheBuilt = false;\n\n\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(){\n\t\tresourceTaskCache = {};\n\t\tsingleResourceCacheBuilt = false;\n\t});\n\tgantt.attachEvent(\"onBeforeGanttRender\", function(){\n\t\tresourceTaskCache = {};\n\t});\n\n\tfunction getTaskBy(propertyName, propertyValue, typeFilter) {\n\t\tif (typeof propertyName == \"function\") {\n\t\t\treturn filterResourceTasks(propertyName);\n\t\t} else {\n\t\t\tif (helpers.isArray(propertyValue)) {\n\t\t\t\treturn getResourceTasks(propertyName, propertyValue, typeFilter);\n\t\t\t} else {\n\t\t\t\treturn getResourceTasks(propertyName, [propertyValue], typeFilter);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction filterResourceTasks(filter) {\n\t\tvar res = [];\n\t\tgantt.eachTask(function (task) {\n\t\t\tif (filter(task)) {\n\t\t\t\tres.push(task);\n\t\t\t}\n\t\t});\n\t\treturn res;\n\t}\n\n\tvar falsyValuePrefix = String(Math.random());\n\tfunction resourceHashFunction(value){\n\t\tif (value === null){\n\t\t\treturn falsyValuePrefix + String(value);\n\t\t}\n\t\treturn String(value);\n\t}\n\n\tfunction getCacheKey(resourceIds, property, typeFilter) {\n\t\tif (Array.isArray(resourceIds)) {\n\t\t\treturn resourceIds.map(function (value) {\n\t\t\t\treturn resourceHashFunction(value);\n\t\t\t}).join(\"_\") + `_${property}_${typeFilter}`;\n\t\t} else {\n\t\t\treturn resourceHashFunction(resourceIds) + `_${property}_${typeFilter}`;\n\t\t}\n\t}\n\n\tfunction getResourceTasks(property, resourceIds, typeFilter) {\n\t\tvar res;\n\t\tvar cacheKey = getCacheKey(resourceIds, property, JSON.stringify(typeFilter));\n\t\tvar matchingResources = {};\n\t\thelpers.forEach(resourceIds, function(resourceId) {\n\t\t\tmatchingResources[resourceHashFunction(resourceId)] = true;\n\t\t});\n\n\t\tif (!resourceTaskCache[cacheKey]) {\n\t\t\tres = resourceTaskCache[cacheKey] = [];\n\t\t\tgantt.eachTask(function (task) {\n\t\t\t\tif (typeFilter) {\n\t\t\t\t\tif (!typeFilter[gantt.getTaskType(task)]) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if (task.type == gantt.config.types.project) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (property in task) {\n\t\t\t\t\tvar resourceValue;\n\t\t\t\t\tif (!helpers.isArray(task[property])) {\n\t\t\t\t\t\tresourceValue = [task[property]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresourceValue = task[property];\n\t\t\t\t\t}\n\n\t\t\t\t\thelpers.forEach(resourceValue, function(value) {\n\t\t\t\t\t\tvar resourceValue = (value && value.resource_id) ? value.resource_id : value;\n\n\t\t\t\t\t\tif (matchingResources[resourceHashFunction(resourceValue)]) {\n\t\t\t\t\t\t\tres.push(task);\n\t\t\t\t\t\t}else if(!singleResourceCacheBuilt){\n\n\t\t\t\t\t\t\tvar key = getCacheKey(value, property);\n\t\t\t\t\t\t\tif(!resourceTaskCache[key]){\n\t\t\t\t\t\t\t\tresourceTaskCache[key] = [];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresourceTaskCache[key].push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsingleResourceCacheBuilt = true;\n\t\t} else {\n\t\t\tres = resourceTaskCache[cacheKey];\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tfunction selectAssignments(resourceId, taskId, result){\n\t\tvar property = gantt.config.resource_property;\n\t\tvar owners = [];\n\t\tif (gantt.getDatastore(\"task\").exists(taskId)) {\n\t\t\tvar task = gantt.getTask(taskId);\n\t\t\towners = task[property] || [];\n\t\t}\n\n\t\tif (!Array.isArray(owners)) {\n\t\t\towners = [owners];\n\t\t}\n\t\tfor (var i = 0; i < owners.length; i++) {\n\t\t\tif (owners[i].resource_id == resourceId) {\n\t\t\t\tresult.push({task_id: task.id, resource_id:owners[i].resource_id, value:owners[i].value});\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getResourceAssignments(resourceId, taskId){\n\t\t// resource assignment as an independent module:\n\t\t// {taskId:, resourceId, value}\n\t\t// TODO: probably should add a separate datastore for these\n\t\tvar assignments = [];\n\t\tvar property = gantt.config.resource_property;\n\t\tif(taskId !== undefined){\n\t\t\tselectAssignments(resourceId, taskId, assignments);\n\t\t}else{\n\t\t\tvar tasks = gantt.getTaskBy(property, resourceId);\n\t\t\ttasks.forEach(function(task){\n\t\t\t\tselectAssignments(resourceId, task.id, assignments);\n\t\t\t});\n\t\t}\n\t\treturn assignments;\n\t}\n\n\treturn {\n\t\tgetTaskBy: getTaskBy,\n\t\tgetResourceAssignments: getResourceAssignments\n\t};\n}\n\nfunction createHelper(gantt){\n\tconst resourcePlugin = {\n\t\trenderEditableLabel: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tconst editable = gantt.config.readonly ? \"\" : \"contenteditable\";\n\t\t\tif(start_date < resource.end_date && end_date > resource.start_date){\n\t\t\t\tfor(let i = 0; i < assignments.length; i++){\n\t\t\t\t\tconst a = assignments[i];\n\t\t\t\t\t\treturn \"<div \"+editable+\" data-assignment-cell data-assignment-id='\"+a.id+\"'\"+\n\t\t\t\t\t\t\" data-row-id='\"+resource.id+\"'\"+\n\t\t\t\t\t\t\" data-task='\"+resource.$task_id+\"'\"+\n\t\t\t\t\t\t\" data-start-date='\"+gantt.templates.format_date(start_date)+\"'\"+\n\t\t\t\t\t\t\" data-end-date='\"+gantt.templates.format_date(end_date)+\"'>\" + a.value + \"</div>\";\n\t\t\t\t}\n\t\t\t\treturn \"<div \"+editable+\" data-assignment-cell data-empty \"+ \n\t\t\t\t\t\t\" data-row-id='\"+resource.id+\"'\"+\n\t\t\t\t\t\t\" data-resource-id='\"+resource.$resource_id+\"'\"+\n\t\t\t\t\t\t\" data-task='\"+resource.$task_id+\"'\"+\n\t\t\t\t\t\t\" data-start-date='\"+gantt.templates.format_date(start_date)+\"'\"+\n\t\t\t\t\t\t\"'  data-end-date='\"+gantt.templates.format_date(end_date)+\"'>-</div>\";\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\trenderSummaryLabel: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tlet sum = assignments.reduce(function(total, assignment){ \n\t\t\t\treturn total + Number(assignment.value);\n\t\t\t}, 0);\n\n\t\t\tif(sum % 1){\n\t\t\t\tsum = Math.round(sum * 10)/10;\n\t\t\t}\n\n\t\t\tif(sum){\n\t\t\t\treturn \"<div>\" + sum + \"</div>\";\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\teditableResourceCellTemplate: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tif(resource.$role === \"task\"){\n\t\t\t\treturn resourcePlugin.renderEditableLabel(start_date, end_date, resource, tasks, assignments);\n\t\t\t}else{\n\t\t\t\treturn resourcePlugin.renderSummaryLabel(start_date, end_date, resource, tasks, assignments);\n\t\t\t}\n\n\t\t},\n\t\t\n\t\teditableResourceCellClass: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tconst css = [];\n\t\t\tcss.push(\"resource_marker\");\n\n\t\t\tif(resource.$role === \"task\"){\n\t\t\t\tcss.push(\"task_cell\");\n\t\t\t}else{\n\t\t\t\tcss.push(\"resource_cell\");\n\t\t\t}\n\n\t\t\tconst sum = assignments.reduce(function(total, assignment){ \n\t\t\t\treturn total + Number(assignment.value);\n\t\t\t}, 0);\n\n\t\t\tlet capacity = Number(resource.capacity);\n\t\t\tif(isNaN(capacity)){\n\t\t\t\tcapacity = 8;\n\t\t\t}\n\t\t\tif (sum <= capacity) {\n\t\t\t\tcss.push(\"workday_ok\");\n\t\t\t} else {\n\t\t\t\tcss.push(\"workday_over\");\n\t\t\t}\n\t\t\treturn css.join(\" \");\n\t\t},\n\t\tgetSummaryResourceAssignments: function getResourceAssignments(resourceId) {\n\t\t\tlet assignments;\n\t\t\tconst store = gantt.getDatastore(gantt.config.resource_store);\n\t\t\tconst resource = store.getItem(resourceId);\n\n\t\t\tif(resource.$role === \"task\"){\n\t\t\t\tassignments = gantt.getResourceAssignments(resource.$resource_id, resource.$task_id);\n\t\t\t}else{\n\t\t\t\tassignments = gantt.getResourceAssignments(resourceId);\n\t\t\t\tif(store.eachItem){\n\t\t\t\t\tstore.eachItem(function(childResource){\n\t\t\t\t\t\tif(childResource.$role !== \"task\"){\n\t\t\t\t\t\t\tassignments = assignments.concat(gantt.getResourceAssignments(childResource.id));\n\t\t\t\t\t\t}\n\t\t\t\t\t}, resourceId);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn assignments;\n\t\t},\n\t\t\n\t\tinitEditableDiagram: function(){\n\t\t\tgantt.config.resource_render_empty_cells = true;\n\t\t\t\n\t\t\t\n\t\t\t(function(){\n\t\t\t\t/// salesforce locker workaround\n\t\t\t\t// SF removes 'contenteditable' attribute from cells\n\t\t\t\t// restore it on render\n\t\t\t\tlet timeoutId = null;\n\t\t\t\tfunction makeEditable() {\n\t\t\t\t\tif (timeoutId) {\n\t\t\t\t\t\tcancelAnimationFrame(timeoutId);\n\t\t\t\t\t}\n\t\t\t\t\ttimeoutId = requestAnimationFrame(function () {\n\t\t\t\t\t\tif (gantt.$container){\n\t\t\t\t\t\t\tvar cells = Array.prototype.slice.call(gantt.$container.querySelectorAll(\".resourceTimeline_cell [data-assignment-cell]\"));\n\t\t\t\t\t\t\tcells.forEach(function (cell) {\n\t\t\t\t\t\t\t\tcell.contentEditable = true;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\t\t\t\tgantt.getDatastore(gantt.config.resource_assignment_store).attachEvent(\"onStoreUpdated\", makeEditable);\n\t\t\t\t\tgantt.getDatastore(gantt.config.resource_store).attachEvent(\"onStoreUpdated\", makeEditable);\n\t\t\t\t}, {once: true});\n\t\t\t\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\t\t\t\tconst ganttViews = gantt.$layout.getCellsByType(\"viewCell\");\n\t\t\t\t\tganttViews.forEach(function(view){\n\t\t\t\t\t\tif(view.$config && view.$config.view === \"resourceTimeline\" && view.$content){\n\t\t\t\t\t\t\tview.$content.attachEvent(\"onScroll\", makeEditable);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t})();\n\t\t\t//GS-2766: need to restore focus after updating assignments\n\t\t\tlet currentFocusIndex = null;\n\t\t\tfunction setNextFocus(){\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tconst focusableElementsAfterRender = dom_helpers.getFocusableNodes(gantt.$container);\n\t\t\t\t\tif(currentFocusIndex > -1){\n\t\t\t\t\t\tfocusableElementsAfterRender[currentFocusIndex +1].focus();\n\t\t\t\t\t}\n\t\t\t\t}, 300);\n\t\t\t};\n\n\t\t\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\t\t\tlet assignmentEditInProcess = false;\n\t\t\t\tgantt.event(gantt.$container, \"keypress\", function(e){\n\t\t\t\t\tvar target = e.target.closest(\".resourceTimeline_cell [data-assignment-cell]\");\n\t\t\t\t\tif(target){\n\t\t\t\t\t\tif (e.keyCode === 13 || e.keyCode === 27) {\n\t\t\t\t\t\t\ttarget.blur();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tgantt.event(gantt.$container, \"keydown\", function(event){\n\t\t\t\t\tif (event.key === \"Tab\") {\n\t\t\t\t\t\tconst focusableElements = dom_helpers.getFocusableNodes(gantt.$container);\n\t\t\t\t\t\tcurrentFocusIndex = focusableElements.indexOf(document.activeElement);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tgantt.event(gantt.$container, \"focusout\", function(e){\n\t\t\t\t\tif (assignmentEditInProcess){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tassignmentEditInProcess = true;\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\tassignmentEditInProcess = false;\n\t\t\t\t\t}, 300);\n\t\t\t\t\tvar target = e.target.closest(\".resourceTimeline_cell [data-assignment-cell]\");\n\t\t\t\t\tif(target){\n\t\t\t\t\t\tvar strValue = (target.innerText || \"\").trim();\n\t\t\t\t\t\tif(strValue == \"-\"){\n\t\t\t\t\t\t\tstrValue = \"0\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar value = Number(strValue);\n\t\t\t\t\t\tvar rowId = target.getAttribute(\"data-row-id\");\n\t\t\t\t\t\tvar assignmentId = target.getAttribute(\"data-assignment-id\");\n\t\t\t\t\t\tvar taskId = target.getAttribute(\"data-task\");\n\t\t\t\t\t\tvar resourceId = target.getAttribute(\"data-resource-id\");\n\t\t\t\t\t\tvar startDate = gantt.templates.parse_date(target.getAttribute(\"data-start-date\"));\n\t\t\t\t\t\tvar endDate = gantt.templates.parse_date(target.getAttribute(\"data-end-date\"));\n\n\t\t\t\t\t\tvar assignmentStore = gantt.getDatastore(gantt.config.resource_assignment_store);\n\t\t\t\t\t\tif(isNaN(value)){\n\t\t\t\t\t\t\tgantt.getDatastore(gantt.config.resource_store).refresh(rowId);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tvar task = gantt.getTask(taskId);\n\t\t\t\t\t\t\t// GS-2141. Track the changes by the Undo extension\n\t\t\t\t\t\t\tif (gantt.plugins().undo){\n\t\t\t\t\t\t\t\tgantt.ext.undo.saveState(taskId, \"task\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(assignmentId){\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar assignment = assignmentStore.getItem(assignmentId);\n\t\t\t\t\t\t\t\tif(value === assignment.value){\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(assignment.start_date.valueOf() === startDate.valueOf() && assignment.end_date.valueOf() === endDate.valueOf()){\n\t\t\t\t\t\t\t\t\tassignment.value = value;\n\t\t\t\t\t\t\t\t\tif(!value){\n\t\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tassignmentStore.updateItem(assignment.id);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif(assignment.end_date.valueOf() > endDate.valueOf()){\n\t\t\t\t\t\t\t\t\t\tvar nextChunk = gantt.copy(assignment);\n\t\t\t\t\t\t\t\t\t\tnextChunk.id = gantt.uid();\n\t\t\t\t\t\t\t\t\t\tnextChunk.start_date = endDate;\n\t\t\t\t\t\t\t\t\t\tnextChunk.duration = gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\tstart_date: nextChunk.start_date,\n\t\t\t\t\t\t\t\t\t\t\tend_date: nextChunk.end_date,\n\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tnextChunk.delay = gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\t\t\t\t\t\tend_date: nextChunk.start_date,\n\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tnextChunk.mode = assignment.mode || \"default\";\n\t\t\t\t\t\t\t\t\t\tif(nextChunk.duration !== 0){\n\t\t\t\t\t\t\t\t\t\t\tassignmentStore.addItem(nextChunk);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif(assignment.start_date.valueOf() < startDate.valueOf()){\n\t\t\t\t\t\t\t\t\t\tassignment.end_date = startDate;\n\t\t\t\t\t\t\t\t\t\tassignment.duration = gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\tstart_date: assignment.start_date,\n\t\t\t\t\t\t\t\t\t\t\tend_date: assignment.end_date,\n\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tassignment.mode = \"fixedDuration\";\n\n\t\t\t\t\t\t\t\t\t\tif(assignment.duration === 0){\n\t\t\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\n\t\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t\tassignmentStore.updateItem(assignment.id);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif(value){\n\t\t\t\t\t\t\t\t\t\tassignmentStore.addItem({\n\t\t\t\t\t\t\t\t\t\t\ttask_id: assignment.task_id,\n\t\t\t\t\t\t\t\t\t\t\tresource_id: assignment.resource_id,\n\t\t\t\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\t\t\tduration: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\tdelay: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\t\t\t\t\t\t\tend_date: startDate,\n\t\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\tmode: \"fixedDuration\"\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tgantt.updateTaskAssignments(task.id);\n\t\t\t\t\t\t\t\tgantt.updateTask(task.id);\n\t\t\t\t\t\t\t\tsetNextFocus();\n\n\t\t\t\t\t\t\t}else if(value){\n\t\t\t\t\t\t\t\tvar assignment = {\n\t\t\t\t\t\t\t\t\ttask_id: taskId,\n\t\t\t\t\t\t\t\t\tresource_id: resourceId,\n\t\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\tduration: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tdelay: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\t\t\t\t\tend_date: startDate,\n\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tmode: \"fixedDuration\"\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tassignmentStore.addItem(assignment);\n\t\t\t\t\t\t\t\tgantt.updateTaskAssignments(task.id);\n\t\t\t\t\t\t\t\tgantt.updateTask(task.id);\n\t\t\t\t\t\t\t\tsetNextFocus();\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, {once: true});\n\t\t}\n\t};\n\treturn resourcePlugin;\n}\n\nexport default function(gantt){\n\tvar methods = createResourceMethods(gantt);\n\t\n\tgantt.ext.resources = createHelper(gantt);\n\n\tgantt.config.resources = {\n\t\tdataprocessor_assignments: false,\n\t\tdataprocessor_resources: false,\n\t\teditable_resource_diagram: false,\n\t\tresource_store: {\n\t\t\ttype: \"treeDataStore\",\n\t\t\tfetchTasks: false,\n\t\t\tinitItem: function(item) {\n\t\t\t\titem.parent = item.parent || gantt.config.root_id;\n\t\t\t\titem[gantt.config.resource_property] = item.parent;\n\t\t\t\titem.open = true;\n\t\t\t\treturn item;\n\t\t\t}\n\t\t},\n\t\tlightbox_resources: function selectResourceControlOptions(resources){\n\t\t\tconst lightboxOptions = [];\n\t\t\tconst store = gantt.getDatastore(gantt.config.resource_store);\n\t\t\tresources.forEach(function(res) {\n\t\t\t\tif (!store.hasChild(res.id)) {\n\t\t\t\t\tconst copy = gantt.copy(res);\n\t\t\t\t\tcopy.key = res.id;\n\t\t\t\t\tcopy.label = res.text;\n\t\t\t\t\tlightboxOptions.push(copy);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn lightboxOptions;\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tif(gantt.getDatastore(gantt.config.resource_store)){\n\t\t\treturn;\n\t\t}\n\n\t\tconst resourceStoreConfig = gantt.config.resources ? gantt.config.resources.resource_store : undefined;\n\t\tlet fetchTasks = resourceStoreConfig ? resourceStoreConfig.fetchTasks : undefined;\n\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\n\t\t\tfetchTasks = true;\n\t\t}\n\n\t\tlet initItems = function(item) {\n\t\t\titem.parent = item.parent || gantt.config.root_id;\n\t\t\titem[gantt.config.resource_property] = item.parent;\n\t\t\titem.open = true;\n\t\t\treturn item;\n\t\t};\n\n\t\tif(resourceStoreConfig && resourceStoreConfig.initItem){\n\t\t\tinitItems = resourceStoreConfig.initItem;\n\t\t}\n\n\t\tconst storeType = resourceStoreConfig && resourceStoreConfig.type ? resourceStoreConfig.type : \"treeDatastore\";\n\n\t\tgantt.$resourcesStore = gantt.createDatastore({\n\t\t\tname: gantt.config.resource_store,\n\t\t\ttype: storeType,\n\t\t\tfetchTasks: fetchTasks !== undefined ? fetchTasks : false,\n\t\t\tinitItem: initItems\n\t\t});\n\n\t\tgantt.$data.resourcesStore = gantt.$resourcesStore;\n\n\t\tgantt.$resourcesStore.attachEvent(\"onParse\", function() {\n\t\t\tfunction selectResourceControlOptions(resources){\n\t\t\t\tconst lightboxOptions = [];\n\t\t\t\tresources.forEach(function(res) {\n\t\t\t\t\tconst copy = gantt.copy(res);\n\t\t\t\t\tcopy.key = res.id;\n\t\t\t\t\tcopy.label = res.text;\n\t\t\t\t\tlightboxOptions.push(copy);\n\t\t\t\t});\n\t\t\t\treturn lightboxOptions;\n\t\t\t}\n\n\t\t\tlet lightboxOptionsFnc = selectResourceControlOptions;\n\t\t\tlet options;\n\t\t\tif(gantt.config.resources && gantt.config.resources.lightbox_resources){\n\t\t\t\tlightboxOptionsFnc = gantt.config.resources.lightbox_resources;\n\t\t\t}\n\t\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\n\t\t\t\t// GS-2604: case for the next parsed resources\n\t\t\t\t// to filter only resources with assignments\n\t\t\t\tconst resources = gantt.$resourcesStore.getItems();\n\t\t\t\tconst filteredResources = resources.filter(resource => {\n\t\t\t\t\tlet assignments = gantt.getResourceAssignments(resource.id);\n\t\t\t\t\tif(!gantt.$resourcesStore.hasChild(resource.id) || (assignments && assignments.length)){\n\t\t\t\t\t\tif(resource.$resource_id && resource.$task_id){\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\toptions = lightboxOptionsFnc(filteredResources);\n\t\t\t} else {\n\t\t\t\toptions = lightboxOptionsFnc(gantt.$resourcesStore.getItems());\n\t\t\t}\n\t\t\tgantt.updateCollection(\"resourceOptions\", options);\n\t\t});\n\t});\n\n\tgantt.getTaskBy = methods.getTaskBy;\n\tgantt.getResourceAssignments = methods.getResourceAssignments;\n\tgantt.config.resource_property = \"owner_id\";\n\tgantt.config.resource_store = \"resource\";\n\tgantt.config.resource_render_empty_cells = false;\n\n\t/**\n\t * these are placeholder functions that should be redefined by the user\n\t*/\n\tgantt.templates.histogram_cell_class = function(start_date, end_date, resource, tasks, assignments) {};\n\tgantt.templates.histogram_cell_label = function(start_date, end_date, resource, tasks, assignments) {\n\t\treturn tasks.length + \"/3\";\n\t};\n\tgantt.templates.histogram_cell_allocated = function(start_date, end_date, resource, tasks, assignments) {\n\t\treturn tasks.length / 3;\n\t};\n\tgantt.templates.histogram_cell_capacity = function(start_date, end_date, resource, tasks, assignments) {\n\t\treturn 0;\n\t};\n\n\n\tconst defaultResourceCellClass = function(start, end, resource, tasks, assignments) {\n\t\tvar css = \"\";\n\t\tif (tasks.length <= 1) {\n\t\t\tcss = \"gantt_resource_marker_ok\";\n\t\t} else {\n\t\t\tcss = \"gantt_resource_marker_overtime\";\n\t\t}\n\t\treturn css;\n\t};\n\n\tconst defaultResourceCellTemplate = function(start, end, resource, tasks, assignments) {\n\t\treturn tasks.length * 8;\n\t};\n\n\tgantt.templates.resource_cell_value = defaultResourceCellTemplate;\n\tgantt.templates.resource_cell_class = defaultResourceCellClass;\n\n\t//editable_resource_diagram\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\n\n\t\t\tgantt.config.resource_render_empty_cells = true;\n\t\t\tif(gantt.templates.resource_cell_value === defaultResourceCellTemplate){\n\t\t\t\tgantt.templates.resource_cell_value = gantt.ext.resources.editableResourceCellTemplate;\n\t\t\t}\n\t\t\tif(gantt.templates.resource_cell_class === defaultResourceCellClass){\n\t\t\t\tgantt.templates.resource_cell_class = gantt.ext.resources.editableResourceCellClass;\n\t\t\t}\n\t\t\t\n\t\t\tgantt.ext.resources.initEditableDiagram(gantt);\n\t\t}\n\t});\n};\n\n\n","export default function (gantt) {\n\tvar resourceAssignmentsProperty = \"$resourceAssignments\";\n\tgantt.config.resource_assignment_store = \"resourceAssignments\";\n\tgantt.config.process_resource_assignments = true;\n\n\tvar resourceAssignmentFormats = {\n\t\tauto: \"auto\",\n\t\tsingleValue: \"singleValue\",\n\t\tvalueArray: \"valueArray\",\n\t\tresourceValueArray: \"resourceValueArray\",\n\t\tassignmentsArray: \"assignmentsArray\"\n\t};\n\tvar resourceAssignmentFormat = resourceAssignmentFormats.auto;//\"primitiveSingle\";//\"primitive\";//\"object\"|\"assignment\"\n\n\tvar assignmentModes = {\n\t\tfixedDates: \"fixedDates\",\n\t\tfixedDuration: \"fixedDuration\",\n\t\tdefault: \"default\"\n\t};\n\n\n\tfunction initAssignmentFields(item, task){\n\t\tif (item.start_date) {\n\t\t\titem.start_date = gantt.date.parseDate(item.start_date, \"parse_date\");\n\t\t} else {\n\t\t\titem.start_date = null;\n\t\t}\n\n\t\tif (item.end_date) {\n\t\t\titem.end_date = gantt.date.parseDate(item.end_date, \"parse_date\");\n\t\t} else {\n\t\t\titem.end_date = null;\n\t\t}\n\n\t\tvar delay = Number(item.delay);\n\t\tvar initDelay = false;\n\t\tif (!isNaN(delay)) {\n\t\t\titem.delay = delay;\n\t\t} else {\n\t\t\titem.delay = 0;\n\t\t\tinitDelay = true;\n\t\t}\n\n\t\tif (!gantt.defined(item.value)) {\n\t\t\titem.value = null;\n\t\t}\n\n\t\tif (!item.task_id || !item.resource_id) {\n\t\t\treturn false;\n\t\t}\n\n\t\titem.mode = item.mode || assignmentModes.default;\n\n\t\tif(item.mode === assignmentModes.fixedDuration){\n\t\t\tif(isNaN(Number(item.duration))){\n\t\t\t\ttask = task || gantt.getTask(item.task_id);\n\t\t\t\titem.duration = gantt.calculateDuration({\n\t\t\t\t\tstart_date: item.start_date,\n\t\t\t\t\tend_date: item.end_date,\n\t\t\t\t\tid: task\n\t\t\t\t});\n\t\t\t}\n\t\t\tif(initDelay){\n\t\t\t\ttask = task || gantt.getTask(item.task_id);\n\t\t\t\titem.delay = gantt.calculateDuration({\n\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\tend_date: item.start_date,\n\t\t\t\t\tid: task\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (item.mode !== assignmentModes.fixedDates && (task || gantt.isTaskExists(item.task_id))) {\n\t\t\ttask = task || gantt.getTask(item.task_id);\n\t\t\tvar timing = _assignmentTimeFromTask(item, task);\n\t\t\titem.start_date = timing.start_date;\n\t\t\titem.end_date = timing.end_date;\n\t\t\titem.duration = timing.duration;\n\t\t}\n\t}\n\t// gantt init\n\tvar resourceAssignmentsStore = gantt.createDatastore({\n\t\tname: gantt.config.resource_assignment_store,\n\t\tinitItem: function (item) {\n\t\t\tif (!item.id) {\n\t\t\t\titem.id = gantt.uid();\n\t\t\t}\n\n\t\t\tinitAssignmentFields(item);\n\n\t\t\treturn item;\n\t\t}\n\t});\n\t\n\tgantt.$data.assignmentsStore = resourceAssignmentsStore;\n\n\tfunction _assignmentTimeFromTask(assignment, task) {\n\n\t\tif (assignment.mode === assignmentModes.fixedDates) {\n\t\t\treturn {\n\t\t\t\tstart_date: assignment.start_date,\n\t\t\t\tend_date: assignment.end_date,\n\t\t\t\tduration: assignment.duration\n\t\t\t};\n\t\t} else {\n\t\t\tvar start = assignment.delay ? gantt.calculateEndDate({\n\t\t\t\tstart_date: task.start_date,\n\t\t\t\tduration: assignment.delay,\n\t\t\t\ttask: task\n\t\t\t}) : new Date(task.start_date);\n\n\t\t\tvar end;\n\t\t\tvar duration;\n\t\t\tif (assignment.mode === assignmentModes.fixedDuration) {\n\t\t\t\tend = gantt.calculateEndDate({\n\t\t\t\t\tstart_date: start,\n\t\t\t\t\tduration: assignment.duration,\n\t\t\t\t\ttask: task\n\t\t\t\t});\n\t\t\t\tduration = assignment.duration;\n\t\t\t} else {\n\t\t\t\tend = new Date(task.end_date);\n\t\t\t\tduration = task.duration - assignment.delay;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tstart_date: start,\n\t\t\tend_date: end,\n\t\t\tduration: duration\n\t\t};\n\t}\n\n\t// data loading\n\n\tfunction _makeAssignmentsFromTask(task) {\n\t\tconst property = gantt.config.resource_property;\n\t\tlet assignments = task[property];\n\t\tconst resourceAssignments = [];\n\t\tlet detectFormat = resourceAssignmentFormat === resourceAssignmentFormats.auto;\n\n\t\tif (gantt.defined(assignments) && assignments) {\n\t\t\tif (!Array.isArray(assignments)) {\n\t\t\t\tassignments = [assignments];\n\t\t\t\tif (detectFormat) {\n\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.singleValue;\n\t\t\t\t\tdetectFormat = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst usedIds = {};\n\t\t\tassignments.forEach(function (res) {\n\t\t\t\tif (!res.resource_id) { // when resource is a string/number\n\t\t\t\t\tres = { resource_id: res };\n\t\t\t\t\tif (detectFormat) {\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.valueArray;\n\t\t\t\t\t\tdetectFormat = false;\n\t\t\t\t\t}\n\t\t\t\t\t//\tisSimpleArray = true;\n\t\t\t\t}\n\n\t\t\t\tif (detectFormat) {\n\t\t\t\t\tif (res.id && res.resource_id) {\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.assignmentsArray;\n\t\t\t\t\t\tdetectFormat = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.resourceValueArray;\n\t\t\t\t\t\tdetectFormat = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet defaultMode = assignmentModes.default;\n\t\t\t\tif(!res.mode){\n\t\t\t\t\tif((res.start_date && res.end_date) || (res.start_date && res.duration)){\n\t\t\t\t\t\tdefaultMode = assignmentModes.fixedDuration;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet id;\n\t\t\t\tif(!res.id && res.$id && !usedIds[res.$id]){\n\t\t\t\t\tid = res.$id;\n\t\t\t\t} else if(res.id && !usedIds[res.id]){\n\t\t\t\t\tid = res.id;\n\t\t\t\t} else{\n\t\t\t\t\tid = gantt.uid();\n\t\t\t\t}\n\t\t\t\tusedIds[id] = true;\n\n\t\t\t\tconst assignment = {\n\t\t\t\t\tid: id,\n\t\t\t\t\tstart_date: res.start_date,\n\t\t\t\t\tduration: res.duration,\n\t\t\t\t\tend_date: res.end_date,\n\t\t\t\t\tdelay: res.delay,\n\t\t\t\t\ttask_id: task.id,\n\t\t\t\t\tresource_id: res.resource_id,\n\t\t\t\t\tvalue: res.value,\n\t\t\t\t\tmode: res.mode || defaultMode\n\t\t\t\t};\n\t\t\t\t// GS-2490: to add custom properties to assignment\n\t\t\t\t// need to exclude $id which incfluences on render \n\t\t\t\tObject.keys(res).forEach(key => {\n\t\t\t\t\tif(key != \"$id\") {\n\t\t\t\t\t\tassignment[key] = res[key];\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(!(assignment.start_date && assignment.start_date.getMonth \n\t\t\t\t\t&& assignment.end_date && assignment.end_date.getMonth && typeof assignment.duration === \"number\")){\n\t\t\t\t\tinitAssignmentFields(assignment, task);\n\t\t\t\t}\n\n\t\t\t\tresourceAssignments.push(assignment);\n\t\t\t});\n\t\t}\n\t\treturn resourceAssignments;\n\t}\n\n\tfunction _updateTaskBack(taskId) {\n\t\t// GS-1493. In some cases, the resource assignment store has the tasks that no longer exist\n\t\tif (!gantt.isTaskExists(taskId)){\n\t\t\treturn;\n\t\t}\n\n\t\tvar task = gantt.getTask(taskId);\n\t\tvar assignments = gantt.getTaskAssignments(task.id);\n\t\t_assignAssignments(task, assignments);\n\t}\n\n\tfunction _assignAssignments(task, assignments){\n\t\tassignments.sort(function(a, b){\n\t\t\tif(a.start_date && b.start_date && a.start_date.valueOf() != b.start_date.valueOf()){\n\t\t\t\treturn a.start_date - b.start_date;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\t\tif (resourceAssignmentFormat == resourceAssignmentFormats.assignmentsArray) {\n\t\t\ttask[gantt.config.resource_property] = assignments;\n\t\t} else if (resourceAssignmentFormat == resourceAssignmentFormats.resourceValueArray) {\n\t\t\ttask[gantt.config.resource_property] = assignments.map(function (a) {\n\t\t\t\treturn {\n\t\t\t\t\t$id: a.id,\n\t\t\t\t\tstart_date: a.start_date,\n\t\t\t\t\tduration: a.duration,\n\t\t\t\t\tend_date: a.end_date,\n\t\t\t\t\tdelay: a.delay,\n\t\t\t\t\tresource_id: a.resource_id,\n\t\t\t\t\tvalue: a.value,\n\t\t\t\t\tmode: a.mode\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\ttask[resourceAssignmentsProperty] = assignments;\n\t}\n\n\tfunction _loadAssignmentsFromTask(task) {\n\t\tvar assignments = _makeAssignmentsFromTask(task);\n\t\tvar taskAssignments = [];\n\t\tassignments.forEach(function (a) {\n\t\t\ta.id = a.id || gantt.uid();\n\t\t\t//var newId = resourceAssignmentsStore.addItem(a);\n\t\t\ttaskAssignments.push(a);\n\t\t});\n\n\t\treturn assignments;\n\t}\n\n\tfunction diffAssignments(taskValues, assignmentsStoreValues) {\n\t\tvar result = {\n\t\t\tinBoth: [],\n\t\t\tinTaskNotInStore: [],\n\t\t\tinStoreNotInTask: []\n\t\t};\n\n\t\tif (resourceAssignmentFormat == resourceAssignmentFormats.singleValue) {\n\t\t\tvar taskOwner = taskValues[0];\n\t\t\tvar ownerId = taskOwner ? taskOwner.resource_id : null;\n\t\t\tvar foundOwnerAssignment = false;\n\t\t\tassignmentsStoreValues.forEach(function (a) {\n\t\t\t\tif (a.resource_id != ownerId) {\n\t\t\t\t\tresult.inStoreNotInTask.push(a);\n\t\t\t\t} else if (a.resource_id == ownerId) {\n\t\t\t\t\tresult.inBoth.push({ store: a, task: taskOwner });\n\t\t\t\t\tfoundOwnerAssignment = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!foundOwnerAssignment && taskOwner) {\n\t\t\t\tresult.inTaskNotInStore.push(taskOwner);\n\t\t\t}\n\n\n\t\t} else if (resourceAssignmentFormat == resourceAssignmentFormats.valueArray){\n\n\t\t\tvar taskSearch = {};\n\t\t\tvar storeSearch = {};\n\t\t\tvar processedIds = {};\n\t\t\ttaskValues.forEach(function (a) {\n\t\t\t\ttaskSearch[a.resource_id] = a;\n\t\t\t});\n\t\t\tassignmentsStoreValues.forEach(function (a) {\n\t\t\t\tstoreSearch[a.resource_id] = a;\n\t\t\t});\n\t\t\ttaskValues.concat(assignmentsStoreValues).forEach(function (a) {\n\t\t\t\tif (processedIds[a.resource_id]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tprocessedIds[a.resource_id] = true;\n\t\t\t\tvar inTask = taskSearch[a.resource_id];\n\t\t\t\tvar inStore = storeSearch[a.resource_id];\n\n\t\t\t\tif (inTask && inStore) {\n\t\t\t\t\tresult.inBoth.push({ store: inStore, task: inTask });\n\t\t\t\t} else if (inTask && !inStore) {\n\t\t\t\t\tresult.inTaskNotInStore.push(inTask);\n\t\t\t\t} else if (!inTask && inStore) {\n\t\t\t\t\tresult.inStoreNotInTask.push(inStore);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if ((resourceAssignmentFormat == resourceAssignmentFormats.assignmentsArray)\n\t\t\t|| (resourceAssignmentFormat == resourceAssignmentFormats.resourceValueArray)) {\n\t\t\tvar taskSearch = {};\n\t\t\tvar storeSearch = {};\n\t\t\tvar processedIds = {};\n\t\t\ttaskValues.forEach(function (a) {\n\t\t\t\ttaskSearch[a.id || a.$id] = a;\n\t\t\t});\n\t\t\tassignmentsStoreValues.forEach(function (a) {\n\t\t\t\tstoreSearch[a.id] = a;\n\t\t\t});\n\t\t\ttaskValues.concat(assignmentsStoreValues).forEach(function (a) {\n\t\t\t\tvar id = a.id || a.$id;\n\t\t\t\tif (processedIds[id]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tprocessedIds[id] = true;\n\t\t\t\tvar inTask = taskSearch[id];\n\t\t\t\tvar inStore = storeSearch[id];\n\n\t\t\t\tif (inTask && inStore) {\n\t\t\t\t\tresult.inBoth.push({ store: inStore, task: inTask });\n\t\t\t\t} else if (inTask && !inStore) {\n\t\t\t\t\tresult.inTaskNotInStore.push(inTask);\n\t\t\t\t} else if (!inTask && inStore) {\n\t\t\t\t\tresult.inStoreNotInTask.push(inStore);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction assignmentHasChanged(source, target) {\n\t\tvar ignoreFields = {\n\t\t\tid: true\n\t\t};\n\n\t\tfor (var i in source) {\n\t\t\tif (!ignoreFields[i]) {\n\t\t\t\tif (String(source[i]) !== String(target[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tfunction updateAssignment(source, target) {\n\t\tvar ignoreFields = {\n\t\t\tid: true\n\t\t};\n\n\t\tfor (var i in source) {\n\t\t\tif (!ignoreFields[i]) {\n\t\t\t\ttarget[i] = source[i];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction _syncAssignments(task, storeAssignments){\n\t\tvar tasksAssignments = _makeAssignmentsFromTask(task);\n\n\t\tvar diff = diffAssignments(tasksAssignments, storeAssignments);\n\t\tdiff.inStoreNotInTask.forEach(function (a) {\n\t\t\tresourceAssignmentsStore.removeItem(a.id);\n\t\t});\n\t\tdiff.inTaskNotInStore.forEach(function (a) {\n\t\t\tresourceAssignmentsStore.addItem(a);\n\t\t});\n\n\t\tdiff.inBoth.forEach(function (a) {\n\t\t\tif (assignmentHasChanged(a.task, a.store)) {\n\t\t\t\tupdateAssignment(a.task, a.store);\n\t\t\t\tresourceAssignmentsStore.updateItem(a.store.id);\n\t\t\t} else {\n\t\t\t\tif (a.task.start_date && a.task.end_date && a.task.mode !== assignmentModes.fixedDates) {\n\t\t\t\t\tvar timing = _assignmentTimeFromTask(a.store, task);\n\t\t\t\t\tif (a.store.start_date.valueOf() != timing.start_date.valueOf() || a.store.end_date.valueOf() != timing.end_date.valueOf()) {\n\t\t\t\t\t\ta.store.start_date = timing.start_date;\n\t\t\t\t\t\ta.store.end_date = timing.end_date;\n\t\t\t\t\t\ta.store.duration = timing.duration;\n\t\t\t\t\t\tresourceAssignmentsStore.updateItem(a.store.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t_updateTaskBack(task.id);\n\t}\n\n\tfunction _syncOnTaskUpdate(task) {\n\t\tvar storeAssignments = task[resourceAssignmentsProperty] || resourceAssignmentsStore.find(function (a) {\n\t\t\treturn a.task_id == task.id;\n\t\t});\n\n\t\t_syncAssignments(task, storeAssignments);\n\t}\n\n\tfunction _syncOnTaskDelete(ids) {\n\t\tvar idsSearch = {};\n\t\tids.forEach(function (id) {\n\t\t\tidsSearch[id] = true;\n\t\t});\n\t\tvar taskResources = resourceAssignmentsStore.find(function (a) {\n\t\t\treturn idsSearch[a.task_id];\n\t\t});\n\t\ttaskResources.forEach(function (a) {\n\t\t\tresourceAssignmentsStore.removeItem(a.id);\n\t\t});\n\t}\n\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\n\t\tif (gantt.config.process_resource_assignments) {\n\t\t\tgantt.attachEvent(\"onParse\", function () {\n\t\t\t\tgantt.silent(function () {\n\t\t\t\t\tresourceAssignmentsStore.clearAll();\n\t\t\t\t\tvar totalAssignments = [];\n\t\t\t\t\tgantt.eachTask(function (task) {\n\t\t\t\t\t\tif (task.type === gantt.config.types.project) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar assignments = _loadAssignmentsFromTask(task);\n\t\t\t\t\t\t_assignAssignments(task, assignments);\n\n\t\t\t\t\t\tassignments.forEach(function (a) {\n\t\t\t\t\t\t\ttotalAssignments.push(a);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tresourceAssignmentsStore.parse(totalAssignments);\n\t\t\t\t});\n\n\t\t\t});\n\n\t\t\tvar batchUpdate = false;\n\t\t\tvar needUpdate = false;\n\t\t\tvar needUpdateFor = {};\n\t\t\tvar undoBatchCancel = false;\n\t\t\tgantt.attachEvent(\"onBeforeBatchUpdate\", function(){\n\t\t\t\tbatchUpdate = true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterBatchUpdate\", function(){\n\t\t\t\t\n\t\t\t\tif(needUpdate){\n\t\t\t\t\tvar assignmentsHash = {};\n\t\t\t\t\tfor(var i in needUpdateFor){\n\t\t\t\t\t\tassignmentsHash[i] = gantt.getTaskAssignments(needUpdateFor[i].id);\n\t\t\t\t\t}\n\t\t\t\t\t// GS-2546. If we add a task that has the data in the old format,\n\t\t\t\t\t// we need to reset the cache as the assignment will be added\n\t\t\t\t\t// to the assignment store, but the cache won't have the changes\n\t\t\t\t\tif (gantt.config.process_resource_assignments && resourceAssignmentFormat === \"resourceValueArray\"){\n\t\t\t\t\t\ttaskAssignmentsCache = null;\n\t\t\t\t\t}\n\t\t\t\t\tfor(var i in needUpdateFor){\n\t\t\t\t\t\t_syncAssignments(needUpdateFor[i], assignmentsHash[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tneedUpdate = false;\n\t\t\t\tbatchUpdate = false;\n\t\t\t\tneedUpdateFor = {};\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onTaskCreated\", function (item) {\n\t\t\t\tvar assignments = _loadAssignmentsFromTask(item);\n\t\t\t\tresourceAssignmentsStore.parse(assignments);\n\t\t\t\t_assignAssignments(item, assignments);\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", function (id, item) {\n\t\t\t\tif(batchUpdate){\n\t\t\t\t\tneedUpdate = true;\n\t\t\t\t\tneedUpdateFor[id] = item;\n\t\t\t\t}else if (!item.unscheduled){\n\t\t\t\t\t_syncOnTaskUpdate(item);\n\t\t\t\t}\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", function (id, item) {\n\t\t\t\tif(batchUpdate){\n\t\t\t\t\tneedUpdate = true;\n\t\t\t\t\tneedUpdateFor[id] = item;\n\t\t\t\t}else{\n\t\t\t\t\t_syncOnTaskUpdate(item);\n\t\t\t\t}\n\t\t\t});\n\n\t\t/*\tgantt.attachEvent(\"onRowDragMove\", function (id) {\n\t\t\t\t_syncOnTaskUpdate(gantt.getTask(id));\n\t\t\t});*/\n\t\t\tgantt.attachEvent(\"onRowDragEnd\", function (id) {\n\t\t\t\t_syncOnTaskUpdate(gantt.getTask(id));\n\t\t\t});\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onAfterDeleteConfirmed\", function (id, item) {\n\t\t\t\tvar deleteIds = [id];\n\t\t\t\tgantt.eachTask(function (task) {\n\t\t\t\t\tdeleteIds.push(task.id);\n\t\t\t\t}, id);\n\t\t\t\t_syncOnTaskDelete(deleteIds);\n\t\t\t});\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onClearAll\", function () {\n\t\t\t\tresourceAssignmentsCache = null;\n\t\t\t\tresourceTaskAssignmentsCache = null;\n\t\t\t\ttaskAssignmentsCache = null;\n\t\t\t\tresourceAssignmentsStore.clearAll();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\n\t\t\t\tvar taskResources = resourceAssignmentsStore.find(function (a) {\n\t\t\t\t\treturn a.task_id == id;\n\t\t\t\t});\n\t\t\t\ttaskResources.forEach(function (a) {\n\t\t\t\t\ta.task_id = new_id;\n\t\t\t\t\tresourceAssignmentsStore.updateItem(a.id);\n\t\t\t\t});\n\t\t\t\t_updateTaskBack(new_id);\n\t\t\t\t//any custom logic here\n\t\t\t});\n\t\t\t// GS-2144. When we Undo something, the cache should be reset\n\t\t\t// during the `onStoreUpdated` event to properly update the assignments\n\t\t\tgantt.attachEvent(\"onBeforeUndo\", function (action) {\n\t\t\t\tundoBatchCancel = true;\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterUndo\", function (action) {\n\t\t\t\tundoBatchCancel = true;\n\t\t\t});\n\n\n\t\t\tvar resourceAssignmentsCache = null;\n\t\t\tvar resourceTaskAssignmentsCache = null;\n\t\t\tvar taskAssignmentsCache = null;\n\n\t\t\tresourceAssignmentsStore.attachEvent(\"onStoreUpdated\", function resetCache(){\n\t\t\t\tif(batchUpdate && !undoBatchCancel){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tresourceAssignmentsCache = null;\n\t\t\t\tresourceTaskAssignmentsCache = null;\n\t\t\t\ttaskAssignmentsCache = null;\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\tgantt.getResourceAssignments = function (resourceId, taskId) {\n\t\t\t\tvar searchTaskId = gantt.defined(taskId) && taskId !== null;\n\n\t\t\t\tif(resourceAssignmentsCache === null){\n\t\t\t\t\tresourceAssignmentsCache = {};\n\t\t\t\t\tresourceTaskAssignmentsCache = {};\n\n\t\t\t\t\tresourceAssignmentsStore.eachItem(function (a) {\n\t\t\t\t\t\tif(!resourceAssignmentsCache[a.resource_id]){\n\t\t\t\t\t\t\tresourceAssignmentsCache[a.resource_id] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresourceAssignmentsCache[a.resource_id].push(a);\n\n\t\t\t\t\t\tvar resourceTaskCacheKey = a.resource_id + \"-\" + a.task_id;\n\t\t\t\t\t\tif(!resourceTaskAssignmentsCache[resourceTaskCacheKey]){\n\t\t\t\t\t\t\tresourceTaskAssignmentsCache[resourceTaskCacheKey] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresourceTaskAssignmentsCache[resourceTaskCacheKey].push(a);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\n\t\t\t\tif(searchTaskId){\n\t\t\t\t\treturn (resourceTaskAssignmentsCache[resourceId + \"-\" + taskId] || []).slice();\n\t\t\t\t}else{\n\t\t\t\t\treturn (resourceAssignmentsCache[resourceId] || []).slice();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t\n\t\t\tgantt.getTaskAssignments = function (taskId) {\n\t\t\t\tif(taskAssignmentsCache === null){\n\t\t\t\t\tvar result = [];\n\t\t\t\t\ttaskAssignmentsCache = {};\n\t\t\t\t\tresourceAssignmentsStore.eachItem(function (a) {\n\t\t\t\t\t\tif(!taskAssignmentsCache[a.task_id]){\n\t\t\t\t\t\t\ttaskAssignmentsCache[a.task_id] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttaskAssignmentsCache[a.task_id].push(a);\n\t\t\t\t\t\tif (a.task_id == taskId) {\n\t\t\t\t\t\t\tresult.push(a);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn (taskAssignmentsCache[taskId] || []).slice();\n\t\t\t};\n\t\t\t\n\t\t\tgantt.getTaskResources = function (taskId) {\n\t\t\t\tconst store = gantt.getDatastore(\"resource\");\n\t\t\t\tconst assignments = gantt.getTaskAssignments(taskId);\n\t\n\t\t\t\tconst uniqueResources = {};\n\t\t\t\tassignments.forEach(function(a){\n\t\t\t\t\tif(!uniqueResources[a.resource_id]){\n\t\t\t\t\t\tuniqueResources[a.resource_id] = a.resource_id;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tconst resources = [];\n\t\t\t\tfor(const i in uniqueResources){\n\t\t\t\t\tconst res = store.getItem(uniqueResources[i]);\n\t\t\t\t\tif(res){\n\t\t\t\t\t\tresources.push(res);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn resources;\n\t\t\t};\n\n\t\t\tgantt.updateTaskAssignments = _updateTaskBack;\n\t\t}\n\t}, {once: true});\n};","export default function addPlaceholder(gantt){\n\tfunction isEnabled(){\n\t\treturn gantt.config.placeholder_task;\n\t}\n\n\tfunction callIfEnabled(callback){\n\t\treturn function(){\n\t\t\tif(!isEnabled()){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn callback.apply(this, arguments);\n\t\t};\n\t}\n\n\tfunction silenceDataProcessor(dataProcessor){\n\t\tif(dataProcessor && !dataProcessor._silencedPlaceholder){\n\t\t\tdataProcessor._silencedPlaceholder = true;\n\t\t\tdataProcessor.attachEvent(\"onBeforeUpdate\", callIfEnabled(function(id, state, data){\n\t\t\t\tif(data.type == gantt.config.types.placeholder){\n\t\t\t\t\tdataProcessor.setUpdated(id, false);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}));\n\t\t}\n\t}\n\n\tfunction insertPlaceholder(){\n\t\tvar placeholders = gantt.getTaskBy(\"type\", gantt.config.types.placeholder);\n\t\tif(!placeholders.length || !gantt.isTaskExists(placeholders[0].id)){\n\t\t\tvar placeholder = {\n\t\t\t\tunscheduled: true,\n\t\t\t\ttype: gantt.config.types.placeholder,\n\t\t\t\tduration:0,\n\t\t\t\ttext: gantt.locale.labels.new_task\n\t\t\t};\n\t\t\tif(gantt.callEvent(\"onTaskCreated\", [placeholder]) === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tgantt.addTask(placeholder);\n\t\t\t\n\t\t}\n\t}\n\n\tfunction afterEdit(id){\n\t\tvar item = gantt.getTask(id);\n\t\tif(item.type == gantt.config.types.placeholder) {\n\t\t\tif(item.start_date && item.end_date && item.unscheduled){\n\t\t\t\titem.unscheduled = false;\n\t\t\t}\n\n\t\t\tgantt.batchUpdate(function(){\n\t\t\t\tvar newTask = gantt.copy(item);\n\t\t\t\tgantt.silent(function(){\n\t\t\t\t\tgantt.deleteTask(item.id);\n\t\t\t\t});\n\n\t\t\t\tdelete newTask[\"!nativeeditor_status\"];\n\t\t\t\tnewTask.type = gantt.config.types.task;\n\t\t\t\tnewTask.id = gantt.uid();\n\t\t\t\tgantt.addTask(newTask);\n\n\t\t\t\t//insertPlaceholder();\n\t\t\t});\n\n\t\t}\n\t}\n\n\tgantt.config.types.placeholder = \"placeholder\";\n\tgantt.attachEvent(\"onDataProcessorReady\", callIfEnabled(silenceDataProcessor));\n\n\tvar ready = false;\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(ready){\n\t\t\treturn;\n\t\t}\n\t\tready = true;\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", callIfEnabled(afterEdit));\n\t\tgantt.attachEvent(\"onAfterTaskAdd\", callIfEnabled(function(id, task){\n\t\t\tif(task.type != gantt.config.types.placeholder){\n\t\t\t\tvar placeholders = gantt.getTaskBy(\"type\", gantt.config.types.placeholder);\n\t\t\t\tplaceholders.forEach(function(p){\n\t\t\t\t\tgantt.silent(function(){\n\t\t\t\t\t\tif(gantt.isTaskExists(p.id))\n\t\t\t\t\t\t\tgantt.deleteTask(p.id);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tinsertPlaceholder();\n\t\t\t}\n\t\t}));\n\t\tgantt.attachEvent(\"onParse\", callIfEnabled(insertPlaceholder));\n\t});\n\n\tfunction isPlaceholderTask(taskId){\n\t\tif(gantt.config.types.placeholder && gantt.isTaskExists(taskId)){\n\t\t\tvar task = gantt.getTask(taskId);\n\t\t\tif(task.type == gantt.config.types.placeholder){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tfunction isPlaceholderLink(link){\n\t\tif(isPlaceholderTask(link.source) || isPlaceholderTask(link.target)){\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\tgantt.attachEvent(\"onLinkValidation\", function(link){\n\t\tif(isPlaceholderLink(link)){\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\tgantt.attachEvent(\"onBeforeLinkAdd\", function(id,link){\n\t\tif(isPlaceholderLink(link)){\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\n\tgantt.attachEvent(\"onBeforeUndoStack\", function(action){\n\t\tfor(var i = 0; i < action.commands.length; i++){\n\t\t\tvar command = action.commands[i];\n\t\t\tif(command.entity === \"task\" && command.value.type === gantt.config.types.placeholder){\n\t\t\t\taction.commands.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\n};","export default function(gantt) {\n\tfunction isEnabled() {\n\t\treturn gantt.config.auto_types && // if enabled\n\t\t\t(gantt.getTaskType(gantt.config.types.project) == gantt.config.types.project);// and supported\n\t}\n\n\tfunction callIfEnabled(callback) {\n\t\treturn function() {\n\t\t\tif (!isEnabled()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn callback.apply(this, arguments);\n\t\t};\n\t}\n\n\tfunction checkTaskType(id, changedTypes) {\n\t\tvar task = gantt.getTask(id);\n\t\tvar targetType = getTaskTypeToUpdate(task);\n\t\tif (targetType !== false && gantt.getTaskType(task) !== targetType) {\n\t\t\tchangedTypes.$needsUpdate = true;\n\t\t\tchangedTypes[task.id] = {task: task, type: targetType};\n\t\t}\n\t}\n\n\tfunction getUpdatedTypes(id, changedTypes) {\n\t\tchangedTypes = changedTypes || {};\n\t\t\n\t\tcheckTaskType(id, changedTypes);\n\t\tgantt.eachParent(function(parent) {\n\t\t\tcheckTaskType(parent.id, changedTypes);\n\t\t}, id);\n\n\t\treturn changedTypes;\n\t}\n\n\tfunction applyChanges(changedTypes) {\n\t\tfor (var i in changedTypes) {\n\t\t\tif(changedTypes[i] && changedTypes[i].task){\n\t\t\t\tvar task = changedTypes[i].task;\n\t\t\t\ttask.type = changedTypes[i].type;\n\t\t\t\tgantt.updateTask(task.id);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction updateParentTypes(startId) {\n\t\tif (gantt.getState().group_mode) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tvar changedTypes = getUpdatedTypes(startId);\n\t\tif (changedTypes.$needsUpdate) {\n\t\t\tgantt.batchUpdate(function() {\n\t\t\t\tapplyChanges(changedTypes);\n\t\t\t});\n\t\t}\n\t}\n\n\tvar delTaskParent;\n\n\tfunction updateTaskType(task, targetType) {\n\t\tif(!gantt.getState().group_mode){\n\t\t\ttask.type = targetType;\n\t\t\tgantt.updateTask(task.id);\n\t\t}\n\t}\n\n\tfunction getTaskTypeToUpdate(task) {\n\t\tvar allTypes = gantt.config.types;\n\t\tvar hasChildren = gantt.hasChild(task.id);\n\t\tvar taskType = gantt.getTaskType(task.type);\n\n\t\tif (hasChildren && taskType === allTypes.task) {\n\t\t\treturn allTypes.project;\n\t\t}\n\n\t\tif (!hasChildren && taskType === allTypes.project) {\n\t\t\treturn allTypes.task;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvar isParsingDone = true;\n\n\tgantt.attachEvent(\"onParse\", callIfEnabled(function() {\n\t\tisParsingDone = false;\n\t\tif(gantt.getState().group_mode){\n\t\t\treturn;\n\t\t}\n\n\t\tgantt.batchUpdate(function() {\n\t\t\tgantt.eachTask(function(task) {\n\t\t\t\tvar targetType = getTaskTypeToUpdate(task);\n\t\t\t\tif (targetType !== false) {\n\t\t\t\t\tupdateTaskType(task, targetType);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tisParsingDone = true;\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskAdd\", callIfEnabled(function(id) {\n\t\tif (isParsingDone) {\n\t\t\tupdateParentTypes(id);\n\t\t}\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskUpdate\", callIfEnabled(function(id) {\n\t\tif (isParsingDone) {\n\t\t\tupdateParentTypes(id);\n\t\t}\n\t}));\n\n\tfunction updateAfterRemoveChild(id){\n\t\tif (id != gantt.config.root_id && gantt.isTaskExists(id)) {\n\t\t\tupdateParentTypes(id);\n\t\t}\n\t}\n\n\tgantt.attachEvent(\"onBeforeTaskDelete\", callIfEnabled(function(id, task) {\n\t\tdelTaskParent = gantt.getParent(id);\n\t\treturn true;\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskDelete\", callIfEnabled(function(id, task) {\n\t\tupdateAfterRemoveChild(delTaskParent);\n\t}));\n\n\n\tvar originalRowDndParent;\n\n\tgantt.attachEvent(\"onRowDragStart\", callIfEnabled(function(id, target, e) {\n\t\toriginalRowDndParent = gantt.getParent(id);\n\t\treturn true;\n\t}));\n\n\tgantt.attachEvent(\"onRowDragEnd\", callIfEnabled(function(id, target) {\n\t\tupdateAfterRemoveChild(originalRowDndParent);\n\t\tupdateParentTypes(id);\n\t}));\n\n\tvar originalMoveTaskParent;\n\n\tgantt.attachEvent(\"onBeforeTaskMove\", callIfEnabled(function(sid, parent, tindex) {\n\t\toriginalMoveTaskParent = gantt.getParent(sid);\n\t\treturn true;\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskMove\", callIfEnabled(function(id, parent, tindex) {\n\t\tif (document.querySelector(\".gantt_drag_marker\")) {\n\t\t\t// vertical dnd in progress\n\t\t\treturn;\n\t\t}\n\t\tupdateAfterRemoveChild(originalMoveTaskParent);\n\t\tupdateParentTypes(id);\n\t}));\n};","interface IFormatterTransfer {\n\ttoMinutes: (value: number) => number;\n\tfromMinutes: (value: number) => number;\n}\n\nexport default class DurationFormatter implements IDurationFormatter {\n\tstatic create = (settings: IDurationFormatterConfig = null): IDurationFormatter => {\n\t\treturn new DurationFormatter(settings);\n\t};\n\tprotected transferUnits: { [unit: string]: IFormatterTransfer };\n\tprotected _config: IDurationFormatterConfig;\n\tconstructor(settings: IDurationFormatterConfig = null) {\n\n\t\tthis._config = this._defaultSettings(settings);\n\t\tthis.transferUnits = {\n\t\t\tminute: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t},\n\t\t\thour: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / this._config.minutesPerHour;\n\t\t\t\t}\n\t\t\t},\n\t\t\tday: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour * this._config.hoursPerDay;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / (this._config.minutesPerHour * this._config.hoursPerDay);\n\t\t\t\t}\n\t\t\t},\n\t\t\tweek: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour * this._config.hoursPerWeek;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / (this._config.minutesPerHour * this._config.hoursPerWeek);\n\t\t\t\t}\n\t\t\t},\n\t\t\tmonth: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour * this._config.hoursPerDay * this._config.daysPerMonth;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / (this._config.minutesPerHour * this._config.hoursPerDay * this._config.daysPerMonth);\n\t\t\t\t}\n\t\t\t},\n\t\t\tyear: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour * this._config.hoursPerDay * this._config.daysPerYear;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / (this._config.minutesPerHour * this._config.hoursPerDay * this._config.daysPerYear);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tcanParse = (value: string) : boolean => {\n\t\tlet units = \"\";\n\t\t// create all possible unit names\n\t\tconst labels = this._config.labels;\n\t\tfor(const labelName in labels){\n\t\t\tconst label = labels[labelName];\n\t\t\tunits += `${label.full}|${label.plural}|${label.short}|`;\n\t\t}\n\t\tconst reg = new RegExp(`^([+\\-]? *[0-9\\.]{1,}\\\\s*(${units})\\\\s*)*$`); // model looks like: 4h 20 minute\n\t\treturn reg.test((value||\"\").trim());\n\t};\n\n\tformat = (value:number) : string => {\n\n\t\tconst durationUnit = this._config.store;\n\t\tconst formatUnits = this._config.format;\n\t\tconst useShortLabels = this._config.short;\n\n\t\tlet totalMinutes = this.transferUnits[durationUnit]\n\t\t\t.toMinutes(value);\n\n\t\tlet units = formatUnits;\n\t\tif(units && units === \"auto\") {\n\t\t\tunits = this._selectFormatForValue(totalMinutes);\n\t\t}\n\t\tif(!units) {\n\t\t\tunits = \"day\";\n\t\t}\n\n\t\tif(formatUnits === \"auto\" && !value){\n\t\t\treturn \"\";\n\t\t}\n\t\tunits = Array.isArray(units) ? units : [units];\n\t\tlet result = \"\";\n\t\tconst last = units.length - 1;\n\t\tfor(let i = 0; i < units.length; i++){\n\t\t\tconst unit = units[i];\n\t\t\tconst countedValue = this._getValueFromMinutes(totalMinutes, unit, i === last);\n\t\t\ttotalMinutes -= this._getValueInMinutes(countedValue, unit);\n\n\t\t\tresult += `${this._getLabelForConvert(countedValue, unit, useShortLabels)}${i === last ? \"\" : \" \"}`;\n\t\t}\n\t\treturn result;\n\t};\n\n\tparse = (value: string) : number => {\n\t\tif(this.canParse(value)){\n\t\t\tvalue = (value||\"\").trim();\n\t\t\tlet part = \"\";\n\t\t\tlet isPartReady = false;\n\t\t\tlet needToParse = false;\n\t\t\tlet result = 0;\n\t\t\tconst last = value.length - 1;\n\t\t\tconst isNumber = /^[+\\-0-9\\. ]$/; // numbers and .;\n\n\t\t\tfor(let i = 0; i < value.length; i++){\n\t\t\t\tconst symbol = value[i];\n\t\t\t\tif(isNumber.test(symbol)){\n\t\t\t\t\t// found the next number. can parse the part of value\n\t\t\t\t\tneedToParse = isPartReady;\n\t\t\t\t} else {\n\t\t\t\t\t// the number is over. letters in turn. find the next number to get whole unit name\n\t\t\t\t\tisPartReady = true;\n\t\t\t\t}\n\n\t\t\t\t// parse the part of number or the resulting part, if the last element\n\t\t\t\tif(needToParse || last === i){\n\t\t\t\t\t// add the last symbol to the part if the last element\n\t\t\t\t\tif(!needToParse) {\n\t\t\t\t\t\tpart += symbol;\n\t\t\t\t\t}\n\n\t\t\t\t\t// parse the part to minutes\n\t\t\t\t\tresult += this._getNumericValue(part);\n\t\t\t\t\tisPartReady = needToParse = false;\n\t\t\t\t\tpart = \"\";\n\t\t\t\t}\n\t\t\t\tpart += symbol;\n\t\t\t}\n\t\t\tif(result){\n\t\t\t\tconst durationUnit = this._config.store;\n\t\t\t\treturn Math.round(this.transferUnits[durationUnit]\n\t\t\t\t\t.fromMinutes(Math.ceil(result)));\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tprotected _defaultSettings(settings: IDurationFormatterConfig = null){\n\t\tconst preparedSettings: IDurationFormatterConfig = {\n\t\t\tenter: \"day\",\n\t\t\tstore: \"hour\",\n\t\t\tformat: \"auto\",\n\t\t\tshort: false,\n\t\t\tminutesPerHour: 60,\n\t\t\thoursPerDay: 8,\n\t\t\thoursPerWeek: 40,\n\t\t\tdaysPerMonth: 30,\n\t\t\tdaysPerYear: 365,\n\t\t\tlabels: {\n\t\t\t\tminute: {\n\t\t\t\t\tfull: \"minute\",\n\t\t\t\t\tplural: \"minutes\",\n\t\t\t\t\tshort: \"min\"\n\t\t\t\t},\n\t\t\t\thour: {\n\t\t\t\t\tfull: \"hour\",\n\t\t\t\t\tplural: \"hours\",\n\t\t\t\t\tshort: \"h\"\n\t\t\t\t},\n\t\t\t\tday: {\n\t\t\t\t\tfull: \"day\",\n\t\t\t\t\tplural: \"days\",\n\t\t\t\t\tshort: \"d\"\n\t\t\t\t},\n\t\t\t\tweek: {\n\t\t\t\t\tfull: \"week\",\n\t\t\t\t\tplural: \"weeks\",\n\t\t\t\t\tshort: \"wk\"\n\t\t\t\t},\n\t\t\t\tmonth: {\n\t\t\t\t\tfull: \"month\",\n\t\t\t\t\tplural: \"months\",\n\t\t\t\t\tshort: \"mon\"\n\t\t\t\t},\n\t\t\t\tyear: {\n\t\t\t\t\tfull: \"year\",\n\t\t\t\t\tplural: \"years\",\n\t\t\t\t\tshort: \"y\"\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tif(settings){\n\t\t\tfor(const i in settings){\n\t\t\t\tif(settings[i] !== undefined && i !== \"labels\") {\n\t\t\t\t\tpreparedSettings[i] = settings[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(settings.labels){\n\t\t\t\tfor(const i in settings.labels) {\n\t\t\t\t\tpreparedSettings.labels[i] = settings.labels[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn preparedSettings;\n\n\t}\n\n\tprotected _selectFormatForValue(value: number): string {\n\t\tconst units = [\"year\",\"month\",\"day\",\"hour\",\"minute\"];\n\t\tconst values = [];\n\t\tfor(let i = 0; i < units.length; i++) {\n\t\t\tvalues[i] = Math.abs(this.transferUnits[units[i]].fromMinutes(value));\n\t\t}\n\n\t\tfor(let i = 0; i < values.length; i++) {\n\t\t\tconst valueInUnit = values[i];\n\t\t\tif(valueInUnit < 1 && i < values.length - 1){\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\treturn units[i];\n\t\t\t}\n\t\t}\n\n\t\treturn \"day\";\n\t}\n\n\tprotected _getNumericValue(value: string) : number {\n\t\tconst numericValue = parseFloat(value.replace(/ /g, \"\")) || 0;\n\t\tconst lettersValue = value.match(/\\p{L}/gu) ? value.match(/\\p{L}/gu).join(\"\") : \"\";\n\t\tconst unitName = this._getUnitName(lettersValue); // leave only letters\n\n\t\tif(!numericValue || !unitName){\n\t\t\treturn 0;\n\t\t}\n\n\t\treturn this._getValueInMinutes(numericValue, unitName);\n\t}\n\n\tprotected _getValueInMinutes = (value: number, unit: string) => {\n\t\tif(this.transferUnits[unit] && this.transferUnits[unit].toMinutes){\n\t\t\treturn this.transferUnits[unit].toMinutes(value);\n\t\t}\n\t\treturn 0;\n\t};\n\n\tprotected _getLabelForConvert = (value: number, unit: string, short: boolean) : string => {\n\t\tconst labels = this._config.labels;\n\t\tconst label = labels[unit];\n\t\tif(short){\n\t\t\treturn `${value}${label.short}`;\n\t\t}\n\n\t\treturn `${value} ${value !== 1 ? label.plural : label.full}`;\n\t};\n\n\tprotected _getValueFromMinutes = (value: number, unit: string, last: boolean) : number => {\n\t\tif(this.transferUnits[unit] && this.transferUnits[unit].fromMinutes){\n\t\t\tconst result = this.transferUnits[unit].fromMinutes(value);\n\n\t\t\tif(last){\n\t\t\t\treturn parseFloat(result.toFixed(2));\n\t\t\t}\n\t\t\treturn parseInt(result.toString(), 10);\n\t\t}\n\t\treturn null;\n\t};\n\n\tprotected _isUnitName = (unit: any, value: string) : boolean => {\n\t\tvalue = value.toLowerCase();\n\t\treturn unit.full.toLowerCase() === value\n\t\t\t|| unit.plural.toLowerCase() === value\n\t\t\t|| unit.short.toLowerCase() === value;\n\t};\n\n\tprotected _getUnitName = (value: string) : string => {\n\t\tconst labels = this._config.labels;\n\t\tlet labelName: string;\n\t\tlet isUnit = false;\n\t\tfor(labelName in labels){\n\t\t\tif(this._isUnitName(labels[labelName], value)){\n\t\t\t\tisUnit = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(isUnit){\n\t\t\treturn labelName;\n\t\t}\n\t\treturn this._config.enter;\n\t};\n}","export default class LinkFormatterSimple implements ILinkFormatter {\n\tstatic create = (settings: ILinkFormatterConfig = null, gantt: any): LinkFormatterSimple => {\n\t\treturn new LinkFormatterSimple(gantt);\n\t};\n\tprotected _linkReg: RegExp;\n\tprotected _gantt: any;\n\n\tconstructor(gantt: any) {\n\t\tthis._linkReg = /^[0-9\\.]+/;\n\t\tthis._gantt = gantt;\n\t}\n\n\tformat = (link: ILink) : string => {\n\t\tconst wbs = this._getWBSCode(link.source);\n\t\treturn wbs;\n\t};\n\n\tcanParse = (value: string) : boolean => {\n\t\treturn this._linkReg.test(value);\n\t};\n\tparse = (value: string) : ILink => {\n\t\tif(!this.canParse(value)){\n\t\t\treturn null;\n\t\t}\n\n\t\tconst linkPart = this._linkReg.exec(value)[0].trim();\n\n\t\tconst source = this._findSource(linkPart) || null;\n\n\t\treturn {\n\t\t\tid: undefined,\n\t\t\tsource,\n\t\t\ttarget: null,\n\t\t\ttype: this._gantt.config.links.finish_to_start,\n\t\t\tlag: 0\n\t\t};\n\t};\n\n\tprotected _getWBSCode = (source: number | string) => {\n\t\tconst pred = this._gantt.getTask(source);\n\t\treturn this._gantt.getWBSCode(pred);\n\t};\n\n\tprotected _findSource = (value: string) => {\n\t\tconst reqTemplate = new RegExp(\"^[0-9\\.]+\", \"i\");\n\t\tif(reqTemplate.exec(value)){\n\t\t\tconst wbs = reqTemplate.exec(value)[0];\n\t\t\tconst task = this._gantt.getTaskByWBSCode(wbs);\n\t\t\tif(task){\n\t\t\t\treturn task.id;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n}","import LinkFormatterSimple from \"./link_formatter_simple\";\n\nexport default class LinkFormatter extends LinkFormatterSimple implements ILinkFormatter {\n\tstatic create = (settings: ILinkFormatterConfig = null, gantt: any): LinkFormatter => {\n\t\treturn new LinkFormatter(settings, gantt);\n\t};\n\tprotected _config: ILinkFormatterConfig;\n\n\tconstructor(settings: ILinkFormatterConfig, gantt: any) {\n\t\tsuper(gantt);\n\t\tthis._config = this._defaultSettings(settings);\n\t\tthis._linkReg = /^[0-9\\.]+[a-zA-Z]*/;\n\t}\n\n\tformat = (link: ILink) : string => {\n\t\tconst formattedType = this._getFormattedLinkType(this._getLinkTypeName(link.type));\n\t\tconst wbs = this._getWBSCode(link.source);\n\t\tconst lag = this._getLagString(link.lag);\n\n\t\tif(link.type === this._gantt.config.links.finish_to_start && !link.lag){\n\t\t\treturn wbs;\n\t\t}else{\n\t\t\treturn `${wbs}${formattedType}${lag}`;\n\t\t}\n\t};\n\n\tparse = (value: string) : ILink => {\n\t\tif(!this.canParse(value)){\n\t\t\treturn null;\n\t\t}\n\n\t\tconst linkPart = this._linkReg.exec(value)[0].trim();\n\t\tconst lagPart = value.replace(linkPart, \"\").trim();\n\n\t\tconst typeFormat = this._findTypeFormat(linkPart);\n\t\tconst typeNumber = this._getLinkTypeNumber(typeFormat);\n\t\tconst source = this._findSource(linkPart) || null;\n\t\tconst lag = this._parseLag(lagPart);\n\n\t\treturn {\n\t\t\tid: undefined,\n\t\t\tsource,\n\t\t\ttarget: null,\n\t\t\ttype: typeNumber,\n\t\t\tlag\n\t\t};\n\t};\n\n\tprotected _defaultSettings(settings: ILinkFormatterConfig = null) : ILinkFormatterConfig{\n\t\tconst preparedSettings: ILinkFormatterConfig = {\n\t\t\tdurationFormatter: this._gantt.ext.formatters.durationFormatter(),\n\t\t\tlabels: {\n\t\t\t\tfinish_to_finish: \"FF\",\n\t\t\t\tfinish_to_start: \"FS\",\n\t\t\t\tstart_to_start: \"SS\",\n\t\t\t\tstart_to_finish: \"SF\"\n\t\t\t}\n\t\t};\n\n\t\tif(settings && settings.durationFormatter){\n\t\t\tpreparedSettings.durationFormatter = settings.durationFormatter;\n\t\t}\n\n\t\tif(settings && settings.labels){\n\t\t\tfor(const i in settings.labels){\n\t\t\t\tpreparedSettings.labels[i] = settings.labels[i];\n\t\t\t}\n\t\t}\n\t\treturn preparedSettings;\n\t}\n\n\tprotected _getLinkTypeName = (value: string) => {\n\t\tlet linkName = \"\";\n\t\tfor(linkName in this._config.labels){\n\t\t\tif(String(this._gantt.config.links[linkName]).toLowerCase() === String(value).toLowerCase()){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn linkName;\n\t};\n\n\tprotected _getLinkTypeNumber = (value: string) => {\n\t\tlet linkName = \"\";\n\t\tfor(linkName in this._gantt.config.links){\n\t\t\tif(linkName.toLowerCase() === value.toLowerCase()){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn this._gantt.config.links[linkName];\n\t};\n\n\tprotected _getFormattedLinkType = (name: string) => {\n\t\treturn this._config.labels[name] || \"\";\n\t};\n\n\tprotected _getLagString = (lag: number) => {\n\t\tif(!lag){\n\t\t\treturn \"\";\n\t\t}\n\n\t\tconst formatted = this._config.durationFormatter.format(lag);\n\t\tif(lag < 0) {\n\t\t\treturn formatted;// -3 days\n\t\t}else{\n\t\t\treturn `+${formatted}`;// + 3 days\n\t\t}\n\t};\n\n\tprotected _findTypeFormat = (value: string) => {\n\t\tconst format = value.replace(/[^a-zA-Z]/gi, \"\"); // leave only letters\n\t\tlet name = \"finish_to_start\";\n\t\tfor(const i in this._config.labels){\n\t\t\tif(this._config.labels[i].toLowerCase() === format.toLowerCase()){\n\t\t\t\tname = i;\n\t\t\t}\n\t\t}\n\t\treturn name;\n\t};\n\n\tprotected _parseLag = (value: string) => {\n\t\tif(!value){\n\t\t\treturn 0;\n\t\t}\n\t\treturn this._config.durationFormatter.parse(value);\n\t};\n}","\nimport DurationFormatter from \"../common/duration_formatter\";\nimport LinkFormatter from \"../common/link_formatter\";\n\nexport default function(gantt){\n\tgantt.ext.formatters = {\n\t\tdurationFormatter: function(settings){\n\t\t\tif(!settings){\n\t\t\t\tsettings = {};\n\t\t\t}\n\t\t\tif(!settings.store){\n\t\t\t\tsettings.store = gantt.config.duration_unit;\n\t\t\t}\n\t\t\tif(!settings.enter){\n\t\t\t\tsettings.enter = gantt.config.duration_unit;\n\t\t\t}\n\t\t\treturn DurationFormatter.create(settings, gantt);\n\t\t},\n\t\tlinkFormatter: function(settings){\n\t\t\treturn LinkFormatter.create(settings, gantt);\n\t\t}\n\t};\n};","export default function(gantt: any){\n\n\tgantt.ext = gantt.ext || {};\n\tgantt.config.show_empty_state = false;\n\n\tgantt.ext.emptyStateElement = gantt.ext.emptyStateElement || {\n\t\tisEnabled() {\n\t\t\treturn gantt.config.show_empty_state === true;\n\t\t},\n\t\tisGanttEmpty(){\n\t\t\treturn !gantt.getTaskByTime().length;\n\t\t},\n\t\trenderContent(container){\n\t\t\tconst placeholderTextElement = `<div class='gantt_empty_state_text'>\n    <div class='gantt_empty_state_text_link' data-empty-state-create-task>${gantt.locale.labels.empty_state_text_link}</div>\n    <div class='gantt_empty_state_text_description'>${gantt.locale.labels.empty_state_text_description}</div>\n    </div>`;\n\t\t\tconst placeholderImageElement = \"<div class='gantt_empty_state_image'></div>\";\n\n\t\t\tconst placeholderContainer = `<div class='gantt_empty_state'>${placeholderImageElement}${placeholderTextElement}</div>`;\n\t\t\tcontainer.innerHTML = placeholderContainer;\n\t\t},\n\n\t\tclickEvents: [],\n\t\tattachAddTaskEvent(){\n\t\t\tconst id = gantt.attachEvent(\"onEmptyClick\", function(e){\n\t\t\t\tconst domHelpers = gantt.utils.dom;\n\t\t\t\tconst gridPlaceholder = domHelpers.closest(e.target, \"[data-empty-state-create-task]\");\n\t\t\t\tif (gridPlaceholder){\n\t\t\t\t\tgantt.createTask({\n\t\t\t\t\t\tid: gantt.uid(),\n\t\t\t\t\t\ttext: \"New Task\"\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.clickEvents.push(id);\n\t\t},\n\t\tdetachAddTaskEvents(){\n\t\t\tthis.clickEvents.forEach(function(event){\n\t\t\t\tgantt.detachEvent(event);\n\t\t\t});\n\t\t\tthis.clickEvents = [];\n\t\t},\n\n\t\tgetContainer(){\n\t\t\tif (gantt.$container) {\n\t\t\t\tconst domHelpers = gantt.utils.dom;\n\t\t\t\tif (gantt.$container.contains(gantt.$grid_data)) {\n\t\t\t\t\treturn domHelpers.closest(gantt.$grid_data, \".gantt_layout_content\");\n\t\t\t\t}\n\t\t\t\tif (gantt.$container.contains(gantt.$task_data)){\n\t\t\t\t\treturn domHelpers.closest(gantt.$task_data, \".gantt_layout_content\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tgetNode(){\n\t\t\tconst container = this.getContainer();\n\t\t\tif (!container){\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst emptyStateElementNode = container.querySelector(\".gantt_empty_state_wrapper\");\n\t\t\treturn emptyStateElementNode;\n\t\t},\n\n\t\tshow(){\n\t\t\tconst container = this.getContainer();\n\t\t\tif (!container && this.isGanttEmpty()){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst wrapper = document.createElement(\"div\");\n\t\t\twrapper.className = \"gantt_empty_state_wrapper\";\n\t\t\twrapper.style.marginTop = (gantt.config.scale_height - container.offsetHeight) + \"px\";\n\t\t\tconst oldNodes = gantt.$container.querySelectorAll(\".gantt_empty_state_wrapper\");\n\t\t\t// for IE11\n\t\t\tArray.prototype.forEach.call(oldNodes, function(node){\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t});\n\n\t\t\tthis.detachAddTaskEvents();\n\t\t\tthis.attachAddTaskEvent();\n\n\t\t\tcontainer.appendChild(wrapper);\n\t\t\tthis.renderContent(wrapper);\n\t\t},\n\t\thide(){\n\t\t\tconst emptyStateElementNode = this.getNode();\n\t\t\tif (emptyStateElementNode){\n\t\t\t\temptyStateElementNode.parentNode.removeChild(emptyStateElementNode);\n\t\t\t} else{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t},\n\t\tinit(){ }\n\t};\n\n\tgantt.attachEvent(\"onDataRender\", function() {\n\t\tconst emptyStateElement = gantt.ext.emptyStateElement;\n\t\tif (emptyStateElement.isEnabled() && emptyStateElement.isGanttEmpty()) {\n\t\t\temptyStateElement.show();\n\t\t} else {\n\t\t\temptyStateElement.hide();\n\t\t}\n\t});\n\n\n\n\n}\n","export const hasBaselinesBelow = function (gantt, task) {\n  const baselines = task.baselines && task.baselines.length;\n  const baselinesOnDifferentRow = gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\";\n  if (baselines && baselinesOnDifferentRow) {\n    return true;\n  }\n};\n\nexport const childrenHaveBaselines = function (gantt, taskId) {\n  let hasBaselines = false;\n  gantt.eachTask(function (child) {\n    if (hasBaselines) {\n      return;\n    }\n    hasBaselines = hasBaselinesBelow(gantt, child);\n  }, taskId);\n  return hasBaselines;\n};\n\nexport const isSplitChild = function (gantt, id) {\n  let splitChild = false;\n  gantt.eachParent(function (parent) {\n    if (isSplitParent(parent)) {\n      splitChild = true;\n    }\n  }, id);\n  return splitChild;\n};\n\nexport const isSplitParent = function (task) {\n  return task.render && task.render == \"split\" && !task.$open;\n};\n\nexport const getMaxParentHeight = function (gantt, view, task, heightLimit) {\n  let maxHeight = heightLimit || view.$task_data.scrollHeight;\n  let shrinkHeight = false;\n  let splitChild = false;\n\n  gantt.eachParent(function (parent) {\n    if (isSplitParent(parent)) {\n      splitChild = true;\n      const parentSizes = view.getItemPosition(parent);\n      const parentHeight = parentSizes.rowHeight;\n      if (parentHeight < maxHeight) {\n        maxHeight = parentHeight;\n        shrinkHeight = true;\n      }\n    }\n  }, task.id);\n\n  return { maxHeight, shrinkHeight, splitChild };\n};\n\nexport const getMilestoneHeight = function (height) {\n  return Math.sqrt(2 * height * height);\n};\n\nexport const getInvertedMilestoneHeight = function (height) {\n  return Math.round(height / Math.sqrt(2));\n};\n\nexport const getAdjustedPosition = function (gantt, timeline, sizes, heightLimit, task, childBaselines) {\n  const baselines = hasBaselinesBelow(gantt, task);\n\n  const splitParams = getMaxParentHeight(gantt, timeline, task);\n  let maxHeight = splitParams.maxHeight;\n\n  let height = sizes.height;\n  let largerHeight = height > heightLimit;\n  let noNeedToShrink = sizes.rowHeight >= heightLimit && !splitParams.splitChild && !baselines;\n  if (largerHeight || noNeedToShrink) {\n    height = heightLimit;\n  }\n\n  if (maxHeight < height) {\n    height = maxHeight;\n  }\n\n  let marginTop = Math.floor((sizes.rowHeight - height) / 2);\n\n  if (splitParams.splitChild) {\n    marginTop = Math.floor((maxHeight - height) / 2);\n  }\n  if (childBaselines || baselines) {\n    let heightDiff = Math.min(sizes.height, maxHeight) - height;\n\n    let additionalMargin = 2;\n    let exceedBarHeight = baselines && task.bar_height >= task.row_height;\n    let exceedParentHeight = splitParams.splitChild && sizes.height >= maxHeight;\n    if (exceedBarHeight || exceedParentHeight){\n      additionalMargin = 0;\n    }\n\n    marginTop = Math.floor(heightDiff / 2) + additionalMargin;\n    const bottom = height + marginTop;\n    if (bottom > sizes.rowHeight || bottom > maxHeight) {\n      // marginTop = 0;\n    }\n  }\n\n  return { height, marginTop };\n};\n\nexport default {\n  hasBaselinesBelow,\n  childrenHaveBaselines,\n  isSplitChild,\n  isSplitParent,\n  getMaxParentHeight,\n  getMilestoneHeight,\n  getInvertedMilestoneHeight,\n  getAdjustedPosition\n};\n","import { hasBaselinesBelow, isSplitParent } from \"../ui/render/baseline_helper\";\nimport isHeadless from \"../../utils/is_headless\";\n\nexport default function (gantt) {\n  gantt.config.baselines = {\n    datastore: \"baselines\",\n    render_mode: false,\n    dataprocessor_baselines: false,\n    row_height: 16,\n    bar_height: 8\n  };\n\n  function initBaselineFields(item, task) {\n    // don't add baseline if it doesn't belong to any task\n    // or if doesn't have the dates\n    if (!item.task_id || (!item.start_date && !item.end_date)) {\n      return false;\n    }\n\n    if (item.start_date) {\n      item.start_date = gantt.date.parseDate(item.start_date, \"parse_date\");\n    } else {\n      item.start_date = null;\n    }\n\n    if (item.end_date) {\n      item.end_date = gantt.date.parseDate(item.end_date, \"parse_date\");\n    } else {\n      item.end_date = null;\n    }\n\n    // set min baseline duration\n    item.duration = item.duration || 1;\n\n    // GS-2636. Calculate the 3rd date parameter basing on existing date parameters\n    if (item.start_date && !item.end_date){\n      item.end_date = gantt.calculateEndDate(item.start_date, item.duration);\n    } else if (item.end_date && !item.start_date){\n      item.start_date = gantt.calculateEndDate(item.end_date, -item.duration);\n    } \n  }\n  // gantt init\n  const baselineStore = gantt.createDatastore({\n    name: gantt.config.baselines.datastore,\n    initItem: function (item) {\n      if (!item.id) {\n        item.id = gantt.uid();\n      }\n\n      initBaselineFields(item);\n\n      return item;\n    }\n  });\n\n  gantt.$data.baselineStore = baselineStore;\n\n  function _syncBaselines(task) {\n    let shouldRepaint = false;\n    const iteratedBaselines = {};\n\n    const taskBaselines = task.baselines || [];\n    const exisingBaselines = gantt.getTaskBaselines(task.id);\n\n    if (taskBaselines.length != exisingBaselines.length) {\n      shouldRepaint = true;\n    }\n\n    taskBaselines.forEach(function (baseline) {\n      iteratedBaselines[baseline.id] = true;\n      const exisingBaseline = baselineStore.getItem(baseline.id);\n      if (exisingBaseline) {\n        const start = +exisingBaseline.start_date !== +baseline.start_date;\n        const end = +exisingBaseline.end_date !== +baseline.end_date;\n        if (start || end) {\n          baselineStore.updateItem(baseline.id, baseline);\n        }\n      } else {\n        baselineStore.addItem(baseline);\n      }\n    });\n\n    exisingBaselines.forEach(function (baseline) {\n      if (!iteratedBaselines[baseline.id]) {\n        baselineStore.removeItem(baseline.id);\n      }\n    });\n\n    if (shouldRepaint) {\n      if (isSplitParent(task)){\n        // here we adjust the parent height, then adjust it with the total child height\n        _adjustSplitParentHeight (task);\n      } else {\n        gantt.adjustTaskHeightForBaselines(task);\n      }\n      gantt.render();\n    }\n  }\n\n  function _deleteOrphanBaselines() {\n    baselineStore.eachItem(function (baseline) {\n      if (!gantt.isTaskExists(baseline.task_id)) {\n        baselineStore.removeItem(baseline.id);\n      }\n    });\n  }\n\n  function _adjustSplitParentHeight (task){\n    let maxParentHeight = 0;\n\n    gantt.adjustTaskHeightForBaselines(task);\n\n    gantt.eachTask(function(child){\n      let childHeight = child.row_height || gantt.config.row_height;\n\n      maxParentHeight = maxParentHeight || childHeight;\n      if (childHeight > maxParentHeight){\n        maxParentHeight = childHeight;\n      }\n    }, task.id);\n\n    if (task.row_height < maxParentHeight){\n      task.row_height = maxParentHeight;\n    }\n  }\n\n  gantt.adjustTaskHeightForBaselines = function (task) {\n    let height, baselineSize, betweenBaselines;\n    let margins = 2;\n    let baselineAmount = task.baselines && task.baselines.length || 0;\n    const subrowHeight = gantt.config.baselines.row_height;\n    //const baselineBarHeight = task?.baselines.bar_height\n\n    const timelineView = gantt.getLayoutView(\"timeline\");\n    if (!timelineView || !gantt.config.show_chart){\n      return;\n    }\n\n    switch (gantt.config.baselines.render_mode) {\n      case \"taskRow\":\n        task.row_height = task.bar_height + 4;\n        break;\n\n      case \"separateRow\":\n        height = timelineView.getBarHeight(task.id);\n        if (baselineAmount) {\n          task.bar_height = task.bar_height || height;\n\n          if (task.bar_height > height){\n            height = task.bar_height;\n          }\n\n          task.row_height = height + subrowHeight;\n        } else if (task.bar_height) {\n          task.row_height = task.bar_height + 4;\n        }\n\n        _increaseSplitParentHeight(task);\n        break;\n\n      case \"individualRow\":\n        height = timelineView.getBarHeight(task.id);\n\n        if (baselineAmount) {\n          task.bar_height = task.bar_height || height;\n\n          if (task.bar_height > height){\n            height = task.bar_height;\n          }\n\n          baselineSize = subrowHeight * baselineAmount;\n       //   betweenBaselines = 3 * (baselineAmount + 1);\n\n          task.row_height = height + baselineSize + margins;\n        } else if (task.bar_height){\n          task.row_height = task.bar_height + 4;\n        }\n\n        _increaseSplitParentHeight(task);\n    }\n  };\n\n  function _increaseSplitParentHeight(task) {\n    gantt.eachParent(function (parent) {\n      if (isSplitParent(parent)) {\n        const parentHeight = parent.row_height || gantt.getLayoutView(\"timeline\").getBarHeight(parent.id);\n        let maxHeight = task.row_height;\n\n        // iterate only direct children\n        const subtasks = gantt.getChildren(parent.id);\n        subtasks.forEach(function (subtaskId) {\n          const subtask = gantt.getTask(subtaskId);\n          if (subtask.id == task.id) {\n            return;\n          }\n          const subtaskHeight = subtask.row_height || gantt.getLayoutView(\"timeline\").getBarHeight(subtask.id);\n          maxHeight = maxHeight || subtaskHeight;\n          if (subtaskHeight > maxHeight) {\n            maxHeight = subtaskHeight;\n          }\n        });\n\n        parent.row_height = maxHeight;\n        parent.bar_height = parent.bar_height || parentHeight;\n      }\n    }, task.id);\n  }\n\n  gantt.attachEvent(\n    \"onGanttReady\",\n    function () {\n\n      if(!gantt.config.baselines){\n        return;\n      }\n\n      gantt.attachEvent(\"onParse\", function () {\n        baselineStore.eachItem(function (baseline) {\n          const taskId = baseline.task_id;\n          if (gantt.isTaskExists(taskId)) {\n            const task = gantt.getTask(taskId);\n\n            task.baselines = task.baselines || [];\n\n            let newBaseline = true;\n            for (let i = 0; i < task.baselines.length; i++) {\n              let existingBaseline = task.baselines[i];\n              if (existingBaseline.id == baseline.id){\n                newBaseline = false;\n                gantt.mixin(existingBaseline, baseline, true);\n                break;\n              }\n            }\n            if (newBaseline){\n              task.baselines.push(baseline);\n            }\n\n            if(!isHeadless(gantt)){\n              if (isSplitParent(task)){\n                _adjustSplitParentHeight (task);\n              } else {\n                gantt.adjustTaskHeightForBaselines(task);\n              }\n            }\n          }\n        });\n      });\n\n      gantt.attachEvent(\"onBeforeTaskUpdate\", function (id, task) {\n        _syncBaselines(task);\n        return true;\n      });\n\n      gantt.attachEvent(\"onAfterUndo\", function(action){\n        const baselinesRenderedBelow = gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\";\n        if (baselinesRenderedBelow && action){\n          let repaint = false;\n          action.commands.forEach(function(command){\n            if (command.entity == \"task\"){\n              const taskId = command.value.id;\n              if (gantt.isTaskExists(taskId)){\n                const task = gantt.getTask(taskId);\n                if (task.parent && gantt.isTaskExists(task.parent)){\n                  const parent = gantt.getTask(task.parent);\n                  if (isSplitParent(parent)){\n                    _adjustSplitParentHeight (parent);\n                    repaint = true;\n                  }\n                }\n              }    \n            }\n          });\n          if (repaint){\n            gantt.render();\n          }\n        }\n      });\n\n      gantt.attachEvent(\"onAfterTaskDelete\", function (id, task) {\n        if (hasBaselinesBelow){\n          if (task.parent && gantt.isTaskExists(task.parent)){\n            const parent = gantt.getTask(task.parent);\n            if (isSplitParent(parent)){\n              _adjustSplitParentHeight (parent);\n            }\n          }\n        }\n        _deleteOrphanBaselines();\n      });\n\n      gantt.getTaskBaselines = function (taskId) {\n        const baselines = [];\n        baselineStore.eachItem(function (baseline) {\n          if (baseline.task_id == taskId) {\n            baselines.push(baseline);\n          }\n        });\n        return baselines;\n      };\n      gantt.$data.baselineStore.attachEvent(\"onClearAll\", function () {\n        gantt.eachTask(function(task){\n          if (task.baselines){\n            delete task.baselines;\n          }\n        });\n        // The data should not be repainted as otherwise it causes issues when we have resource \n        // assignments and group tasks. It should be fixed when we add a repaint stack\n        // gantt.refreshData();\n        return true;\n      });\n\n      gantt.$data.tasksStore.attachEvent(\"onClearAll\", function () {\n        baselineStore.clearAll();\n        return true;\n      });\n      gantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\n        const baselines = baselineStore.find(function (a) {\n          return a.task_id == id;\n        });\n        baselines.forEach(function (a) {\n          a.task_id = new_id;\n          baselineStore.updateItem(a.id);\n        });\n      });\n    },\n    { once: true }\n  );\n};\n","import quickPositionHelperFactory from \"./row_position_fixed_height\";\n\nfunction createMixin(view){\n\tvar getItemTopCache = {};\n\tvar getRowTopCache = {};\n\tvar getItemHeightCache = null;\n\tvar totalHeightCache = -1;\n\tvar getItemHeightCacheState = null;\n\n\tvar quickPosition = quickPositionHelperFactory(view);\n\n\treturn {\n\t\t_resetTopPositionHeight: function(){\n\t\t\tgetItemTopCache = {};\n\t\t\tgetRowTopCache = {};\n\t\t\tquickPosition.resetCache();\n\t\t},\n\t\t_resetHeight: function(){\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tvar newState = this.getCacheStateTotalHeight(store);\n\t\t\tif(!getItemHeightCacheState){\n\t\t\t\tgetItemHeightCacheState = newState;\n\t\t\t}else if(this.shouldClearHeightCache(getItemHeightCacheState, newState)){\n\t\t\t\tgetItemHeightCacheState = newState;\n\t\t\t\tgetItemHeightCache = null;\n\t\t\t}\n\n\t\t\ttotalHeightCache = -1;\n\t\t\tquickPosition.resetCache();\n\t\t},\n\n\t\t/**\n\t\t * Get top coordinate by row index (order)\n\t\t * @param {number} index\n\t\t */\n\t\tgetRowTop: function(index){\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\treturn quickPosition.getRowTop(index);\n\t\t\t}\n\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tif(!store){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(getRowTopCache[index] !== undefined){\n\t\t\t\treturn getRowTopCache[index];\n\t\t\t}else {\n\t\t\t\tvar all = store.getIndexRange();\n\t\t\t\tvar top = 0;\n\t\t\t\tvar result = 0;\n\t\t\t\tfor(var i = 0; i < all.length; i++){\n\t\t\t\t\tgetRowTopCache[i] = top;\n\t\t\t\t\ttop += this.getItemHeight(all[i].id);\n\t\t\t\t\tif(i < index){\n\t\t\t\t\t\tresult = top;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get top coordinate by item id\n\t\t * @param {*} task_id\n\t\t */\n\t\tgetItemTop: function (taskId) {\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tif(getItemTopCache[taskId] !== undefined){\n\t\t\t\t\treturn getItemTopCache[taskId];\n\t\t\t\t}\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tif(!store) return 0;\n\n\t\t\t\tvar itemIndex = store.getIndexById(taskId);\n\n\t\t\t\tif (itemIndex === -1 && store.getParent && store.exists(taskId)) {\n\t\t\t\t\tvar parentId = store.getParent(taskId);\n\t\t\t\t\tif (store.exists(parentId)) {\n\t\t\t\t\t\t// if task is not found in list - maybe it's parent is a split task and we should use parents index instead\n\t\t\t\t\t\tvar parent = store.getItem(parentId);\n\t\t\t\t\t\tif (this.$gantt.isSplitTask(parent)) {\n\t\t\t\t\t\t\treturn this.getItemTop(parentId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgetItemTopCache[taskId] = this.getRowTop(itemIndex);\n\t\t\t\treturn getItemTopCache[taskId];\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t},\n\n\t\t/**\n\t\t * Get height of the item by item id\n\t\t * @param {*} itemId\n\t\t */\n\t\tgetItemHeight: function (itemId) {\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\treturn quickPosition.getItemHeight(itemId);\n\t\t\t}\n\n\t\t\tif(!getItemHeightCache && this.$config.rowStore){\n\t\t\t\tthis._fillHeightCache(this.$config.rowStore);\n\t\t\t}\n\n\t\t\tif(getItemHeightCache[itemId] !== undefined){\n\t\t\t\treturn getItemHeightCache[itemId];\n\t\t\t}\n\n\t\t\tvar defaultHeight = this.$getConfig().row_height;\n\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tif(!store) return defaultHeight;\n\n\t\t\t\tvar item = store.getItem(itemId);\n\n\t\t\t\treturn getItemHeightCache[itemId] = item && item.row_height || defaultHeight;\n\t\t\t}else{\n\t\t\t\treturn defaultHeight;\n\t\t\t}\n\t\t},\n\n\t\t_fillHeightCache: function(store){\n\t\t\tif(!store){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tgetItemHeightCache = {};\n\t\t\tvar defaultHeight = this.$getConfig().row_height;\n\t\t\tstore.eachItem(function(item){\n\t\t\t\treturn getItemHeightCache[item.id] = item && item.row_height || defaultHeight;\n\t\t\t});\n\t\t},\n\n\t\tgetCacheStateTotalHeight: function(store){\n\n\t\t\tvar globalHeight = this.$getConfig().row_height;\n\t\t\tvar itemHeightCache = {};\n\t\t\tvar items = [];\n\t\t\tvar sumHeight = 0;\n\t\t\tif(store){\n\t\t\t\tstore.eachItem(function(item){\n\t\t\t\t\titems.push(item);\n\t\t\t\t\titemHeightCache[item.id] = item.row_height;\n\t\t\t\t\tsumHeight += item.row_height || globalHeight;\n\t\t\t\t});\n\t\t\t}\n\n\n\t\t\treturn {\n\t\t\t\tglobalHeight: globalHeight,\n\t\t\t\titems: items,\n\t\t\t\tcount: items.length,\n\t\t\t\tsumHeight: sumHeight\n\t\t\t};\n\t\t},\n\t\tshouldClearHeightCache: function(oldState, newState){\n\n\t\t\tif(oldState.count != newState.count){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif(oldState.globalHeight != newState.globalHeight){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif(oldState.sumHeight != newState.sumHeight){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tfor(var i in oldState.items){\n\t\t\t\tvar newValue = newState.items[i];\n\t\t\t\tif(newValue !== undefined && newValue != oldState.items[i]){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\t/**\n\t\t * Get total height of items\n\t\t */\n\t\tgetTotalHeight: function () {\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\treturn quickPosition.getTotalHeight();\n\t\t\t}\n\n\t\t\tif(totalHeightCache != -1){\n\t\t\t\treturn totalHeightCache;\n\t\t\t}\n\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tthis._fillHeightCache(store);\n\t\t\t\tvar getHeight = this.getItemHeight.bind(this);\n\t\t\t\tvar visibleItems = store.getVisibleItems();\n\t\t\t\tvar totalHeight = 0;\n\n\t\t\t\tvisibleItems.forEach(function(item){\n\t\t\t\t\ttotalHeight += getHeight(item.id);\n\t\t\t\t});\n\n\t\t\t\ttotalHeightCache = totalHeight;\n\t\t\t\treturn totalHeight;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get item by top position\n\t\t * @param {*} top\n\t\t */\n\t\tgetItemIndexByTopPosition: function (top) {\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\t\treturn quickPosition.getItemIndexByTopPosition(top);\n\t\t\t\t}\n\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tfor(var i = 0; i < store.countVisible(); i++){\n\t\t\t\t\tvar current = this.getRowTop(i);\n\t\t\t\t\tvar next = this.getRowTop(i+1);\n\t\t\t\t\tif(!next){\n\t\t\t\t\t\tvar taskId = store.getIdByIndex(i);\n\t\t\t\t\t\tnext = current + this.getItemHeight(taskId);\n\t\t\t\t\t}\n\t\t\t\t\tif(top >= current && top < next){\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// GS-1723: If we iterated all tasks and didn't find the position, the target is below all other tasks\n\t\t\t\treturn store.countVisible() + 2;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default createMixin;","function createHelper(view){\n\tvar cachedRowHeight = -1;\n\tvar canUseSimpleCalc = -1;\n\treturn {\n\t\tresetCache: function(){\n\t\t\tcachedRowHeight = -1;\n\t\t\tcanUseSimpleCalc = -1;\n\t\t},\n\t\t_getRowHeight: function(){\n\t\t\tif(cachedRowHeight === -1){\n\t\t\t\tcachedRowHeight = view.$getConfig().row_height;\n\t\t\t}\n\t\t\treturn cachedRowHeight;\n\t\t},\n\t\t_refreshState: function(){\n\t\t\tthis.resetCache();\n\t\t\tcanUseSimpleCalc = true;\n\t\t\tvar store = view.$config.rowStore;\n\t\t\tif(!store){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar globalRowHeight = this._getRowHeight();\n\t\t\tfor (var i=0; i<store.fullOrder.length; i++) {\n\t\t\t\tvar item = store.getItem(store.fullOrder[i]);\n\t\t\t\t// GS-1491: ignore the task when it is filtered:\n\t\t\t\tif (!item) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(item.row_height && item.row_height !== globalRowHeight){\n\t\t\t\t\tcanUseSimpleCalc = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t},\n\t\tcanUseSimpleCalculation: function(){\n\t\t\tif(canUseSimpleCalc === -1){\n\t\t\t\tthis._refreshState();\n\t\t\t}\n\t\t\treturn canUseSimpleCalc;\n\t\t},\n\n\t\t/**\n\t\t * Get top coordinate by row index (order)\n\t\t * @param {number} index\n\t\t */\n\t\tgetRowTop: function(index){\n\t\t\tvar store = view.$config.rowStore;\n\t\t\tif(!store){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn index * this._getRowHeight();\n\t\t},\n\n\t\t/**\n\t\t * Get height of the item by item id\n\t\t * @param {*} itemId\n\t\t */\n\t\tgetItemHeight: function (itemId) {\n\t\t\treturn this._getRowHeight();\n\t\t},\n\n\t\t/**\n\t\t * Get total height of items\n\t\t */\n\t\tgetTotalHeight: function () {\n\t\t\tif(view.$config.rowStore){\n\t\t\t\tvar store = view.$config.rowStore;\n\t\t\t\treturn store.countVisible() * this._getRowHeight();\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get item by top position\n\t\t * @param {*} top\n\t\t */\n\t\tgetItemIndexByTopPosition: function (top) {\n\t\t\tif(view.$config.rowStore){\n\t\t\t\treturn Math.floor(top / this._getRowHeight());\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default createHelper;","const SENSITIVITY = 20;\nconst TIMEOUT = 50;\nconst SCROLLSTEP = 10;\n\nexport default class ScrollableGrid {\n\tpublic getCurrentX;\n\tprivate $gantt;\n\tprivate $grid;\n\tprivate _dnd;\n\tprivate _scrollView;\n\tprivate _scrollOrder: 0 | 1 | -1 = 0;\n\n\tconstructor(params) {\n\t\tconst {gantt, grid, dnd, getCurrentX} = params;\n\t\tthis.$gantt = gantt;\n\t\tthis.$grid = grid;\n\t\tthis._dnd = dnd;\n\t\tthis.getCurrentX = getCurrentX;\n\t\tthis._scrollView = this.$gantt.$ui.getView(this.$grid.$config.scrollX);\n\t\tthis.attachEvents();\n\t}\n\tattachEvents() {\n\t\tif (this.isScrollable()) {\n\t\t\tthis._dnd.attachEvent(\"onDragMove\", (obj, e) => {\n\t\t\t\tconst gridBoundingRect = this.$grid.$grid.getBoundingClientRect();\n\t\t\t\tconst maxLeft = gridBoundingRect.right;\n\t\t\t\tconst minLeft = gridBoundingRect.left;\n\t\t\t\tconst currentX = this.getCurrentX(e.clientX);\n\n\t\t\t\tif (currentX >= maxLeft - SENSITIVITY) {\n\t\t\t\t\tthis.autoscrollRight();\n\t\t\t\t\tthis.autoscrollStart();\n\t\t\t\t}\n\t\t\t\tif (currentX <= minLeft + SENSITIVITY) {\n\t\t\t\t\tthis.autoscrollLeft();\n\t\t\t\t\tthis.autoscrollStart();\n\t\t\t\t}\n\t\t\t\tif (currentX < maxLeft - SENSITIVITY && currentX > minLeft + SENSITIVITY) {\n\t\t\t\t\tthis.autoscrollStop();\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tthis._dnd.attachEvent(\"onDragEnd\", () => {\n\t\t\t\tthis.autoscrollStop();\n\t\t\t});\n\t\t}\n\t}\n\tautoscrollStart() {\n\t\tif (this._scrollOrder === 0) {\n\t\t\treturn;\n\t\t}\n\t\tconst scrollStep = SCROLLSTEP * this._scrollOrder;\n\t\tconst scrollState = this._scrollView.getScrollState();\n\t\tthis._scrollView.scrollTo(scrollState.position + scrollStep);\n\t\tsetTimeout(() => { this.autoscrollStart(); }, TIMEOUT);\n\t}\n\tautoscrollRight() {\n\t\tthis._scrollOrder = 1;\n\t}\n\tautoscrollLeft() {\n\t\tthis._scrollOrder = -1;\n\t}\n\tautoscrollStop() {\n\t\tthis._scrollOrder = 0;\n\t}\n\tgetCorrection() {\n\t\tif (!this.isScrollable()) {\n\t\t\treturn 0;\n\t\t}\n\t\treturn this._scrollView.getScrollState().position;\n\t}\n\tisScrollable() {\n\t\treturn !!this.$grid.$config.scrollable;\n\t}\n}","import * as domHelpers from \"../../utils/dom_helpers\";\nimport ScrollableGrid from \"./scrollable_grid\";\n\nconst COLUMN_ID_ATTR_NAME = \"data-column-id\";\n\nexport class ColumnsGridDnd {\n\tprivate $gantt;\n\tprivate $grid;\n\tprivate _dragX;\n\tprivate _dnd;\n\tprivate _originAutoscroll;\n\tprivate _scrollableGrid: ScrollableGrid;\n\tprivate _draggedCell;\n\tprivate _targetMarker = null;\n\tprivate _gridConfig;\n\tconstructor(gantt, grid) {\n\t\tthis.$gantt = gantt;\n\t\tthis.$grid = grid;\n\t}\n\tinit() {\n\t\tconst DND = this.$gantt.$services.getService(\"dnd\");\n\t\tthis._dnd = new DND(this.$grid.$grid_scale, { updates_per_second: 60 });\n\t\tthis._scrollableGrid = new ScrollableGrid({\n\t\t\tgantt: this.$gantt,\n\t\t\tgrid: this.$grid,\n\t\t\tdnd: this._dnd,\n\t\t\tgetCurrentX: this.calculateCurrentPosition\n\t\t});\n\t\tthis.attachEvents();\n\t}\n\tattachEvents() {\n\t\tthis._dnd.attachEvent(\"onBeforeDragStart\", (obj, e) => {\n\t\t\tthis._draggedCell = this.$gantt.utils.dom.closest(e.target, \".gantt_grid_head_cell\");\n\t\t\tif(!this._draggedCell){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst columns = this.$grid.$getConfig().columns;\n\t\t\tconst columnName = this._draggedCell.getAttribute(COLUMN_ID_ATTR_NAME);\n\t\t\tlet draggedColumn;\n\t\t\tlet draggedIndex;\n\t\t\tcolumns.map(function(column, index){\n\t\t\t\tif(column.name === columnName){\n\t\t\t\t\tdraggedColumn = column;\n\t\t\t\t\tdraggedIndex = index;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.$grid.callEvent(\"onBeforeColumnDragStart\", [{ draggedColumn, draggedIndex}]) === false) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this._draggedCell || !draggedColumn) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis._gridConfig = this.$grid.$getConfig();\n\t\t\tthis._originAutoscroll = this.$gantt.config.autoscroll;\n\t\t\tthis.$gantt.config.autoscroll = false;\n\t\t\treturn true;\n\t\t});\n\n\t\tthis._dnd.attachEvent(\"onAfterDragStart\", (obj, e) => {\n\t\t\tif (!this._draggedCell) {\n\t\t\t\treturn; // GS-1333: don't try to reorder a column when we resize it\n\t\t\t}\n\t\t\tthis._dnd.config.column = this._draggedCell.getAttribute(COLUMN_ID_ATTR_NAME);\n\t\t\tthis._dnd.config.marker.innerHTML = this._draggedCell.outerHTML;\n\t\t\tthis._dnd.config.marker.classList.add(\"gantt_column_drag_marker\");\n\t\t\tthis._dnd.config.marker.style.height = this._gridConfig.scale_height + \"px\";\n\t\t\tthis._dnd.config.marker.style.lineHeight = this._gridConfig.scale_height + \"px\";\n\t\t\tthis._draggedCell.classList.add(\"gantt_grid_head_cell_dragged\");\n\t\t});\n\n\t\tthis._dnd.attachEvent(\"onDragMove\", (obj, e) => {\n\t\t\tif(!this._draggedCell){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._dragX = e.clientX;\n\t\t\tconst x = this.calculateCurrentPosition(e.clientX);\n\t\t\tconst columnIndexes = this.findColumnsIndexes();\n\t\t\tthis.setMarkerPosition(x);\n\t\t\tthis.drawTargetMarker(columnIndexes);\n\t\t\treturn true;\n\t\t});\n\n\t\tthis._dnd.attachEvent(\"onDragEnd\", () => {\n\t\t\tif (!this._draggedCell) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst columnIndexes = this.findColumnsIndexes();\n\t\t\tconst targetIndex = columnIndexes.targetIndex;\n\t\t\tconst draggedIndex = columnIndexes.draggedIndex;\n\t\t\tconst columns = this.$grid.$getConfig().columns;\n\n\t\t\tconst draggedColumn = columns[draggedIndex];\n\t\t\tconst targetColumn = columns[targetIndex];\n\t\t\tif (this.$grid.callEvent(\"onColumnDragMove\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]) === false) {\n\t\t\t\tthis.cleanTargetMarker();\n\t\t\t\tthis.$gantt.render();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.$gantt.config.autoscroll = this._originAutoscroll;\n\t\t\tthis._draggedCell.classList.remove(\"gantt_grid_head_cell_dragged\");\n\t\t\tthis.cleanTargetMarker();\n\t\t\tthis.reorderColumns();\n\t\t});\n\n\t}\n\treorderColumns() {\n\t\tconst { targetIndex, draggedIndex } = this.findColumnsIndexes();\n\n\t\tconst columns = this.$grid.$getConfig().columns;\n\t\tconst draggedColumn = columns[draggedIndex];\n\t\tconst targetColumn = columns[targetIndex];\n\n\t\tif (this.$grid.callEvent(\"onBeforeColumnReorder\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]) === false) {\n\t\t\treturn;\n\t\t}\n\t\tif (targetIndex === draggedIndex) {\n\t\t\treturn;\n\t\t}\n\t\tcolumns.splice(draggedIndex, 1);\n\t\tcolumns.splice(targetIndex, 0, draggedColumn);\n\t\tthis.$gantt.render();\n\t\tthis.$grid.callEvent(\"onAfterColumnReorder\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]);\n\t}\n\tfindColumnsIndexes() {\n\t\tconst draggedId = this._dnd.config.column;\n\t\tconst columns = this.$grid.$getConfig().columns;\n\t\tlet targetIndex: number;\n\t\tlet draggedIndex: number;\n\t\tlet xBefore: number;\n\t\tlet xAfter: number;\n\t\tconst currentColumn = { startX: 0, endX: 0 };\n\n\t\tlet start = 0;\n\t\tlet end = columns.length - 1;\n\t\tlet compare = (a, b) => a <= b;\n\t\tlet next = (index) => ++index;\n\t\tif (this.$gantt.config.rtl) {\n\t\t\tstart = columns.length - 1;\n\t\t\tend = 0;\n\t\t\tcompare = (a, b) => a >= b;\n\t\t\tnext = (index) => --index;\n\t\t}\n\n\t\tlet columnRelativePos: number;\n\n\t\tconst relativeX = this._dragX - this.$grid.$grid.getBoundingClientRect().left + this._scrollableGrid.getCorrection();\n\t\tfor (let i = start; compare(i, end); i = next(i)) {\n\t\t\tif (targetIndex !== undefined && draggedIndex !== undefined) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(!columns[i].hide) {\n\t\t\t\tcurrentColumn.startX = currentColumn.endX;\n\t\t\t\tcurrentColumn.endX += columns[i].width;\n\n\t\t\t\t// if drop on a column or drop after the last column\n\t\t\t\tif (relativeX >= currentColumn.startX && (relativeX <= currentColumn.endX || !compare(next(i), end))) {\n\t\t\t\t\ttargetIndex = i;\n\t\t\t\t\txBefore = currentColumn.startX;\n\t\t\t\t\txAfter = currentColumn.endX;\n\t\t\t\t\tcolumnRelativePos = (relativeX - currentColumn.startX) / (currentColumn.endX - currentColumn.startX);\n\t\t\t\t}\n\t\t\t\tif (draggedId === columns[i].name) {\n\t\t\t\t\tdraggedIndex = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\ttargetIndex,\n\t\t\tdraggedIndex,\n\t\t\txBefore,\n\t\t\txAfter,\n\t\t\tcolumnRelativePos\n\t\t};\n\t}\n\tsetMarkerPosition(x: number, y: number = 10) {\n\t\tconst { marker } = this._dnd.config;\n\t\tconst gridOffset = this._dnd._obj.getBoundingClientRect();\n\t\tmarker.style.top = `${gridOffset.y + y}px`;\n\t\tmarker.style.left = `${x}px`;\n\t}\n\tcalculateCurrentPosition = (eventX: number) => {\n\t\tconst gridBoundingRect = this.$grid.$grid.getBoundingClientRect();\n\t\tconst maxLeft = gridBoundingRect.right;\n\t\tconst minLeft = gridBoundingRect.left;\n\t\tlet x = eventX;\n\t\tif (x > maxLeft) {\n\t\t\tx = maxLeft;\n\t\t}\n\t\tif (x < minLeft) {\n\t\t\tx = minLeft;\n\t\t}\n\t\treturn x;\n\t};\n\tdrawTargetMarker({ targetIndex, draggedIndex, xBefore, xAfter, columnRelativePos }) {\n\t\tif (!this._targetMarker) {\n\t\t\tthis._targetMarker = document.createElement(\"div\");\n\t\t\tdomHelpers.addClassName(this._targetMarker, \"gantt_grid_target_marker\");\n\t\t\tthis._targetMarker.style.display = \"none\";\n\t\t\tthis._targetMarker.style.height = `${this._gridConfig.scale_height}px`;\n\t\t}\n\n\t\t// marker can be detached after gantt.render\n\t\tif(!this._targetMarker.parentNode){\n\t\t\tthis.$grid.$grid_scale.appendChild(this._targetMarker);\n\t\t}\n\n\t\tlet nextPosition: number;\n\t\tif (targetIndex > draggedIndex) {\n\t\t\tnextPosition = xAfter;\n\t\t} else if (targetIndex < draggedIndex) {\n\t\t\tnextPosition = xBefore;\n\t\t} else {\n\t\t\tif(columnRelativePos > 0.5){\n\t\t\t\tnextPosition = xAfter;\n\t\t\t}else{\n\t\t\t\tnextPosition = xBefore;\n\t\t\t}\n\t\t}\n\n\t\tthis._targetMarker.style.left = `${nextPosition}px`;\n\t\tthis._targetMarker.style.display = \"block\";\n\t}\n\tcleanTargetMarker() {\n\t\tif (this._targetMarker && this._targetMarker.parentNode) {\n\t\t\tthis.$grid.$grid_scale.removeChild(this._targetMarker);\n\t\t}\n\t\tthis._targetMarker = null;\n\t}\n}","function create(gantt){\n\tvar events = [];\n\n\treturn {\n\t\tdelegate:function(event, className, handler, root) {\n\t\t\tevents.push([event, className, handler, root]);\n\n\t\t\tvar helper = gantt.$services.getService(\"mouseEvents\");\n\t\t\thelper.delegate(event, className, handler, root);\n\t\t},\n\t\tdestructor: function(){\n\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\n\t\t\tfor(var i = 0; i < events.length; i++){\n\t\t\t\tvar h = events[i];\n\t\t\t\tmouseEvents.detach(h[0], h[1], h[2], h[3]);\n\t\t\t}\n\t\t\tevents = [];\n\t\t}\n\t};\n}\n\nexport default create;","import * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport eventable from \"../../../utils/eventable\";\nimport gridResize from \"./grid_resize\";\nimport topPositionMixin from \"../row_position_mixin\";\nimport rowResize from \"./task_grid_row_resize\";\n\nimport ColumnDnd from \"../plugins/column_grid_dnd\";\n\nimport mouseEventContainer from \"../mouse_event_container\";\n\nvar Grid = function (parent, config, factory, gantt) {\n\tthis.$config = utils.mixin({}, config || {});\n\tthis.$gantt = gantt;\n\tthis.$parent = parent;\n\teventable(this);\n\tthis.$state = {};\n\tutils.mixin(this, topPositionMixin(this));\n};\n\n\nGrid.prototype = {\n\tinit: function(container) {\n\t\tvar gantt = this.$gantt;\n\t\tvar gridAriaAttr = gantt._waiAria.gridAttrString();\n\t\tvar gridDataAriaAttr = gantt._waiAria.gridDataAttrString();\n\t\tvar _ganttConfig = this.$getConfig();\n\t\tvar reorderColumns = _ganttConfig.reorder_grid_columns || false;\n\t\tif (this.$config.reorder_grid_columns !== undefined) {\n\t\t\treorderColumns = this.$config.reorder_grid_columns;\n\t\t}\n\n\n\t\tcontainer.innerHTML = \"<div class='gantt_grid' style='height:inherit;width:inherit;' \" + gridAriaAttr + \"></div>\";\n\t\tthis.$grid = container.childNodes[0];\n\n\t\tthis.$grid.innerHTML = \"<div class='gantt_grid_scale' \" +\n\t\t\tgantt._waiAria.gridScaleRowAttrString() + \"></div><div class='gantt_grid_data' \" + gridDataAriaAttr + \"></div>\";\n\n\t\tthis.$grid_scale = this.$grid.childNodes[0];\n\t\tthis.$grid_data = this.$grid.childNodes[1];\n\n\t\tvar attr = _ganttConfig[this.$config.bind + \"_attribute\"];\n\t\tif (!attr && this.$config.bind) {\n\t\t\tattr = \"data-\" + this.$config.bind + \"-id\";\n\t\t}\n\t\tthis.$config.item_attribute = attr || null;\n\n\t\tif (!this.$config.layers) {\n\t\t\tvar layers = this._createLayerConfig();\n\t\t\tthis.$config.layers = layers;\n\t\t}\n\n\t\tvar resizer = gridResize(gantt, this);\n\t\tresizer.init();\n\t\tthis._renderHeaderResizers = resizer.doOnRender;\n\t\tthis._mouseDelegates = mouseEventContainer(gantt);\n\n\t\tvar resizerrow = rowResize(gantt, this);\n\t\tresizerrow.init();\n\n\t\tthis._addLayers(this.$gantt);\n\t\tthis._initEvents();\n\n\t\tif (reorderColumns) {\n\t\t\tthis._columnDND = new ColumnDnd(gantt, this);\n\t\t\tthis._columnDND.init();\n\t\t}\n\n\t\tthis.callEvent(\"onReady\", []);\n\t\t//this.refresh();\n\t},\n\n\t_validateColumnWidth: function (column, property) {\n\t\t// user can set {name:\"text\", width:\"200\",...} for some reason,\n\t\t// check and convert it to number when possible\n\t\tvar value = column[property];\n\t\tif (value && value != \"*\") {\n\t\t\tvar gantt = this.$gantt;\n\t\t\tvar numericWidth = value * 1;\n\t\t\tif (isNaN(numericWidth)) {\n\t\t\t\tgantt.assert(false, \"Wrong \" + property + \" value of column \" + column.name);\n\t\t\t} else {\n\t\t\t\tcolumn[property] = numericWidth;\n\t\t\t}\n\t\t}\n\t},\n\n\tsetSize: function (width, height) {\n\t\tthis.$config.width = this.$state.width = width;\n\t\tthis.$config.height = this.$state.height = height;\n\n\t\t// TODO: maybe inherit and override in a subclass instead of extending here\n\n\t\tvar columns = this.getGridColumns(),\n\t\t\tinnerWidth = 0;\n\n\t\tvar config = this.$getConfig();\n\t\tvar elasticColumns = config.grid_elastic_columns;\n\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\tthis._validateColumnWidth(columns[i], \"min_width\");\n\t\t\tthis._validateColumnWidth(columns[i], \"max_width\");\n\t\t\tthis._validateColumnWidth(columns[i], \"width\");\n\n\t\t\tinnerWidth += columns[i].width * 1;\n\t\t}\n\n\t\tvar outerWidth;\n\t\tif (isNaN(innerWidth) || !this.$config.scrollable) {\n\t\t\touterWidth = this._setColumnsWidth(width + 1);\n\t\t\tinnerWidth = outerWidth;\n\t\t}\n\n\t\tif(this.$config.scrollable && elasticColumns && !isNaN(innerWidth)){\n\t\t\t// GS-1352: Allow resizing the grid columns, then the grid width is increased\n\t\t\t// or keep the grid width, but don't allow column resize to affect the grid width\n\t\t\tlet columnProperty = \"width\";\n\t\t\tif (elasticColumns == \"min_width\"){\n\t\t\t\tcolumnProperty = \"min_width\";\n\t\t\t}\n\t\t\tlet newColumnWidth = 0;\n\t\t\tcolumns.forEach(function(col){\n\t\t\t\tnewColumnWidth += col[columnProperty] || config.min_grid_column_width;\n\t\t\t});\n\t\t\t//newColumnWidth--; // the total column width shouldn't match the outerWidth // GS-2190 reducing width seems to be not needed\n\t\t\tvar columnsWidth = Math.max(newColumnWidth, width);\n\t\t\tinnerWidth = this._setColumnsWidth(columnsWidth);\n\t\t\touterWidth = width;\n\t\t}\n\n\t\tif (this.$config.scrollable) {\n\t\t\tthis.$grid_scale.style.width = innerWidth + \"px\";\n\t\t\tthis.$grid_data.style.width = innerWidth + \"px\";\n\t\t} else {\n\t\t\tthis.$grid_scale.style.width = \"inherit\";\n\t\t\tthis.$grid_data.style.width = \"inherit\";\n\t\t}\n\t\tthis.$config.width -= 1;\n\n\t\tvar config = this.$getConfig();\n\t\tif (outerWidth !== width) {\n\t\t\tif(outerWidth !== undefined){\n\t\t\t\tconfig.grid_width = outerWidth;\n\t\t\t\tthis.$config.width = outerWidth - 1;\n\t\t\t}else{\n\t\t\t\tif(!isNaN(innerWidth)){\n\t\t\t\t\tthis._setColumnsWidth(innerWidth);\n\t\t\t\t\tconfig.grid_width = innerWidth;\n\t\t\t\t\tthis.$config.width = innerWidth - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar dataHeight = Math.max(this.$state.height - config.scale_height, 0);\n\t\tthis.$grid_data.style.height = dataHeight + \"px\";\n\t\tthis.refresh();\n\t},\n\tgetSize: function () {\n\n\t\tvar config = this.$getConfig();\n\n\t\tvar store = this.$config.rowStore;\n\n\t\tvar contentHeight = store ? this.getTotalHeight() : 0,\n\t\t\tcontentWidth = this._getGridWidth();\n\n\t\tvar size = {\n\t\t\tx: this.$state.width,\n\t\t\ty: this.$state.height,\n\t\t\tcontentX: this.isVisible() ? contentWidth : 0,\n\t\t\tcontentY: this.isVisible() ? (config.scale_height + contentHeight) : 0,\n\t\t\tscrollHeight: this.isVisible() ? contentHeight : 0,\n\t\t\tscrollWidth: this.isVisible() ? contentWidth : 0\n\t\t};\n\n\t\treturn size;\n\t},\n\n\t_bindStore: function () {\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tthis.$config.rowStore = rowStore;\n\t\t\tif(rowStore && !rowStore._gridCacheAttached){\n\t\t\t\tvar self = this;\n\t\t\t\trowStore._gridCacheAttached = rowStore.attachEvent(\"onBeforeFilter\", function(){\n\t\t\t\t\tself._resetTopPositionHeight();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\t_unbindStore: function(){\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tif(rowStore && rowStore._gridCacheAttached){\n\t\t\t\trowStore.detachEvent(rowStore._gridCacheAttached);\n\t\t\t\trowStore._gridCacheAttached = false;\n\t\t\t}\n\t\t}\n\t},\n\n\trefresh: function () {\n\t\tthis._bindStore();\n\n\t\tthis._resetTopPositionHeight();\n\t\tthis._resetHeight();\n\t\tthis._initSmartRenderingPlaceholder();\n\n\t\tthis._calculateGridWidth();\n\t\tthis._renderGridHeader();\n\t},\n\n\tgetViewPort: function(){\n\t\tvar scrollLeft = this.$config.scrollLeft || 0;\n\t\tvar scrollTop = this.$config.scrollTop || 0;\n\t\tvar height = this.$config.height || 0;\n\t\tvar width = this.$config.width || 0;\n\t\treturn {\n\t\t\ty: scrollTop,\n\t\t\ty_end: scrollTop + height,\n\t\t\tx: scrollLeft,\n\t\t\tx_end: scrollLeft + width,\n\t\t\theight: height,\n\t\t\twidth: width\n\t\t};\n\t},\n\n\tscrollTo: function (left, top) {\n\t\tif (!this.isVisible())\n\t\t\treturn;\n\n\t\tvar scrolled = false;\n\n\t\tthis.$config.scrollTop = this.$config.scrollTop || 0;\n\t\tthis.$config.scrollLeft = this.$config.scrollLeft || 0;\n\n\t\tif (left * 1 == left) {\n\t\t\tthis.$config.scrollLeft = this.$state.scrollLeft = this.$grid.scrollLeft = left;\n\t\t\tscrolled = true;\n\t\t}\n\n\t\t// var config = this.$getConfig();\n\t\tif (top * 1 == top) {\n\t\t\tthis.$config.scrollTop = this.$state.scrollTop = this.$grid_data.scrollTop = top;\n\t\t\tscrolled = true;\n\t\t}\n\n\t\tif(scrolled){\n\t\t\tthis.callEvent(\"onScroll\", [this.$config.scrollLeft, this.$config.scrollTop]);\n\t\t}\n\t},\n\n\tgetColumnIndex: function (name, excludeHidden) {\n\t\tvar columns = this.$getConfig().columns;\n\t\tvar hiddenIndexShift = 0;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\t// GS-1257. If the cell is hidden, the target column index should be correct\n\t\t\tif (excludeHidden && columns[i].hide){\n\t\t\t\thiddenIndexShift++;\n\t\t\t}\n\t\t\tif (columns[i].name == name) {\n\t\t\t\treturn i - hiddenIndexShift;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\n\tgetColumn: function (name) {\n\t\tvar index = this.getColumnIndex(name);\n\t\tif (index === null) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this.$getConfig().columns[index];\n\t},\n\n\tgetGridColumns: function () {\n\t\tvar config = this.$getConfig();\n\t\treturn config.columns.slice();\n\t},\n\tisVisible: function () {\n\t\tif (this.$parent && this.$parent.$config) {\n\t\t\treturn !this.$parent.$config.hidden;\n\t\t} else {\n\t\t\treturn this.$grid.offsetWidth;\n\t\t}\n\t},\n\n\t// getItemHeight: function () {\n\t// \tvar config = this.$getConfig();\n\t// \treturn config.row_height;\n\t// },\n\n\t_createLayerConfig: function () {\n\t\tvar gantt = this.$gantt;\n\t\tvar self = this;\n\t\tvar layers = [\n\t\t\t{\n\t\t\t\trenderer: gantt.$ui.layers.gridLine(),\n\t\t\t\tcontainer: this.$grid_data,\n\t\t\t\tfilter: [function () {\n\t\t\t\t\treturn self.isVisible();\n\t\t\t\t}]\n\t\t\t},\n\t\t\t{\n\t\t\t\trenderer: gantt.$ui.layers.gridTaskRowResizer(),\n\t\t\t\tcontainer: this.$grid_data,\n\t\t\t\tappend: true,\n\t\t\t\tfilter: [function () {\n\t\t\t\t\treturn gantt.config.resize_rows;\n\t\t\t\t}]\n\t\t\t}\n\t\t];\n\t\treturn layers;\n\t},\n\n\t_addLayers: function (gantt) {\n\t\tif (!this.$config.bind)\n\t\t\treturn;\n\n\t\tthis._taskLayers = [];\n\n\t\tvar self = this;\n\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\n\t\tif (!taskRenderer) {\n\t\t\ttaskRenderer = layers.createDataRender({\n\t\t\t\tname: this.$config.bind,\n\t\t\t\tdefaultContainer: function () { return self.$grid_data; }\n\t\t\t});\n\t\t}\n\n\t\tvar taskLayers = this.$config.layers;\n\t\tfor (var i = 0; taskLayers && i < taskLayers.length; i++) {\n\t\t\tvar layer = taskLayers[i];\n\t\t\tlayer.view = this;\n\n\t\t\tvar bar_layer = taskRenderer.addLayer(layer);\n\t\t\tthis._taskLayers.push(bar_layer);\n\t\t}\n\n\t\tthis._bindStore();\n\n\t\tthis._initSmartRenderingPlaceholder();\n\t},\n\n\t_refreshPlaceholderOnStoreUpdate: function (id) {\n\t\tvar config = this.$getConfig(),\n\t\t\tstore = this.$config.rowStore;\n\n\t\tif (!store || id !== null || !this.isVisible() || !config.smart_rendering) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar contentHeight;\n\t\tif (this.$config.scrollY) {\n\t\t\tvar scroll = this.$gantt.$ui.getView(this.$config.scrollY);\n\t\t\tif (scroll)\n\t\t\t\tcontentHeight = scroll.getScrollState().scrollSize;\n\t\t}\n\n\t\tif (!contentHeight) {\n\t\t\tcontentHeight = store ? this.getTotalHeight() : 0;\n\t\t}\n\n\t\tif (contentHeight) {\n\t\t\tif (this.$rowsPlaceholder && this.$rowsPlaceholder.parentNode) {\n\t\t\t\tthis.$rowsPlaceholder.parentNode.removeChild(this.$rowsPlaceholder);\n\t\t\t}\n\n\t\t\tvar placeholder = this.$rowsPlaceholder = document.createElement(\"div\");\n\t\t\tplaceholder.style.visibility = \"hidden\";\n\t\t\tplaceholder.style.height = contentHeight + \"px\";\n\t\t\tplaceholder.style.width = \"1px\";\n\t\t\tthis.$grid_data.appendChild(placeholder);\n\t\t}\n\t},\n\n\t_initSmartRenderingPlaceholder: function () {\n\t\tvar store = this.$config.rowStore;\n\t\tif (!store) {\n\t\t\treturn;\n\t\t} else {\n\t\t\tthis._initSmartRenderingPlaceholder = function () { };\n\t\t}\n\t\tthis._staticBgHandler = store.attachEvent(\"onStoreUpdated\", utils.bind(this._refreshPlaceholderOnStoreUpdate, this));\n\t},\n\n\t_initEvents: function () {\n\t\tvar gantt = this.$gantt;\n\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_close\", gantt.bind(function (e, id, trg) {\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tif (!store) return true;\n\n\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\n\t\t\tif (target) {\n\t\t\t\tstore.close(target.getAttribute(this.$config.item_attribute));\n\n\t\t\t}\n\t\t\treturn false;\n\t\t}, this), this.$grid);\n\n\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_open\", gantt.bind(function (e, id, trg) {\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tif (!store) return true;\n\n\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\n\t\t\tif (target) {\n\t\t\t\tstore.open(target.getAttribute(this.$config.item_attribute));\n\n\t\t\t}\n\t\t\treturn false;\n\t\t}, this), this.$grid);\n\t},\n\n\t_clearLayers: function (gantt) {\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\n\t\tif (this._taskLayers) {\n\t\t\tfor (var i = 0; i < this._taskLayers.length; i++) {\n\t\t\t\ttaskRenderer.removeLayer(this._taskLayers[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis._taskLayers = [];\n\t},\n\n\t_getColumnWidth: function (column, config, width) {\n\t\tvar min_width = column.min_width || config.min_grid_column_width;\n\t\tvar new_width = Math.max(width, min_width || 10);\n\t\tif (column.max_width)\n\t\t\tnew_width = Math.min(new_width, column.max_width);\n\t\treturn new_width;\n\t},\n\t// set min width only if width < than config.min_grid_column_width\n\t_checkGridColumnMinWidthLimits: function (columns, config) {\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\tvar width = columns[i].width * 1;\n\t\t\tif (!columns[i].min_width && width < config.min_grid_column_width){\n\t\t\t\tcolumns[i].min_width = width;\n\t\t\t}\n\t\t}\n\t},\n\t// return min and max possible grid width according to restricts\n\t_getGridWidthLimits: function () {\n\t\tvar config = this.$getConfig(),\n\t\t\tcolumns = this.getGridColumns(),\n\t\t\tmin_limit = 0,\n\t\t\tmax_limit = 0;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tmin_limit += columns[i].min_width ? columns[i].min_width : config.min_grid_column_width;\n\t\t\tif (max_limit !== undefined) {\n\t\t\t\tmax_limit = columns[i].max_width ? (max_limit + columns[i].max_width) : undefined;\n\t\t\t}\n\t\t}\n\t\tthis._checkGridColumnMinWidthLimits(columns, config); // FIX ME: should it be before calculating limits?\n\t\treturn [min_limit, max_limit];\n\t},\n\t// resize columns to get total newWidth, starting from columns[start_index]\n\t_setColumnsWidth: function (newWidth, start_index) {\n\t\tvar config = this.$getConfig();\n\t\tvar columns = this.getGridColumns(),\n\t\t\tcolumns_width = 0,\n\t\t\tfinal_width = newWidth;\n\n\t\tstart_index = !window.isNaN(start_index) ? start_index : -1;\n\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\tcolumns_width += columns[i].width * 1;\n\t\t}\n\n\t\tif (window.isNaN(columns_width)) {\n\t\t\tthis._calculateGridWidth();\n\t\t\tcolumns_width = 0;\n\t\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\t\tcolumns_width += columns[i].width * 1;\n\t\t\t}\n\t\t}\n\n\t\tvar extra_width = final_width - columns_width;\n\n\t\tvar start_width = 0;\n\t\tfor (var i = 0; i < start_index + 1; i++) {\n\t\t\tstart_width += columns[i].width;\n\t\t}\n\n\t\tcolumns_width -= start_width;\n\n\t\tfor (var i = start_index + 1; i < columns.length; i++) {\n\n\t\t\tvar col = columns[i];\n\t\t\tvar share = Math.round(extra_width * (col.width / columns_width));\n\n\t\t\t// columns have 2 additional restrict fields - min_width & max_width that are set by user\n\t\t\tif (extra_width < 0) {\n\t\t\t\tif (col.min_width && col.width + share < col.min_width)\n\t\t\t\t\tshare = col.min_width - col.width;\n\t\t\t\telse if (!col.min_width && config.min_grid_column_width && col.width + share < config.min_grid_column_width)\n\t\t\t\t\tshare = config.min_grid_column_width - col.width;\n\t\t\t} else if (col.max_width && col.width + share > col.max_width)\n\t\t\t\tshare = col.max_width - col.width;\n\n\t\t\tcolumns_width -= col.width;\n\t\t\tcol.width += share;\n\t\t\textra_width -= share;\n\n\t\t}\n\n\t\tvar iterator = extra_width > 0 ? 1 : -1;\n\t\twhile ((extra_width > 0 && iterator === 1) || (extra_width < 0 && iterator === -1)) {\n\t\t\tvar curExtra = extra_width;\n\t\t\tfor (i = start_index + 1; i < columns.length; i++) {\n\t\t\t\tvar new_width = columns[i].width + iterator;\n\n\t\t\t\tif (new_width == this._getColumnWidth(columns[i], config, new_width)) {\n\t\t\t\t\textra_width -= iterator;\n\t\t\t\t\tcolumns[i].width = new_width;\n\t\t\t\t}\n\n\t\t\t\tif (!extra_width)\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif (curExtra == extra_width)\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// if impossible to resize the right-side columns, resize the start column\n\t\tif (extra_width && start_index > -1) {\n\t\t\tvar new_width = columns[start_index].width + extra_width;\n\t\t\tif (new_width == this._getColumnWidth(columns[start_index], config, new_width))\n\t\t\t\tcolumns[start_index].width = new_width;\n\t\t}\n\n\t\t//if (this.callEvent(\"onGridResizeEnd\", [config.grid_width, final_width]) === false)\n\t\t//\treturn;\n\n\t\treturn this._getColsTotalWidth();\n\t},\n\n\t_getColsTotalWidth: function () {\n\t\tvar columns = this.getGridColumns();\n\t\tvar cols_width = 0;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar v = parseFloat(columns[i].width);\n\t\t\tif (window.isNaN(v)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tcols_width += v;\n\t\t}\n\t\treturn cols_width;\n\t},\n\t_calculateGridWidth: function () {\n\t\tvar config = this.$getConfig();\n\t\tvar columns = this.getGridColumns();\n\t\tvar cols_width = 0;\n\t\tvar unknown = [];\n\t\tvar width = [];\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar v = parseFloat(columns[i].width);\n\t\t\tif (window.isNaN(v)) {\n\t\t\t\tv = config.min_grid_column_width || 10;\n\t\t\t\tunknown.push(i);\n\t\t\t}\n\t\t\twidth[i] = v;\n\t\t\tcols_width += v;\n\t\t}\n\t\tvar gridWidth = this._getGridWidth() + 1;\n\t\tif (config.autofit || unknown.length) {\n\t\t\tvar diff = gridWidth - cols_width;\n\t\t\t// TODO: logic may be improved for proportional changing of width\n\n\t\t\t// autofit adjusts columns widths to the outer grid width\n\t\t\t// it doesn't makes sense if grid has inner scroll with elastic columns\n\t\t\tif (config.autofit && !config.grid_elastic_columns) {\n\t\t\t\t// delta must be added for all columns\n\t\t\t\tfor (var i = 0; i < width.length; i++) {\n\t\t\t\t\tvar delta = Math.round(diff / (width.length - i));\n\t\t\t\t\twidth[i] += delta;\n\t\t\t\t\tvar new_width = this._getColumnWidth(columns[i], config, width[i]);\n\n\t\t\t\t\tif (new_width != width[i]) {\n\t\t\t\t\t\tdelta = new_width - width[i];\n\t\t\t\t\t\twidth[i] = new_width;\n\t\t\t\t\t}\n\t\t\t\t\tdiff -= delta;\n\t\t\t\t}\n\t\t\t} else if (unknown.length) {\n\t\t\t\t// there are several columns with undefined width\n\t\t\t\tfor (var i = 0; i < unknown.length; i++) {\n\t\t\t\t\tvar delta = Math.round(diff / (unknown.length - i)); // no float values, just integer\n\t\t\t\t\tvar index = unknown[i];\n\t\t\t\t\twidth[index] += delta;\n\t\t\t\t\tvar new_width = this._getColumnWidth(columns[index], config, width[index]);\n\t\t\t\t\tif (new_width != width[index]) {\n\t\t\t\t\t\tdelta = new_width - width[index];\n\t\t\t\t\t\twidth[index] = new_width;\n\t\t\t\t\t}\n\t\t\t\t\tdiff -= delta;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < width.length; i++) {\n\t\t\t\tcolumns[i].width = width[i];\n\t\t\t}\n\t\t} else {\n\t\t\tvar changed = (gridWidth != cols_width);\n\t\t\tthis.$config.width = cols_width - 1;\n\t\t\tconfig.grid_width = cols_width;\n\t\t\tif (changed) {\n\t\t\t\tthis.$parent._setContentSize(this.$config.width, null);\n\t\t\t}\n\t\t}\n\n\t},\n\n\t_renderGridHeader: function () {\n\t\tvar gantt = this.$gantt;\n\t\tvar config = this.$getConfig();\n\t\tvar locale = this.$gantt.locale;\n\t\tvar templates = this.$gantt.templates;\n\n\t\tvar columns = this.getGridColumns();\n\t\tif (config.rtl) {\n\t\t\tcolumns = columns.reverse();\n\t\t}\n\t\tvar cells = [];\n\t\tvar width = 0,\n\t\t\tlabels = locale.labels;\n\n\t\tvar lineHeigth = config.scale_height - 1;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar last = i == columns.length - 1;\n\t\t\tvar col = columns[i];\n\n\t\t\t// ensure columns have non-empty names\n\t\t\tif (!col.name) {\n\t\t\t\tcol.name = gantt.uid() + \"\";\n\t\t\t}\n\n\t\t\tvar colWidth = col.width * 1;\n\n\t\t\tvar gridWidth = this._getGridWidth();\n\t\t\tif (last && gridWidth > width + colWidth)\n\t\t\t\tcol.width = colWidth = gridWidth - width;\n\t\t\twidth += colWidth;\n\t\t\tvar sort = (gantt._sort && col.name == gantt._sort.name) ? (`<div data-column-id=\"${col.name}\" class=\"gantt_sort gantt_${gantt._sort.direction}\"></div>`) : \"\";\n\t\t\tvar cssClass = [\"gantt_grid_head_cell\",\n\t\t\t\t(\"gantt_grid_head_\" + col.name),\n\t\t\t\t(last ? \"gantt_last_cell\" : \"\"),\n\t\t\t\ttemplates.grid_header_class(col.name, col)].join(\" \");\n\n\t\t\tvar style = \"width:\" + (colWidth - (last ? 1 : 0)) + \"px;\";\n\t\t\tvar label = (col.label || labels[\"column_\" + col.name] || labels[col.name]);\n\t\t\tlabel = label || \"\";\n\n\t\t\tvar ariaAttrs = gantt._waiAria.gridScaleCellAttrString(col, label);\n\n\t\t\tvar cell = \"<div class='\" + cssClass + \"' style='\" + style + \"' \" + ariaAttrs + \n\t\t\t\t\" data-column-id='\" + col.name + \"' column_id='\" + col.name + \"'\" +\n\t\t\t\t\" data-column-name='\" + col.name + \"' data-column-index='\" + i + \"'\" +\n\t\t\t\t\">\" + label + sort + \"</div>\";\n\t\t\tcells.push(cell);\n\t\t}\n\t\tthis.$grid_scale.style.height = (config.scale_height) + \"px\";\n\t\tthis.$grid_scale.style.lineHeight = lineHeigth + \"px\";\n\t\t//this.$grid_scale.style.width = \"inherit\";\n\t\tthis.$grid_scale.innerHTML = cells.join(\"\");\n\n\t\tif (this._renderHeaderResizers) {\n\t\t\tthis._renderHeaderResizers();\n\t\t}\n\t},\n\n\t_getGridWidth: function () {\n\t\t// TODO: refactor/remove/comment some of _getGridWidth/this.$config.width/this.$state.width, it's not clear what they do\n\t\treturn this.$config.width;\n\t},\n\n\tdestructor: function () {\n\t\tthis._clearLayers(this.$gantt);\n\t\tif (this._mouseDelegates) {\n\t\t\tthis._mouseDelegates.destructor();\n\t\t\tthis._mouseDelegates = null;\n\t\t}\n\t\tthis._unbindStore();\n\t\tthis.$grid = null;\n\t\tthis.$grid_scale = null;\n\t\tthis.$grid_data = null;\n\t\tthis.$gantt = null;\n\t\tif (this.$config.rowStore) {\n\t\t\tthis.$config.rowStore.detachEvent(this._staticBgHandler);\n\t\t\tthis.$config.rowStore = null;\n\t\t}\n\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\t}\n};\n\nexport default Grid;\n","import * as helpers from \"../../utils/helpers\";\n\nexport default function(gantt) {\n\tgantt.load = function(){\n\t\tthrow new Error(\"gantt.load() method is not available in the node.js, use gantt.parse() instead\");\n\t};\n\tgantt.parse = function (data, type) {\n\t\tthis.on_load({xmlDoc: {responseText: data}}, type);\n\t};\n\n\tgantt.serialize = function (type) {\n\t\ttype = type || \"json\";\n\t\treturn this[type].serialize();\n\t};\n\n\t/*\n\ttasks and relations\n\t{\n\tdata:[\n\t\t{\n\t\t\t\"id\":\"string\",\n\t\t\t\"text\":\"...\",\n\t\t\t\"start_date\":\"Date or string\",\n\t\t\t\"end_date\":\"Date or string\",\n\t\t\t\"duration\":\"number\",\n\t\t\t\"progress\":\"0..1\",\n\t\t\t\"parent_id\":\"string\",\n\t\t\t\"order\":\"number\"\n\t\t},...],\n\tlinks:[\n\t\t{\n\t\t\tid:\"string\",\n\t\t\tsource:\"string\",\n\t\t\ttarget:\"string\",\n\t\t\ttype:\"string\"\n\t\t},...],\n\tcollections:{\n\t\t\tcollectionName:[\n\t\t\t\t{key:, label:, optional:...},...\n\t\t\t],...\n\t\t}\n\t}\n\n\t* */\n\n\tgantt.on_load = function (resp, type) {\n\t\tif(resp.xmlDoc && resp.xmlDoc.status === 404){ // work if we don't have a file at current url\n\t\t\tthis.assert(false, \"Failed to load the data from <a href='\" + resp.xmlDoc.responseURL + \"' target='_blank'>\" \n\t\t\t\t+ resp.xmlDoc.responseURL + \"</a>, server returns 404\");\n\t\t\treturn;\n\t\t}\n\t\tif(gantt.$destroyed){\n\t\t\treturn;\n\t\t}\n\t\tthis.callEvent(\"onBeforeParse\", []);\n\t\tif (!type)\n\t\t\ttype = \"json\";\n\t\tthis.assert(this[type], \"Invalid data type:'\" + type + \"'\");\n\n\t\tvar raw = resp.xmlDoc.responseText;\n\n\t\tvar data = this[type].parse(raw, resp);\n\t\tthis._process_loading(data);\n\t};\n\n\tfunction attachAssignmentsToTasks(tasks, assignments) {\n\t\tconst assignmentsByTasks = {};\n\t\tassignments.forEach((a)=>{\n\t\t\tif(!assignmentsByTasks[a.task_id]) {\n\t\t\t\tassignmentsByTasks[a.task_id] = [];\n\t\t\t}\n\t\t\tassignmentsByTasks[a.task_id].push(a);\n\t\t});\n\t\ttasks.forEach((t) => {\n\t\t\tt[gantt.config.resource_property] = assignmentsByTasks[t.id] || [];\n\t\t});\t\n\t}\n\t\n\tgantt._process_loading = function (data) {\n\t\tif(data.collections)\n\t\t\tthis._load_collections(data.collections);\n\n\t\tif(data.resources && this.$data.resourcesStore){\n\t\t\tthis.$data.resourcesStore.parse(data.resources);\n\t\t}\n\t\tif(gantt.config.baselines && data.baselines && this.$data.baselineStore){\n\t\t\tthis.$data.baselineStore.parse(data.baselines);\n\t\t}\n\t\t\n\t\tconst tasks = data.data || data.tasks;\n\t\tif(data.assignments){\n\t\t\tattachAssignmentsToTasks(tasks, data.assignments);\n\t\t}\n\n\t\tthis.$data.tasksStore.parse(tasks);\n\t\tvar links = data.links || ((data.collections && data.collections.links) ? data.collections.links : []);\n\t\tthis.$data.linksStore.parse(links);\n\n\t\t//this._sync_links();\n\t\tthis.callEvent(\"onParse\", []);\n\t\tthis.render();\n\t};\n\n\tgantt._load_collections = function (collections) {\n\t\tvar collections_loaded = false;\n\t\tfor (var key in collections) {\n\t\t\tif (collections.hasOwnProperty(key)) {\n\t\t\t\tcollections_loaded = true;\n\t\t\t\tvar collection = collections[key];\n\t\t\t\t// GS-1728. Create an empty serverList if it doesn't exist\n\t\t\t\tthis.serverList[key] = this.serverList[key] || [];\n\t\t\t\tvar arr = this.serverList[key];\n\t\t\t\tif (!arr) continue;\n\t\t\t\tarr.splice(0, arr.length); //clear old options\n\t\t\t\tfor (var j = 0; j < collection.length; j++) {\n\t\t\t\t\tvar option = collection[j];\n\t\t\t\t\tvar obj = this.copy(option);\n\t\t\t\t\tobj.key = obj.value;// resulting option object\n\n\t\t\t\t\tfor (var option_key in option) {\n\t\t\t\t\t\tif (option.hasOwnProperty(option_key)) {\n\t\t\t\t\t\t\tif (option_key == \"value\" || option_key == \"label\")\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\tobj[option_key] = option[option_key]; // obj['value'] = option['value']\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tarr.push(obj);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (collections_loaded)\n\t\t\tthis.callEvent(\"onOptionsLoad\", []);\n\t};\n\n\tgantt.attachEvent(\"onBeforeTaskDisplay\", function (id, task) {\n\t\treturn !task.$ignore;\n\t});\n\n\tfunction jsonParseError(data){\n\t\tgantt.assert(false, \"Can't parse data: incorrect value of gantt.parse or gantt.load method. \"\n\t\t\t+ \"Actual argument value: \" + JSON.stringify(data));\n\t\tthrow new Error(\"Invalid argument for gantt.parse or gantt.load. An object or a JSON string of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#json is expected. Actual argument value: \"\n\t\t\t+ JSON.stringify(data));\n\t}\n\n\tgantt.json = {\n\t\tparse: function (data) {\n\t\t\tif(!data){\n\t\t\t\tjsonParseError(data);\n\t\t\t}\n\n\t\t\tif (typeof data == \"string\") {\n\t\t\t\tif (typeof JSON != undefined){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t\t}\n\t\t\t\t\tcatch(e) {\n\t\t\t\t\t\tjsonParseError(data);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tgantt.assert(false, \"JSON is not supported\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!data.data && !data.tasks){\n\t\t\t\tjsonParseError(data);\n\t\t\t}\n\n\t\t\tif (data.dhx_security)\n\t\t\t\tgantt.security_key = data.dhx_security;\n\t\t\treturn data;\n\t\t},\n\t\tserializeTask: function (task) {\n\t\t\treturn this._copyObject(task);\n\t\t},\n\t\tserializeLink: function (link) {\n\t\t\treturn this._copyLink(link);\n\t\t},\n\t\t_copyLink: function (obj) {\n\t\t\tvar copy = {};\n\t\t\tfor (var key in obj)\n\t\t\t\tcopy[key] = obj[key];\n\t\t\treturn copy;\n\t\t},\n\t\t_copyObject: function (obj) {\n\t\t\tvar copy = {};\n\t\t\tfor (var key in obj) {\n\t\t\t\tif (key.charAt(0) == \"$\")\n\t\t\t\t\tcontinue;\n\t\t\t\tcopy[key] = obj[key];\n\n\t\t\t\tif (helpers.isDate(copy[key])) {\n\t\t\t\t\tcopy[key] = gantt.defined(gantt.templates.xml_format) ? gantt.templates.xml_format(copy[key]) : gantt.templates.format_date(copy[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn copy;\n\t\t},\n\t\tserialize: function () {\n\t\t\tvar tasks = [];\n\t\t\tvar links = [];\n\t\t\tlet baselines = [];\n\n\t\t\tgantt.eachTask(function (obj) {\n\t\t\t\tgantt.resetProjectDates(obj);\n\t\t\t\ttasks.push(this.serializeTask(obj));\n\t\t\t}, gantt.config.root_id, this);\n\n\t\t\tvar rawLinks = gantt.getLinks();\n\t\t\tfor (var i = 0; i < rawLinks.length; i++) {\n\t\t\t\tlinks.push(this.serializeLink(rawLinks[i]));\n\t\t\t}\n\n\t\t\tconst baselineStore = gantt.getDatastore(\"baselines\");\n\t\t\tbaselineStore.eachItem(function(baseline){\n\t\t\t\tconst baselineCopy = gantt.json.serializeTask(baseline);\n\t\t\t\tbaselines.push(baselineCopy);\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\tdata: tasks,\n\t\t\t\tlinks,\n\t\t\t\tbaselines\n\t\t\t};\n\t\t}\n\t};\n\n\t/*\n\t<data>\n\t\t<task id:\"some\" parent_id=\"0\" progress=\"0.5\">\n\t\t\t<text>My task 1</text>\n\t\t\t<start_date>16.08.2013</start_date>\n\t\t\t<end_date>22.08.2013</end_date>\n\t\t</task>\n\t\t<coll_options>\n\t\t\t<links>\n\t\t\t\t<link source='a1' target='b2' type='c3' />\n\t\t\t</links>\n\t\t</coll_options>\n\t</data>\n\t*/\n\n\tfunction xmlParseError(data){\n\t\tgantt.assert(false, \"Can't parse data: incorrect value of gantt.parse or gantt.load method. \"\n\t\t\t+ \"Actual argument value: \" + JSON.stringify(data));\n\t\tthrow new Error(\"Invalid argument for gantt.parse or gantt.load. An XML of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#xmldhtmlxgantt20 is expected. Actual argument value: \"\n\t\t\t+ JSON.stringify(data));\n\t}\n\n\tgantt.xml = {\n\t\t_xmlNodeToJSON: function (node, attrs_only) {\n\t\t\tvar t = {};\n\t\t\tfor (var i = 0; i < node.attributes.length; i++)\n\t\t\t\tt[node.attributes[i].name] = node.attributes[i].value;\n\n\t\t\tif (!attrs_only) {\n\t\t\t\tfor (var i = 0; i < node.childNodes.length; i++) {\n\t\t\t\t\tvar child = node.childNodes[i];\n\t\t\t\t\tif (child.nodeType == 1)\n\t\t\t\t\t\tt[child.tagName] = child.firstChild ? child.firstChild.nodeValue : \"\";\n\t\t\t\t}\n\n\t\t\t\tif (!t.text) t.text = node.firstChild ? node.firstChild.nodeValue : \"\";\n\t\t\t}\n\n\t\t\treturn t;\n\t\t},\n\t\t_getCollections: function (loader) {\n\t\t\tvar collection = {};\n\t\t\tvar opts = gantt.ajax.xpath(\"//coll_options\", loader);\n\t\t\tfor (var i = 0; i < opts.length; i++) {\n\t\t\t\tvar bind = opts[i].getAttribute(\"for\");\n\t\t\t\tvar arr = collection[bind] = [];\n\t\t\t\tvar itms = gantt.ajax.xpath(\".//item\", opts[i]);\n\t\t\t\tfor (var j = 0; j < itms.length; j++) {\n\t\t\t\t\tvar itm = itms[j];\n\t\t\t\t\tvar attrs = itm.attributes;\n\t\t\t\t\tvar obj = {key: itms[j].getAttribute(\"value\"), label: itms[j].getAttribute(\"label\")};\n\t\t\t\t\tfor (var k = 0; k < attrs.length; k++) {\n\t\t\t\t\t\tvar attr = attrs[k];\n\t\t\t\t\t\tif (attr.nodeName == \"value\" || attr.nodeName == \"label\")\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tobj[attr.nodeName] = attr.nodeValue;\n\t\t\t\t\t}\n\t\t\t\t\tarr.push(obj);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn collection;\n\t\t},\n\t\t_getXML: function (text, loader, toptag) {\n\t\t\ttoptag = toptag || \"data\";\n\t\t\tif (!loader.getXMLTopNode) {\n\t\t\t\tloader = gantt.ajax.parse(loader);\n\t\t\t}\n\n\t\t\tvar xml = gantt.ajax.xmltop(toptag, loader.xmlDoc);\n\t\t\tif (!xml || xml.tagName != toptag) {\n\t\t\t\txmlParseError(text);\n\t\t\t}\n\n\t\t\tvar skey = xml.getAttribute(\"dhx_security\");\n\t\t\tif (skey)\n\t\t\t\tgantt.security_key = skey;\n\n\t\t\treturn xml;\n\t\t},\n\t\tparse: function (text, loader) {\n\t\t\tloader = this._getXML(text, loader);\n\t\t\tvar data = {};\n\n\t\t\tvar evs = data.data = [];\n\t\t\tvar xml = gantt.ajax.xpath(\"//task\", loader);\n\n\t\t\tfor (var i = 0; i < xml.length; i++)\n\t\t\t\tevs[i] = this._xmlNodeToJSON(xml[i]);\n\n\t\t\tdata.collections = this._getCollections(loader);\n\t\t\treturn data;\n\t\t},\n\t\t_copyLink: function (obj) {\n\t\t\treturn \"<item id='\" + obj.id + \"' source='\" + obj.source + \"' target='\" + obj.target + \"' type='\" + obj.type + \"' />\";\n\t\t},\n\t\t_copyObject: function (obj) {\n\t\t\treturn \"<task id='\" + obj.id + \"' parent='\" + (obj.parent || \"\") + \"' start_date='\" + obj.start_date + \"' duration='\" + obj.duration + \"' open='\" + (!!obj.open) + \"' progress='\" + obj.progress + \"' end_date='\" + obj.end_date + \"'><![CDATA[\" + obj.text + \"]]></task>\";\n\t\t},\n\t\tserialize: function () {\n\t\t\tvar tasks = [];\n\t\t\tvar links = [];\n\n\t\t\tvar json = gantt.json.serialize();\n\t\t\tfor (var i = 0, len = json.data.length; i < len; i++) {\n\t\t\t\ttasks.push(this._copyObject(json.data[i]));\n\t\t\t}\n\t\t\tfor (var i = 0, len = json.links.length; i < len; i++) {\n\t\t\t\tlinks.push(this._copyLink(json.links[i]));\n\t\t\t}\n\t\t\treturn \"<data>\" + tasks.join(\"\") + \"<coll_options for='links'>\" + links.join(\"\") + \"</coll_options></data>\";\n\t\t}\n\t};\n\n\n\tgantt.oldxml = {\n\t\tparse: function (text, loader) {\n\t\t\tloader = gantt.xml._getXML(text, loader, \"projects\");\n\t\t\tvar data = {collections: {links: []}};\n\n\t\t\tvar evs = data.data = [];\n\t\t\tvar xml = gantt.ajax.xpath(\"//task\", loader);\n\n\t\t\tfor (var i = 0; i < xml.length; i++) {\n\t\t\t\tevs[i] = gantt.xml._xmlNodeToJSON(xml[i]);\n\t\t\t\tvar parent = xml[i].parentNode;\n\n\t\t\t\tif (parent.tagName == \"project\")\n\t\t\t\t\tevs[i].parent = \"project-\" + parent.getAttribute(\"id\");\n\t\t\t\telse\n\t\t\t\t\tevs[i].parent = parent.parentNode.getAttribute(\"id\");\n\t\t\t}\n\n\t\t\txml = gantt.ajax.xpath(\"//project\", loader);\n\t\t\tfor (var i = 0; i < xml.length; i++) {\n\t\t\t\tvar ev = gantt.xml._xmlNodeToJSON(xml[i], true);\n\t\t\t\tev.id = \"project-\" + ev.id;\n\t\t\t\tevs.push(ev);\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\t\tvar ev = evs[i];\n\t\t\t\tev.start_date = ev.startdate || ev.est;\n\t\t\t\tev.end_date = ev.enddate;\n\t\t\t\tev.text = ev.name;\n\t\t\t\tev.duration = ev.duration / 8;\n\t\t\t\tev.open = 1;\n\t\t\t\tif (!ev.duration && !ev.end_date) ev.duration = 1;\n\t\t\t\tif (ev.predecessortasks)\n\t\t\t\t\tdata.collections.links.push({\n\t\t\t\t\t\ttarget: ev.id,\n\t\t\t\t\t\tsource: ev.predecessortasks,\n\t\t\t\t\t\ttype: gantt.config.links.finish_to_start\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\t\tserialize: function () {\n\t\t\tgantt.message(\"Serialization to 'old XML' is not implemented\");\n\t\t}\n\t};\n\n\tgantt.serverList = function (name, array) {\n\t\tif (array) {\n\t\t\tthis.serverList[name] = array.slice(0);\n\t\t} else if (!this.serverList[name]) {\n\t\t\tthis.serverList[name] = [];\n\t\t}\n\t\treturn this.serverList[name];\n\t};\n\n};","import * as utils from \"../../utils/utils\";\nimport * as helpers from \"../../utils/helpers\";\n\n\nfunction IsWorkTimeArgument(date, unit, task, id, calendar){\n\tthis.date = date;\n\tthis.unit = unit;\n\tthis.task = task;\n\tthis.id = id;\n\tthis.calendar = calendar;\n\treturn this;\n}\n\nfunction ClosestWorkTimeArgument(date, dir, unit, task, id, calendar){\n\tthis.date = date;\n\tthis.dir = dir;\n\tthis.unit = unit;\n\tthis.task = task;\n\tthis.id = id;\n\tthis.calendar = calendar;\n\treturn this;\n}\n\nfunction CalculateEndDateArgument(start_date, duration, unit, step, task, id, calendar){\n\tthis.start_date = start_date;\n\tthis.duration = duration;\n\tthis.unit = unit;\n\tthis.step = step;\n\tthis.task = task;\n\tthis.id = id;\n\tthis.calendar = calendar;\n\treturn this;\n}\n\nfunction GetDurationArgument(start, end, task, calendar) {\n\tthis.start_date = start;\n\tthis.end_date = end;\n\tthis.task = task;\n\tthis.calendar = calendar;\n\tthis.unit = null;\n\tthis.step = null;\n\treturn this;\n}\n\nvar calendarArgumentsHelper = function(gantt){\n\treturn {\n\t\tgetWorkHoursArguments: function () {\n\t\t\tvar config = arguments[0];\n\t\t\tif (helpers.isDate(config)) {\n\t\t\t\tconfig = {\n\t\t\t\t\tdate: config\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tconfig = utils.mixin({}, config);\n\t\t\t}\n\n\t\t\tif(!helpers.isValidDate(config.date)){\n\t\t\t\tgantt.assert(false, \"Invalid date argument for getWorkHours method\");\n\t\t\t\tthrow new Error(\"Invalid date argument for getWorkHours method\");\n\t\t\t}\n\n\t\t\treturn config;\n\t\t},\n\t\tsetWorkTimeArguments: function () {\n\t\t\treturn arguments[0];\n\t\t},\n\t\tunsetWorkTimeArguments: function () {\n\t\t\treturn arguments[0];\n\t\t},\n\t\tisWorkTimeArguments: function () {\n\t\t\tvar config = arguments[0];\n\t\t\tif(config instanceof IsWorkTimeArgument){\n\t\t\t\treturn config;\n\t\t\t}\n\n\t\t\tvar processedConfig;\n\t\t\tif (!config.date) {\n\t\t\t\t//IsWorkTimeArgument(date, unit, task, id, calendar)\n\t\t\t\tprocessedConfig = new IsWorkTimeArgument(arguments[0], arguments[1], arguments[2], null, arguments[3]);\n\t\t\t} else {\n\t\t\t\tprocessedConfig = new IsWorkTimeArgument(config.date, config.unit, config.task, null, config.calendar);\n\t\t\t}\n\n\t\t\tprocessedConfig.unit = processedConfig.unit || gantt.config.duration_unit;\n\n\t\t\tif(!helpers.isValidDate(processedConfig.date)){\n\t\t\t\tgantt.assert(false, \"Invalid date argument for isWorkTime method\");\n\t\t\t\tthrow new Error(\"Invalid date argument for isWorkTime method\");\n\t\t\t}\n\n\t\t\treturn processedConfig;\n\t\t},\n\t\tgetClosestWorkTimeArguments: function (arg) {\n\t\t\tvar config = arguments[0];\n\t\t\tif (config instanceof ClosestWorkTimeArgument)\n\t\t\t\treturn config;\n\n\t\t\tvar processedConfig;\n\t\t\tif (helpers.isDate(config)) {\n\t\t\t\tprocessedConfig = new ClosestWorkTimeArgument(config);\n\n\t\t\t} else {\n\t\t\t\tprocessedConfig = new ClosestWorkTimeArgument(\n\t\t\t\t\tconfig.date,\n\t\t\t\t\tconfig.dir,\n\t\t\t\t\tconfig.unit,\n\t\t\t\t\tconfig.task,\n\t\t\t\t\tnull,//config.id,\n\t\t\t\t\tconfig.calendar\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif(config.id){\n\t\t\t\tprocessedConfig.task = config;\n\t\t\t}\n\t\t\tprocessedConfig.dir = config.dir || 'any';\n\t\t\tprocessedConfig.unit = config.unit || gantt.config.duration_unit;\n\n\t\t\tif(!helpers.isValidDate(processedConfig.date)){\n\t\t\t\tgantt.assert(false, \"Invalid date argument for getClosestWorkTime method\");\n\t\t\t\tthrow new Error(\"Invalid date argument for getClosestWorkTime method\");\n\t\t\t}\n\t\t\treturn processedConfig;\n\t\t},\n\n\t\t_getStartEndConfig: function (param) {\n\t\t\tvar argumentType = GetDurationArgument;\n\t\t\tvar config;\n\t\t\tif (param instanceof argumentType)\n\t\t\t\treturn param;\n\n\t\t\tif (helpers.isDate(param)) {\n\t\t\t\tconfig = new argumentType(arguments[0], arguments[1], arguments[2], arguments[3]);\n\t\t\t} else {\n\t\t\t\tconfig = new argumentType(param.start_date, param.end_date, param.task);\n\t\t\t\tif (param.id !== null && param.id !== undefined) {\n\t\t\t\t\tconfig.task = param;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconfig.unit = config.unit || gantt.config.duration_unit;\n\t\t\tconfig.step = config.step || gantt.config.duration_step;\n\t\t\tconfig.start_date = config.start_date || config.start || config.date;\n\n\t\t\tif(!helpers.isValidDate(config.start_date)){\n\t\t\t\tgantt.assert(false, \"Invalid start_date argument for getDuration method\");\n\t\t\t\tthrow new Error(\"Invalid start_date argument for getDuration method\");\n\t\t\t}\n\n\t\t\tif(!helpers.isValidDate(config.end_date)){\n\t\t\t\tgantt.assert(false, \"Invalid end_date argument for getDuration method\");\n\t\t\t\tthrow new Error(\"Invalid end_date argument for getDuration method\");\n\t\t\t}\n\n\t\t\treturn config;\n\t\t},\n\n\t\tgetDurationArguments: function (start, end, unit, step) {\n\t\t\treturn this._getStartEndConfig.apply(this, arguments);\n\t\t},\n\n\t\thasDurationArguments: function (start, end, unit, step) {\n\t\t\treturn this._getStartEndConfig.apply(this, arguments);\n\t\t},\n\n\t\tcalculateEndDateArguments: function (start, duration, unit, step) {\n\t\t\tvar config = arguments[0];\n\t\t\tif (config instanceof CalculateEndDateArgument)\n\t\t\t\treturn config;\n\n\t\t\tvar processedConfig;\n\t\t\t//CalculateEndDateArgument(start_date, duration, unit, step, task, id, calendar)\n\t\t\tif (helpers.isDate(config)) {\n\t\t\t\tprocessedConfig = new CalculateEndDateArgument(\n\t\t\t\t\targuments[0],\n\t\t\t\t\targuments[1],\n\t\t\t\t\targuments[2],\n\t\t\t\t\tundefined,\n\t\t\t\t\targuments[3],\n\t\t\t\t\tundefined,\n\t\t\t\t\targuments[4]\n\t\t\t\t);\n\n\t\t\t} else {\n\t\t\t\tprocessedConfig = new CalculateEndDateArgument(\n\t\t\t\t\tconfig.start_date,\n\t\t\t\t\tconfig.duration,\n\t\t\t\t\tconfig.unit,\n\t\t\t\t\tconfig.step,\n\t\t\t\t\tconfig.task,\n\t\t\t\t\tnull,//config.id,\n\t\t\t\t\tconfig.calendar\n\t\t\t\t);\n\t\t\t}\n\t\t\tif(config.id !== null && config.id !== undefined){\n\t\t\t\tprocessedConfig.task = config;\n\n\t\t\t\t// received a task object as an argument\n\t\t\t\t// ignore 'unit' and 'step' properties in this case, since it's likely a part of data model of a task\n\t\t\t\tprocessedConfig.unit = null;\n\t\t\t\tprocessedConfig.step = null;\n\t\t\t}\n\n\t\t\tprocessedConfig.unit = processedConfig.unit || gantt.config.duration_unit;\n\t\t\tprocessedConfig.step = processedConfig.step || gantt.config.duration_step;\n\n\t\t\tif(!helpers.isValidDate(processedConfig.start_date)){\n\t\t\t\tgantt.assert(false, \"Invalid start_date argument for calculateEndDate method\");\n\t\t\t\tthrow new Error(\"Invalid start_date argument for calculateEndDate method\");\n\t\t\t}\n\n\t\t\treturn processedConfig;\n\t\t}\n\t};\n};\n\n\nexport default calendarArgumentsHelper;","import * as domHelpers from \"../utils/dom_helpers\";\n\nfunction createResizer(gantt, grid){\n// renders resize elements in the grid header\n\tvar _render_grid_header_resize = function () {\n\t\tvar columns = grid.getGridColumns(),\n\t\t\tconfig = grid.$getConfig(),\n\t\t\twidth = 0,\n\t\t\ttotalWidth = grid.$config.width,\n\t\t\tlineHeigth = config.scale_height;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar col = columns[i];\n\n\t\t\tvar pos;\n\t\t\twidth += col.width;\n\t\t\tif(config.rtl){\n\t\t\t\tpos = totalWidth - width;\n\t\t\t}else{\n\t\t\t\tpos = width;\n\t\t\t}\n\n\t\t\t// GS-205. don't add resizer for the last column\n\t\t\tif (col.resize && i != columns.length - 1) {\n\t\t\t\tvar resize_el = document.createElement(\"div\");\n\t\t\t\tresize_el.className = \"gantt_grid_column_resize_wrap\";\n\t\t\t\tresize_el.style.top = \"0px\";\n\t\t\t\tresize_el.style.height = lineHeigth + \"px\";\n\t\t\t\tresize_el.innerHTML = \"<div class='gantt_grid_column_resize'></div>\";\n\t\t\t\tresize_el.setAttribute(config.grid_resizer_column_attribute, i);\n\t\t\t\tresize_el.setAttribute(\"column_index\", i); // hardcoded for backward compatibility\n\n\t\t\t\tgantt._waiAria.gridSeparatorAttr(resize_el);\n\n\t\t\t\tgrid.$grid_scale.appendChild(resize_el);\n\n\t\t\t\tresize_el.style.left = Math.max(0, pos) + \"px\";\n\t\t\t}\n\t\t}\n\t};\n\n\tvar _grid_resize = {\n\t\tcolumn_before_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar el = domHelpers.locateAttribute(e, config.grid_resizer_column_attribute);\n\t\t\tif (!el) return false;\n\n\t\t\tif (!domHelpers.closest(el,\".gantt_grid_column_resize_wrap\")) {\n\t\t\t\t// column resize should work only when we use the resizer\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar column_index = this.locate(e, config.grid_resizer_column_attribute),\n\t\t\t\tcolumn = grid.getGridColumns()[column_index];\n\n\t\t\tif (grid.callEvent(\"onColumnResizeStart\", [column_index, column]) === false)\n\t\t\t\treturn false;\n\t\t}, gantt),\n\n\t\tcolumn_after_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar column_index = this.locate(e, config.grid_resizer_column_attribute);\n\t\t\tdnd.config.marker.innerHTML = \"\";\n\t\t\tdnd.config.marker.className += \" gantt_grid_resize_area\";\n\t\t\tdnd.config.marker.style.height = grid.$grid.offsetHeight + \"px\";\n\t\t\tdnd.config.marker.style.top = \"0px\";\n\t\t\tdnd.config.drag_index = column_index;\n\n\t\t}, gantt),\n\n\t\tcolumn_drag_move: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar dd = dnd.config,\n\t\t\t\tcolumns = grid.getGridColumns();\n\t\t\tvar index = parseInt(dd.drag_index, 10);\n\t\t\tvar target_column = columns[index];\n\t\t\tvar\tpos = domHelpers.getNodePosition(grid.$grid_scale),\n\t\t\t\tpointerPosition = parseInt(dd.marker.style.left, 10),\n\t\t\t\tminPointerPosition = target_column.min_width ? target_column.min_width : config.min_grid_column_width,\n\t\t\t\tmaxPointerPosition = grid.$grid_data.offsetWidth,// - config.min_grid_column_width * (columns.length - dd.drag_index - 2),// 1 for current column + 1 for last column\n\t\t\t\tmarkerStartPosition = 0,\n\t\t\t\tmarker_width = 0;\n\n\t\t\t\n\t\t/*\tif(config.rtl){\n\t\t\t\tindex = columns.length - 1 - index;\n\t\t\t\tcolumns = columns.reverse();\n\t\t\t}*/\n\n\t\t\tif(!config.rtl){\n\t\t\t\tpointerPosition -= pos.x - 1;\n\t\t\t}else{\n\t\t\t\tpointerPosition = (pos.x + pos.width - 1) - pointerPosition;\n\t\t\t}\n\n\t\t\t//pointerPosition -= pos.x - 1;\n\t\t\tfor (var i = 0; i < index; i++) {\n\t\t\t\tminPointerPosition += columns[i].width;\n\t\t\t\tmarkerStartPosition += columns[i].width;\n\t\t\t}\n\n\t\t\tif (pointerPosition < minPointerPosition) {\n\t\t\t\tpointerPosition = minPointerPosition;\n\t\t\t}\n\n\t\t\tif (config.keep_grid_width) {\n\t\t\t\tvar limit_max = 0;\n\t\t\t\tfor (var i=index+1; i<columns.length; i++) {\n\t\t\t\t\tif (columns[i].min_width)\n\t\t\t\t\t\tmaxPointerPosition -= columns[i].min_width;\n\t\t\t\t\telse if (config.min_grid_column_width)\n\t\t\t\t\t\tmaxPointerPosition -= config.min_grid_column_width;\n\n\t\t\t\t\tif (columns[i].max_width && limit_max !== false)\n\t\t\t\t\t\tlimit_max += columns[i].max_width;\n\t\t\t\t\telse\n\t\t\t\t\t\tlimit_max = false;\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\t// we have to restrict min value if only ALL right-side columns have 'max_width' field\n\t\t\t\tif (limit_max) {\n\t\t\t\t\tminPointerPosition = grid.$grid_data.offsetWidth - limit_max;\n\t\t\t\t}\n\t\t\t\tif (pointerPosition < minPointerPosition) {\n\t\t\t\t\tpointerPosition = minPointerPosition;\n\t\t\t\t}\n\n\t\t\t\tif (pointerPosition > maxPointerPosition) {\n\t\t\t\t\tpointerPosition = maxPointerPosition;\n\t\t\t\t}\n\t\t\t} else if (!grid.$config.scrollable) {\n\t\t\t\tvar targetWidth = pointerPosition;\n\t\t\t\tvar maxWidth = gantt.$container.offsetWidth;\n\n\t\t\t\tvar rightColumnsWidth = 0;\n\t\t\t\t// 25 is a scrollbar width. due to GS-1314 fix, the grid should always be visible\n\t\t\t\t// because of that, the internal grid width can be larger than the visible grid width\n\t\t\t\tif (grid.$grid_data.offsetWidth <= (maxWidth - 25)){\n\t\t\t\t\tfor (var i=index+1; i<columns.length; i++) {\n\t\t\t\t\t\trightColumnsWidth += columns[i].width;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// GS-627. When the grid is not scrollable and occupies almost all Gantt container's width\n\t\t\t\t\tfor (var i=index+1; i >= 0; i--) {\n\t\t\t\t\t\trightColumnsWidth += columns[i].width;\n\t\t\t\t\t}\n\t\t\t\t\trightColumnsWidth = maxWidth - rightColumnsWidth;\n\t\t\t\t}\n\n\t\t\t\t// in case if something went wrong in the previous part\n\t\t\t\tif (rightColumnsWidth > maxWidth){\n\t\t\t\t\trightColumnsWidth -= maxWidth;\n\t\t\t\t}\n\n\t\t\t\t// prevent grid from occupying the whole layout cell, which would disable the timeline\n\t\t\t\tvar parentLayout = grid.$parent.$parent;\n\t\t\t\tif(parentLayout && parentLayout.$config.mode == \"y\"){\n\t\t\t\t\tvar parentWidth = parentLayout.$lastSize.x;\n\t\t\t\t\tmaxWidth = Math.min(maxWidth, parentWidth - (parentLayout.$cells.length - 1));\n\t\t\t\t}\n\t\n\t\t\t\tif(targetWidth + rightColumnsWidth > maxWidth){\n\t\t\t\t\tpointerPosition = maxWidth - rightColumnsWidth;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tdd.left = pointerPosition - 1;// -1 for border\n\n\t\t\tmarker_width = Math.abs(pointerPosition - markerStartPosition);\n\n\t\t\t// column.max_width - maximum width of the column, user defined\n\t\t\tif (target_column.max_width && marker_width > target_column.max_width)\n\t\t\t\tmarker_width = target_column.max_width;\n\n\t\t\tif(config.rtl){\n\t\t\t\tmarkerStartPosition = (pos.width - markerStartPosition) + 2 - marker_width;\n\t\t\t}\n\t\t\tdd.marker.style.top = pos.y + \"px\";\n\t\t\tdd.marker.style.left = pos.x - 1 + markerStartPosition + \"px\";\n\t\t\tdd.marker.style.width = marker_width + \"px\";\n\n\t\t\tgrid.callEvent(\"onColumnResize\", [index, columns[index], marker_width - 1]);\n\t\t\treturn true;\n\t\t}, gantt),\n\n\t\tcolumn_drag_end: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar columns = grid.getGridColumns(),\n\t\t\t\tcolumns_width = 0,\n\t\t\t\tindex = parseInt(dnd.config.drag_index, 10),\n\t\t\t\ttarget_column = columns[index];\n\n\t\t\t// var colIndex = index;\n\t\t\t/*if(config.rtl){\n\t\t\t\tcolIndex = columns.length - 1 - target_index;\n\t\t\t\tcolumns = columns.reverse();\n\t\t\t}*/\n\n\t\t\tfor (var i = 0; i < index; i++) {\n\t\t\t\tcolumns_width += columns[i].width;\n\t\t\t}\n\n\t\t\tvar final_width = (target_column.min_width && (dnd.config.left - columns_width) < target_column.min_width) ?\n\t\t\t\ttarget_column.min_width : (dnd.config.left - columns_width);\n\n\t\t\tif (target_column.max_width && target_column.max_width < final_width) // TODO: probably can be omitted\n\t\t\t\tfinal_width = target_column.max_width;\n\n\t\t\tif (grid.callEvent(\"onColumnResizeEnd\", [index, target_column, final_width]) === false)\n\t\t\t\treturn;\n\n\t\t\tif (target_column.width == final_width)\n\t\t\t\treturn;\n\n\t\t\ttarget_column.width = final_width;\n\n\t\t\tif (config.keep_grid_width) {\n\t\t\t\tcolumns_width = config.grid_width;\n\t\t\t} else {\n\t\t\t\t// in other case we set a new grid width and call gantt render\n\t\t\t\tfor (var i = index, l = columns.length; i < l; i++) {\n\t\t\t\t\tcolumns_width += columns[i].width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgrid.callEvent(\"onColumnResizeComplete\", [columns, grid._setColumnsWidth(columns_width, index)]);\n\n\t\t\tif(!grid.$config.scrollable){\n\t\t\t\tgantt.$layout._syncCellSizes(grid.$config.group, {value: config.grid_width, isGravity: false});\n\t\t\t}\n\t\t\t//grid.callEvent(\"onColumnResizeComplete\", [columns, columns_width]);\n\n\t\t\tthis.render();\n\t\t}, gantt)\n\t};\n\n// calls the initialization of the D'n'D events for resize elements\n\tvar _init_resize = function () {\n\t\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\t\tvar config = grid.$getConfig();\n\n\t\tvar dnd = new DnD(grid.$grid_scale, {updates_per_second: 60});\n\t\tif (gantt.defined(config.dnd_sensitivity))\n\t\t\tdnd.config.sensitivity = config.dnd_sensitivity;\n\n\t\tdnd.attachEvent(\"onBeforeDragStart\", function (obj, e) {\n\t\t\treturn _grid_resize.column_before_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onAfterDragStart\", function (obj, e) {\n\t\t\treturn _grid_resize.column_after_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragMove\", function (obj, e) {\n\t\t\treturn _grid_resize.column_drag_move(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragEnd\", function (obj, e) {\n\t\t\treturn _grid_resize.column_drag_end(dnd, obj, e);\n\t\t});\n\n\t};\n\n\treturn {\n\t\tinit: _init_resize,\n\t\tdoOnRender: _render_grid_header_resize\n\t};\n}\n\nexport default createResizer;\n","import * as domHelpers from \"../utils/dom_helpers\";\n\nfunction createRowResizer(gantt, grid){\n\n\tvar _task_grid_row_resize = {\n\t\trow_before_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar store = grid.$config.rowStore;\n\n\t\t\tvar el = domHelpers.locateAttribute(e, config.task_grid_row_resizer_attribute);\n\t\t\tif (!el) return false;\n\n\t\t\tvar row_id = this.locate(e, config.task_grid_row_resizer_attribute),\n\t\t\t\trow = store.getItem(row_id);\n\n\t\t\tif (grid.callEvent(\"onBeforeRowResize\", [row]) === false)\n\t\t\t\treturn false;\n\t\t}, gantt),\n\n\t\trow_after_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar row_id = this.locate(e, config.task_grid_row_resizer_attribute);\n\t\t\tdnd.config.marker.innerHTML = \"\";\n\n\t\t\tdnd.config.marker.className += \" gantt_row_grid_resize_area\";\n\t\t\tdnd.config.marker.style.width = grid.$grid.offsetWidth + \"px\";\n\t\t\tdnd.config.drag_id = row_id;\n\n\t\t}, gantt),\n\n\t\trow_drag_move: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar store = grid.$config.rowStore;\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar dd = dnd.config;\n\t\t\tvar id = dd.drag_id,\n\t\t\t\titemHeight = grid.getItemHeight(id),\n\t\t\t\titemTop = grid.getItemTop(id) - obj.scrollTop;\n\t\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data),\n\t\t\t\tpointerPosition = parseInt(dd.marker.style.top, 10),\n\t\t\t\tmarkerStartPosition = itemTop + pos.y,\n\t\t\t\tmarker_height = 0,\n\t\t\t\tminPointerPosition = config.min_task_grid_row_height;\n\n\t\t\tmarker_height = pointerPosition - markerStartPosition;\n\t\t\tif(marker_height < minPointerPosition){\n\t\t\t\tmarker_height = minPointerPosition;\n\t\t\t}\n\n\t\t\tdd.marker.style.left = pos.x + \"px\";\n\t\t\tdd.marker.style.top = markerStartPosition - 1 + \"px\";\n\t\t\tdd.marker.style.height = Math.abs(marker_height) + 1 + \"px\";\n\n\t\t\tdd.marker_height = marker_height;\n\t\t\t\n\t\t\tgrid.callEvent(\"onRowResize\", [id, store.getItem(id), marker_height + itemHeight]);\n\t\t\treturn true;\n\t\t}, gantt),\n\n\t\trow_drag_end: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar store = grid.$config.rowStore;\n\t\t\tvar dd = dnd.config;\n\t\t\tvar id = dd.drag_id,\n\t\t\t\titem = store.getItem(id),\n\t\t\t\toldItemHeight = grid.getItemHeight(id);\n\n\t\t\tvar finalHeight = dd.marker_height;\n\n\t\t\tif (grid.callEvent(\"onBeforeRowResizeEnd\", [id, item, finalHeight]) === false)\n\t\t\t\treturn;\n\n\t\t\tif (item.row_height == finalHeight)\n\t\t\t\treturn;\n\n\t\t\titem.row_height = finalHeight;\n\t\t\t// GS-2275: case for resizing resource grid row and others\n\t\t\tstore.updateItem(id);\n\t\t\tgrid.callEvent(\"onAfterRowResize\", [id, item, oldItemHeight, finalHeight]);\n\n\t\t\tthis.render();\n\t\t}, gantt)\n\t};\n\n\t// calls the initialization of the D'n'D events for resize elements\n\tvar _init_resize = function () {\n\n\t\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\t\tvar config = grid.$getConfig();\n\n\t\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\n\t\tif (gantt.defined(config.dnd_sensitivity))\n\t\t\tdnd.config.sensitivity = config.dnd_sensitivity;\n\n\t\tdnd.attachEvent(\"onBeforeDragStart\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_before_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onAfterDragStart\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_after_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragMove\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_drag_move(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragEnd\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_drag_end(dnd, obj, e);\n\t\t});\n\n\t};\n\n\treturn {\n\t\tinit: _init_resize\n\t};\n}\n\nexport default createRowResizer;","import * as utils from \"../../../utils/utils\";\nfunction WorkTimeCalendarMerger(){\n}\n\nWorkTimeCalendarMerger.prototype = {\n\n\n\t/**\n\t * convert hours array items into objects, e.g. [8, 12, 17, 18] -> [{start: 8, end: 12}, {start:17, end:18}]\n\t * @param {Array} hoursArray\n\t */\n\t_getIntervals: function(hoursArray){\n\t\tvar result = [];\n\t\tfor(var i = 0; i < hoursArray.length; i += 2){\n\n\t\t\tresult.push({\n\t\t\t\tstart: hoursArray[i],\n\t\t\t\tend: hoursArray[i+1]\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Convert ranges config into hours array\n\t * [{start: 8, end: 12}, {start:17, end:18}] --> [8, 12, 17, 18]\n\t * @param {*} intervalsArray\n\t */\n\t_toHoursArray: function(intervalsArray){\n\t\tvar result = [];\n\n\t\tfunction toFixed(value){\n\t\t\tvar str = String(value);\n\t\t\tif(str.length < 2){\n\t\t\t\tstr = \"0\" + str;\n\t\t\t}\n\t\t\treturn str;\n\t\t}\n\t\tfunction formatHHMM(secondsValue){\n\t\t\tvar hours = Math.floor(secondsValue / (60*60));\n\t\t\tvar minutePart = secondsValue - hours * 60 * 60;\n\n\t\t\tvar minutes = Math.floor(minutePart / (60));\n\t\t\treturn hours + \":\" + toFixed(minutes);\n\t\t}\n\t\tfor(var i = 0; i < intervalsArray.length; i++){\n\t\t\tresult.push(\n\t\t\t\tformatHHMM(intervalsArray[i].start) +\n\t\t\t\t\"-\" +\n\t\t\t\tformatHHMM(intervalsArray[i].end)\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Build intersection of hour intervals. e.g.\n\t * first: [{start: 8, end: 12}, {start:13, end:18}]\n\t * second: [{start: 10, end: 15}]\n\t * result: [{start: 10, end: 12}, {start: 13, end: 15}]\n\t * @param {Array} first\n\t * @param {Array} second\n\t */\n\t_intersectHourRanges: function(first, second){\n\t\tvar result = [];\n\n\t\tvar baseArray = first.length > second.length ? first : second;\n\t\tvar overridesArray = first === baseArray ? second: first;\n\t\tbaseArray = baseArray.slice();\n\t\toverridesArray = overridesArray.slice();\n\n\t\tvar result = [];\n\t\tfor(var i = 0; i < baseArray.length; i++){\n\t\t\tvar base = baseArray[i];\n\n\t\t\tfor(var j = 0; j < overridesArray.length; j++){\n\t\t\t\tvar current = overridesArray[j];\n\t\t\t\tif(current.start < base.end && current.end > base.start){\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\tstart: Math.max(base.start, current.start),\n\t\t\t\t\t\tend: Math.min(base.end, current.end)\n\t\t\t\t\t});\n\t\t\t\t\tif(base.end > current.end){\n\t\t\t\t\t\toverridesArray.splice(j, 1);\n\t\t\t\t\t\tj--;\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Reduce the number of ranges in config when possible,\n\t * joins ranges that can be merged\n\t * parts: [{start: 8, end: 12}, {start:12, end:13}, {start: 15, end: 17}]\n\t * result: [{start: 8, end: 13}, {start: 15, end: 17}]\n\t * @param {Array} parts\n\t */\n\t_mergeAdjacentIntervals: function(parts){\n\t\tvar result = parts.slice();\n\t\tresult.sort(function(a, b){\n\t\t\treturn a.start - b.start;\n\t\t});\n\t\tvar base = result[0];\n\t\tfor(var i = 1; i < result.length; i++){\n\t\t\tvar current = result[i];\n\t\t\tif(current.start <= base.end){\n\t\t\t\tif(current.end > base.end){\n\t\t\t\t\tbase.end = current.end;\n\t\t\t\t}\n\t\t\t\tresult.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}else{\n\t\t\t\tbase = current;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t_mergeHoursConfig: function(firstHours, secondHours){\n\t\t//var firstIntervals = this._getIntervals(firstHours);\n\t\t//var secondIntervals = this._getIntervals(secondHours);\n\n\t\treturn this._mergeAdjacentIntervals(\n\t\t\tthis._intersectHourRanges(firstHours, secondHours)\n\t\t);\n\t},\n\n\tmerge: function(first, second){\n\t\tvar firstConfig = utils.copy(first.getConfig().parsed);\n\n\t\tvar secondConfig = utils.copy(second.getConfig().parsed);\n\n\t\tvar mergedSettings = {\n\t\t\thours: this._toHoursArray(this._mergeHoursConfig(firstConfig.hours, secondConfig.hours)),\n\t\t\tdates: {},\n\t\t\tcustomWeeks: {}\n\t\t};\n\n\t\tconst processCalendar = (config1, config2) => {\n\t\t\tfor (let i in config1.dates) {\n\t\t\t\tconst date1 = config1.dates[i];\n\t\n\t\t\t\t// dates contain day-of-week rules [0-7] and rules for specific dates (js date timestamps) - set false date rules initially\n\t\t\t\tif (+i > 1000) {\n\t\t\t\t\tmergedSettings.dates[i] = false;\n\t\t\t\t}\n\t\t\t\t// Check if the key exists in the fisrt calendar object\n\t\t\t\tfor (const key in config2.dates) {\n\t\t\t\t\tconst date2 = config2.dates[key];\n\t\n\t\t\t\t\t// Logical AND for week days\n\t\t\t\t\tif (key == i) {\n\t\t\t\t\t\tmergedSettings.dates[i] = !!(date1 && date2);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// Handle case where dates are arrays\n\t\t\t\t\tif (Array.isArray(date1)) {\n\t\t\t\t\t\tconst hours2 = Array.isArray(date2) ? date2 : config2.hours;\n\t\t\t\t\t\tmergedSettings.dates[i] = this._toHoursArray(this._mergeHoursConfig(date1, hours2));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\t// Check both calendars\n\t\tprocessCalendar(firstConfig, secondConfig);\n\t\tprocessCalendar(secondConfig, firstConfig);\n\n\t\t// transfer and overwrite custom week calendars\n\t\tif(firstConfig.customWeeks){\n\t\t\tfor(var i in firstConfig.customWeeks){\n\t\t\t\tmergedSettings.customWeeks[i] = firstConfig.customWeeks[i];\n\t\t\t}\n\t\t}\n\t\tif(secondConfig.customWeeks){\n\t\t\tfor(var i in secondConfig.customWeeks){\n\t\t\t\tmergedSettings.customWeeks[i] = secondConfig.customWeeks[i];\n\t\t\t}\n\t\t}\n\n\t\treturn mergedSettings;\n\n\t}\n\n};\n\nexport default WorkTimeCalendarMerger;","\n\nimport { IWorkUnitCache } from \"./workunit_cache_interface\";\n\nexport class WorkUnitsMapCache implements IWorkUnitCache {\n\tprivate _cache: Map<string, Array<Map<string, boolean>>>;\n\tconstructor() {\n\t\tthis.clear();\n\t}\n\n\tgetItem(unit: string, timestamp: string, value: Date): number|boolean {\n\t\tif (this._cache.has(unit)) {\n\t\t\tconst unitCache = this._cache.get(unit);\n\n\t\t\tconst subCache = unitCache[value.getFullYear()];\n\t\t\tif (subCache && subCache.has(timestamp)) {\n\t\t\t\treturn subCache.get(timestamp);\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\tsetItem(unit: string, timestamp: string, value: boolean, rawValue: Date): void {\n\t\tif (!unit || !timestamp) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cache = this._cache;\n\t\tconst year = rawValue.getFullYear();\n\n\t\tlet unitCache;\n\t\tif (!cache.has(unit)) {\n\t\t\tunitCache = [];\n\t\t\tcache.set(unit, unitCache);\n\t\t} else {\n\t\t\tunitCache = cache.get(unit);\n\t\t}\n\n\t\tlet yearCache = unitCache[year];\n\t\tif(!yearCache){\n\t\t\tyearCache = unitCache[year] = new Map<string, boolean>();\n\t\t}\n\n\n\t\tyearCache.set(timestamp, value);\n\t}\n\tclear(): void{\n\t\tthis._cache = new Map<string, Array<Map<string, boolean>>>();\n\t}\n}","import { IWorkUnitCache } from \"./workunit_cache_interface\";\n\nexport class WorkUnitsObjectCache implements IWorkUnitCache {\n\tprivate _cache: any;\n\tconstructor() {\n\t\tthis.clear();\n\t}\n\n\tgetItem(unit: string, timestamp: string, value: Date): number|boolean {\n\t\tconst cache = this._cache;\n\t\tif (cache && cache[unit]) {\n\t\t\tconst units = cache[unit];\n\t\t\tif(units === undefined){\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tconst subCache = units[value.getFullYear()];\n\t\t\tif (subCache && subCache[timestamp] !== undefined) {\n\t\t\t\treturn subCache[timestamp];\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\tsetItem(unit: string, timestamp: string, value: boolean, rawValue: Date): void {\n\t\tif (!unit || !timestamp) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cache = this._cache;\n\n\t\tif (!cache) {\n\t\t\treturn;\n\t\t}\n\t\tif (!cache[unit]) {\n\t\t\tcache[unit] = [];\n\t\t}\n\t\tconst unitCache = cache[unit];\n\n\t\tconst year = rawValue.getFullYear();\n\t\tlet yearCache = unitCache[year];\n\t\tif(!yearCache){\n\t\t\tyearCache = unitCache[year] = {};\n\t\t}\n\t\tyearCache[timestamp] = value;\n\t}\n\tclear(): void{\n\t\tthis._cache = {};\n\t}\n}","\n\nexport class LargerUnitsCache {\n\tprivate _weekCache: Map<number, number>;\n\tprivate _monthCache: Map<number, number>;\n\tprivate _calendar: any;\n\tconstructor(calendar) {\n\t\tthis.clear();\n\t\tthis._calendar = calendar;\n\t}\n\n\tgetMinutesPerWeek = (weekStart: Date) => {\n\t\tconst key = weekStart.valueOf();\n\n\t\tif(this._weekCache.has(key)){\n\t\t\treturn this._weekCache.get(key);\n\t\t}\n\n\t\tconst calendar = this._calendar;\n\t\tconst gantt = this._calendar.$gantt;\n\n\t\tlet minutesPerWeek = 0;\n\t\tlet start = gantt.date.week_start(new Date(weekStart));\n\t\tfor(let i = 0; i < 7; i++){\n\t\t\tminutesPerWeek += calendar.getHoursPerDay(start) * 60;\n\t\t\tstart = gantt.date.add(start, 1, \"day\");\n\t\t}\n\n\t\tthis._weekCache.set(key, minutesPerWeek);\n\t\treturn minutesPerWeek;\n\t};\n\n\tgetMinutesPerMonth = (monthStart: Date) => {\n\t\tconst key = monthStart.valueOf();\n\n\t\tif(this._monthCache.has(key)){\n\t\t\treturn this._monthCache.get(key);\n\t\t}\n\n\t\tconst calendar = this._calendar;\n\t\tconst gantt = this._calendar.$gantt;\n\n\t\tlet minutesPerMonth = 0;\n\t\tlet start = gantt.date.week_start(new Date(monthStart));\n\t\tconst nextMonth = gantt.date.add(start, 1, \"month\").valueOf();\n\t\twhile(start.valueOf() < nextMonth){\n\t\t\tminutesPerMonth += calendar.getHoursPerDay(start) * 60;\n\t\t\tstart = gantt.date.add(start, 1, \"day\");\n\t\t}\n\n\t\tthis._monthCache.set(key, minutesPerMonth);\n\t\treturn minutesPerMonth;\n\t};\n\n\tclear = (): void => {\n\t\tthis._weekCache = new Map<number, number>();\n\t\tthis._monthCache = new Map<number, number>();\n\t};\n}","export class DateDurationCache  {\n\tprivate _cache: any;\n\tconstructor() {\n\t\tthis.clear();\n\t}\n\n\t_getCacheObject(startDate: Date, unit: string, step:number){\n\t\tconst cache = this._cache;\n\t\tif (!cache[unit]) {\n\t\t\tcache[unit] = [];\n\t\t}\n\t\tlet unitCache = cache[unit];\n\t\tif(!unitCache) {\n\t\t\tunitCache = cache[unit] = {};\n\t\t}\n\n\t\tlet stepCache = unitCache[step];\n\t\tif(!stepCache) {\n\t\t\tstepCache = unitCache[step] = {};\n\t\t}\n\n\t\tconst year = startDate.getFullYear();\n\t\tlet yearCache = stepCache[year];\n\t\tif(!yearCache){\n\t\t\tyearCache = stepCache[year] = {durations: {}, endDates: {}};\n\t\t}\n\n\t\treturn yearCache;\n\t}\n\t_endDateCacheKey(startDate: number, duration: number){\n\t\treturn String(startDate) + \"-\" + String(duration);\n\t}\n\t_durationCacheKey(startDate: number, endDate: number){\n\t\treturn String(startDate) + \"-\" + String(endDate);\n\t}\n\tgetEndDate(startDate: Date, duration: number, unit: string, step: number, compute: () => Date): number|null{\n\t\tconst cache = this._getCacheObject(startDate, unit, step);\n\n\t\tconst startDateTimestamp = startDate.valueOf();\n\t\tconst key = this._endDateCacheKey(startDateTimestamp, duration);\n\t\tlet endDate;\n\t\tif(cache.endDates[key] === undefined){\n\t\t\tconst result = compute();\n\t\t\tconst resultTimestamp = result.valueOf();\n\t\t\tcache.endDates[key] = resultTimestamp;\n\t\t\tcache.durations[this._durationCacheKey(startDateTimestamp, resultTimestamp)] = duration;\n\t\t\tendDate = result;\n\t\t}else{\n\t\t\tendDate = new Date(cache.endDates[key]);\n\t\t}\n\n\t\treturn endDate;\n\t}\n\n\tgetDuration(startDate: Date, endDate: Date, unit: string, step: number, compute: () => number): number|null{\n\t\tconst cache = this._getCacheObject(startDate, unit, step);\n\n\t\tconst startDateTimestamp = startDate.valueOf();\n\t\tconst endDateTimestamp = endDate.valueOf();\n\t\tconst key = this._durationCacheKey(startDateTimestamp, endDateTimestamp);\n\t\tlet duration;\n\t\tif(cache.durations[key] === undefined){\n\t\t\tconst result = compute();\n\t\t\tcache.durations[key] = result.valueOf();\n\n\t\t\t// can't populate end date due to logic of end date calculation, current unit tests capture it\n\t\t\t// cache.endDates[this._endDateCacheKey(startDateTimestamp, result)] = endDateTimestamp;\n\t\t\tduration = result;\n\t\t}else{\n\t\t\tduration = cache.durations[key];\n\t\t}\n\n\t\treturn duration;\n\t}\n\n\tclear(): void{\n\t\tthis._cache = {};\n\t}\n}","import {createCacheObject} from \"./work_unit_cache\";\nimport {LargerUnitsCache} from \"./work_unit_cache\";\nimport * as utils from \"../../../utils/utils\";\nimport {DateDurationCache} from \"./work_unit_cache/date_duration_cache\";\n\nfunction CalendarWorkTimeStrategy(gantt, argumentsHelper) {\n\tthis.argumentsHelper = argumentsHelper;\n\tthis.$gantt = gantt;\n\tthis._workingUnitsCache = createCacheObject();\n\tthis._largeUnitsCache = new LargerUnitsCache(this);\n\tthis._dateDurationCache = new DateDurationCache();\n\tthis._worktime = null;\n\tthis._cached_timestamps = {};\n\tthis._cached_timestamps_count = 0;\n}\n\nCalendarWorkTimeStrategy.prototype = {\n\tunits: [\n\t\t\"year\",\n\t\t\"month\",\n\t\t\"week\",\n\t\t\"day\",\n\t\t\"hour\",\n\t\t\"minute\"\n\t],\n\t_clearCaches: function(){\n\t\tthis._workingUnitsCache.clear();\n\t\tthis._largeUnitsCache.clear();\n\t\tthis._dateDurationCache.clear();\n\t},\n\t// cache previously calculated worktime\n\t_getUnitOrder: function (unit) {\n\t\tfor (var i = 0, len = this.units.length; i < len; i++) {\n\t\t\tif (this.units[i] == unit)\n\t\t\t\treturn i;\n\t\t}\n\t},\n\t_resetTimestampCache: function(){\n\t\tthis._cached_timestamps = {};\n\t\tthis._cached_timestamps_count = 0;\n\t},\n\t_timestamp: function (settings) {\n\t\t// minor optimization, store calculated timestamps to reduce computations\n\t\t// reset cache when number of keys exceeds large number where key lookup may became more expensive than the recalculation\n\t\tif(this._cached_timestamps_count > 1000000){\n\t\t\tthis._resetTimestampCache();\n\t\t}\n\n\t\tvar timestamp = null;\n\t\tif ((settings.day || settings.day === 0)) {\n\t\t\ttimestamp = settings.day;\n\t\t} else if (settings.date) {\n\t\t\tvar value = String(settings.date.valueOf());\n\t\t\tif(this._cached_timestamps[value]){\n\t\t\t\ttimestamp = this._cached_timestamps[value];\n\t\t\t}else{\n\t\t\t\t// store worktime datestamp in utc so it could be recognized in different timezones (e.g. opened locally and sent to the export service in different timezone)\n\t\t\t\ttimestamp = Date.UTC(settings.date.getFullYear(), settings.date.getMonth(), settings.date.getDate());\n\t\t\t\tthis._cached_timestamps[value] = timestamp;\n\t\t\t\tthis._cached_timestamps_count++;\n\t\t\t}\n\n\t\t}\n\t\treturn timestamp;\n\t},\n\t_checkIfWorkingUnit: function (date, unit) {\n\t\t// GS-596: If unit is larger than day or has a custom logic\n\t\tif (!this[\"_is_work_\" + unit]) {\n\t\t\tconst from = this.$gantt.date[`${unit}_start`](new Date(date));\n\t\t\tconst to = this.$gantt.date.add(from, 1, unit);\n\t\t\treturn this.hasDuration(from, to);\n\t\t}\n\t\treturn this[\"_is_work_\" + unit](date);\n\t},\n\t//checkings for particular time units\n\t//methods for month-year-week can be defined, otherwise always return 'true'\n\t_is_work_day: function (date) {\n\t\tvar val = this._getWorkHours(date);\n\n\t\tif (Array.isArray(val)) {\n\t\t\treturn val.length > 0;\n\t\t}\n\t\treturn false;\n\t},\n\t_is_work_hour: function (date) {\n\t\tvar hours = this._getWorkHours(date); // [{start: 8*60*60, end: 12*60*60}, {start: 13*60*60, end: 17*60*60}]\n\t\tvar value = date.getHours();\n\t\tfor (var i = 0; i < hours.length; i++) {\n\t\t\tif(value >= hours[i].startHour && value < hours[i].endHour){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t_getTimeOfDayStamp: function(date, dayEnd) {\n\t\tvar hours = date.getHours();\n\t\tif(!date.getHours() && !date.getMinutes() && dayEnd){\n\t\t\thours = 24;\n\t\t}\n\t\treturn hours * 60 * 60 + date.getMinutes() * 60;\n\t},\n\n\t_is_work_minute: function(date){\n\t\tvar hours = this._getWorkHours(date); // [{start: 8*60*60, end: 12*60*60}, {start: 13*60*60, end: 17*60*60}]\n\t\tvar checkTime = this._getTimeOfDayStamp(date);\n\t\tfor (var i = 0; i < hours.length; i++) {\n\t\t\tif(checkTime >= hours[i].start && checkTime < hours[i].end){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t_nextDate: function (start, unit, step) {\n\t\treturn this.$gantt.date.add(start, step, unit);\n\t},\n\t_getWorkUnitsBetweenGeneric: function (from, to, unit, step) {\n\t\tvar dateHelper = this.$gantt.date;\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\t\tvar units = 0;\n\n\n\t\tvar next = null;\n\t\tvar stepStart,\n\t\t\tstepEnd;\n\n\t\t// calculating decimal durations, i.e. 2016-09-20 00:05:00 - 2016-09-20 01:00:00 ~ 0.95 instead of 1\n\t\t// and also  2016-09-20 00:00:00 - 2016-09-20 00:05:00 ~ 0.05 instead of 1\n\t\t// durations must be rounded later\n\t\tvar checkFirst = false;\n\t\tstepStart = dateHelper[unit + \"_start\"](new Date(start));\n\t\tif (stepStart.valueOf() != start.valueOf()) {\n\t\t\tcheckFirst = true;\n\t\t}\n\t\tvar checkLast = false;\n\t\tstepEnd = dateHelper[unit + \"_start\"](new Date(to));\n\t\tif (stepEnd.valueOf() != to.valueOf()) {\n\t\t\tcheckLast = true;\n\t\t}\n\n\t\tvar isLastStep = false;\n\t\twhile (start.valueOf() < end.valueOf()) {\n\t\t\tnext = this._nextDate(start, unit, step);\n\t\t\tisLastStep = (next.valueOf() > end.valueOf());\n\n\t\t\tif (this._isWorkTime(start, unit)) {\n\t\t\t\tif (checkFirst || (checkLast && isLastStep)) {\n\t\t\t\t\tstepStart = dateHelper[unit + \"_start\"](new Date(start));\n\t\t\t\t\tstepEnd = dateHelper.add(stepStart, step, unit);\n\t\t\t\t}\n\n\t\t\t\tif (checkFirst) {\n\t\t\t\t\tcheckFirst = false;\n\t\t\t\t\tnext = this._nextDate(stepStart, unit, step);\n\t\t\t\t\tunits += ((stepEnd.valueOf() - start.valueOf()) / (stepEnd.valueOf() - stepStart.valueOf()));\n\t\t\t\t} else if (checkLast && isLastStep) {\n\t\t\t\t\tcheckLast = false;\n\t\t\t\t\tunits += ((end.valueOf() - start.valueOf()) / (stepEnd.valueOf() - stepStart.valueOf()));\n\n\t\t\t\t} else {\n\t\t\t\t\tunits++;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tvar unitOrder = this._getUnitOrder(unit);\n\t\t\t\tvar biggerTimeUnit = this.units[unitOrder - 1];\n\t\t\t\tif(biggerTimeUnit && !this._isWorkTime(start, biggerTimeUnit)){\n\t\t\t\t\tnext = this._getClosestWorkTimeFuture(start, biggerTimeUnit);\n\t\t\t\t}\n\t\t\t}\n\t\t\tstart = next;\n\t\t}\n\t\treturn units;\n\t},\n\n\t_getMinutesPerHour: function (date) {\n\t\tvar hourStart = this._getTimeOfDayStamp(date);\n\t\tvar hourEnd = this._getTimeOfDayStamp(this._nextDate(date, \"hour\", 1));\n\t\tif (hourEnd === 0){\n\t\t\thourEnd = 24 * 60 * 60;\n\t\t}\n\t\tvar worktimes = this._getWorkHours(date);\n\n\t\tfor(var i = 0; i < worktimes.length; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(hourStart >= interval.start && hourEnd <= interval.end){\n\t\t\t\treturn 60;// hour inside a working interval, all hour is a work hour\n\t\t\t}else if(hourStart < interval.end && hourEnd > interval.start){\n\t\t\t\t// hour is partially work time\n\t\t\t\tvar duration = Math.min(hourEnd, interval.end) - Math.max(hourStart, interval.start);\n\t\t\t\treturn duration / 60;\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t},\n\n\t_getMinutesPerDay: function (date) {\n\t\tvar hours = this._getWorkHours(date);\n\t\tvar res = 0;\n\t\thours.forEach(function(interval){\n\t\t\tres+= interval.durationMinutes;\n\t\t});\n\t\treturn res;\n\t},\n\tgetHoursPerDay: function (date) {\n\t\tvar hours = this._getWorkHours(date);\n\t\tvar res = 0;\n\t\thours.forEach(function(interval){\n\t\t\tres+= interval.durationHours;\n\t\t});\n\t\treturn res;\n\t},\n\t_getWorkUnitsForRange: function (from, to, unit, step) {\n\t\tvar total = 0;\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\n\t\tvar getUnitsPerDay;\n\t\tif (unit == \"minute\") {\n\t\t\tgetUnitsPerDay = utils.bind(this._getMinutesPerDay, this);\n\t\t} else {\n\t\t\tgetUnitsPerDay = utils.bind(this.getHoursPerDay, this);\n\t\t}\n\n\t\twhile (start.valueOf() < end.valueOf()) {\n\t\t\tif(end - start > 1000*60*60*24*32 && start.getDate() === 0) {\n\t\t\t\tvar units = this._largeUnitsCache.getMinutesPerMonth(start);\n\t\t\t\tif(unit == \"hour\"){\n\t\t\t\t\tunits = units / 60;\n\t\t\t\t}\n\t\t\t\ttotal += units;\n\t\t\t\tstart = this.$gantt.date.add(start, 1, \"month\");\n\t\t\t\tcontinue;\n\t\t\t}else if(end - start > 1000*60*60*24*16) {\n\t\t\t\tvar weekStart = this.$gantt.date.week_start(new Date(start));\n\t\t\t\tif(start.valueOf() === weekStart.valueOf()){\n\t\t\t\t\tvar units = this._largeUnitsCache.getMinutesPerWeek(start);\n\t\t\t\t\tif(unit == \"hour\"){\n\t\t\t\t\t\tunits = units / 60;\n\t\t\t\t\t}\n\t\t\t\t\ttotal += units;\n\t\t\t\t\tstart = this.$gantt.date.add(start, 7, \"day\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t//\tif (this._isWorkTime(start, \"day\")) {\n\t\t\ttotal += getUnitsPerDay(start);\n\t\t//\t}\n\t\t\tstart = this._nextDate(start, \"day\", 1);\n\t\t}\n\n\t\treturn total / step;\n\t},\n\n\n\t_getMinutesBetweenSingleDay: function(from, to){\n\t\tvar range = this._getIntervalTimestamp(from, to);\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tvar result = 0;\n\n\t\tfor(var i = 0; i < worktimes.length; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\n\n\t\t\t\tresult += (minuteTo - minuteFrom) / 60;\n\t\t\t\trange.start = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\treturn Math.floor(result);\n\t},\n\n\t_getMinutesBetween: function(from, to, unit, step){\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\n\t\tvar firstDayStart = new Date(start);\n\t\tvar firstDayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(start)), 1, \"day\");\n\n\t\tif (end.valueOf() <= firstDayEnd.valueOf()) {\n\t\t\treturn this._getMinutesBetweenSingleDay(from, to);\n\t\t} else {\n\n\t\t\tvar lastDayStart = this.$gantt.date.day_start(new Date(end));\n\t\t\tvar lastDayEnd = end;\n\n\t\t\tvar startPart = this._getMinutesBetweenSingleDay(firstDayStart, firstDayEnd);\n\t\t\tvar endPart = this._getMinutesBetweenSingleDay(lastDayStart, lastDayEnd);\n\n\t\t\tvar rangePart = this._getWorkUnitsForRange(firstDayEnd, lastDayStart, unit, step);\n\t\t\tvar total = startPart + rangePart + endPart;\n\n\t\t\treturn total;\n\t\t}\n\t},\n\t// optimized method for calculating work units duration of large time spans\n\t// implemented for hours and minutes units, bigger time units don't benefit from the optimization so much\n\t_getHoursBetween: function (from, to, unit, step) {\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\n\t\tvar firstDayStart = new Date(start);\n\t\tvar firstDayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(start)), 1, \"day\");\n\n\t\tif (end.valueOf() <= firstDayEnd.valueOf()) {\n\t\t\treturn Math.round(this._getMinutesBetweenSingleDay(from, to) / 60);\n\t\t} else {\n\n\t\t\tvar lastDayStart = this.$gantt.date.day_start(new Date(end));\n\t\t\tvar lastDayEnd = end;\n\n\t\t\tvar startPart = this._getMinutesBetweenSingleDay(firstDayStart, firstDayEnd, unit, step) / 60;\n\t\t\tvar endPart = this._getMinutesBetweenSingleDay(lastDayStart, lastDayEnd, unit, step) / 60;\n\n\t\t\tvar rangePart = this._getWorkUnitsForRange(firstDayEnd, lastDayStart, unit, step);\n\t\t\tvar total = startPart + rangePart + endPart;\n\n\t\t\treturn Math.round(total);\n\t\t}\n\t},\n\n\tgetConfig: function () {\n\t\treturn this._worktime;\n\t},\n\t_setConfig: function (settings) {\n\t\tthis._worktime = settings;\n\t\tthis._parseSettings();\n\t\tthis._clearCaches();\n\t},\n\t_parseSettings: function() {\n\t\tvar settings = this.getConfig();\n\t\tsettings.parsed = {\n\t\t\tdates: {},\n\t\t\thours: null,\n\t\t\thaveCustomWeeks: false,\n\t\t\tcustomWeeks: {},\n\t\t\tcustomWeeksRangeStart: null,\n\t\t\tcustomWeeksRangeEnd: null,\n\t\t\tcustomWeeksBoundaries: []\n\t\t};\n\n\t\tsettings.parsed.hours = this._parseHours(settings.hours);\n\t\tfor(var i in settings.dates){\n\t\t\tsettings.parsed.dates[i] = this._parseHours(settings.dates[i]);\n\t\t}\n\n\t\tif(settings.customWeeks) {\n\t\t\tvar minCustomRangeStart = null;\n\t\t\tvar maxCustomRangeEnd = null;\n\t\t\tfor(var i in settings.customWeeks){\n\t\t\t\tvar customTime = settings.customWeeks[i];\n\n\t\t\t\tif(customTime.from && customTime.to){\n\t\t\t\t\tvar rangeStart = customTime.from;\n\t\t\t\t\tvar rangeEnd = customTime.to;\n\t\t\t\t\tif(!minCustomRangeStart || minCustomRangeStart > rangeStart.valueOf()){\n\t\t\t\t\t\tminCustomRangeStart = rangeStart.valueOf();\n\t\t\t\t\t}\n\t\t\t\t\tif(!maxCustomRangeEnd || maxCustomRangeEnd < rangeEnd.valueOf()){\n\t\t\t\t\t\tmaxCustomRangeEnd = rangeEnd.valueOf();\n\t\t\t\t\t}\n\n\t\t\t\t\tsettings.parsed.customWeeksBoundaries.push({\n\t\t\t\t\t\tfrom: rangeStart.valueOf(),\n\t\t\t\t\t\tfromReadable: new Date(rangeStart),\n\t\t\t\t\t\tto: rangeEnd.valueOf(),\n\t\t\t\t\t\ttoReadable: new Date(rangeEnd),\n\t\t\t\t\t\tname: i\n\t\t\t\t\t});\n\n\t\t\t\t\tsettings.parsed.haveCustomWeeks = true;\n\t\t\t\t\tvar currentWeek = settings.parsed.customWeeks[i] = {\n\t\t\t\t\t\tfrom: customTime.from,\n\t\t\t\t\t\tto: customTime.to,\n\t\t\t\t\t\thours: this._parseHours(customTime.hours),\n\t\t\t\t\t\tdates: {}\n\t\t\t\t\t};\n\n\t\t\t\t\tfor(var d in customTime.dates){\n\t\t\t\t\t\tcurrentWeek.dates[d] = this._parseHours(customTime.dates[d]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsettings.parsed.customWeeksRangeStart = minCustomRangeStart;\n\t\t\tsettings.parsed.customWeeksRangeEnd = maxCustomRangeEnd;\n\n\t\t}\n\t},\n\n\t_tryChangeCalendarSettings: function (payload) {\n\t\tvar backup = JSON.stringify(this.getConfig());\n\t\tpayload();\n\t\tif (!this.hasWorkTime()) {\n\t\t//\tthis.$gantt.assert(false, \"Invalid calendar settings, no worktime available\");\n\t\t\tthis._setConfig(JSON.parse(backup));\n\t\t\tthis._clearCaches();\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\n\t},\n\n\t_arraysEqual: function(a, b){\n\t\tif (a === b) return true;\n\t\tif (!a || !b) return false;\n\t\tif (a.length != b.length) return false;\n\n\t\tfor (var i = 0; i < a.length; ++i) {\n\t\t\tif (a[i] !== b[i]) return false;\n\t\t}\n\t\treturn true;\n\t},\n\n\n\t_compareSettings: function (mySettings, thatSettings) {\n\t\tif (!this._arraysEqual(mySettings.hours, thatSettings.hours)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar myDays = Object.keys(mySettings.dates);\n\t\tvar otherDates = Object.keys(thatSettings.dates);\n\t\tmyDays.sort();\n\t\totherDates.sort();\n\n\t\tif (!this._arraysEqual(myDays, otherDates)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tfor(var i = 0; i < myDays.length; i++){\n\t\t\tvar timestamp = myDays[i];\n\t\t\tvar myHours = mySettings.dates[timestamp];\n\t\t\tvar otherHours = mySettings.dates[timestamp];\n\n\t\t\t// day settings not equal\n\t\t\tif(myHours !== otherHours &&\n\t\t\t\t// but still can be two arrays with the equivalent hour settings\n\t\t\t\t!(Array.isArray(myHours) && Array.isArray(otherHours) && this._arraysEqual(myHours, otherHours))\n\t\t\t\t){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n\n\tequals: function (calendar) {\n\t\tif(!(calendar instanceof CalendarWorkTimeStrategy)){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar mySettings = this.getConfig();\n\t\tvar thatSettings = calendar.getConfig();\n\n\t\tif(!this._compareSettings(mySettings, thatSettings)){\n\t\t\treturn false;\n\t\t}\n\n\t\tif(mySettings.parsed.haveCustomWeeks && thatSettings.parsed.haveCustomWeeks){\n\t\t\tif(mySettings.parsed.customWeeksBoundaries.length != thatSettings.parsed.customWeeksBoundaries.length){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tfor(var i in mySettings.parsed.customWeeks){\n\t\t\t\tvar myWeek = mySettings.parsed.customWeeks[i];\n\t\t\t\tvar thatWeek = thatSettings.parsed.customWeeks[i];\n\t\t\t\tif(!thatWeek){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif(!this._compareSettings(myWeek, thatWeek)){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}else if(mySettings.parse.haveCustomWeeks !== thatSettings.parsed.haveCustomWeeks){\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\tgetWorkHours: function () {\n\t\tvar config = this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper, arguments);\n\t\treturn this._getWorkHours(config.date, false);\n\t},\n\t_getWorkHours: function (date, parsed) {\n\t\tvar calendar = this.getConfig();\n\t\tif(parsed !== false){\n\t\t\tcalendar = calendar.parsed;\n\t\t}\n\n\t\tif(!date){\n\t\t\treturn calendar.hours;\n\t\t}\n\n\t\tvar dateValue = this._timestamp({date: date});\n\n\t\tif(calendar.haveCustomWeeks){\n\t\t\tif(calendar.customWeeksRangeStart <= dateValue && calendar.customWeeksRangeEnd > dateValue){\n\t\t\t\tfor(var i = 0; i < calendar.customWeeksBoundaries.length; i++){\n\t\t\t\t\tif(calendar.customWeeksBoundaries[i].from <= dateValue && calendar.customWeeksBoundaries[i].to > dateValue){\n\t\t\t\t\t\tcalendar = calendar.customWeeks[calendar.customWeeksBoundaries[i].name];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar hours = true;\n\n\t\tif (calendar.dates[dateValue] !== undefined) {\n\t\t\thours = calendar.dates[dateValue];//custom day\n\t\t} else if (calendar.dates[date.getDay()] !== undefined) {\n\t\t\thours = calendar.dates[date.getDay()];//week day\n\t\t}\n\t\tif (hours === true) {\n\t\t\treturn calendar.hours;\n\t\t} else if (hours) {\n\t\t\treturn hours;\n\t\t}\n\t\treturn [];\n\t},\n\n\t_getIntervalTimestamp: function(from, to){\n\t\tvar res = {\n\t\t\tstart: 0,\n\t\t\tend: 0\n\t\t};\n\n\t\tres.start = from.getHours() * 60 * 60 + from.getMinutes() * 60 + from.getSeconds();\n\t\tvar endHours = to.getHours();\n\t\tif(!endHours && !to.getMinutes() && !to.getSeconds() && from.valueOf() < to.valueOf()){\n\t\t\tendHours = 24;\n\t\t}\n\t\tres.end = endHours * 60 * 60 + to.getMinutes() * 60 + to.getSeconds();\n\t\treturn res;\n\t},\n\n\t_parseHours: function(hours) {\n\t\tif(Array.isArray(hours)){\n\n\t\t\tvar timestampRanges = [];// worktime as seconds range\n\t\t\thours.forEach(function(hour){\n\t\t\t\tif(typeof hour === \"number\"){\n\t\t\t\t\ttimestampRanges.push(hour*60*60);\n\t\t\t\t}else if(typeof hour === \"string\") {\n\t\t\t\t\t// \"12-13\", or \"12:00-13:00\", or \"12:00:00-13:00:00\"\n\t\t\t\t\thour.split(\"-\").map(function(time){\n\t\t\t\t\t\treturn time.trim();\n\t\t\t\t\t}).forEach(function(part){\n\t\t\t\t\t\tvar parsed = part.split(\":\").map(function(time){\n\t\t\t\t\t\t\treturn time.trim();\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tvar value = parseInt(parsed[0]*60*60);\n\t\t\t\t\t\tif(parsed[1]){\n\t\t\t\t\t\t\tvalue += parseInt(parsed[1]*60);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(parsed[2]){\n\t\t\t\t\t\t\tvalue += parseInt(parsed[2]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttimestampRanges.push(value);\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvar timerangeConfig = [];\n\t\t\tfor (var i = 0; i < timestampRanges.length; i += 2) {\n\t\t\t\tvar start = timestampRanges[i];\n\t\t\t\tvar end = timestampRanges[i + 1];\n\t\t\t\tvar duration = end - start;\n\n\t\t\t\ttimerangeConfig.push({\n\t\t\t\t\tstart: start,\n\t\t\t\t\tend: end,\n\t\t\t\t\tstartHour: Math.floor(start / (60*60)),\n\t\t\t\t\tstartMinute: Math.floor(start / (60)),\n\t\t\t\t\tendHour: Math.ceil(end / (60*60)),\n\t\t\t\t\tendMinute: Math.ceil(end / (60)),\n\t\t\t\t\tdurationSeconds: duration,\n\t\t\t\t\tdurationMinutes: duration/60,\n\t\t\t\t\tdurationHours: duration/(60 * 60)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn timerangeConfig;\n\t\t} else {\n\t\t\treturn hours;\n\t\t}\n\t},\n\n\tsetWorkTime: function (settings) {\n\t\treturn this._tryChangeCalendarSettings(utils.bind(function () {\n\t\t\tvar hours = settings.hours !== undefined ? settings.hours : true;\n\t\t\tvar timestamp = this._timestamp(settings);\n\t\t\tvar calendarConfig = this.getConfig();\n\t\t\tif (timestamp !== null) {\n\t\t\t\tcalendarConfig.dates[timestamp] = hours;\n\t\t\t} else if(!settings.customWeeks) {\n\t\t\t\tcalendarConfig.hours = hours;\n\t\t\t}\n\n\t\t\tif(settings.customWeeks){\n\t\t\t\tif(!calendarConfig.customWeeks){\n\t\t\t\t\tcalendarConfig.customWeeks = {};\n\t\t\t\t}\n\t\t\t\t// GS-1867. allow setWorkTime to exclude dates in the customWeeks range\n\t\t\t\tif (typeof settings.customWeeks == \"string\"){\n\t\t\t\t\tif (timestamp !== null) {\n\t\t\t\t\t\tcalendarConfig.customWeeks[settings.customWeeks].dates[timestamp] = hours;\n\t\t\t\t\t} else if(!settings.customWeeks) {\n\t\t\t\t\t\tcalendarConfig.customWeeks[settings.customWeeks].hours = hours;\n\t\t\t\t\t}\t\t\n\t\t\t\t} else if (typeof settings.customWeeks === \"object\"\n\t\t\t\t&& Function.prototype.toString.call(settings.customWeeks.constructor) === \"function Object() { [native code] }\"){\n\t\t\t\t\tfor(var i in settings.customWeeks){\n\t\t\t\t\t\tcalendarConfig.customWeeks[i] = settings.customWeeks[i];\n\t\t\t\t\t}\t\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._parseSettings();\n\t\t\tthis._clearCaches();\n\t\t}, this));\n\t},\n\n\tunsetWorkTime: function (settings) {\n\t\treturn this._tryChangeCalendarSettings(utils.bind(function () {\n\t\t\tif (!settings) {\n\t\t\t\tthis.reset_calendar();\n\t\t\t} else {\n\n\t\t\t\tvar timestamp = this._timestamp(settings);\n\n\t\t\t\tif (timestamp !== null) {\n\t\t\t\t\tdelete this.getConfig().dates[timestamp];\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Load updated settings and clear work units cache\n\t\t\tthis._parseSettings();\n\t\t\tthis._clearCaches();\n\t\t}, this));\n\t},\n\n\t_isWorkTime: function (date, unit) {\n\t\t// Check if this item has in the cache\n\n\t\tvar useCache = true;//unit === \"day\"; // use cache only for days. In case of hours/minutes cache size grows too large and the overhead exceeds the gains\n\t\tvar isWorkUnit = -1;\n\t\tvar dateKey = null;\n\n\t\tif(useCache){\n\t\t\t// use string keys\n\t\t\tdateKey = String(date.valueOf());\n\t\t\tisWorkUnit = this._workingUnitsCache.getItem(unit, dateKey, date);\n\t\t}\n\n\t\tif (isWorkUnit == -1) {\n\t\t\t// calculate if not cached\n\t\t\tisWorkUnit = this._checkIfWorkingUnit(date, unit);\n\t\t\tif(useCache){\n\t\t\t\tthis._workingUnitsCache.setItem(unit, dateKey, isWorkUnit, date);\n\t\t\t}\n\t\t}\n\n\t\treturn isWorkUnit;\n\t},\n\n\tisWorkTime: function () {\n\t\tvar config =  this.argumentsHelper.isWorkTimeArguments.apply( this.argumentsHelper, arguments);\n\t\treturn this._isWorkTime(config.date, config.unit);\n\t},\n\n\tcalculateDuration: function () {\n\t\tvar config =  this.argumentsHelper.getDurationArguments.apply( this.argumentsHelper, arguments);\n\n\t\tif (!config.unit) {\n\t\t\treturn false;\n\t\t}\n\t\t//return this._calculateDuration(config.start_date, config.end_date, config.unit, config.step);\n\n\t\tvar self = this;\n\t\treturn this._dateDurationCache.getDuration(config.start_date, config.end_date, config.unit, config.step, function(){ \n\t\t\treturn self._calculateDuration(config.start_date, config.end_date, config.unit, config.step);\n\t\t});\n\t},\n\n\t_calculateDuration: function (from, to, unit, step) {\n\t\tvar res = 0;\n\n\t\tvar sign = 1;\n\t\tif(from.valueOf() > to.valueOf()){\n\t\t\tvar tmp = to;\n\t\t\tto = from;\n\t\t\tfrom = tmp;\n\t\t\tsign = -1;\n\t\t}\n\n\t\tif (unit == \"hour\" && step == 1) {\n\t\t\tres = this._getHoursBetween(from, to, unit, step);\n\t\t} else if(unit == \"minute\" && step == 1){\n\t\t\t// quick calculation for minutes with 1 minute step\n\t\t\tres = this._getMinutesBetween(from, to, unit, step);\n\t\t} else {\n\t\t\tres = this._getWorkUnitsBetweenGeneric(from, to, unit, step);\n\t\t}\n\n\t\t// getWorkUnits.. returns decimal durations\n\t\treturn sign * Math.round(res);\n\t},\n\thasDuration: function () {\n\t\tvar config =  this.argumentsHelper.getDurationArguments.apply( this.argumentsHelper, arguments);\n\n\t\tvar from = config.start_date,\n\t\t\tto = config.end_date,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\tif (!unit) {\n\t\t\treturn false;\n\t\t}\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\n\t\twhile (start.valueOf() < end.valueOf()) {\n\t\t\tif (this._isWorkTime(start, unit))\n\t\t\t\treturn true;\n\t\t\tstart = this._nextDate(start, unit, step);\n\t\t}\n\t\treturn false;\n\t},\n\n\tcalculateEndDate: function () {\n\t\tvar config =  this.argumentsHelper.calculateEndDateArguments.apply( this.argumentsHelper, arguments);\n\n\t\tvar from = config.start_date,\n\t\t\tduration = config.duration,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\tif (!unit)\n\t\t\treturn false;\n\n\t\tvar mult = (config.duration >= 0) ? 1 : -1;\n\t\tduration = Math.abs(duration * 1);\n\t//\tvar endDate = this._calculateEndDate(from, duration, unit, step * mult);\n\t//\treturn endDate;\n\t\tvar self = this;\n\t\treturn this._dateDurationCache.getEndDate(from, duration, unit, step * mult, function(){ \n\t\t\treturn self._calculateEndDate(from, duration, unit, step * mult);\n\t\t} );\n\t},\n\n\t_calculateEndDate: function (from, duration, unit, step) {\n\t\tif (!unit)\n\t\t\treturn false;\n\n\t\tif (step == 1 && unit == \"minute\") {\n\t\t\treturn this._calculateMinuteEndDate(from, duration, step);\n\t\t} else if(step == -1 && unit == \"minute\") {\n\t\t\treturn this._subtractMinuteDate(from, duration, step);\n\t\t} else if (step == 1 && unit == \"hour\") {\n\t\t\treturn this._calculateHourEndDate(from, duration, step);\n\t\t} else {\n\t\t\tvar interval = this._addInterval(from, duration, unit, step, null);\n\t\t\treturn interval.end;\n\t\t}\n\t},\n\n\t_addInterval: function (start, duration, unit, step, stopAction) {\n\t\tvar added = 0;\n\t\tvar current = start;\n\t\tvar dstShift = false;\n\n\t\twhile (added < duration && !(stopAction && stopAction(current))) {\n\t\t\tvar next = this._nextDate(current, unit, step);\n\n\t\t\t// GS-1501. Correct hours after DST change\n\t\t\tif (unit == \"day\"){\n\t\t\t\tdstShift = dstShift || !current.getHours() && next.getHours();\n\n\t\t\t\tif (dstShift){\n\t\t\t\t\tnext.setHours(0);\n\t\t\t\t\tif (next.getHours()){\n\t\t\t\t\t// the day when the timezone is changed, try to correct hours next time\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdstShift = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar dateValue = new Date(next.valueOf() + 1);\n\t\t\tif (step > 0) {\n\t\t\t\tdateValue = new Date(next.valueOf() - 1);\n\t\t\t}\n\t\t\tvar workTimeCheck = this._isWorkTime(dateValue, unit);\n\n\t\t\tif (workTimeCheck && !dstShift) {\n\t\t\t\tadded++;\n\t\t\t}\n\t\t\tcurrent = next;\n\t\t}\n\t\treturn {\n\t\t\tend: current,\n\t\t\tstart: start,\n\t\t\tadded: added\n\t\t};\n\t},\n\n\t_addHoursUntilDayEnd: function(from, duration) {\n\t\tvar dayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(from)), 1, \"day\");\n\t\tvar added = 0;\n\t\tvar left = duration;\n\n\t\tvar range = this._getIntervalTimestamp(from, dayEnd);\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tfor(var i = 0; i < worktimes.length && added < duration; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\n\t\t\t\tvar rangeHours = (minuteTo - minuteFrom) / (60 * 60);\n\t\t\t\tif(rangeHours > left){\n\t\t\t\t\trangeHours = left;\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60 * 60);\n\t\t\t\t}\n\n\t\t\t\tvar addHours = Math.round((minuteTo - minuteFrom) / (60 * 60));\n\t\t\t\tadded += addHours;\n\t\t\t\tleft -= addHours;\n\t\t\t\trange.start = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\tvar intervalEnd = dayEnd;\n\t\tif(added === duration){\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, range.start);\n\t\t}\n\t\treturn {\n\t\t\tadded: added,\n\t\t\tend: intervalEnd\n\t\t};\n\t},\n\n\t_calculateHourEndDate: function (from, duration,  step) {\n\t\tvar start = new Date(from),\n\t\tadded = 0;\n\t\tstep = step || 1;\n\t\tduration = Math.abs(duration * 1);\n\n\t\tvar interval = this._addHoursUntilDayEnd(start, duration);\n\t\tadded = interval.added;\n\t\tstart = interval.end;\n\n\t\tvar durationLeft = duration - added;\n\n\t\tif (durationLeft) {\n\t\t\tvar current = start;\n\t\t\twhile (added < duration) {\n\t\t\t\tvar next = this._nextDate(current, \"day\", step);\n\t\t\t\t// reset to day start in case DST switch happens in the process\n\t\t\t\tnext.setHours(0);\n\t\t\t\tnext.setMinutes(0);\n\t\t\t\tnext.setSeconds(0);\n\n\t\t\t\tvar hoursPerDay = 0;\n\t\t\t\tif(step > 0){\n\t\t\t\t\thoursPerDay = this.getHoursPerDay(new Date(next.valueOf() - 1));\n\t\t\t\t}else{\n\t\t\t\t\thoursPerDay = this.getHoursPerDay(new Date(next.valueOf() + 1));\n\t\t\t\t}\n\n\t\t\t\tif (added + hoursPerDay >= duration) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tadded += hoursPerDay;\n\t\t\t\t}\n\n\t\t\t\tcurrent = next;\n\t\t\t}\n\t\t\tstart = current;\n\t\t}\n\n\t\tif (added < duration) {\n\t\t\tvar durationLeft = duration - added;\n\t\t\tinterval = this._addHoursUntilDayEnd(start, durationLeft);\n\t\t\tstart = interval.end;\n\t\t}\n\n\t\treturn start;\n\t},\n\n\t_addMinutesUntilHourEnd: function(from, duration){\n\t\tif(from.getMinutes() === 0) {\n\t\t\t// already at hour end\n\t\t\treturn {\n\t\t\t\tadded: 0,\n\t\t\t\tend: new Date(from)\n\t\t\t};\n\t\t}\n\t\tvar hourEnd = this.$gantt.date.add(this.$gantt.date.hour_start(new Date(from)), 1, \"hour\");\n\t\tvar added = 0;\n\t\tvar left = duration;\n\n\t\tvar range = this._getIntervalTimestamp(from, hourEnd);\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tfor(var i = 0; i < worktimes.length && added < duration; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\n\t\t\t\tvar rangeMinutes = (minuteTo - minuteFrom) / 60;\n\t\t\t\tif(rangeMinutes > left){\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60);\n\t\t\t\t}\n\n\t\t\t\t// TODO: verify testcase https://dhtmlxsupport.teamwork.com/desk/tickets/9625700/messages\n\t\t\t\t/*if (rangeMinutes === 0) {\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60);\n\t\t\t\t}*/\n\n\t\t\t\tvar addMinutes = Math.round((minuteTo - minuteFrom) / 60);\n\t\t\t\tleft -= addMinutes;\n\t\t\t\tadded += addMinutes;\n\t\t\t\trange.start = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\tvar intervalEnd = hourEnd;\n\t\tif(added === duration){\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, range.start);\n\t\t}\n\t\treturn {\n\t\t\tadded: added,\n\t\t\tend: intervalEnd\n\t\t};\n\t},\n\n\t_subtractMinutesUntilHourStart: function(from, duration){\n\t\tvar hourStart = this.$gantt.date.hour_start(new Date(from));\n\t\tvar added = 0;\n\t\tvar left = duration;\n\n\t\tvar hourStartTimestamp = hourStart.getHours() * 60 * 60 + hourStart.getMinutes() * 60 + hourStart.getSeconds();\n\t\tvar initialDateTimestamp = from.getHours() * 60 * 60 + from.getMinutes() * 60 + from.getSeconds();\n\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tfor(var i = worktimes.length - 1; i >= 0 && added < duration; i--){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(initialDateTimestamp > interval.start && hourStartTimestamp <= interval.end){\n\t\t\t\tvar minuteFrom = Math.min(initialDateTimestamp, interval.end);\n\t\t\t\tvar minuteTo = Math.max(hourStartTimestamp, interval.start);\n\n\t\t\t//\tvar minuteFrom = Math.max(interval.start, currentHour.start);\n\t\t\t//\tvar minuteTo = Math.min(interval.end, currentHour.end);\n\t\t\t\tvar rangeMinutes = (minuteFrom - minuteTo) / 60;\n\t\t\t\tif(rangeMinutes > left){\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom - (left * 60);\n\t\t\t\t}\n\n\t\t\t\t// TODO: verify testcase https://dhtmlxsupport.teamwork.com/desk/tickets/9625700/messages\n\t\t\t\t/*if (rangeMinutes === 0) {\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom - (left * 60);\n\t\t\t\t}*/\n\n\t\t\t\tvar addMinutes = Math.abs(Math.round((minuteFrom - minuteTo) / 60));\n\t\t\t\tleft -= addMinutes;\n\t\t\t\tadded += addMinutes;\n\t\t\t\tinitialDateTimestamp = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\tvar intervalEnd = hourStart;\n\t\tif(added === duration){\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, initialDateTimestamp);\n\t\t}\n\t\treturn {\n\t\t\tadded: added,\n\t\t\tend: intervalEnd\n\t\t};\n\t},\n\n\t_subtractMinuteDate: function (from, duration, step) {\n\t\t// var start = new Date(from),\n\t\t// GS-2683. We should start calculating minutes from the working time\n\t\tvar start = this.getClosestWorkTime({ date: from, dir: \"past\", unit: \"minute\" }),\n\t\t\tadded = 0;\n\t\tstep = step || -1;\n\t\tduration = Math.abs(duration * 1);\n\t\tduration = Math.round(duration);\n\n\t\tconst minutePrecision = this._isMinutePrecision(start);\n\n\t\tlet addedInterval = this._subtractMinutesUntilHourStart(start, duration);\n\t\tadded += addedInterval.added;\n\n\t\tstart = addedInterval.end;\n\n\t\tvar calculatedDay = 0;\n\t\tvar daySchedule = [];\n\t\tvar minutesInDay = 0;\n\n\t\twhile (added < duration) {\n\t\t\tvar dayStart = this.$gantt.date.day_start(new Date(start));\n\n\t\t\tvar iterateFromDayEnd = false;\n\t\t\tif(start.valueOf() === dayStart.valueOf()){\n\t\t\t\tdayStart = this.$gantt.date.add(dayStart, -1, \"day\");\n\t\t\t\titerateFromDayEnd = true;\n\t\t\t}\n\t\t\t//var dayStartTimestamp = this.$gantt.date.day_start(new Date(start)).valueOf();\n\t\t\tvar dayEnd = new Date(dayStart.getFullYear(), dayStart.getMonth(), dayStart.getDate(), 23, 59,59,999).valueOf();\n\n\t\t\tif(dayEnd !== calculatedDay){\n\t\t\t\tdaySchedule = this._getWorkHours(dayStart);\n\t\t\t\tminutesInDay = this._getMinutesPerDay(dayStart);\n\t\t\t\tcalculatedDay = dayEnd;\n\t\t\t}\n\n\t\t\tvar left = duration - added;\n\t\t\tvar timestamp = this._getTimeOfDayStamp(start, iterateFromDayEnd);\n\n\t\t\tif(!daySchedule.length || !minutesInDay){\n\t\t\t\tstart = this.$gantt.date.add(start, -1, \"day\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(daySchedule[daySchedule.length - 1].end <= timestamp){\n\t\t\t\tif(left > minutesInDay){\n\t\t\t\t\tadded += minutesInDay;\n\t\t\t\t\tstart = this.$gantt.date.add(start, -1, \"day\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar isWorkHour = false;\n\t\t\tvar workInterval = null;\n\t\t\tvar prevInterval = null;\n\t\t\tfor(var i = daySchedule.length - 1; i >= 0; i--){\n\t\t\t\tif(daySchedule[i].start < timestamp - 1 && daySchedule[i].end >= timestamp - 1){\n\t\t\t\t\tisWorkHour = true;\n\t\t\t\t\tworkInterval = daySchedule[i];\n\t\t\t\t\tprevInterval = daySchedule[i-1];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(isWorkHour){\n\n\t\t\t\t// we're at the end of worktime interval and subtracting more than the duration of the interval\n\t\t\t\t// -> subtract the duration of the interval and move to the start of the interval (we're moving from end)\n\t\t\t\tif(timestamp === workInterval.end && left >= workInterval.durationMinutes){\n\t\t\t\t\tadded += workInterval.durationMinutes;\n\t\t\t\t\tstart = this.$gantt.date.add(start, -workInterval.durationMinutes, \"minute\");\n\t\t\t\t} // worktime is set in whole hours (no intervals like 9:15-10:00)\n\t\t\t\t// the amount we need to subtract lies inside the interval\n\t\t\t\telse if(!minutePrecision && left <= (timestamp/60 - workInterval.startMinute)){\n\t\t\t\t\tadded += left;\n\t\t\t\t\tstart = this.$gantt.date.add(start, -left, \"minute\");\n\t\t\t\t}else if (minutePrecision){\n\t\t\t\t\t// GS-2129. If the working time is set in minutes, we accumulate the working time in minutes from right to left\n\t\t\t\t\t\n\t\t\t\t\t// duration we need to subtract lies completely inside the work interval\n\t\t\t\t\tif(left <= (timestamp/60 - workInterval.startMinute)){\n\t\t\t\t\t\tadded += left;\n\t\t\t\t\t\tstart = this.$gantt.date.add(start, -left, \"minute\");\n\t\t\t\t\t}else {\n\t\t\t\t\t\t// we need to go trough multiple work intervals to subtract needed time\n\t\t\t\t\t\tadded += (timestamp/60 - workInterval.startMinute);\n\t\t\t\t\t\tif(prevInterval){\n\t\t\t\t\t\t\tstart = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, prevInterval.end);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\n\t\t\t\t}else{\n\t\t\t\t\tvar minutesInHour = this._getMinutesPerHour(start);\n\t\t\t\t\tif(minutesInHour <= left){\n\t\t\t\t\t\tadded += minutesInHour;\n\t\t\t\t\t\tstart = this._nextDate(start, \"hour\", step);\n\t\t\t\t\t}else{\n\t\t\t\t\t\taddedInterval = this._subtractMinutesUntilHourStart(start, left);\n\t\t\t\t\t\tadded += addedInterval.added;\n\t\t\t\t\t\tstart = addedInterval.end;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(start.getHours() === 0 && start.getMinutes() === 0 && start.getSeconds() === 0){\n\t\t\t\t\tvar prev = this._getClosestWorkTimePast(start, \"hour\");\n\t\t\t\t\tif(prev.valueOf() === start.valueOf()){\n\t\t\t\t\t\tvar prev = this.$gantt.date.add(start, -1, \"day\");\n\t\t\t\t\t\tvar times = this._getWorkHours(prev);\n\t\t\t\t\t\tif(times.length){\n\t\t\t\t\t\t\tvar lastInterval = times[times.length - 1];\n\t\t\t\t\t\t\tprev.setSeconds(lastInterval.durationSeconds);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tstart = prev;\n\n\t\t\t\t} else{\n\t\t\t\t\tstart = this._getClosestWorkTimePast(new Date(start - 1), \"hour\");\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tif (added < duration) {\n\t\t\tvar durationLeft = duration - added;\n\t\t\taddedInterval = this._subtractMinutesUntilHourStart(start, durationLeft);\n\t\t\tadded += addedInterval.added;\n\t\t\tstart = addedInterval.end;\n\t\t}\n\n\t\treturn start;\n\t},\n\t_calculateMinuteEndDate: function (from, duration, step) {\n\t\tvar start = new Date(from),\n\t\t\tadded = 0;\n\t\tstep = step || 1;\n\t\tduration = Math.abs(duration * 1);\n\t\tduration = Math.round(duration);\n\n\t\tvar addedInterval = this._addMinutesUntilHourEnd(start, duration);\n\t\tadded += addedInterval.added;\n\n\t\tstart = addedInterval.end;\n\n\t\tvar calculatedDay = 0;\n\t\tvar daySchedule = [];\n\t\tvar minutesInDay = 0;\n\n\t\tvar minutePrecision = this._isMinutePrecision(start);\n\n\t\twhile (added < duration) {\n\t\t\tvar dayStart = this.$gantt.date.day_start(new Date(start)).valueOf();\n\t\t\tif(dayStart !== calculatedDay){\n\t\t\t\tdaySchedule = this._getWorkHours(start);\n\t\t\t\tminutesInDay = this._getMinutesPerDay(start);\n\t\t\t\tcalculatedDay = dayStart;\n\n\t\t\t}\n\n\t\t\tvar left = duration - added;\n\t\t\tvar timestamp = this._getTimeOfDayStamp(start);\n\n\t\t\tif(!daySchedule.length || !minutesInDay){\n\t\t\t\tstart = this.$gantt.date.add(this.$gantt.date.day_start(start), 1, \"day\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(daySchedule[0].start >= timestamp){\n\t\t\t\tif(left >= minutesInDay){\n\t\t\t\t\tadded += minutesInDay;\n\t\t\t\t\tif (left == minutesInDay) {\n\t\t\t\t\t\tstart = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, daySchedule[daySchedule.length - 1].end);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tstart = this.$gantt.date.add(start, 1, \"day\");\n\t\t\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar isWorkHour = false;\n\t\t\tvar workInterval = null;\n\t\t\tfor(var i = 0; i < daySchedule.length; i++){\n\t\t\t\tif(daySchedule[i].start <= timestamp && daySchedule[i].end > timestamp){\n\t\t\t\t\tisWorkHour = true;\n\t\t\t\t\tworkInterval = daySchedule[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(isWorkHour){\n\n\t\t\t\tif(timestamp === workInterval.start && left >= workInterval.durationMinutes){\n\t\t\t\t\tadded += workInterval.durationMinutes;\n\t\t\t\t\tstart = this.$gantt.date.add(start, workInterval.durationMinutes, \"minute\");\n\t\t\t\t}else if(left <= (workInterval.endMinute - timestamp/60)){\n\t\t\t\t\tadded += left;\n\t\t\t\t\tstart = this.$gantt.date.add(start, left, \"minute\");\n\t\t\t\t}else{\n\t\t\t\t\tvar minutesInHour = this._getMinutesPerHour(start);\n\t\t\t\t\tif(minutesInHour <= left){\n\t\t\t\t\t\tadded += minutesInHour;\n\t\t\t\t\t\t// when the working time settings are set in minutes move to the next minutes\n\t\t\t\t\t\tif (minutePrecision) {\n\t\t\t\t\t\t\tstart = this.$gantt.date.add(start, minutesInHour, \"minute\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstart = this._nextDate(start, \"hour\", step);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\taddedInterval = this._addMinutesUntilHourEnd(start, left);\n\t\t\t\t\t\tadded += addedInterval.added;\n\t\t\t\t\t\tstart = addedInterval.end;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tstart = this._getClosestWorkTimeFuture(start, \"hour\");\n\t\t\t}\n\t\t}\n\n\t\tif (added < duration) {\n\t\t\tvar durationLeft = duration - added;\n\t\t\taddedInterval = this._addMinutesUntilHourEnd(start, durationLeft);\n\t\t\tadded += addedInterval.added;\n\t\t\tstart = addedInterval.end;\n\t\t}\n\n\t\treturn start;\n\t},\n\n\tgetClosestWorkTime: function () {\n\t\tvar settings =  this.argumentsHelper.getClosestWorkTimeArguments.apply( this.argumentsHelper, arguments);\n\t\treturn this._getClosestWorkTime(settings.date, settings.unit, settings.dir);\n\t},\n\n\t_getClosestWorkTime: function (inputDate, unit, direction) {\n\t\tvar result = new Date(inputDate);\n\n\t\tif (this._isWorkTime(result, unit)) {\n\t\t\treturn result;\n\t\t}\n\n\t\tresult = this.$gantt.date[unit + '_start'](result);\n\n\t\tif (direction == 'any' || !direction) {\n\t\t\tvar closestFuture = this._getClosestWorkTimeFuture(result, unit);\n\t\t\tvar closestPast = this._getClosestWorkTimePast(result, unit);\n\t\t\tif (Math.abs(closestFuture - inputDate) <= Math.abs(inputDate - closestPast)) {\n\t\t\t\tresult = closestFuture;\n\t\t\t} else {\n\t\t\t\tresult = closestPast;\n\t\t\t}\n\t\t} else if (direction == \"past\") {\n\t\t\tresult = this._getClosestWorkTimePast(result, unit);\n\t\t} else {\n\t\t\tresult = this._getClosestWorkTimeFuture(result, unit);\n\t\t}\n\t\treturn result;\n\t},\n\n\t_getClosestWorkTimeFuture: function (date, unit) {\n\t\treturn this._getClosestWorkTimeGeneric(date, unit, 1);\n\t},\n\n\t_getClosestWorkTimePast: function (date, unit) {\n\t\tvar result = this._getClosestWorkTimeGeneric(date, unit, -1);\n\t\t// should return the end of the closest work interval\n\t\treturn this.$gantt.date.add(result, 1, unit);\n\t},\n\n\t_findClosestTimeInDay: function(date, direction, worktimes) {\n\t\tvar start = new Date(date);\n\t\tvar resultDate = null;\n\t\tvar fromDayEnd = false;\n\t\tif(!this._getWorkHours(start).length){\n\t\t\tstart = this._getClosestWorkTime(start, \"day\", direction < 0 ? \"past\" : \"future\");\n\t\t\tif(direction < 0){\n\t\t\t\tstart = new Date(start.valueOf() - 1);\n\t\t\t\tfromDayEnd = true;\n\t\t\t}\n\t\t\tworktimes = this._getWorkHours(start);\n\t\t}\n\n\t\tvar value = this._getTimeOfDayStamp(start);\n\t\tif(fromDayEnd){\n\t\t\tvalue = this._getTimeOfDayStamp(new Date(start.valueOf() + 1), fromDayEnd);\n\t\t}\n\t\tif(direction > 0){\n\t\t\tfor(var i = 0; i < worktimes.length; i++){\n\t\t\t\tif(worktimes[i].start >= value){\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, worktimes[i].start);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}else{\n\t\t\tfor(var i = worktimes.length - 1; i >= 0; i--){\n\t\t\t\tif(worktimes[i].end <= value){\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, worktimes[i].end);\n\t\t\t\t\tbreak;\n\t\t\t\t}else if(worktimes[i].end > value && worktimes[i].start <= value) {\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, value);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn resultDate;\n\t},\n\t_getClosestWorkMinute: function(date, unit, direction) {\n\t\tvar start = new Date(date);\n\t\tvar worktimes = this._getWorkHours(start);\n\t\tvar resultDate = this._findClosestTimeInDay(start, direction, worktimes);\n\t\tif(!resultDate){\n\t\t\tif(direction > 0){\n\t\t\t\tstart = this.calculateEndDate(start, direction, unit);\n\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t}else{\n\t\t\t\tstart = this.calculateEndDate(start, direction, \"day\");\n\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t\tstart = this.$gantt.date.add(start, 1, \"day\");\n\t\t\t\tstart = new Date(start.valueOf() - 1);\n\t\t\t}\n\t\t\tworktimes = this._getWorkHours(start);\n\t\t\tresultDate = this._findClosestTimeInDay(start, direction, worktimes);\n\t\t}\n\t\tif(direction < 0){\n\t\t\t// getClosestWorkTimePast adds one time unit to the result date after this\n\t\t\tresultDate = this.$gantt.date.add(resultDate, -1, unit);\n\t\t}\n\t\treturn resultDate;\n\t},\n\n\t_getClosestWorkTimeGeneric: function (date, unit, increment) {\n\t\tif(unit === \"hour\" || unit === \"minute\"){\n\t\t\treturn this._getClosestWorkMinute(date, unit, increment);\n\t\t}\n\n\t\tvar unitOrder = this._getUnitOrder(unit),\n\t\t\tbiggerTimeUnit = this.units[unitOrder - 1];\n\n\t\tvar result = date;\n\n\t\t// be extra sure we won't fall into infinite loop, 3k seems big enough\n\t\tvar maximumLoop = 3000,\n\t\t\tcount = 0;\n\n\t\twhile (!this._isWorkTime(result, unit)) {\n\t\t\tif (biggerTimeUnit && !this._isWorkTime(result, biggerTimeUnit)) {\n\t\t\t\t// if we look for closest work hour and detect a week-end - first find the closest work day,\n\t\t\t\t// and continue iterations after that\n\t\t\t\tif (increment > 0) {\n\t\t\t\t\tresult = this._getClosestWorkTimeFuture(result, biggerTimeUnit);\n\t\t\t\t} else {\n\t\t\t\t\tresult = this._getClosestWorkTimePast(result, biggerTimeUnit);\n\t\t\t\t}\n\n\t\t\t\tif (this._isWorkTime(result, unit)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcount++;\n\t\t\tif (count > maximumLoop) {\n\t\t\t\tthis.$gantt.assert(false, \"Invalid working time check\");\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar tzOffset = result.getTimezoneOffset();\n\t\t\tresult = this.$gantt.date.add(result, increment, unit);\n\n\t\t\tresult = this.$gantt._correct_dst_change(result, tzOffset, increment, unit);\n\t\t\tif (this.$gantt.date[unit + '_start']) {\n\t\t\t\tresult = this.$gantt.date[unit + '_start'](result);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Check whether this calendar has working time. Calendar has working time only if there are regular working days of week\n\t *\n\t */\n\thasWorkTime: function () {\n\t\tvar worktime = this.getConfig();\n\t\tvar dates = worktime.dates;\n\n\t\tvar daysOfWeek = [0, 1, 2, 3, 4, 5, 6];\n\t\tvar exceptions = [];\n\t\tfor(var i in worktime.dates){\n\t\t\tif(Number(i) > 6){\n\t\t\t\texceptions.push(Number(i));\n\t\t\t}\n\t\t}\n\n\t\tvar hasRegularHours = this._checkWorkHours(worktime.hours);\n\n\t\tvar result = false;\n\t\tdaysOfWeek.forEach((function(day){\n\t\t\tif(result){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar dayConfig = dates[day];\n\t\t\tif(dayConfig === true){\n\t\t\t\t// workday uses global hours\n\t\t\t\tresult = hasRegularHours;\n\t\t\t}else if(Array.isArray(dayConfig)){\n\t\t\t\t// workday uses custom hours\n\t\t\t\tresult = this._checkWorkHours(dayConfig);\n\t\t\t}\n\t\t}).bind(this));\n\n\t\treturn result;\n\n\t},\n\n\t_checkWorkHours: function(hoursArray) {\n\t\tif (hoursArray.length === 0) {\n\t\t\treturn false;\n\t\t}\n\t\tvar result = false;\n\t\tfor (var i = 0; i < hoursArray.length; i += 2) {\n\t\t\tif (hoursArray[i] !== hoursArray[i + 1]) {\n\t\t\t\tresult = true;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t_isMinutePrecision: function (date) {\n\t\tlet minutePrecision = false;\n\t\tthis._getWorkHours(date).forEach(function(interval){\n\t\t\tif (interval.startMinute % 60 || interval.endMinute % 60){\n\t\t\t\tminutePrecision = true;\n\t\t\t}\n\t\t});\n\t\treturn minutePrecision;\n\t}\n};\n\nexport default CalendarWorkTimeStrategy;","import { IWorkUnitCache } from \"./workunit_cache_interface\";\nimport { WorkUnitsMapCache } from \"./workunit_map_cache\";\nimport { WorkUnitsObjectCache } from \"./workunit_object_cache\";\nexport { LargerUnitsCache } from \"./larger_units_helper\";\n\nexport function createCacheObject(): IWorkUnitCache {\n\n\t// worktime hash is on the hot path,\n\t// Map seems to work faster than plain array, use it whenever possible\n\tif (typeof Map !== \"undefined\") {\n\t\treturn new WorkUnitsMapCache();\n\t} else {\n\t\treturn new WorkUnitsObjectCache();\n\t}\n}\n","export default {\n\tisLegacyResourceCalendarFormat: function(resourceCalendarsProperty){\n\t\t// modern format:\n\t\t//gantt.config.resource_calendars = {\n\t\t//\tresourceId: calendarId,\n\t\t//\tresourceId: calendarId,\n\t\t//\tresourceId: calendarId\n\t\t//\t};\n\t\t\n\t\t// legacy format:\n\t\t// gantt.config.resource_calendars = {\n\t\t//\t\"resourceProperty\": {\n\t\t//\t\tresourceId: calendarId,\n\t\t//\t\tresourceId: calendarId,\n\t\t//\t\tresourceId: calendarId\n\t\t//\t\t}\n\t\t//\t};\n\n\t\tif(!resourceCalendarsProperty){\n\t\t\treturn false;\n\t\t}\n\t\tfor(var i in resourceCalendarsProperty){\n\t\t\tif(resourceCalendarsProperty[i] && typeof resourceCalendarsProperty[i] === \"object\"){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\tgetResourceProperty: function(config){\n\t\tvar resourceCalendarsConfig = config.resource_calendars;\n\t\tvar propertyName = config.resource_property;\n\t\tif(this.isLegacyResourceCalendarFormat(resourceCalendarsConfig)){\n\t\t\tfor(var i in config){\n\t\t\t\tpropertyName = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn propertyName;\n\t},\n\tgetCalendarIdFromLegacyConfig: function(task, config){\n\t\tif (config) {\n\t\t\tfor (var field in config) {\n\t\t\t\tvar resource = config[field];\n\t\t\t\tif (task[field]) {\n\t\t\t\t\tvar calendarId = resource[task[field]];\n\t\t\t\t\tif (calendarId) {\n\t\t\t\t\t\treturn calendarId;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n};","import * as utils from \"../../utils/utils\";\nimport createArgumentsHelper from \"./calendar_arguments_helper\";\nimport CalendarMergeHelper from \"./strategy/work_calendar_merger\";\nimport CalendarWorkTimeStrategy from \"./strategy/calendar_strategy\";\nimport legacyResourceCalendarConfig from \"./legacy_resource_config\";\nimport dynamicResourceCalendarsFactory from \"./dynamic_resource_calendars\";\n\nconst dynamicResourceCalendars = dynamicResourceCalendarsFactory();\n\nfunction CalendarManager (gantt){\n\tthis.$gantt = gantt;\n\tthis._calendars = {};\n\tthis._legacyConfig = undefined;\n\tthis.$gantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(this.$gantt.config.resource_calendars){\n\t\t\tthis._isLegacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(this.$gantt.config.resource_calendars);\n\t\t}\n\t}.bind(this));\n\n\tthis.$gantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tthis.createDefaultCalendars();\n\t}.bind(this));\n\tthis.$gantt.attachEvent(\"onBeforeGanttRender\", function(){\n\t\tthis.createDefaultCalendars();\n\t}.bind(this));\n}\n\nCalendarManager.prototype = {\n\t_calendars: {},\n\t_convertWorkTimeSettings: function (settings) {\n\t\tvar days = settings.days;\n\t\tif (days && !settings.dates) {\n\t\t\tsettings.dates = settings.dates || {};\n\t\t\tfor (var i = 0; i < days.length; i++) {\n\t\t\t\tsettings.dates[i] = days[i];\n\t\t\t\tif (!(days[i] instanceof Array)) {\n\t\t\t\t\tsettings.dates[i] = !!days[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdelete settings.days;\n\t\treturn settings;\n\t},\n\tmergeCalendars: function(){\n\t\tvar calendars = [];\n\t\tvar args = arguments;\n\t\tif(Array.isArray(args[0])){\n\t\t\tcalendars = args[0].slice();\n\t\t}else{\n\t\t\tfor(var i = 0; i < arguments.length; i++){\n\t\t\t\tcalendars.push(arguments[i]);\n\t\t\t}\n\t\t}\n\n\t\tvar mergeHelper = new CalendarMergeHelper();\n\n\t\tvar result;\n\t\tcalendars.forEach(function(calendar){\n\t\t\tif(!result){\n\t\t\t\tresult = calendar;\n\t\t\t} else{\n\t\t\t\tresult = this._createCalendarFromConfig(mergeHelper.merge(result, calendar));\n\t\t\t}\n\n\t\t}.bind(this));\n\t\treturn this.createCalendar(result);\n\t},\n\n\t_createCalendarFromConfig: function(config){\n\t\tvar apiCore = new CalendarWorkTimeStrategy(this.$gantt, createArgumentsHelper(this.$gantt));\n\t\tapiCore.id = String(utils.uid());\n\n\t\tvar preparedConfig = this._convertWorkTimeSettings(config);\n\t\tif(preparedConfig.customWeeks){\n\t\t\tfor(var i in preparedConfig.customWeeks){\n\t\t\t\tpreparedConfig.customWeeks[i] = this._convertWorkTimeSettings(preparedConfig.customWeeks[i]);\n\t\t\t}\n\t\t}\n\t\tapiCore._setConfig(preparedConfig);\n\n\t\treturn apiCore;\n\t},\n\n\tcreateCalendar: function (parentCalendar) {\n\t\tvar settings;\n\n\t\tif (!parentCalendar) {\n\t\t\tparentCalendar = {};\n\t\t}\n\n\t\tif (parentCalendar.getConfig){\n\t\t\tsettings = utils.copy(parentCalendar.getConfig());\n\t\t} else if (parentCalendar.worktime) {\n\t\t\tsettings = utils.copy(parentCalendar.worktime);\n\t\t} else {\n\t\t\tsettings = utils.copy(parentCalendar);\n\t\t}\n\n\t\tvar defaults = utils.copy(this.defaults.fulltime.worktime);\n\t\tutils.mixin(settings, defaults);\n\n\t\treturn this._createCalendarFromConfig(settings);\n\t},\n\n\tgetCalendar: function (id) {\n\t\tid = id || \"global\";\n\t\tvar calendar = this._calendars[id];\n\t\tif(!calendar){\n\t\t\tthis.createDefaultCalendars();\n\t\t\tcalendar = this._calendars[id];\n\t\t}\n\n\t\treturn calendar;\n\t},\n\n\tgetCalendars: function () {\n\t\tvar res = [];\n\t\tfor (var i in this._calendars) {\n\t\t\tres.push(this.getCalendar(i));\n\t\t}\n\t\treturn res;\n\t},\n\n\t_getOwnCalendar: function(task){\n\t\tvar config = this.$gantt.config;\n\t\tif (task[config.calendar_property]) {\n\t\t\treturn this.getCalendar(task[config.calendar_property]);\n\t\t}\n\n\t\tif (config.resource_calendars) {\n\t\t\tvar calendar;\n\t\t\tvar calendarId;\n\t\t\tvar resourceProperty;\n\t\t\tif(this._legacyConfig === false){\n\t\t\t\tresourceProperty = config.resource_property;\n\t\t\t}else{\n\t\t\t\tresourceProperty = legacyResourceCalendarConfig.getResourceProperty(config);\n\t\t\t}\n\t\t\tif(Array.isArray(task[resourceProperty])){\n\t\t\t\t// if multiple resources are attached to the task - merge their calendars\n\t\t\t\tif(config.dynamic_resource_calendars){\n\t\t\t\t\tcalendarId = dynamicResourceCalendars.getCalendarIdFromMultipleResources(task[resourceProperty], this);\n\t\t\t\t} else {\n\t\t\t\t\tcalendar = this.getResourceCalendar(task[resourceProperty]);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(this._legacyConfig === undefined){\n\t\t\t\t\tthis._legacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(config.resource_calendars);\n\t\t\t\t}\n\n\t\t\t\tif(this._legacyConfig){\n\t\t\t\t\tvar calendarId = legacyResourceCalendarConfig.getCalendarIdFromLegacyConfig(task, config.resource_calendars);\n\t\t\t\t}else if(resourceProperty && task[resourceProperty] && config.resource_calendars[task[resourceProperty]]){\n\t\t\t\t\tvar calendar = this.getResourceCalendar(task[resourceProperty]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(calendarId){\n\t\t\t\tcalendar = this.getCalendar(calendarId);\n\t\t\t}\n\n\t\t\tif(calendar){\n\t\t\t\treturn calendar;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\n\t/**\n\t * Returns calendar assigned to the specified resource.\n\t * Returns the global calendar if no custom calendar is associated with the resource.\n\t * @param {(string|number|Object)} resource - resource object or resource id\n\t * @returns {object} Calendar object\n\t */\n\tgetResourceCalendar: function(resource) {\n\t\tif (resource === null || resource === undefined) {\n\t\t\treturn this.getCalendar();\n\t\t}\n\n\t\tvar resourceId = null;\n\t\t// if task id is provided\n\t\tif((typeof resource === \"number\" || typeof resource === \"string\")){\n\t\t\tresourceId = resource;\n\t\t}else{\n\t\t\tresourceId = resource.id || resource.key;\n\t\t}\n\n\t\tvar config = this.$gantt.config;\n\t\tvar calendarsConfig = config.resource_calendars;\n\t\tvar calendarId = null;\n\n\t\t// GS-1714: if resource is specified through array\n\t\tif (Array.isArray(resource)){\n\t\t\tif (resource.length === 1){\n\t\t\t\tif (typeof resource[0] === 'object'){\n\t\t\t\t\tresourceId = resource[0].resource_id; // if resource: [\"resource_id: \"6\", value: \"4\", ...\"]\n\t\t\t\t} else {\n\t\t\t\t\tresourceId = resource[0]; // if resource: [1]\n\t\t\t\t}\n\t\t\t} \n\t\t}\n\t\t\n\t\tif (calendarsConfig) {\n\t\t\tif(this._legacyConfig === undefined){\n\t\t\t\tthis._legacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(config.resource_calendars);\n\t\t\t}\n\n\t\t\tif(this._legacyConfig){\n\t\t\t\tfor(var field in calendarsConfig){\n\t\t\t\t\tif(calendarsConfig[field][resourceId]){\n\t\t\t\t\t\tcalendarId = calendarsConfig[field][resourceId];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tvar calendarId = calendarsConfig[resourceId];\n\t\t\t}\n\n\t\t\tif(calendarId){\n\t\t\t\treturn this.getCalendar(calendarId);\n\t\t\t}\n\n\t\t}\n\t\treturn this.getCalendar();\n\t},\n\n\t/**\n\t * Returns the calendar assigned to a task.\n\t * - Returns a calendar assigned via task[gantt.config.calendar_property] if specified.\n\t * - Returns a calendar assigned to the task resource if specified.\n\t * - Returns the global calendar otherwise.\n\t * @param {(string|number|Object)} task - task object or task id\n\t * @returns {object} Calendar object\n\t */\n\tgetTaskCalendar: function (task) {\n\t\tvar gantt = this.$gantt;\n\t\tvar taskObject;\n\t\tif (task === null || task === undefined) {\n\t\t\treturn this.getCalendar();\n\t\t}\n\n\t\t// if task id is provided\n\t\tif((typeof task === \"number\" || typeof task === \"string\") && gantt.isTaskExists(task)){\n\t\t\ttaskObject = gantt.getTask(task);\n\t\t}else{\n\t\t\ttaskObject = task;\n\t\t}\n\n\t\tif(!taskObject){\n\t\t\treturn this.getCalendar();\n\t\t}\n\n\t\tvar calendar = this._getOwnCalendar(taskObject);\n\t\tvar groupMode = !!gantt.getState().group_mode;\n\n\t\tif (!calendar && gantt.config.inherit_calendar && gantt.isTaskExists(taskObject.parent)){\n\t\t\t// GS-1579  group mode overrides tree hierarchy, iterate using `.parent` property, instead of using eachParent iterator\n\t\t\tvar currentTask = taskObject;\n\t\t\twhile(gantt.isTaskExists(currentTask.parent)){\n\t\t\t\tcurrentTask = gantt.getTask(currentTask.parent);\n\t\t\t\tif(gantt.isSummaryTask(currentTask)){\n\t\t\t\t\tcalendar = this._getOwnCalendar(currentTask);\n\t\t\t\t\tif(calendar){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(groupMode && !calendar){\n\t\t\t\t// if group mode and inherit_calendars is enabled - preserve previously applied parent calendar\n\t\t\t\t// we may need it when groupBy parses grouped data, old parent may be not loaded yet\n\t\t\t\tif(task.$effective_calendar){\n\t\t\t\t\tcalendar = this.getCalendar(task.$effective_calendar);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn calendar || this.getCalendar();\n\t},\n\n\taddCalendar: function(calendar) { // puts new calendar to Global Storage - gantt.calendarManager._calendars {}\n\t\tif (!(this.isCalendar(calendar))) {\n\t\t\tvar id = calendar.id;\n\t\t\tcalendar = this.createCalendar(calendar);\n\t\t\tcalendar.id = id;\n\t\t}\n\n\t\t// validate/check if empty calendar\n\t\tif (!calendar._tryChangeCalendarSettings(function () {\n\t\t\t})) {\n\n\t\t\tthis.$gantt.callEvent(\"onCalendarError\", [{message: \"Invalid calendar settings, no worktime available\"}, calendar]);\n\t\t\treturn null;\n\t\t} else {\n\t\t\tvar config = this.$gantt.config;\n\n\t\t\tcalendar.id = calendar.id || utils.uid();\n\t\t\tthis._calendars[calendar.id] = calendar;\n\t\t\tif (!config.worktimes)\n\t\t\t\tconfig.worktimes = {};\n\t\t\tconfig.worktimes[calendar.id] = calendar.getConfig();\n\t\t\treturn calendar.id;\n\t\t}\n\t},\n\n\tdeleteCalendar: function (calendar) {\n\t\tvar config = this.$gantt.config;\n\t\tif (!calendar) return false;\n\t\tif (this._calendars[calendar]) {\n\t\t\tdelete this._calendars[calendar];\n\t\t\tif (config.worktimes && config.worktimes[calendar])\n\t\t\t\tdelete config.worktimes[calendar];\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t},\n\n\trestoreConfigCalendars: function (configs) {\n\t\tfor (var i in configs) {\n\t\t\tif (this._calendars[i])\n\t\t\t\tcontinue;\n\n\t\t\tvar settings = configs[i];\n\t\t\tvar calendar = this.createCalendar(settings);\n\t\t\tcalendar.id = i;\n\t\t\tthis.addCalendar(calendar);\n\t\t}\n\t},\n\n\tdefaults: {\n\t\tglobal: {\n\t\t\tid: \"global\",\n\t\t\tworktime: {\n\t\t\t\thours: [8, 12, 13, 17],\n\t\t\t\tdays: [0, 1, 1, 1, 1, 1, 0]\n\t\t\t}\n\t\t},\n\t\tfulltime: {\n\t\t\tid: \"fulltime\",\n\t\t\tworktime: {\n\t\t\t\thours: [0, 24],\n\t\t\t\tdays: [1, 1, 1, 1, 1, 1, 1]\n\t\t\t}\n\t\t}\n\t},\n\n\tcreateDefaultCalendars: function () {\n\t\tvar config = this.$gantt.config;\n\t\tthis.restoreConfigCalendars(this.defaults);\n\t\tthis.restoreConfigCalendars(config.worktimes);\n\t},\n\n\tisCalendar: function(possibleCalendar) {\n\t\t// because we don't have any way to check without dependency to CalendarWorkTimeStrategy\n\t\tvar props = [\n\t\t\tpossibleCalendar.isWorkTime,\n\t\t\tpossibleCalendar.setWorkTime,\n\t\t\tpossibleCalendar.getWorkHours,\n\t\t\tpossibleCalendar.unsetWorkTime,\n\t\t\tpossibleCalendar.getClosestWorkTime,\n\t\t\tpossibleCalendar.calculateDuration,\n\t\t\tpossibleCalendar.hasDuration,\n\t\t\tpossibleCalendar.calculateEndDate\n\t\t];\n\t\treturn props.every(function(entry) {\n\t\t\treturn entry instanceof Function;\n\t\t});\n\t}\n};\n\nexport default CalendarManager;","export default function() {\n\tfunction getResourcesCalendarKey(resourceAssignments){\n\t\treturn resourceAssignments.map(function(res){\n\t\t\tif(res && res.resource_id){\n\t\t\t\treturn res.resource_id;\n\t\t\t} else {\n\t\t\t\treturn res;\n\t\t\t}\n\t\t}).sort().join(\"-\");\n\t}\n\n\tvar dynamicCalendars = {};\n\n\tfunction mergeResourceCalendars(resourceAssignments, manager){\n\t\treturn manager.mergeCalendars(resourceAssignments.map(function(assignment){\n\t\t\tvar resourceId = (assignment && assignment.resource_id) ? assignment.resource_id : assignment;\n\t\t\treturn manager.getResourceCalendar(resourceId);\n\t\t}));\n\t}\n\tfunction getCalendarIdFromMultipleResources(resourceAssignments, manager){\n\t\tvar key = getResourcesCalendarKey(resourceAssignments);\n\t\tif(!resourceAssignments.length){\n\t\t\treturn null;\n\t\t}else if(resourceAssignments.length === 1){\n\t\t\treturn manager.getResourceCalendar(key).id;\n\t\t}else if (dynamicCalendars[key]){\n\t\t\treturn dynamicCalendars[key].id;\n\t\t} else {\n\t\t\tvar tempCalendar = mergeResourceCalendars(resourceAssignments, manager);\n\n\t\t\tdynamicCalendars[key] = tempCalendar;\n\t\t\treturn manager.addCalendar(tempCalendar);\n\t\t}\n\t}\n\n\treturn {\n\t\tgetCalendarIdFromMultipleResources: getCalendarIdFromMultipleResources\n\t};\n};","function CalendarDisabledTimeStrategy(gantt, argumentsHelper){\n\tthis.argumentsHelper = argumentsHelper;\n\tthis.$gantt = gantt;\n}\n\nCalendarDisabledTimeStrategy.prototype = {\n\tgetWorkHours: function () {\n\t\treturn [0, 24];\n\t},\n\tsetWorkTime: function () {\n\t\treturn true;\n\t},\n\tunsetWorkTime: function () {\n\t\treturn true;\n\t},\n\tisWorkTime: function () {\n\t\treturn true;\n\t},\n\tgetClosestWorkTime: function (config) {\n\t\tvar config = this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\t\treturn config.date;\n\t},\n\n\tcalculateDuration: function () {\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n\t\tvar from = config.start_date,\n\t\t\tto = config.end_date,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\treturn this._calculateDuration(from, to, unit, step);\n\t},\n\t_calculateDuration: function (start, end, unit, step) {\n\t\tvar dateHelper = this.$gantt.date;\n\t\tvar fixedUnits = {\n\t\t\t\"week\": 1000 * 60 * 60 * 24 * 7,\n\t\t\t\"day\": 1000 * 60 * 60 * 24,\n\t\t\t\"hour\": 1000 * 60 * 60,\n\t\t\t\"minute\": 1000 * 60\n\t\t};\n\n\t\tvar res = 0;\n\t\tif (fixedUnits[unit]) {\n\t\t\tres = Math.round((end - start) / (step * fixedUnits[unit]));\n\t\t} else {\n\t\t\tvar from = new Date(start),\n\t\t\t\tto = new Date(end);\n\t\t\twhile (from.valueOf() < to.valueOf()) {\n\t\t\t\tres += 1;\n\t\t\t\tfrom = dateHelper.add(from, step, unit);\n\t\t\t}\n\n\t\t\tif (from.valueOf() != end.valueOf()) {\n\t\t\t\tres += (to - from) / (dateHelper.add(from, step, unit) - from);\n\t\t\t}\n\t\t}\n\n\t\treturn Math.round(res);\n\t},\n\n\thasDuration: function () {\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n\t\tvar from = config.start_date,\n\t\t\tto = config.end_date,\n\t\t\tunit = config.unit;\n\n\t\tif (!unit) {\n\t\t\treturn false;\n\t\t}\n\t\tfrom = new Date(from);\n\t\tto = new Date(to);\n\n\t\treturn (from.valueOf() < to.valueOf());\n\t},\n\n\thasWorkTime: function() {\n\t\treturn true;\n\t},\n\n\tequals: function(calendar) {\n\t\tif(!(calendar instanceof CalendarDisabledTimeStrategy)){\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\n\tcalculateEndDate: function () {\n\t\tvar config = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar start = config.start_date,\n\t\t\tduration = config.duration,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\treturn this.$gantt.date.add(start, step * duration, unit);\n\t}\n};\n\nexport default CalendarDisabledTimeStrategy;","import createArgumentsHelper from \"./calendar_arguments_helper\";\nimport NoWorkTimeCalendar from \"./strategy/no_work_time\";\n\nfunction TimeCalculator(calendarManager){\n\n\tthis.$gantt = calendarManager.$gantt;\n\tthis.argumentsHelper = createArgumentsHelper(this.$gantt);\n\tthis.calendarManager = calendarManager;\n\tthis.$disabledCalendar = new NoWorkTimeCalendar(this.$gantt, this.argumentsHelper);\n}\n\nTimeCalculator.prototype = {\n\t_getCalendar: function (config) {\n\t\tvar calendar;\n\t\tif (!this.$gantt.config.work_time) {\n\t\t\tcalendar = this.$disabledCalendar;\n\t\t} else {\n\t\t\tvar manager = this.calendarManager;\n\t\t\tif (config.task) {\n\t\t\t\tcalendar = manager.getTaskCalendar(config.task);\n\t\t\t} else if (config.id) {\n\t\t\t\tcalendar = manager.getTaskCalendar(config);\n\t\t\t} else if (config.calendar) {\n\t\t\t\tcalendar = config.calendar;\n\t\t\t}\n\t\t\tif (!calendar) {\n\t\t\t\tcalendar = manager.getTaskCalendar();\n\t\t\t}\n\t\t}\n\t\treturn calendar;\n\t},\n\n\tgetWorkHours: function (config) {\n\t\tconfig = this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\n\t\treturn calendar.getWorkHours(config.date);\n\t},\n\n\tsetWorkTime: function (config, calendar) {\n\t\tconfig = this.argumentsHelper.setWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tif (!calendar)\n\t\t\tcalendar = this.calendarManager.getCalendar(); // Global\n\t\treturn calendar.setWorkTime(config);\n\t},\n\n\tunsetWorkTime: function (config, calendar) {\n\t\tconfig = this.argumentsHelper.unsetWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tif (!calendar)\n\t\t\tcalendar = this.calendarManager.getCalendar(); // Global\n\t\treturn calendar.unsetWorkTime(config);\n\t},\n\tisWorkTime: function (date, unit, task, calendar) {\n\t\tvar config = this.argumentsHelper.isWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tcalendar = this._getCalendar(config);\n\t\treturn calendar.isWorkTime(config);\n\t},\n\tgetClosestWorkTime: function (config) {\n\t\tconfig = this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\n\t\treturn calendar.getClosestWorkTime(config);\n\t},\n\n\tcalculateDuration: function () { // start_date_date, end_date, task\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n\n\n\t\tvar calendar = this._getCalendar(config);\n\t\treturn calendar.calculateDuration(config);\n\t},\n\thasDuration: function () {\n\t\tvar config = this.argumentsHelper.hasDurationArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\n\t\treturn calendar.hasDuration(config);\n\t},\n\tcalculateEndDate: function (config) { // start_date, duration, unit, task\n\t\tvar config = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\t\treturn calendar.calculateEndDate(config);\n\t}\n};\n\nexport default TimeCalculator;\n\n","// TODO: rework public api for date methods\nimport * as utils from \"../../utils/utils\";\n\nvar createWorkTimeFacade = function(calendarManager, timeCalculator){\n\treturn {\n\t\tgetWorkHours: function (date) {\n\t\t\treturn timeCalculator.getWorkHours(date);\n\t\t},\n\n\t\tsetWorkTime: function (config) {\n\t\t\treturn timeCalculator.setWorkTime(config);\n\t\t},\n\n\t\tunsetWorkTime: function (config) {\n\t\t\ttimeCalculator.unsetWorkTime(config);\n\t\t},\n\n\t\tisWorkTime: function (date, unit, task) {\n\t\t\treturn timeCalculator.isWorkTime(date, unit, task);\n\t\t},\n\n\t\tgetClosestWorkTime: function (config) {\n\t\t\treturn timeCalculator.getClosestWorkTime(config);\n\t\t},\n\n\t\tcalculateDuration: function (start_date, end_date, task) {\n\t\t\treturn timeCalculator.calculateDuration(start_date, end_date, task);\n\t\t},\n\t\t_hasDuration: function (start_date, end_date, task) {\n\t\t\treturn timeCalculator.hasDuration(start_date, end_date, task);\n\t\t},\n\n\t\tcalculateEndDate: function (start, duration, unit, task) {\n\t\t\treturn timeCalculator.calculateEndDate(start, duration, unit, task);\n\t\t},\n\n\t\tmergeCalendars: utils.bind(calendarManager.mergeCalendars, calendarManager),\n\t\tcreateCalendar: utils.bind(calendarManager.createCalendar, calendarManager),\n\t\taddCalendar: utils.bind(calendarManager.addCalendar, calendarManager),\n\t\tgetCalendar: utils.bind(calendarManager.getCalendar, calendarManager),\n\t\tgetCalendars: utils.bind(calendarManager.getCalendars, calendarManager),\n\t\tgetResourceCalendar: utils.bind(calendarManager.getResourceCalendar, calendarManager),\n\t\tgetTaskCalendar: utils.bind(calendarManager.getTaskCalendar, calendarManager),\n\t\tdeleteCalendar: utils.bind(calendarManager.deleteCalendar, calendarManager)\n\t};\n};\n\n\nexport default { create: createWorkTimeFacade };","import * as helpers from \"../utils/helpers\";\n\nexport default function(gantt) {\n\n\tgantt.isUnscheduledTask = function (task) {\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isUnscheduledTask. Task object was expected\");\n\t\treturn (!!task.unscheduled || !task.start_date);\n\t};\n\n\tgantt._isAllowedUnscheduledTask = function (task) {\n\t\treturn !!(task.unscheduled && gantt.config.show_unscheduled);\n\t};\n\n\tgantt._isTaskInTimelineLimits = function(task) {\n\t\tvar taskStart = task.start_date ? task.start_date.valueOf() : null;\n\t\tvar taskEnd = task.end_date ? task.end_date.valueOf() : null;\n\t\treturn !!(taskStart && taskEnd && taskStart <= this._max_date.valueOf() && taskEnd >= this._min_date.valueOf());\n\t};\n\tgantt.isTaskVisible = function (id) {\n\t\tif (!this.isTaskExists(id)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar task = this.getTask(id);\n\t\tif (!(this._isAllowedUnscheduledTask(task) || this._isTaskInTimelineLimits(task))) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn !!(this.getGlobalTaskIndex(id) >= 0);\n\t};\n\n\tgantt._getProjectEnd = function() {\n\t\tif(gantt.config.project_end){\n\t\t\treturn gantt.config.project_end;\n\t\t}else{\n\t\t\tvar tasks = gantt.getTaskByTime();\n\t\t\ttasks = tasks.sort(function (a, b) {\n\t\t\t\treturn +a.end_date > +b.end_date ? 1 : -1;\n\t\t\t});\n\t\t\treturn tasks.length ? tasks[tasks.length - 1].end_date : null;\n\t\t}\n\t};\n\tgantt._getProjectStart = function() {\n\t\tif (gantt.config.project_start) {\n\t\t\treturn gantt.config.project_start;\n\t\t}\n\n\t\t// use timeline start if project start is not specified\n\t\tif (gantt.config.start_date) {\n\t\t\treturn gantt.config.start_date;\n\t\t}\n\t\tif (gantt.getState().min_date) {\n\t\t\treturn gantt.getState().min_date;\n\t\t}\n\n\t\t// earliest task start if neither project start nor timeline are specified\n\t\tvar tasks = gantt.getTaskByTime();\n\t\ttasks = tasks.sort(function (a, b) {\n\t\t\treturn +a.start_date > +b.start_date ? 1 : -1;\n\t\t});\n\t\treturn tasks.length ? tasks[0].start_date : null;\n\t};\n\n\tvar getDefaultTaskDate = function (item, parent_id) {\n\t\tvar parentExists = parent_id && parent_id != gantt.config.root_id && gantt.isTaskExists(parent_id);\n\t\tvar parent = parentExists ? gantt.getTask(parent_id) : false,\n\t\t\tstartDate = null;\n\t\tif (parent) {\n\t\t\tif(gantt.config.schedule_from_end){\n\t\t\t\tstartDate = gantt.calculateEndDate({\n\t\t\t\t\tstart_date: parent.end_date,\n\t\t\t\t\tduration: - gantt.config.duration_step,\n\t\t\t\t\ttask:item\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\tif(!parent.start_date){\n\t\t\t\t\treturn getDefaultTaskDate(parent, gantt.getParent(parent));\n\t\t\t\t}\n\t\t\t\tstartDate = parent.start_date;\n\t\t\t}\n\n\t\t} else if(gantt.config.schedule_from_end) {\n\t\t\tstartDate = gantt.calculateEndDate({\n\t\t\t\tstart_date: gantt._getProjectEnd(),\n\t\t\t\tduration: - gantt.config.duration_step,\n\t\t\t\ttask:item\n\t\t\t});\n\t\t} else {\n\t\t\tconst first = gantt.getTaskByIndex(0);\n\t\t\tconst minDate = gantt.config.start_date || gantt.getState().min_date;\n\n\t\t\tif (first){\n\t\t\t\tif (first.start_date){\n\t\t\t\t\tstartDate = first.start_date;\n\t\t\t\t}\n\t\t\t\telse if (first.end_date){\n\t\t\t\t\tstartDate = gantt.calculateEndDate({\n\t\t\t\t\t\tstart_date: first.end_date,\n\t\t\t\t\t\tduration: -gantt.config.duration_step,\n\t\t\t\t\t\ttask:item\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tstartDate = minDate;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstartDate = minDate;\n\t\t\t}\n\t\t}\n\t\tgantt.assert(startDate, \"Invalid dates\");\n\t\treturn new Date(startDate);\n\t};\n\n\tgantt._set_default_task_timing = function (task) {\n\t\ttask.start_date = task.start_date || getDefaultTaskDate(task, gantt.getParent(task));\n\t\ttask.duration = task.duration || gantt.config.duration_step;\n\t\ttask.end_date = task.end_date || gantt.calculateEndDate(task);\n\t};\n\n\tgantt.createTask = function (item, parent, index) {\n\t\titem = item || {};\n\n\t\tif (!gantt.defined(item.id))\n\t\t\titem.id = gantt.uid();\n\n\t\tif (!item.start_date) {\n\t\t\titem.start_date = getDefaultTaskDate(item, parent);\n\t\t}\n\t\tif (item.text === undefined) {\n\t\t\titem.text = gantt.locale.labels.new_task;\n\t\t}\n\t\tif (item.duration === undefined) {\n\t\t\titem.duration = 1;\n\t\t}\n\n\t\tif (this.isTaskExists(parent)) {\n\t\t\tthis.setParent(item, parent, true);\n\t\t\tvar parentObj = this.getTask(parent);\n\t\t\tparentObj.$open = true;\n\t\t\t// GS-1583. Save the $open state to the Undo Stack\n\t\t\tif (!this.config.details_on_create){\n\t\t\t\tthis.callEvent(\"onAfterParentExpand\", [parent, parentObj]);\n\t\t\t}\n\t\t}\n\n\t\tif (!this.callEvent(\"onTaskCreated\", [item])) {\n\t\t\treturn null;\n\t\t}\n\t\tif (this.config.details_on_create) {\n\t\t\t//GS-761: assert unique ID\n\t\t\tif (gantt.isTaskExists(item.id)){\n\t\t\t\tvar task = gantt.getTask(item.id);\n\t\t\t\tif (task.$index != item.$index) {\n\t\t\t\t\t// Someone may try to mistakenly add a task with the same ID, and most likely\n\t\t\t\t\t// use the string format for the dates. Gantt shouldn't break in this scenario\n\t\t\t\t\tif (item.start_date && typeof item.start_date === \"string\"){\n\t\t\t\t\t\titem.start_date = this.date.parseDate(item.start_date, \"parse_date\");\n\t\t\t\t\t}\n\t\t\t\t\tif (item.end_date && typeof item.end_date === \"string\"){\n\t\t\t\t\t\titem.end_date = this.date.parseDate(item.end_date, \"parse_date\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.$data.tasksStore.updateItem(item.id, item);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\titem.$new = true;\n\t\t\t\tthis.silent(function(){\n\t\t\t\t\tgantt.$data.tasksStore.addItem(item, index);\n\t\t\t\t});\t\n\t\t\t}\n\t\t\tthis.selectTask(item.id);\n\t\t\tthis.refreshData();\n\t\t\tthis.showLightbox(item.id);\n\t\t} else {\n\t\t\tif (this.addTask(item, parent, index)) {\n\t\t\t\tthis.showTask(item.id);\n\t\t\t\tthis.selectTask(item.id);\n\t\t\t}\n\t\t}\n\t\treturn item.id;\n\t};\n\n\tgantt._update_flags = function (oldid, newid) {\n\t\t//  TODO: need a proper way to update all possible flags\n\t\tvar store = gantt.$data.tasksStore;\n\t\tif (oldid === undefined) {\n\t\t\tthis._lightbox_id = null;\n\n\t\t\tstore.silent(function(){\n\t\t\t\tstore.unselect();\n\t\t\t});\n\t\t\t// GS-1522. If we have multiselect, unselect all previously selected tasks\n\t\t\tif (this.getSelectedTasks) {\n\t\t\t\tthis._multiselect.reset();\n\t\t\t}\n\n\t\t\tif (this._tasks_dnd && this._tasks_dnd.drag) {\n\t\t\t\tthis._tasks_dnd.drag.id = null;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._lightbox_id == oldid)\n\t\t\t\tthis._lightbox_id = newid;\n\n\t\t\t// TODO: probably can be removed\n\t\t\tif (store.getSelectedId() == oldid) {\n\t\t\t\tstore.silent(function(){\n\t\t\t\t\tstore.unselect(oldid);\n\t\t\t\t\tstore.select(newid);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (this._tasks_dnd && this._tasks_dnd.drag && this._tasks_dnd.drag.id == oldid) {\n\t\t\t\tthis._tasks_dnd.drag.id = newid;\n\t\t\t}\n\t\t}\n\t};\n\n\tvar getTaskTimingMode = function (task, force) {\n\t\tvar task_type = gantt.getTaskType(task.type);\n\n\t\tvar state = {\n\t\t\ttype: task_type,\n\t\t\t$no_start: false,\n\t\t\t$no_end: false,\n\t\t\tscheduled_summary: false\n\t\t};\n\n\t\tif(task_type === gantt.config.types.project && task.auto_scheduling === false){\n\t\t\tstate.scheduled_summary = true;\n\t\t}\n\n\t\tif (!force && task_type == task.$rendered_type) {\n\t\t\tstate.$no_start = task.$no_start;\n\t\t\tstate.$no_end = task.$no_end;\n\t\t\treturn state;\n\t\t}\n\n\t\tif (task_type == gantt.config.types.project) {\n\t\t\t//project duration is always defined by children duration\n\t\t\tstate.$no_end = state.$no_start = true;\n\t\t} else if (task_type != gantt.config.types.milestone) {\n\t\t\t//tasks can have fixed duration, children duration(as projects), or one date fixed, and other defined by nested items\n\t\t\tstate.$no_end = !(task.end_date || task.duration);\n\t\t\tstate.$no_start = !task.start_date;\n\n\t\t\tif (gantt._isAllowedUnscheduledTask(task)) {\n\t\t\t\tstate.$no_end = state.$no_start = false;\n\t\t\t}\n\t\t}\n\n\t\treturn state;\n\t};\n\n\tgantt._init_task_timing = function (task) {\n\t\tvar task_mode = getTaskTimingMode(task, true);\n\n\t\tvar dirty = task.$rendered_type != task_mode.type;\n\n\t\tvar task_type = task_mode.type;\n\n\t\tif (dirty) {\n\t\t\ttask.$no_start = task_mode.$no_start;\n\t\t\ttask.$no_end = task_mode.$no_end;\n\t\t\ttask.$rendered_type = task_mode.type;\n\t\t}\n\n\t\tif (dirty && task_type != this.config.types.milestone) {\n\t\t\tif (task_type == this.config.types.project) {\n\t\t\t\t//project duration is always defined by children duration\n\t\t\t\tthis._set_default_task_timing(task);\n\t\t\t\ttask.$calculate_duration = false;// do not recalculate duration below\n\t\t\t}\n\t\t}\n\n\t\tif (task_type == this.config.types.milestone) {\n\t\t\ttask.end_date = task.start_date;\n\t\t}\n\t\tif (task.start_date && task.end_date && task.$calculate_duration !== false) {\n\t\t\ttask.duration = this.calculateDuration(task);\n\t\t}\n\n\t\tif(!task.$calculate_duration){\n\t\t\ttask.$calculate_duration = true;\n\t\t}\n\n\t\tif (!task.end_date) {\n\t\t\ttask.end_date = task.start_date;\n\t\t}\n\n\t\ttask.duration = task.duration || 0;\n\t\t// GS-1145. We should let tasks to have 0 duration if user wants it\n\t\tif (this.config.min_duration === 0 && task.duration === 0){\n\t\t\ttask.$no_end = false;\n\t\t}\n\n\t\t// work calendar of task has changed\n\t\tvar effectiveCalendar = this.getTaskCalendar(task);\n\t\tif(task.$effective_calendar && task.$effective_calendar !== effectiveCalendar.id){\n\t\t\tupdateTaskTiming(task);\n\t\t\tif(this.config.inherit_calendar && this.isSummaryTask(task)){\n\t\t\t\tthis.eachTask(function(child){\n\t\t\t\t\tupdateTaskTiming(child);\n\t\t\t\t}, task.id);\n\t\t\t}\n\t\t}\n\n\t\ttask.$effective_calendar = effectiveCalendar.id;\n\t};\n\n\tfunction updateTaskTiming(task) {\n\t\ttask.$effective_calendar = gantt.getTaskCalendar(task).id;\n\t\ttask.start_date = gantt.getClosestWorkTime({\n\t\t\tdir: \"future\",\n\t\t\tdate: task.start_date,\n\t\t\tunit: gantt.config.duration_unit,\n\t\t\ttask: task\n\t\t});\n\t\ttask.end_date = gantt.calculateEndDate(task);\n\t}\n\n\tgantt.isSummaryTask = function (task) {\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isSummaryTask. Task object was expected\");\n\n\t\tvar mode = getTaskTimingMode(task);\n\n\t\treturn !!(mode.$no_end || mode.$no_start);\n\t};\n\n// downward calculation of project duration\n\tgantt.resetProjectDates = function (task) {\n\t\tvar taskMode = getTaskTimingMode(task);\n\t\tif (taskMode.$no_end || taskMode.$no_start) {\n\t\t\tvar info = getSubtaskInfo(task.id);\n\t\t\tassignProjectDates.call(this, task, taskMode, info.start_date, info.end_date);\n\t\t\ttask.$rollup = info.rollup;\n\t\t}\n\t};\n\n\tfunction assignProjectDates(task, taskTiming, from, to) {\n\n\t\tconst summaryDateFields = {\n\t\t\tstart: \"start_date\",\n\t\t\tend: \"end_date\"\n\t\t};\n\t\tconst manuallyScheduledSummaryDateFields = {\n\t\t\tstart: \"$auto_start_date\",\n\t\t\tend: \"$auto_end_date\"\n\t\t};\n\n\t\tlet dateFields;\n\t\tif(task.type === gantt.config.types.project && task.auto_scheduling === false){\n\t\t\tdateFields = manuallyScheduledSummaryDateFields;\n\t\t}else{\n\t\t\tdateFields = summaryDateFields;\n\t\t}\n\n\t\tif (taskTiming.$no_start) {\n\t\t\tif (from) {\n\t\t\t\ttask[dateFields.start] = new Date(from);\n\t\t\t} else {\n\t\t\t\ttask[dateFields.start] = getDefaultTaskDate(task, this.getParent(task));\n\t\t\t}\n\t\t}\n\n\t\tif (taskTiming.$no_end) {\n\t\t\tif (to) {\n\t\t\t\ttask[dateFields.end] = new Date(to);\n\t\t\t} else {\n\t\t\t\ttask[dateFields.end] = this.calculateEndDate({\n\t\t\t\t\tstart_date: task[dateFields.start],\n\t\t\t\t\tduration: this.config.duration_step,\n\t\t\t\t\ttask: task\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (taskTiming.$no_start || taskTiming.$no_end) {\n\t\t\tthis._init_task_timing(task);\n\t\t}\n\t}\n\n\tgantt.getSubtaskDuration = function (taskId) {\n\t\tvar res = 0,\n\t\t\troot = taskId !== undefined ? taskId : gantt.config.root_id;\n\n\t\tthis.eachTask(function (child) {\n\t\t\tif (this.getTaskType(child.type) == gantt.config.types.project || this.isUnscheduledTask(child))\n\t\t\t\treturn;\n\n\t\t\tres += child.duration;\n\t\t}, root);\n\n\t\treturn res;\n\t};\n\n\tfunction getSubtaskInfo (taskId){\n\t\tvar min = null,\n\t\t\tmax = null,\n\t\t\troot = taskId !== undefined ? taskId : gantt.config.root_id,\n\t\t\trollup = [];\n\n\t\tgantt.eachTask(function (child) {\n\t\t\tconst isScheduledSummary = (gantt.getTaskType(child.type) == gantt.config.types.project && (child.auto_scheduling === false));\n\t\t\tif ((gantt.getTaskType(child.type) == gantt.config.types.project && !isScheduledSummary) || gantt.isUnscheduledTask(child))\n\t\t\t\treturn;\n\t\t\t\n\t\t\tif(child.rollup){\n\t\t\t\trollup.push(child.id);\n\t\t\t}\n\n\t\t\tif ((child.start_date && (!child.$no_start || isScheduledSummary)) && (!min || min > child.start_date.valueOf()))\n\t\t\t\tmin = child.start_date.valueOf();\n\t\t\tif ((child.end_date && (!child.$no_end || isScheduledSummary)) && (!max || max < child.end_date.valueOf()))\n\t\t\t\tmax = child.end_date.valueOf();\n\t\t}, root);\n\n\t\treturn {\n\t\t\tstart_date: min ? new Date(min) : null,\n\t\t\tend_date: max ? new Date(max) : null,\n\t\t\trollup: rollup\n\t\t};\n\t}\n\n\tgantt.getSubtaskDates = function (task_id) {\n\t\tvar info = getSubtaskInfo(task_id);\n\t\treturn {\n\t\t\tstart_date: info.start_date,\n\t\t\tend_date: info.end_date\n\t\t};\n\t};\n\n\n// upward calculation of project duration\n\tgantt._update_parents = function (taskId, silent, updateAll) {\n\t\tif (!taskId) return;\n\n\t\tvar task = this.getTask(taskId);\n\t\tif(task.rollup){\n\t\t\tupdateAll = true;\n\t\t}\n\t\tvar pid = this.getParent(task);\n\n\t\tvar taskTiming = getTaskTimingMode(task);\n\n\t\tvar has_changed = true;\n\t\t// GS-761 the dates check is necessary for adding empty tasks: gantt.addTask({id:\"2\"})\n\t\tif (updateAll || (task.start_date && task.end_date && (taskTiming.$no_start || taskTiming.$no_end))) {\n\n\t\t\tconst startDateField = task.$auto_start_date ? \"$auto_start_date\" : \"start_date\";\n\t\t\tconst endDateField = task.$auto_end_date ? \"$auto_end_date\" : \"end_date\";\n\n\t\t\tvar oldStart = task[startDateField].valueOf(),\n\t\t\t\toldEnd = task[endDateField].valueOf();\n\n\t\t\tgantt.resetProjectDates(task);\n\n\t\t\t// not refresh parent projects if dates hasn't changed\n\t\t\tif (!updateAll && oldStart == task[startDateField].valueOf() && oldEnd == task[endDateField].valueOf()) {\n\t\t\t\thas_changed = false;\n\t\t\t}\n\n\t\t\tif (has_changed && !silent) {\n\t\t\t\tthis.refreshTask(task.id, true);\n\t\t\t}\n\n\t\t\tif(taskTiming.scheduled_summary){\n\t\t\t\thas_changed = true;//recalculate upwards from scheduled summaries\n\t\t\t}\n\t\t}\n\n\n\t\tif (has_changed && pid && this.isTaskExists(pid)) {\n\t\t\tthis._update_parents(pid, silent, updateAll);\n\t\t}\n\t};\n\n\tgantt.roundDate = function (config) {\n\t\tvar scale = gantt.getScale();\n\n\t\tif (helpers.isDate(config)) {\n\t\t\tconfig = {\n\t\t\t\tdate: config,\n\t\t\t\tunit: scale ? scale.unit : gantt.config.duration_unit,\n\t\t\t\tstep: scale ?  scale.step : gantt.config.duration_step\n\t\t\t};\n\t\t}\n\t\tvar date = config.date,\n\t\t\tsteps = config.step,\n\t\t\tunit = config.unit;\n\n\t\tif(!scale){\n\t\t\treturn date;\n\t\t}\n\n\t\tvar upper, lower, colIndex;\n\t\tif (unit == scale.unit && steps == scale.step &&\n\t\t\t+date >= +scale.min_date && +date <= +scale.max_date) {\n\t\t\t//find date in time scale config\n\t\t\tcolIndex = Math.floor(gantt.columnIndexByDate(date));\n\n\t\t\tif (!scale.trace_x[colIndex]) {\n\t\t\t\tcolIndex -= 1;// end of time scale\n\t\t\t\tif(scale.rtl){\n\t\t\t\t\tcolIndex = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlower = new Date(scale.trace_x[colIndex]);\n\t\t\tupper = gantt.date.add(lower, steps, unit);\n\t\t} else {\n\t\t\tcolIndex = Math.floor(gantt.columnIndexByDate(date));\n\n\t\t\tupper = gantt.date[unit + \"_start\"](new Date(scale.min_date));\n\t\t\tif (scale.trace_x[colIndex]) {\n\t\t\t\tupper = gantt.date[unit + \"_start\"](scale.trace_x[colIndex]);// end of time scale\n\t\t\t}\n\n\t\t\twhile (+upper < +date) {\n\t\t\t\tupper = gantt.date[unit + \"_start\"](gantt.date.add(upper, steps, unit));\n\n\t\t\t\tvar tzOffset = upper.getTimezoneOffset();\n\n\t\t\t\tupper = gantt._correct_dst_change(upper, tzOffset, upper, unit);\n\t\t\t\tif (gantt.date[unit + '_start'])\n\t\t\t\t\tupper = gantt.date[unit + '_start'](upper);\n\t\t\t}\n\n\t\t\tlower = gantt.date.add(upper, -1 * steps, unit);\n\n\t\t}\n\t\tif (config.dir && config.dir == 'future')\n\t\t\treturn upper;\n\t\tif (config.dir && config.dir == 'past')\n\t\t\treturn lower;\n\n\t\tif (Math.abs(date - lower) < Math.abs(upper - date)) {\n\t\t\treturn lower;\n\t\t} else {\n\t\t\treturn upper;\n\t\t}\n\n\t};\n\n\tgantt.correctTaskWorkTime = function (task) {\n\t\tif (gantt.config.work_time && gantt.config.correct_work_time) {\n\t\t\tif (!this.isWorkTime(task.start_date, undefined, task)) {\n\t\t\t\ttask.start_date = this.getClosestWorkTime({date: task.start_date, dir: 'future', task: task});\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\n\t\t\t} else if (!this.isWorkTime(new Date(+task.end_date - 1), undefined, task)) {\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\n\t\t\t}\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onBeforeTaskUpdate\", function (id, task) {\n\t\tgantt._init_task_timing(task);\n\t\treturn true;\n\t});\n\tgantt.attachEvent(\"onBeforeTaskAdd\", function (id, task) {\n\t\tgantt._init_task_timing(task);\n\t\treturn true;\n\t});\n\n\tgantt.attachEvent(\"onAfterTaskMove\", function (id, parent, tindex) {\n\t\tgantt._init_task_timing(gantt.getTask(id));\n\t\treturn true;\n\t});\n\n};","function addResizeListener(gantt){\n\tvar containerStyles = window.getComputedStyle(gantt.$root);\n\tif(containerStyles.getPropertyValue(\"position\") == \"static\"){\n\t\tgantt.$root.style.position = \"relative\";\n\t}\n\n\tvar resizeWatcher = document.createElement('iframe');\n\tresizeWatcher.className = \"gantt_container_resize_watcher\";\n\tresizeWatcher.tabIndex = -1;\n\tif(gantt.config.wai_aria_attributes){\n\t\tresizeWatcher.setAttribute(\"role\", \"none\");\n\t\tresizeWatcher.setAttribute(\"aria-hidden\", true);\n\t}\n\n\tvar salesforce_environment = !!window[\"Sfdc\"] || !!window[\"$A\"] || window[\"Aura\"];\n\tif (salesforce_environment){\n\t\tgantt.config.container_resize_method = \"timeout\";\n\t}\n\n\t// in some environments (namely, in SalesForce) iframe.contentWindow is not available\n\tgantt.$root.appendChild(resizeWatcher);\n\tif (resizeWatcher.contentWindow) {\n\t\tlistenWindowResize(gantt, resizeWatcher.contentWindow);\n\t} else {\n\t\t// if so - ditch the iframe and fallback to listening the main window resize\n\t\tgantt.$root.removeChild(resizeWatcher);\n\t\tlistenWindowResize(gantt, window);\n\t}\n}\n\nfunction listenWindowResize(gantt, window){\n\tvar resizeTimeout = gantt.config.container_resize_timeout || 20;\n\tvar resizeDelay;\n\tlet previousSize = getContainerSize(gantt);\n\n\tif (gantt.config.container_resize_method == \"timeout\"){\n\t\tlowlevelResizeWatcher();\n\t}\n\telse {\n\t\ttry {\n\t\t\tgantt.event(window, \"resize\", function () {\n\t\t\t\tif (gantt.$scrollbarRepaint) {\n\t\t\t\t\tgantt.$scrollbarRepaint = null;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// GS-2140. Don't repaint Gantt if it has the same sizes\n\t\t\t\t\tlet currentSize = getContainerSize(gantt);\n\t\t\t\t\tif (previousSize.x == currentSize.x && previousSize.y == currentSize.y){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tpreviousSize = currentSize;\n\t\t\t\t\trepaintGantt();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tcatch (e) {\n\t\t\tlowlevelResizeWatcher();\n\t\t}\n\t}\n\n\tfunction repaintGantt(){\n\t\tclearTimeout(resizeDelay);\n\t\tresizeDelay = setTimeout(function(){\n\t\t\tif(!gantt.$destroyed){\n\t\t\t\tgantt.render();\n\t\t\t}\n\t\t}, resizeTimeout);\n\t}\n\n\tvar previousHeight = gantt.$root.offsetHeight;\n\tvar previousWidth = gantt.$root.offsetWidth;\t\n\n\tfunction lowlevelResizeWatcher(){\n\t\tif (gantt.$root.offsetHeight != previousHeight ||\n\t\t\t\tgantt.$root.offsetWidth != previousWidth){\n\t\t\t\trepaintGantt();\n\t\t}\n\n\t\tpreviousHeight = gantt.$root.offsetHeight;\n\t\tpreviousWidth = gantt.$root.offsetWidth;\n\n\t\tsetTimeout(lowlevelResizeWatcher, resizeTimeout);\n\t}\n}\n\nfunction getContainerSize(gantt){\n\treturn {\n\t\tx: gantt.$root.offsetWidth,\n\t\ty: gantt.$root.offsetHeight\n\t};\n}\n\nexport default addResizeListener;","import * as domHelpers from \"./ui/utils/dom_helpers\";\nimport * as helpers from \"../utils/helpers\";\nimport isHeadless from \"../utils/is_headless\";\nimport addResizeListener from \"./ui/resize_listener\";\nimport calculateScaleRange from \"./gantt_data_range\";\nimport assert from \"./common/assert\";\n\nexport default function(gantt){\n\t\n\n\tgantt.assert = assert(gantt);\n\n\tfunction isHTMLElement(node){\n\t\ttry {\n\t\t\tnode.cloneNode(false);\n\t\t}\n\t\tcatch (e){\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tvar invalidContainerMessage = \"Invalid value of the first argument of `gantt.init`. Supported values: HTMLElement, String (element id).\" +\n\t\"This error means that either invalid object is passed into `gantt.init` or that the element with the specified ID doesn't exist on the page when `gantt.init` is called.\";\n\n\tfunction validateNode(node){\n\t\tif (!node || (typeof node == 'string' && document.getElementById(node))) return true;\n\t\tif (isHTMLElement(node)) return true;\n\n\t\tgantt.assert(false, invalidContainerMessage);\n\t\tthrow new Error(invalidContainerMessage);\n\t}\n\n//initial initialization\n\tgantt.init = function(node, from, to){\n\t\tif (gantt.env.isNode) { \n\t\t\tnode = null; // for the nodejs version\n\t\t} else {\n\t\t\tvalidateNode(node); // for the web version\n\t\t}\n\n\t\tif(from && to){\n\t\t\tthis.config.start_date = this._min_date = new Date(from);\n\t\t\tthis.config.end_date = this._max_date = new Date(to);\n\t\t}\n\t\tthis.date.init();\n\n\t\t//can be called only once\n\t\tthis.init = function(node){\n\t\t\tif (gantt.env.isNode) { \n\t\t\t\tnode = null; // for the nodejs version\n\t\t\t} else {\n\t\t\t\tvalidateNode(node); // for the web version\n\t\t\t}\n\n\t\t\tif (this.$container && this.$container.parentNode){\n\t\t\t\tthis.$container.parentNode.removeChild(this.$container);\n\t\t\t\tthis.$container = null;\n\t\t\t}\n\n\t\t\tif(this.$layout){\n\t\t\t\tthis.$layout.clear();\n\t\t\t}\n\t\t\tthis._reinit(node);\n\t\t};\n\t\tthis._reinit(node);\n\t};\n\n\tgantt._quickRefresh = function(code){\n\t\tvar stores = this._getDatastores.call(this);\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i]._quick_refresh = true;\n\t\t}\n\n\t\tcode();\n\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i]._quick_refresh = false;\n\t\t}\n\t};\n\n\tvar dropLayout = (function dropLayout(){\n\t\tif(this._clearTaskLayers){\n\t\t\tthis._clearTaskLayers();\n\t\t}\n\n\t\tif(this._clearLinkLayers){\n\t\t\tthis._clearLinkLayers();\n\t\t}\n\n\t\tif(this.$layout){\n\t\t\tthis.$layout.destructor();\n\t\t\tthis.$layout = null;\n\t\t\tthis.$ui.reset();\n\t\t}\n\t}).bind(gantt);\n\n\tvar rebuildLayout = (function rebuildLayout(){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$root.innerHTML = \"\";\n\n\t\tthis.$root.gantt = this;\n\t\tcalculateScaleRange(this);\n\t\tthis.config.layout.id = \"main\";\n\t\tthis.$layout = this.$ui.createView(\"layout\", this.$root, this.config.layout);\n\n\t\tthis.$layout.attachEvent(\"onBeforeResize\", function(){\n\t\t\tvar storeNames = gantt.$services.getService(\"datastores\");\n\t\t\tfor(var i = 0; i < storeNames.length; i++){\n\t\t\t\tgantt.getDatastore(storeNames[i]).filter();\n\t\t\t\tif (gantt.$data.tasksStore._skipTaskRecalculation){\n\t\t\t\t\t// do not repaint items, they will be repainted later in the onStoreUpdate event\n\t\t\t\t\tif (gantt.$data.tasksStore._skipTaskRecalculation != \"lightbox\"){\n\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\tgantt.getDatastore(storeNames[i]).callEvent(\"onBeforeRefreshAll\", []);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.$layout.attachEvent(\"onResize\", function(){\n\t\t\tgantt._quickRefresh(function(){\n\t\t\t\tgantt.refreshData();\n\t\t\t});\n\t\t});\n\n\t\tthis.callEvent(\"onGanttLayoutReady\", []);\n\t\tthis.$layout.render();\n\n\t\tthis.$container = this.$layout.$container.firstChild;\n\n\t\taddResizeListener(this);\n\t}).bind(gantt);\n\n\tgantt.resetLayout = function(){\n\t\tdropLayout();\n\t\trebuildLayout();\n\t\tthis.render();\n\t};\n\n\tgantt._reinit = function(node){\n\t\tthis.callEvent(\"onBeforeGanttReady\", []);\n\t\tthis._update_flags();\n\n\t\tvar config = this.$services.getService(\"templateLoader\");\n\t\tconfig.initTemplates(this);\n\n\t\tdropLayout();\n\n\t\tthis.$root = null;\n\t\tif(node){\n\t\t\tthis.$root = domHelpers.toNode(node);\n\t\t\trebuildLayout();\n\t\t\tthis.$mouseEvents.reset(this.$root);\n\t\t\taddMinimalSizes(gantt);\n\t\t}\n\n\t\tthis.callEvent(\"onTemplatesReady\",[]);\n\n\t\tthis.callEvent(\"onGanttReady\", []);\n\n\t\tthis.render();\n\t};\n\n\tfunction addMinimalSizes(gantt) {\n\t\tif (gantt.$container && !gantt.config.autosize) {\n\t\t\tif (gantt.$root.offsetHeight < 50) {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.warn(`The Gantt container has a small height, so you cannot see its content. If it is not intended, you need to set the 'height' style rule to the container:\nhttps://docs.dhtmlx.com/gantt/faq.html#theganttchartisntrenderedcorrectly`);\n\t\t\t}\n\t\t}\n\t}\n\n\tgantt.$click={\n\t\tbuttons:{\n\t\t\t\"edit\": function(id) {\n\t\t\t\tif (gantt.isReadonly(gantt.getTask(id))) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tgantt.showLightbox(id);\n\t\t\t},\n\t\t\t\"delete\": function(id) {\n\t\t\t\tvar task = gantt.getTask(id);\n\t\t\t\tif (gantt.isReadonly(task)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar question = gantt.locale.labels.confirm_deleting;\n\t\t\t\tvar title = gantt.locale.labels.confirm_deleting_title;\n\n\t\t\t\tgantt._simple_confirm(question, title, function(){\n\t\t\t\t\tif(!gantt.isTaskExists(id)){\n\t\t\t\t\t\tgantt.hideLightbox();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(task.$new){\n\t\t\t\t\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks\n\t\t\t\t\t\t// as they will be recalculated in the `refreshData`\n\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = \"lightbox\";\n\t\t\t\t\t\tgantt.silent(function(){\n\t\t\t\t\t\t\tgantt.deleteTask(id, true);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\n\t\t\t\t\t\tgantt.refreshData();\n\t\t\t\t\t}else{\n\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = true;\n\t\t\t\t\t\tgantt.deleteTask(id);\n\t\t\t\t\t}\n\n\t\t\t\t\tgantt.hideLightbox();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n//renders self\n\tgantt.render = function(){\n\t\tthis.callEvent(\"onBeforeGanttRender\", []);\n\n\t\tvar visibleDate;\n\t\tif(!isHeadless(gantt)){\n\t\t\tif (!this.config.sort && this._sort) {\n\t\t\t\tthis._sort = undefined;\n\t\t\t}\n\n\t\t\tif(this.$root){\n\t\t\t\tif(this.config.rtl){\n\t\t\t\t\tthis.$root.classList.add(\"gantt_rtl\");\n\t\t\t\t\tthis.$root.firstChild.classList.add(\"gantt_rtl\"); // GS-1499\n\t\t\t\t}else{\n\t\t\t\t\tthis.$root.classList.remove(\"gantt_rtl\");\n\t\t\t\t\tthis.$root.firstChild.classList.remove(\"gantt_rtl\"); // GS-1499\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar pos = this.getScrollState();\n\t\t\tvar posX = pos ? pos.x : 0;\n\t\t\tif(this._getHorizontalScrollbar()){\n\t\t\t\tvar scrollbar = this._getHorizontalScrollbar();\n\t\t\t\tposX = scrollbar.$config.codeScrollLeft || posX || 0;\n\t\t\t}\n\n\n\t\t\tvisibleDate = null;\n\t\t\tif(posX){\n\t\t\t\tvisibleDate = gantt.dateFromPos(posX + this.config.task_scroll_offset);\n\t\t\t}\n\t\t}\n\n\t\tcalculateScaleRange(this);\n\n\t\tif(!isHeadless(gantt)){\n\t\t\tthis.$layout.$config.autosize = this.config.autosize;\n\t\t\tvar preserveScroll = this.config.preserve_scroll;\n\t\t\tthis.config.preserve_scroll = false; // prevent scrolling from layout resize, scroll will be called here later on\n\t\t\tthis.$layout.resize();\n\t\t\tthis.config.preserve_scroll = preserveScroll;\n\n\t\t\tif(this.config.preserve_scroll && pos){\n\n\t\t\t\t// GS-1640: We need pos.y, otherwise part of the timeline won't be rendered if the scrollbar disappeared\n\t\t\t\tif (posX || pos.y) {\n\t\t\t\t\tvar new_pos = gantt.getScrollState();\n\t\t\t\t\tvar new_date = gantt.dateFromPos(new_pos.x);\n\t\t\t\t\tif(!(+visibleDate == +new_date && new_pos.y == pos.y)){\n\t\t\t\t\t\tvar posX = null;\n\t\t\t\t\t\tvar posY = null;\n\t\t\t\t\t\tif(visibleDate){\n\t\t\t\t\t\t\tvar posX = Math.max(gantt.posFromDate(visibleDate) - gantt.config.task_scroll_offset, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(pos.y){\n\t\t\t\t\t\t\tposY = pos.y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgantt.scrollTo(posX, posY);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// GS-1640: We need to reset the scroll position for the grid if the scrollbar disappeared and\n\t\t\t\t// the grid and timeline have different scrollbars\n\t\t\t\t// GS-2718: if we have resources and two verticall scrollbars for tasks timeline and resource timeline\n\t\t\t\t// we don't get the scroll state of the resource timeline\n\t\t\t\tconst scrollbarsInfo = this.$layout.getScrollbarsInfo();\n\t\t\t\tscrollbarsInfo.forEach((scroll_info) => {\n\t\t\t\t\tconst scroll = gantt.$ui.getView(scroll_info.id);\n\t\t\t\t\tconst scrollbarNodeVisible = gantt.utils.dom.isChildOf(scroll.$view, gantt.$container);\n\t\t\t\t\tscroll_info.boundViews.forEach((viewName) => {\n\t\t\t\t\t\tconst view = gantt.$ui.getView(viewName);\n\t\t\t\t\t\tif(scroll_info.y && scroll_info.y != pos.y){\n\t\t\t\t\t\t\tif(view && !scrollbarNodeVisible){\n\t\t\t\t\t\t\t\tview.scrollTo(undefined, 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//GS-2586: take into account the horizontal scroll of the resource timeline\n\t\t\t\t\t\tif(scroll_info.x_pos && scroll_info.x_pos != pos.x){\n\t\t\t\t\t\t\tif(view && scrollbarNodeVisible){\n\t\t\t\t\t\t\t\tview.scrollTo(scroll_info.x_pos, undefined);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t}else{\n\t\t\tgantt.refreshData();\n\t\t}\n\t\tthis.callEvent(\"onGanttRender\", []);\n\t};\n\n\t//TODO: add layout.resize method that wouldn't trigger data repaint\n\tgantt.setSizes = gantt.render;\n\n\n\tgantt.getTaskRowNode = function(id) {\n\t\tvar els = this.$grid_data.childNodes;\n\t\tvar attribute = this.config.task_attribute;\n\t\tfor (var i = 0; i < els.length; i++) {\n\t\t\tif (els[i].getAttribute) {\n\t\t\t\tvar value = els[i].getAttribute(attribute);\n\t\t\t\tif (value == id) return els[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tgantt.changeLightboxType = function(type){\n\t\tif(this.getLightboxType() == type)\n\t\t\treturn true;\n\t\tgantt._silent_redraw_lightbox(type);\n\t};\n\n\tgantt._get_link_type = function (from_start, to_start) {\n\t\tvar type = null;\n\t\tif (from_start && to_start) {\n\t\t\ttype = gantt.config.links.start_to_start;\n\t\t} else if (!from_start && to_start) {\n\t\t\ttype = gantt.config.links.finish_to_start;\n\t\t} else if (!from_start && !to_start) {\n\t\t\ttype = gantt.config.links.finish_to_finish;\n\t\t} else if (from_start && !to_start) {\n\t\t\ttype = gantt.config.links.start_to_finish;\n\t\t}\n\t\treturn type;\n\t};\n\n\tgantt.isLinkAllowed = function (from, to, from_start, to_start) {\n\t\tvar link = null;\n\t\tif (typeof(from) == \"object\") {\n\t\t\tlink = from;\n\t\t} else {\n\t\t\tlink = {source: from, target: to, type: this._get_link_type(from_start, to_start)};\n\t\t}\n\n\t\tif (!link) return false;\n\t\tif (!(link.source && link.target && link.type)) return false;\n\t\tif (link.source == link.target) return false;\n\n\t\tvar res = true;\n\t\t//any custom rules\n\t\tif (this.checkEvent(\"onLinkValidation\"))\n\t\t\tres = this.callEvent(\"onLinkValidation\", [link]);\n\n\t\treturn res;\n\t};\n\n\n\tgantt._correct_dst_change = function(date, prevOffset, step, unit){\n\t\tvar time_unit = helpers.getSecondsInUnit(unit) * step;\n\t\tif(time_unit > 60*60 && time_unit < 60*60*24){\n\t\t\t//correct dst change only if current unit is more than one hour and less than day (days have own checking), e.g. 12h\n\t\t\tvar offsetChanged = date.getTimezoneOffset() - prevOffset;\n\t\t\tif(offsetChanged){\n\t\t\t\tdate = gantt.date.add(date, offsetChanged, \"minute\");\n\t\t\t}\n\t\t}\n\t\treturn date;\n\t};\n\n\tgantt.isSplitTask = function(task){\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isSplitTask. Task object was expected\");\n\t\treturn this.$data.tasksStore._isSplitItem(task);\n\t};\n\n\tgantt._is_icon_open_click = function(e) {\n\t\tif (!e)\n\t\t\treturn false;\n\t\tvar target = e.target || e.srcElement;\n\t\tif (!(target && target.className))\n\t\t\treturn false;\n\t\tvar className = domHelpers.getClassName(target);\n\t\tif (className.indexOf(\"gantt_tree_icon\") !== -1 && (className.indexOf(\"gantt_close\") !== -1 || className.indexOf(\"gantt_open\") !== -1))\n\t\t\treturn true;\n\t\treturn false;\n\t};\n\n};","/*\n \tasserts will be removed in final code, so you can place them anythere\n\twithout caring about performance impacts\n*/\n\nexport default function(gantt){\n\treturn function assert(check, message){\n\t\tif (!check){\n\t\t\tif(gantt.config.show_errors && gantt.callEvent(\"onError\",[message]) !== false) {\n\t\t\t\tif (gantt.message) {\n\t\t\t\t\tgantt.message({type: \"error\", text: message, expire: -1});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// eslint-disable-next-line\n\t\t\t\t\tconsole.log(message);\n\t\t\t\t}\n\n\t\t\t\t// eslint-disable-next-line no-debugger\n\t\t\t\tdebugger;\n\t\t\t}\n\t\t}\n\t};\n};","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"كانون الثاني\", \"شباط\", \"آذار\", \"نيسان\", \"أيار\", \"حزيران\", \"تموز\", \"آب\", \"أيلول\", \"تشرين الأول\", \"تشرين الثاني\", \"كانون الأول\"],\n\t\tmonth_short: [\"يناير\", \"فبراير\", \"مارس\", \"أبريل\", \"مايو\", \"يونيو\", \"يوليو\", \"أغسطس\", \"سبتمبر\", \"أكتوبر\", \"نوفمبر\", \"ديسمبر\"],\n\t\tday_full: [\"الأحد\", \"الأثنين\", \"ألثلاثاء\", \"الأربعاء\", \"ألحميس\", \"ألجمعة\", \"السبت\"],\n\t\tday_short: [\"احد\", \"اثنين\", \"ثلاثاء\", \"اربعاء\", \"خميس\", \"جمعة\", \"سبت\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"مهمة جديد\",\n\t\ticon_save: \"اخزن\",\n\t\ticon_cancel: \"الغاء\",\n\t\ticon_details: \"تفاصيل\",\n\t\ticon_edit: \"تحرير\",\n\t\ticon_delete: \"حذف\",\n\t\tconfirm_closing: \"التغييرات سوف تضيع, هل انت متأكد؟\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"الحدث سيتم حذفها نهائيا ، هل أنت متأكد؟\",\n\t\tsection_description: \"الوصف\",\n\t\tsection_time: \"الفترة الزمنية\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"الغاء\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Студзень\", \"Люты\", \"Сакавік\", \"Красавік\", \"Maй\", \"Чэрвень\", \"Ліпень\", \"Жнівень\", \"Верасень\", \"Кастрычнік\", \"Лістапад\", \"Снежань\"],\n\t\tmonth_short: [\"Студз\", \"Лют\", \"Сак\", \"Крас\", \"Maй\", \"Чэр\", \"Ліп\", \"Жнів\", \"Вер\", \"Каст\", \"Ліст\", \"Снеж\"],\n\t\tday_full: [\"Нядзеля\", \"Панядзелак\", \"Аўторак\", \"Серада\", \"Чацвер\", \"Пятніца\", \"Субота\"],\n\t\tday_short: [\"Нд\", \"Пн\", \"Аўт\", \"Ср\", \"Чцв\", \"Пт\", \"Сб\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Новае заданне\",\n\t\ticon_save: \"Захаваць\",\n\t\ticon_cancel: \"Адмяніць\",\n\t\ticon_details: \"Дэталі\",\n\t\ticon_edit: \"Змяніць\",\n\t\ticon_delete: \"Выдаліць\",\n\t\tconfirm_closing: \"\", // Унесеныя змены будуць страчаны, працягнуць?\n\t\tconfirm_deleting: \"Падзея будзе выдалена незваротна, працягнуць?\",\n\t\tsection_description: \"Апісанне\",\n\t\tsection_time: \"Перыяд часу\",\n\t\tsection_type: \"Тып\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"ІСР\",\n\t\tcolumn_text: \"Задача\",\n\t\tcolumn_start_date: \"Пачатак\",\n\t\tcolumn_duration: \"Працяг\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Сувязь\",\n\t\tconfirm_link_deleting: \"будзе выдалена\",\n\t\tlink_start: \"(пачатак)\",\n\t\tlink_end: \"(канец)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Хвiлiна\",\n\t\thours: \"Гадзiна\",\n\t\tdays: \"Дзень\",\n\t\tweeks: \"Тыдзень\",\n\t\tmonths: \"Месяц\",\n\t\tyears: \"Год\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Адмяніць\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n @Traducido por Vicente Adria Bohigues - vicenteadria@hotmail.com\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Gener\", \"Febrer\", \"Març\", \"Abril\", \"Maig\", \"Juny\", \"Juliol\", \"Agost\", \"Setembre\", \"Octubre\", \"Novembre\", \"Desembre\"],\n\t\tmonth_short: [\"Gen\", \"Feb\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Oct\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Diumenge\", \"Dilluns\", \"Dimarts\", \"Dimecres\", \"Dijous\", \"Divendres\", \"Dissabte\"],\n\t\tday_short: [\"Dg\", \"Dl\", \"Dm\", \"Dc\", \"Dj\", \"Dv\", \"Ds\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nova tasca\",\n\t\ticon_save: \"Guardar\",\n\t\ticon_cancel: \"Cancel·lar\",\n\t\ticon_details: \"Detalls\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Esborrar\",\n\t\tconfirm_closing: \"\", // \"Els seus canvis es perdràn, continuar ?\"\n\t\tconfirm_deleting: \"L'esdeveniment s'esborrarà definitivament, continuar ?\",\n\t\tsection_description: \"Descripció\",\n\t\tsection_time: \"Periode de temps\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancel·lar\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\nTranslation by FreezeSoul\n\nUpdate 26/10/2015:\nTranslation of new labels by zwh8800\n https://github.com/DHTMLX/gantt/pull/7\n\n*/\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"一月\", \"二月\", \"三月\", \"四月\", \"五月\", \"六月\", \"七月\", \"八月\", \"九月\", \"十月\", \"十一月\", \"十二月\"],\n\t\tmonth_short: [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"],\n\t\tday_full: [\"星期日\", \"星期一\", \"星期二\", \"星期三\", \"星期四\", \"星期五\", \"星期六\"],\n\t\tday_short: [\"日\", \"一\", \"二\", \"三\", \"四\", \"五\", \"六\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"新任務\",\n\t\ticon_save: \"保存\",\n\t\ticon_cancel: \"关闭\",\n\t\ticon_details: \"详细\",\n\t\ticon_edit: \"编辑\",\n\t\ticon_delete: \"删除\",\n\t\tconfirm_closing: \"请确认是否撤销修改!\", // Your changes will be lost, are your sure?\n\t\tconfirm_deleting: \"是否删除日程?\",\n\t\tsection_description: \"描述\",\n\t\tsection_time: \"时间范围\",\n\t\tsection_type: \"类型\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"工作分解结构\",\n\t\tcolumn_text: \"任务名\",\n\t\tcolumn_start_date: \"开始时间\",\n\t\tcolumn_duration: \"持续时间\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\n\t\tlink: \"关联\",\n\t\tconfirm_link_deleting: \"将被删除\",\n\t\tlink_start: \" (开始)\",\n\t\tlink_end: \" (结束)\",\n\n\t\ttype_task: \"任务\",\n\t\ttype_project: \"项目\",\n\t\ttype_milestone: \"里程碑\",\n\n\t\tminutes: \"分钟\",\n\t\thours: \"小时\",\n\t\tdays: \"天\",\n\t\tweeks: \"周\",\n\t\tmonths: \"月\",\n\t\tyears: \"年\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"关闭\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Leden\", \"Únor\", \"Březen\", \"Duben\", \"Květen\", \"Červen\", \"Červenec\", \"Srpen\", \"Září\", \"Říjen\", \"Listopad\", \"Prosinec\"],\n\t\tmonth_short: [\"Led\", \"Ún\", \"Bře\", \"Dub\", \"Kvě\", \"Čer\", \"Čec\", \"Srp\", \"Září\", \"Říj\", \"List\", \"Pro\"],\n\t\tday_full: [\"Neděle\", \"Pondělí\", \"Úterý\", \"Středa\", \"Čtvrtek\", \"Pátek\", \"Sobota\"],\n\t\tday_short: [\"Ne\", \"Po\", \"Út\", \"St\", \"Čt\", \"Pá\", \"So\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nová práce\",\n\t\ticon_save: \"Uložit\",\n\t\ticon_cancel: \"Zpět\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edituj\",\n\t\ticon_delete: \"Smazat\",\n\t\tconfirm_closing: \"\", // Vaše změny budou ztraceny, opravdu ?\n\t\tconfirm_deleting: \"Událost bude trvale smazána, opravdu?\",\n\t\tsection_description: \"Poznámky\",\n\t\tsection_time: \"Doba platnosti\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Zpět\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Marts\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Søndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lørdag\"],\n\t\tday_short: [\"Søn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lør\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny opgave\",\n\t\ticon_save: \"Gem\",\n\t\ticon_cancel: \"Fortryd\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Tilret\",\n\t\ticon_delete: \"Slet\",\n\t\tconfirm_closing: \"Dine rettelser vil gå tabt.. Er dy sikker?\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Bigivenheden vil blive slettet permanent. Er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Fortryd\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\" Januar\", \" Februar\", \" März \", \" April\", \" Mai\", \" Juni\", \" Juli\", \" August\", \" September \", \" Oktober\", \" November \", \" Dezember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mär\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dez\"],\n\t\tday_full: [\"Sonntag\", \"Montag\", \"Dienstag\", \" Mittwoch\", \" Donnerstag\", \"Freitag\", \"Samstag\"],\n\t\tday_short: [\"So\", \"Mo\", \"Di\", \"Mi\", \"Do\", \"Fr\", \"Sa\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Neue Aufgabe\",\n\t\ticon_save: \"Speichern\",\n\t\ticon_cancel: \"Abbrechen\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"Ändern\",\n\t\ticon_delete: \"Löschen\",\n\t\tconfirm_closing: \"\", // \"Ihre Veränderungen werden verloren sein, wollen Sie ergänzen? \"\n\t\tconfirm_deleting: \"Der Eintrag wird gelöscht\",\n\t\tsection_description: \"Beschreibung\",\n\t\tsection_time: \"Zeitspanne\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"PSP\",\n\t\tcolumn_text: \"Task-Namen\",\n\t\tcolumn_start_date: \"Startzeit\",\n\t\tcolumn_duration: \"Dauer\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"werden gelöscht\",\n\t\tlink_start: \"(starten)\",\n\t\tlink_end: \"(ende)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minuten\",\n\t\thours: \"Stunden\",\n\t\tdays: \"Tage\",\n\t\tweeks: \"Wochen\",\n\t\tmonths: \"Monate\",\n\t\tyears: \"Jahre\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Abbrechen\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Regel\",\n\t\tconstraint_type: \"Regel\",\n\t\tconstraint_date: \"Regel - Datum\",\n\t\tasap: \"So bald wie möglich\",\n\t\talap: \"So spät wie möglich\",\n\t\tsnet: \"Beginn nicht vor\",\n\t\tsnlt: \"Beginn nicht später als\",\n\t\tfnet: \"Fertigstellung nicht vor\",\n\t\tfnlt: \"Fertigstellung nicht später als\",\n\t\tmso: \"Muss beginnen am\",\n\t\tmfo: \"Muss fertig sein am\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Ιανουάριος\", \"Φεβρουάριος\", \"Μάρτιος\", \"Απρίλιος\", \"Μάϊος\", \"Ιούνιος\", \"Ιούλιος\", \"Αύγουστος\", \"Σεπτέμβριος\", \"Οκτώβριος\", \"Νοέμβριος\", \"Δεκέμβριος\"],\n\t\tmonth_short: [\"ΙΑΝ\", \"ΦΕΒ\", \"ΜΑΡ\", \"ΑΠΡ\", \"ΜΑΙ\", \"ΙΟΥΝ\", \"ΙΟΥΛ\", \"ΑΥΓ\", \"ΣΕΠ\", \"ΟΚΤ\", \"ΝΟΕ\", \"ΔΕΚ\"],\n\t\tday_full: [\"Κυριακή\", \"Δευτέρα\", \"Τρίτη\", \"Τετάρτη\", \"Πέμπτη\", \"Παρασκευή\", \"Κυριακή\"],\n\t\tday_short: [\"ΚΥ\", \"ΔΕ\", \"ΤΡ\", \"ΤΕ\", \"ΠΕ\", \"ΠΑ\", \"ΣΑ\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Νέα εργασία\",\n\t\ticon_save: \"Αποθήκευση\",\n\t\ticon_cancel: \"Άκυρο\",\n\t\ticon_details: \"Λεπτομέρειες\",\n\t\ticon_edit: \"Επεξεργασία\",\n\t\ticon_delete: \"Διαγραφή\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Το έργο θα διαγραφεί οριστικά. Θέλετε να συνεχίσετε;\",\n\t\tsection_description: \"Περιγραφή\",\n\t\tsection_time: \"Χρονική περίοδος\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Άκυρο\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n\t\tday_short: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"New task\",\n\t\ticon_save: \"Save\",\n\t\ticon_cancel: \"Cancel\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"Edit\",\n\t\ticon_delete: \"Delete\",\n\t\tconfirm_closing: \"\",// Your changes will be lost, are you sure?\n\t\tconfirm_deleting: \"Task will be deleted permanently, are you sure?\",\n\t\tsection_description: \"Description\",\n\t\tsection_time: \"Time period\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\n\t\t/* grid columns */\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancel\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;","/*\n @Autor Manuel Fernandez Panzuela - www.mfernandez.es\n\n Update 30/10/2015:\n Translation of new labels by Jorge Macias\n https://disqus.com/by/disqus_bTuZk1voC7/\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"],\n\t\tmonth_short: [\"Ene\", \"Feb\", \"Mar\", \"Abr\", \"May\", \"Jun\", \"Jul\", \"Ago\", \"Sep\", \"Oct\", \"Nov\", \"Dic\"],\n\t\tday_full: [\"Domingo\", \"Lunes\", \"Martes\", \"Miércoles\", \"Jueves\", \"Viernes\", \"Sábado\"],\n\t\tday_short: [\"Dom\", \"Lun\", \"Mar\", \"Mié\", \"Jue\", \"Vie\", \"Sáb\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nueva tarea\",\n\t\ticon_save: \"Guardar\",\n\t\ticon_cancel: \"Cancelar\",\n\t\ticon_details: \"Detalles\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Eliminar\",\n\t\tconfirm_closing: \"\", // \"Sus cambios se perderán, continuar ?\"\n\t\tconfirm_deleting: \"El evento se borrará definitivamente, ¿continuar?\",\n\t\tsection_description: \"Descripción\",\n\t\tsection_time: \"Período\",\n\t\tsection_type: \"Tipo\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"EDT\",\n\t\tcolumn_text: \"Tarea\",\n\t\tcolumn_start_date: \"Inicio\",\n\t\tcolumn_duration: \"Duración\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Enlace\",\n\t\tconfirm_link_deleting: \"será borrada\",\n\t\tlink_start: \" (inicio)\",\n\t\tlink_end: \" (fin)\",\n\n\t\ttype_task: \"Tarea\",\n\t\ttype_project: \"Proyecto\",\n\t\ttype_milestone: \"Hito\",\n\n\n\t\tminutes: \"Minutos\",\n\t\thours: \"Horas\",\n\t\tdays: \"Días\",\n\t\tweeks: \"Semanas\",\n\t\tmonths: \"Meses\",\n\t\tyears: \"Años\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancelar\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n dhtmlxGantt Persian (Farsi, fa_IR) locale by Mohammad Shokri http://slashsbin.com/\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\n\t\t\t\"ژانویه\",\n\t\t\t\"فوریه\",\n\t\t\t\"مارس\",\n\t\t\t\"آوریل\",\n\t\t\t\"مه\",\n\t\t\t\"ژوئن\",\n\t\t\t\"ژوئیه\",\n\t\t\t\"اوت\",\n\t\t\t\"سپتامبر\",\n\t\t\t\"اکتبر\",\n\t\t\t\"نوامبر\",\n\t\t\t\"دسامبر\"\n\t\t],\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_full: [\n\t\t\t\"يکشنبه\",\n\t\t\t\"دوشنبه\",\n\t\t\t\"سه‌شنبه\",\n\t\t\t\"چهارشنبه\",\n\t\t\t\"پنجشنبه\",\n\t\t\t\"جمعه\",\n\t\t\t\"شنبه\"\n\t\t],\n\t\tday_short: [\n\t\t\t\"ی\",\n\t\t\t\"د\",\n\t\t\t\"س\",\n\t\t\t\"چ\",\n\t\t\t\"پ\",\n\t\t\t\"ج\",\n\t\t\t\"ش\"\n\t\t]\n\t},\n\tlabels: {\n\t\tnew_task: \"وظیفه جدید\",\n\t\ticon_save: \"ذخیره\",\n\t\ticon_cancel: \"لغو\",\n\t\ticon_details: \"جزییات\",\n\t\ticon_edit: \"ویرایش\",\n\t\ticon_delete: \"حذف\",\n\t\tconfirm_closing: \"تغییرات شما ازدست خواهد رفت، آیا مطمئن هستید؟\",\n\t\tconfirm_deleting: \"این مورد برای همیشه حذف خواهد شد، آیا مطمئن هستید؟\",\n\t\tsection_description: \"توضیحات\",\n\t\tsection_time: \"مدت زمان\",\n\t\tsection_type: \"نوع\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"عنوان\",\n\t\tcolumn_start_date: \"زمان شروع\",\n\t\tcolumn_duration: \"مدت\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"ارتباط\",\n\t\tconfirm_link_deleting: \"حذف خواهد شد\",\n\t\tlink_start: \" (آغاز)\",\n\t\tlink_end: \" (پایان)\",\n\n\t\ttype_task: \"وظیفه\",\n\t\ttype_project: \"پروژه\",\n\t\ttype_milestone: \"نگارش\",\n\n\t\tminutes: \"دقایق\",\n\t\thours: \"ساعات\",\n\t\tdays: \"روزها\",\n\t\tweeks: \"هفته\",\n\t\tmonths: \"ماه‌ها\",\n\t\tyears: \"سال‌ها\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"تایید\",\n\t\tmessage_cancel: \"لغو\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Tammikuu\", \"Helmikuu\", \"Maaliskuu\", \"Huhtikuu\", \"Toukokuu\", \"Kes&auml;kuu\", \"Hein&auml;kuu\", \"Elokuu\", \"Syyskuu\", \"Lokakuu\", \"Marraskuu\", \"Joulukuu\"],\n\t\tmonth_short: [\"Tam\", \"Hel\", \"Maa\", \"Huh\", \"Tou\", \"Kes\", \"Hei\", \"Elo\", \"Syy\", \"Lok\", \"Mar\", \"Jou\"],\n\t\tday_full: [\"Sunnuntai\", \"Maanantai\", \"Tiistai\", \"Keskiviikko\", \"Torstai\", \"Perjantai\", \"Lauantai\"],\n\t\tday_short: [\"Su\", \"Ma\", \"Ti\", \"Ke\", \"To\", \"Pe\", \"La\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Uusi tehtävä\",\n\t\ticon_save: \"Tallenna\",\n\t\ticon_cancel: \"Peru\",\n\t\ticon_details: \"Tiedot\",\n\t\ticon_edit: \"Muokkaa\",\n\t\ticon_delete: \"Poista\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Haluatko varmasti poistaa tapahtuman?\",\n\t\tsection_description: \"Kuvaus\",\n\t\tsection_time: \"Aikajakso\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Peru\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Janvier\", \"Février\", \"Mars\", \"Avril\", \"Mai\", \"Juin\", \"Juillet\", \"Août\", \"Septembre\", \"Octobre\", \"Novembre\", \"Décembre\"],\n\t\tmonth_short: [\"Jan\", \"Fév\", \"Mar\", \"Avr\", \"Mai\", \"Juin\", \"Juil\", \"Aoû\", \"Sep\", \"Oct\", \"Nov\", \"Déc\"],\n\t\tday_full: [\"Dimanche\", \"Lundi\", \"Mardi\", \"Mercredi\", \"Jeudi\", \"Vendredi\", \"Samedi\"],\n\t\tday_short: [\"Dim\", \"Lun\", \"Mar\", \"Mer\", \"Jeu\", \"Ven\", \"Sam\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nouvelle tâche\",\n\t\ticon_save: \"Enregistrer\",\n\t\ticon_cancel: \"Annuler\",\n\t\ticon_details: \"Détails\",\n\t\ticon_edit: \"Modifier\",\n\t\ticon_delete: \"Effacer\",\n\t\tconfirm_closing: \"\",// Vos modifications seront perdus, êtes-vous sûr ?\n\t\tconfirm_deleting: \"L'événement sera effacé sans appel, êtes-vous sûr ?\",\n\n\t\tsection_description: \"Description\",\n\t\tsection_time: \"Période\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"OTP\",\n\t\tcolumn_text: \"Nom de la tâche\",\n\t\tcolumn_start_date: \"Date initiale\",\n\t\tcolumn_duration: \"Durée\",\n\t\tcolumn_add: \"\",\n\n\n\t\t/* link confirmation */\n\t\tlink: \"Le lien\",\n\t\tconfirm_link_deleting: \"sera supprimé\",\n\t\tlink_start: \"(début)\",\n\t\tlink_end: \"(fin)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Heures\",\n\t\tdays: \"Jours\",\n\t\tweeks: \"Semaines\",\n\t\tmonths: \"Mois\",\n\t\tyears: \"Années\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Annuler\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"ינואר\", \"פברואר\", \"מרץ\", \"אפריל\", \"מאי\", \"יוני\", \"יולי\", \"אוגוסט\", \"ספטמבר\", \"אוקטובר\", \"נובמבר\", \"דצמבר\"],\n\t\tmonth_short: [\"ינו\", \"פבר\", \"מרץ\", \"אפר\", \"מאי\", \"יונ\", \"יול\", \"אוג\", \"ספט\", \"אוק\", \"נוב\", \"דצמ\"],\n\t\tday_full: [\"ראשון\", \"שני\", \"שלישי\", \"רביעי\", \"חמישי\", \"שישי\", \"שבת\"],\n\t\tday_short: [\"א\", \"ב\", \"ג\", \"ד\", \"ה\", \"ו\", \"ש\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"משימה חדש\",\n\t\ticon_save: \"שמור\",\n\t\ticon_cancel: \"בטל\",\n\t\ticon_details: \"פרטים\",\n\t\ticon_edit: \"ערוך\",\n\t\ticon_delete: \"מחק\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"ארוע ימחק סופית.להמשיך?\",\n\t\tsection_description: \"הסבר\",\n\t\tsection_time: \"תקופה\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"בטל\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n  Translation by Davor\n http://docs.dhtmlx.com/gantt/desktop__localization.html#comment-2569116291\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Siječanj\", \"Veljača\", \"Ožujak\", \"Travanj\", \"Svibanj\", \"Lipanj\", \"Srpanj\", \"Kolovoz\", \"Rujan\", \"Listopad\", \"Studeni\", \"Prosinac\"],\n\t\tmonth_short: [\"Sij\", \"Velj\", \"Ožu\", \"Tra\", \"Svi\", \"Lip\", \"Srp\", \"Kol\", \"Ruj\", \"Lis\", \"Stu\", \"Pro\"],\n\t\tday_full: [\"Nedjelja\", \"Ponedjeljak\", \"Utorak\", \"Srijeda\", \"Četvrtak\", \"Petak\", \"Subota\"],\n\t\tday_short: [\"Ned\", \"Pon\", \"Uto\", \"Sri\", \"Čet\", \"Pet\", \"Sub\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Novi Zadatak\",\n\t\ticon_save: \"Spremi\",\n\t\ticon_cancel: \"Odustani\",\n\t\ticon_details: \"Detalji\",\n\t\ticon_edit: \"Izmjeni\",\n\t\ticon_delete: \"Obriši\",\n\t\tconfirm_closing: \"\",\n\t\tconfirm_deleting: \"Zadatak će biti trajno izbrisan, jeste li sigurni?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"Vremenski Period\",\n\t\tsection_type: \"Tip\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\n\t\t/* grid columns */\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Naziv Zadatka\",\n\t\tcolumn_start_date: \"Početno Vrijeme\",\n\t\tcolumn_duration: \"Trajanje\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Poveznica\",\n\t\tconfirm_link_deleting: \"će biti izbrisan\",\n\t\tlink_start: \" (početak)\",\n\t\tlink_end: \" (kraj)\",\n\n\t\ttype_task: \"Zadatak\",\n\t\ttype_project: \"Projekt\",\n\t\ttype_milestone: \"Milestone\",\n\n\t\tminutes: \"Minute\",\n\t\thours: \"Sati\",\n\t\tdays: \"Dani\",\n\t\tweeks: \"Tjedni\",\n\t\tmonths: \"Mjeseci\",\n\t\tyears: \"Godine\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Odustani\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Január\", \"Február\", \"Március\", \"Április\", \"Május\", \"Június\", \"Július\", \"Augusztus\", \"Szeptember\", \"Október\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Már\", \"Ápr\", \"Máj\", \"Jún\", \"Júl\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Vasárnap\", \"Hétfõ\", \"Kedd\", \"Szerda\", \"Csütörtök\", \"Péntek\", \"szombat\"],\n\t\tday_short: [\"Va\", \"Hé\", \"Ke\", \"Sze\", \"Csü\", \"Pé\", \"Szo\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Új feladat\",\n\t\ticon_save: \"Mentés\",\n\t\ticon_cancel: \"Mégse\",\n\t\ticon_details: \"Részletek\",\n\t\ticon_edit: \"Szerkesztés\",\n\t\ticon_delete: \"Törlés\",\n\t\tconfirm_closing: \"\", // A változások elvesznek, biztosan folytatja? \"\n\t\tconfirm_deleting: \"Az esemény törölve lesz, biztosan folytatja?\",\n\t\tsection_description: \"Leírás\",\n\t\tsection_time: \"Idõszak\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Mégse\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Maret\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Agustus\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Ags\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Minggu\", \"Senin\", \"Selasa\", \"Rabu\", \"Kamis\", \"Jumat\", \"Sabtu\"],\n\t\tday_short: [\"Ming\", \"Sen\", \"Sel\", \"Rab\", \"Kam\", \"Jum\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Tugas baru\",\n\t\ticon_save: \"Simpan\",\n\t\ticon_cancel: \"Batal\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edit\",\n\t\ticon_delete: \"Hapus\",\n\t\tconfirm_closing: \"\", /* Perubahan tidak akan disimpan ? */\n\t\tconfirm_deleting: \"Acara akan dihapus\",\n\t\tsection_description: \"Keterangan\",\n\t\tsection_time: \"Periode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Batal\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n Update 29/12/2015:\n New labels translation by ARCANGELI CLAUDIO\n\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Gennaio\", \"Febbraio\", \"Marzo\", \"Aprile\", \"Maggio\", \"Giugno\", \"Luglio\", \"Agosto\", \"Settembre\", \"Ottobre\", \"Novembre\", \"Dicembre\"],\n\t\tmonth_short: [\"Gen\", \"Feb\", \"Mar\", \"Apr\", \"Mag\", \"Giu\", \"Lug\", \"Ago\", \"Set\", \"Ott\", \"Nov\", \"Dic\"],\n\t\tday_full: [\"Domenica\", \"Lunedì\", \"Martedì\", \"Mercoledì\", \"Giovedì\", \"Venerdì\", \"Sabato\"],\n\t\tday_short: [\"Dom\", \"Lun\", \"Mar\", \"Mer\", \"Gio\", \"Ven\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nuovo compito\",\n\t\ticon_save: \"Salva\",\n\t\ticon_cancel: \"Chiudi\",\n\t\ticon_details: \"Dettagli\",\n\t\ticon_edit: \"Modifica\",\n\t\ticon_delete: \"Elimina\",\n\t\tconfirm_closing: \"\",// \"Sei sicuro di confermare la chiusura?\",\n\t\tconfirm_deleting: \"Sei sicuro di confermare l'eliminazione?\",\n\t\tsection_description: \"Descrizione\",\n\t\tsection_time: \"Periodo di tempo\",\n\t\tsection_type: \"Tipo\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Nome Attività\",\n\t\tcolumn_start_date: \"Inizio\",\n\t\tcolumn_duration: \"Durata\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"sarà eliminato\",\n\t\tlink_start: \" (inizio)\",\n\t\tlink_end: \" (fine)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minuti\",\n\t\thours: \"Ore\",\n\t\tdays: \"Giorni\",\n\t\tweeks: \"Settimane\",\n\t\tmonths: \"Mesi\",\n\t\tyears: \"Anni\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Chiudi\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n Translation by Genexus Japan Inc.\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"],\n\t\tmonth_short: [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"],\n\t\tday_full: [\"日曜日\", \"月曜日\", \"火曜日\", \"水曜日\", \"木曜日\", \"金曜日\", \"土曜日\"],\n\t\tday_short: [\"日\", \"月\", \"火\", \"水\", \"木\", \"金\", \"土\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"新しい仕事\",\n\t\ticon_save: \"保存\",\n\t\ticon_cancel: \"キャンセル\",\n\t\ticon_details: \"詳細\",\n\t\ticon_edit: \"編集\",\n\t\ticon_delete: \"削除\",\n\t\tconfirm_closing: \"\", // 変更が取り消されます、宜しいですか？\n\t\tconfirm_deleting: \"イベント完全に削除されます、宜しいですか？\",\n\t\tsection_description: \"デスクリプション\",\n\t\tsection_time: \"期間\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"キャンセル\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\tTranslated by cjkim@dbvalley.com\n*/\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"1월\", \"2월\", \"3월\", \"4월\", \"5월\", \"6월\", \"7월\", \"8월\", \"9월\", \"10월\", \"11월\", \"12월\"],\n\t\tmonth_short: [\"1월\", \"2월\", \"3월\", \"4월\", \"5월\", \"6월\", \"7월\", \"8월\", \"9월\", \"10월\", \"11월\", \"12월\"],\n\t\tday_full: [\"일요일\", \"월요일\", \"화요일\", \"수요일\", \"목요일\", \"금요일\", \"토요일\"],\n\t\tday_short: [\"일\", \"월\", \"화\", \"수\", \"목\", \"금\", \"토\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"이름없는 작업\",\n\t\ticon_save: \"저장\",\n\t\ticon_cancel: \"취소\",\n\t\ticon_details: \"세부 사항\",\n\t\ticon_edit: \"수정\",\n\t\ticon_delete: \"삭제\",\n\t\tconfirm_closing: \"\",\n\t\tconfirm_deleting: \"작업을 삭제하시겠습니까?\",\n\t\tsection_description: \"설명\",\n\t\tsection_time: \"기간\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"작업명\",\n\t\tcolumn_start_date: \"시작일\",\n\t\tcolumn_duration: \"기간\",\n\t\tcolumn_add: \"\",\n\t\tlink: \"전제\",\n\t\tconfirm_link_deleting: \"삭제 하시겠습니까?\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\t\ttype_task: \"작업\",\n\t\ttype_project: \"프로젝트\",\n\t\ttype_milestone: \"마일스톤\",\n\t\tminutes: \"분\",\n\t\thours: \"시간\",\n\t\tdays: \"일\",\n\t\tweeks: \"주\",\n\t\tmonths: \"달\",\n\t\tyears: \"년\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"취소\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","export default class LocaleManager{\n\tprivate _locales:{[key:string]: IGanttLocale };\n\n\tconstructor(config: {[key:string]: IGanttLocale }){\n\t\tthis._locales = {};\n\t\tfor(const i in config){\n\t\t\tthis._locales[i] = config[i];\n\t\t}\n\t}\n\n\taddLocale = (name: string, locale: IGanttLocale) => {\n\t\tthis._locales[name] = locale;\n\t};\n\n\tgetLocale = (name: string): IGanttLocale => {\n\t\treturn this._locales[name];\n\t};\n}","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Søndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lørdag\"],\n\t\tday_short: [\"Søn\", \"Mon\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lør\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny oppgave\",\n\t\ticon_save: \"Lagre\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Rediger\",\n\t\ticon_delete: \"Slett\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Hendelsen vil bli slettet permanent. Er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Avbryt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Maart\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Augustus\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"mrt\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Zondag\", \"Maandag\", \"Dinsdag\", \"Woensdag\", \"Donderdag\", \"Vrijdag\", \"Zaterdag\"],\n\t\tday_short: [\"Zo\", \"Ma\", \"Di\", \"Wo\", \"Do\", \"Vr\", \"Za\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nieuwe taak\",\n\t\ticon_save: \"Opslaan\",\n\t\ticon_cancel: \"Annuleren\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"Bewerken\",\n\t\ticon_delete: \"Verwijderen\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Item zal permanent worden verwijderd, doorgaan?\",\n\t\tsection_description: \"Beschrijving\",\n\t\tsection_time: \"Tijd periode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Taak omschrijving\",\n\t\tcolumn_start_date: \"Startdatum\",\n\t\tcolumn_duration: \"Duur\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Koppeling\",\n\t\tconfirm_link_deleting: \"zal worden verwijderd\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (eind)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"minuten\",\n\t\thours: \"uren\",\n\t\tdays: \"dagen\",\n\t\tweeks: \"weken\",\n\t\tmonths: \"maanden\",\n\t\tyears: \"jaren\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Annuleren\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Søndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lørdag\"],\n\t\tday_short: [\"Søn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lør\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny oppgave\",\n\t\ticon_save: \"Lagre\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Endre\",\n\t\ticon_delete: \"Slett\",\n\t\tconfirm_closing: \"Endringer blir ikke lagret, er du sikker?\", // Endringer blir ikke lagret, er du sikker?\n\t\tconfirm_deleting: \"Oppføringen vil bli slettet, er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Avbryt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Styczeń\", \"Luty\", \"Marzec\", \"Kwiecień\", \"Maj\", \"Czerwiec\", \"Lipiec\", \"Sierpień\", \"Wrzesień\", \"Październik\", \"Listopad\", \"Grudzień\"],\n\t\tmonth_short: [\"Sty\", \"Lut\", \"Mar\", \"Kwi\", \"Maj\", \"Cze\", \"Lip\", \"Sie\", \"Wrz\", \"Paź\", \"Lis\", \"Gru\"],\n\t\tday_full: [\"Niedziela\", \"Poniedziałek\", \"Wtorek\", \"Środa\", \"Czwartek\", \"Piątek\", \"Sobota\"],\n\t\tday_short: [\"Nie\", \"Pon\", \"Wto\", \"Śro\", \"Czw\", \"Pią\", \"Sob\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nowe zadanie\",\n\t\ticon_save: \"Zapisz\",\n\t\ticon_cancel: \"Anuluj\",\n\t\ticon_details: \"Szczegóły\",\n\t\ticon_edit: \"Edytuj\",\n\t\ticon_delete: \"Usuń\",\n\t\tconfirm_closing: \"\", // Zmiany zostaną usunięte, jesteś pewien?\n\t\tconfirm_deleting: \"Zdarzenie zostanie usunięte na zawsze, kontynuować?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"Okres czasu\",\n\t\tsection_type: \"Typ\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Nazwa zadania\",\n\t\tcolumn_start_date: \"Początek\",\n\t\tcolumn_duration: \"Czas trwania\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"zostanie usunięty\",\n\t\tlink_start: \" (początek)\",\n\t\tlink_end: \" (koniec)\",\n\n\t\ttype_task: \"Zadanie\",\n\t\ttype_project: \"Projekt\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minuty\",\n\t\thours: \"Godziny\",\n\t\tdays: \"Dni\",\n\t\tweeks: \"Tydzień\",\n\t\tmonths: \"Miesiące\",\n\t\tyears: \"Lata\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Anuluj\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\n TRANSLATION BY MATTHEUS PIROVANI RORIZ GONЗALVES\n\n mattheusroriz@hotmail.com / mattheus.pirovani@gmail.com /\n\n www.atrixian.com.br\n\n\n Updated by Jorge Albernaz Martins\n\n jorgefox@hotmail.com\n\n www.redfox.inf.br\n\n JorgeFox\n\n*/\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Janeiro\", \"Fevereiro\", \"Março\", \"Abril\", \"Maio\", \"Junho\", \"Julho\", \"Agosto\", \"Setembro\", \"Outubro\", \"Novembro\", \"Dezembro\"],\n\t\tmonth_short: [\"Jan\", \"Fev\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Out\", \"Nov\", \"Dez\"],\n\t\tday_full: [\"Domingo\", \"Segunda\", \"Terça\", \"Quarta\", \"Quinta\", \"Sexta\", \"Sábado\"],\n\t\tday_short: [\"Dom\", \"Seg\", \"Ter\", \"Qua\", \"Qui\", \"Sex\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nova tarefa\",\n\t\ticon_save: \"Salvar\",\n\t\ticon_cancel: \"Cancelar\",\n\t\ticon_details: \"Detalhes\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Excluir\",\n\t\tconfirm_closing: \"\",// Suas alterações serão perdidas, confirme?\n\t\tconfirm_deleting: \"As tarefas serão excluidas permanentemente, confirme?\",\n\t\tsection_description: \"Descrição\",\n\t\tsection_time: \"Período\",\n\t\tsection_type: \"Tipo\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"EAP\",\n\t\tcolumn_text: \"Nome tarefa\",\n\t\tcolumn_start_date: \"Data início\",\n\t\tcolumn_duration: \"Duração\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"Será excluído!\",\n\t\tlink_start: \" (início)\",\n\t\tlink_end: \" (fim)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Projeto\",\n\t\ttype_milestone: \"Marco\",\n\n\n\t\tminutes: \"Minutos\",\n\t\thours: \"Horas\",\n\t\tdays: \"Dias\",\n\t\tweeks: \"Semanas\",\n\t\tmonths: \"Meses\",\n\t\tyears: \"Anos\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancelar\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Restrição\",\n\t\tconstraint_type: \"Tipo Restrição\",\n\t\tconstraint_date: \"Data restrição\",\n\t\tasap: \"Mais breve possível\",\n\t\talap: \"Mais tarde possível\",\n\t\tsnet: \"Não começar antes de\",\n\t\tsnlt: \"Não começar depois de\",\n\t\tfnet: \"Não terminar antes de\",\n\t\tfnlt: \"Não terminar depois de\",\n\t\tmso: \"Precisa começar em\",\n\t\tmfo: \"Precisa terminar em\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"Tipo de filtros\",\n\t\tresources_filter_label: \"Ocultar vazios\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\tTraducere de Ovidiu Lixandru: http://www.madball.ro\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Ianuarie\", \"Februarie\", \"Martie\", \"Aprilie\", \"Mai\", \"Iunie\", \"Iulie\", \"August\", \"Septembrie\", \"Octombrie\", \"November\", \"December\"],\n\t\tmonth_short: [\"Ian\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Iun\", \"Iul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Duminica\", \"Luni\", \"Marti\", \"Miercuri\", \"Joi\", \"Vineri\", \"Sambata\"],\n\t\tday_short: [\"Du\", \"Lu\", \"Ma\", \"Mi\", \"Jo\", \"Vi\", \"Sa\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Sarcina noua\",\n\t\ticon_save: \"Salveaza\",\n\t\ticon_cancel: \"Anuleaza\",\n\t\ticon_details: \"Detalii\",\n\t\ticon_edit: \"Editeaza\",\n\t\ticon_delete: \"Sterge\",\n\t\tconfirm_closing: \"Schimbarile nu vor fi salvate, esti sigur?\",// Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Evenimentul va fi sters permanent, esti sigur?\",\n\t\tsection_description: \"Descriere\",\n\t\tsection_time: \"Interval\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Anuleaza\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Январь\", \"Февраль\", \"Март\", \"Апрель\", \"Maй\", \"Июнь\", \"Июль\", \"Август\", \"Сентябрь\", \"Oктябрь\", \"Ноябрь\", \"Декабрь\"],\n\t\tmonth_short: [\"Янв\", \"Фев\", \"Maр\", \"Aпр\", \"Maй\", \"Июн\", \"Июл\", \"Aвг\", \"Сен\", \"Окт\", \"Ноя\", \"Дек\"],\n\t\tday_full: [\"Воскресенье\", \"Понедельник\", \"Вторник\", \"Среда\", \"Четверг\", \"Пятница\", \"Суббота\"],\n\t\tday_short: [\"Вс\", \"Пн\", \"Вт\", \"Ср\", \"Чт\", \"Пт\", \"Сб\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Новое задание\",\n\t\ticon_save: \"Сохранить\",\n\t\ticon_cancel: \"Отменить\",\n\t\ticon_details: \"Детали\",\n\t\ticon_edit: \"Изменить\",\n\t\ticon_delete: \"Удалить\",\n\t\tconfirm_closing: \"\", // Ваши изменения будут потеряны, продолжить?\n\t\tconfirm_deleting: \"Событие будет удалено безвозвратно, продолжить?\",\n\t\tsection_description: \"Описание\",\n\t\tsection_time: \"Период времени\",\n\t\tsection_type: \"Тип\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"ИСР\",\n\t\tcolumn_text: \"Задача\",\n\t\tcolumn_start_date: \"Начало\",\n\t\tcolumn_duration: \"Длительность\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Связь\",\n\t\tconfirm_link_deleting: \"будет удалена\",\n\t\tlink_start: \" (начало)\",\n\t\tlink_end: \" (конец)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Минута\",\n\t\thours: \"Час\",\n\t\tdays: \"День\",\n\t\tweeks: \"Неделя\",\n\t\tmonths: \"Месяц\",\n\t\tyears: \"Год\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Отменить\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"начните вводить слово для фильтрации\",\n\t\tresources_filter_label: \"спрятать не установленные\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Marec\", \"April\", \"Maj\", \"Junij\", \"Julij\", \"Avgust\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Nedelja\", \"Ponedeljek\", \"Torek\", \"Sreda\", \"Četrtek\", \"Petek\", \"Sobota\"],\n\t\tday_short: [\"Ned\", \"Pon\", \"Tor\", \"Sre\", \"Čet\", \"Pet\", \"Sob\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nova naloga\",\n\t\ticon_save: \"Shrani\",\n\t\ticon_cancel: \"Prekliči\",\n\t\ticon_details: \"Podrobnosti\",\n\t\ticon_edit: \"Uredi\",\n\t\ticon_delete: \"Izbriši\",\n\t\tconfirm_closing: \"\", // Spremembe ne bodo shranjene. Želite nadaljevati ?\n\t\tconfirm_deleting: \"Dogodek bo izbrisan. Želite nadaljevati?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"Časovni okvir\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Prekliči\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Január\", \"Február\", \"Marec\", \"Apríl\", \"Máj\", \"Jún\", \"Júl\", \"August\", \"September\", \"Október\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Máj\", \"Jún\", \"Júl\", \"Aug\", \"Sept\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Nedeľa\", \"Pondelok\", \"Utorok\", \"Streda\", \"Štvrtok\", \"Piatok\", \"Sobota\"],\n\t\tday_short: [\"Ne\", \"Po\", \"Ut\", \"St\", \"Št\", \"Pi\", \"So\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nová úloha\",\n\t\ticon_save: \"Uložiť\",\n\t\ticon_cancel: \"Späť\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edituj\",\n\t\ticon_delete: \"Zmazať\",\n\t\tconfirm_closing: \"Vaše zmeny nebudú uložené. Skutočne?\", // Vaše změny budou ztraceny, opravdu ?\n\t\tconfirm_deleting: \"Udalosť bude natrvalo vymazaná. Skutočne?\",\n\t\tsection_description: \"Poznámky\",\n\t\tsection_time: \"Doba platnosti\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Späť\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\tTranslation by Peter Eriksson\n */\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Mars\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"Augusti\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Söndag\", \"Måndag\", \"Tisdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lördag\"],\n\t\tday_short: [\"Sön\", \"Mån\", \"Tis\", \"Ons\", \"Tor\", \"Fre\", \"Lör\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny uppgift\",\n\t\ticon_save: \"Spara\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detajer\",\n\t\ticon_edit: \"Ändra\",\n\t\ticon_delete: \"Ta bort\",\n\t\tconfirm_closing: \"\",\n\t\tconfirm_deleting: \"Är du säker på att du vill ta bort händelsen permanent?\",\n\t\tsection_description: \"Beskrivning\",\n\t\tsection_time: \"Tid\",\n\t\tsection_type: \"Typ\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Uppgiftsnamn\",\n\t\tcolumn_start_date: \"Starttid\",\n\t\tcolumn_duration: \"Varaktighet\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\n\t\tlink: \"Länk\",\n\t\tconfirm_link_deleting: \"kommer tas bort\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (slut)\",\n\t\ttype_task: \"Uppgift\",\n\t\ttype_project: \"Projekt\",\n\t\ttype_milestone: \"Milstolpe\",\n\n\t\tminutes: \"Minuter\",\n\t\thours: \"Timmar\",\n\t\tdays: \"Dagar\",\n\t\tweeks: \"Veckor\",\n\t\tmonths: \"Månader\",\n\t\tyears: \"År\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Avbryt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n * updated by @levkar at https://github.com/DHTMLX/gantt/pull/10\n */\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Ocak\", \"Şubat\", \"Mart\", \"Nisan\", \"Mayıs\", \"Haziran\", \"Temmuz\", \"Ağustos\", \"Eylül\", \"Ekim\", \"Kasım\", \"Aralık\"],\n\t\tmonth_short: [\"Oca\", \"Şub\", \"Mar\", \"Nis\", \"May\", \"Haz\", \"Tem\", \"Ağu\", \"Eyl\", \"Eki\", \"Kas\", \"Ara\"],\n\t\tday_full: [\"Pazar\", \"Pazartesi\", \"Salı\", \"Çarşamba\", \"Perşembe\", \"Cuma\", \"Cumartesi\"],\n\t\tday_short: [\"Paz\", \"Pzt\", \"Sal\", \"Çar\", \"Per\", \"Cum\", \"Cmt\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Yeni görev\",\n\t\ticon_save: \"Kaydet\",\n\t\ticon_cancel: \"İptal\",\n\t\ticon_details: \"Detaylar\",\n\t\ticon_edit: \"Düzenle\",\n\t\ticon_delete: \"Sil\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Görev silinecek, emin misiniz?\",\n\t\tsection_description: \"Açıklama\",\n\t\tsection_time: \"Zaman Aralığı\",\n\t\tsection_type: \"Tip\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Görev Adı\",\n\t\tcolumn_start_date: \"Başlangıç\",\n\t\tcolumn_duration: \"Süre\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Bağlantı\",\n\t\tconfirm_link_deleting: \"silinecek\",\n\t\tlink_start: \" (başlangıç)\",\n\t\tlink_end: \" (bitiş)\",\n\n\t\ttype_task: \"Görev\",\n\t\ttype_project: \"Proje\",\n\t\ttype_milestone: \"Kilometretaşı\",\n\n\n\t\tminutes: \"Dakika\",\n\t\thours: \"Saat\",\n\t\tdays: \"Gün\",\n\t\tweeks: \"Hafta\",\n\t\tmonths: \"Ay\",\n\t\tyears: \"Yıl\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Ýptal\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Січень\", \"Лютий\", \"Березень\", \"Квітень\", \"Травень\", \"Червень\", \"Липень\", \"Серпень\", \"Вересень\", \"Жовтень\", \"Листопад\", \"Грудень\"],\n\t\tmonth_short: [\"Січ\", \"Лют\", \"Бер\", \"Кві\", \"Тра\", \"Чер\", \"Лип\", \"Сер\", \"Вер\", \"Жов\", \"Лис\", \"Гру\"],\n\t\tday_full: [\"Неділя\", \"Понеділок\", \"Вівторок\", \"Середа\", \"Четвер\", \"П'ятниця\", \"Субота\"],\n\t\tday_short: [\"Нед\", \"Пон\", \"Вів\", \"Сер\", \"Чет\", \"Птн\", \"Суб\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Нове завдання\",\n\t\ticon_save: \"Зберегти\",\n\t\ticon_cancel: \"Відміна\",\n\t\ticon_details: \"Деталі\",\n\t\ticon_edit: \"Редагувати\",\n\t\ticon_delete: \"Вилучити\",\n\t\tconfirm_closing: \"\", // Ваші зміни втратяться. Ви впевнені ?\n\t\tconfirm_deleting: \"Подія вилучиться назавжди. Ви впевнені?\",\n\t\tsection_description: \"Опис\",\n\t\tsection_time: \"Часовий проміжок\",\n\t\tsection_type: \"Тип\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Відміна\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","import * as utils from \"../utils/utils\";\nimport constants from \"../constants\";\nimport ExtensionManager from \"../ext/extension_manager\";\n\nimport services from \"../core/common/services\";\nimport config from \"../core/common/config\";\nimport ajax from \"../core/common/ajax\";\nimport date from \"../core/common/date\";\nimport {remoteEvents} from \"../core/remote/remote_events\";\n\nimport DnD from \"../core/common/dnd\";\nimport templates from \"../core/common/templates\";\nimport eventable from \"../utils/eventable\";\n\nimport StateService from \"../core/common/state\";\n\nimport Promise from \"../utils/promise\";\nimport env from \"../utils/env\";\nimport datastoreHooks from \"../core/datastore/datastore_hooks\";\nimport DataProcessor from \"../core/dataprocessor\";\n\nimport plugins from \"../core/plugins\";\n\nimport grid_column_api from \"../core/grid_column_api\";\nimport tasks from \"../core/tasks\";\nimport parsing from \"../core/loading/parsing\";\nimport work_time from \"../core/worktime/work_time\";\nimport data from \"../core/data\";\n\nimport void_script_second from \"../publish_helpers/void_script_second\";\n\nimport data_task_types from \"../core/data_task_types\";\nimport cached_functions from \"../core/cached_functions\";\n\nimport gantt_core from \"../core/gantt_core\";\nimport destructor from \"../core/destructor\";\nimport void_script_third from \"../publish_helpers/void_script_third\";\n\nimport i18nFactory from \"../locale\";\n\nfunction DHXGantt(){\n\tthis.constants = constants;\n\tthis.version = VERSION;\n\tthis.license = LICENSE;\n\tthis.templates = {};\n\tthis.ext = {};\n\tthis.keys = {\n\t\tedit_save: this.constants.KEY_CODES.ENTER,\n\t\tedit_cancel: this.constants.KEY_CODES.ESC\n\t};\n}\n\nexport default function(supportedExtensions) {\n\t// use a named constructor to make gantt instance discoverable in heap snapshots\n\tvar gantt = new DHXGantt();\n\n\tvar extensionManager = new ExtensionManager(supportedExtensions);\n\tvar activePlugins = {};\n\tgantt.plugins = function(config){\n\t\tfor(var i in config){\n\t\t\tif(config[i] && !activePlugins[i]){\n\t\t\t\tvar plugin = extensionManager.getExtension(i);\n\t\t\t\tif(plugin){\n\t\t\t\t\tplugin(gantt);\n\t\t\t\t\tactivePlugins[i] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn activePlugins;\n\t};\n\n\tgantt.$services = services();\n\tgantt.config = config();\n\tgantt.ajax =  ajax(gantt);\n\tgantt.date = date(gantt);\n\tgantt.RemoteEvents = remoteEvents;\n\n\tvar dnd = DnD(gantt);\n\tgantt.$services.setService(\"dnd\", function(){return dnd;});\n\n\tvar templatesLoader = templates(gantt);\n\tgantt.$services.setService(\"templateLoader\", function () {\n\t\treturn templatesLoader;\n\t});\n\n\teventable(gantt);\n\n\t\n\tvar stateService = new StateService();\n\n\tstateService.registerProvider(\"global\", function () {\n\t\tvar res = {\n\t\t\tmin_date: gantt._min_date,\n\t\t\tmax_date: gantt._max_date,\n\t\t\tselected_task: null\n\t\t};\n\n\t\t// do not throw error if getState called from non-initialized gantt\n\t\tif(gantt.$data && gantt.$data.tasksStore){\n\t\t\tres.selected_task = gantt.$data.tasksStore.getSelectedId();\n\t\t}\n\t\treturn res;\n\t});\n\tgantt.getState = stateService.getState;\n\tgantt.$services.setService(\"state\", function () {\n\t\treturn stateService;\n\t});\n\n\tutils.mixin(gantt, utils);\n\n\tgantt.Promise = Promise;\n\tgantt.env = env;\n\n\tdatastoreHooks(gantt);\n\n\tgantt.dataProcessor = DataProcessor.DEPRECATED_api;\n\tgantt.createDataProcessor = DataProcessor.createDataProcessor;\n\n\tplugins(gantt);\n\n\tgrid_column_api(gantt);\n\ttasks(gantt);\n\tparsing(gantt);\n\twork_time(gantt);\n\tdata(gantt);\n\n\tvoid_script_second(gantt);\n\n\tdata_task_types(gantt);\n\tcached_functions(gantt);\n\n\tgantt_core(gantt);\n\tdestructor(gantt);\n\tvoid_script_third(gantt);\n\n\tvar i18n = i18nFactory();\n\tgantt.i18n = {\n\t\taddLocale: i18n.addLocale,\n\t\tsetLocale: function(locale){\n\t\t\tif(typeof locale === \"string\"){\n\t\t\t\tvar localeObject = i18n.getLocale(locale);\n\t\t\t\tif(!localeObject){\n\t\t\t\t\tlocaleObject = i18n.getLocale(\"en\");\n\t\t\t\t}\n\n\t\t\t\tgantt.locale = localeObject;\n\t\t\t}else if(locale){\n\t\t\t\tif(!gantt.locale){\n\t\t\t\t\tgantt.locale = locale;\n\t\t\t\t}else{\n\t\t\t\t\tfor(var i in locale){\n\t\t\t\t\t\tif(locale[i] && typeof locale[i] === \"object\"){\n\t\t\t\t\t\t\tif(!gantt.locale[i]){\n\t\t\t\t\t\t\t\tgantt.locale[i] = {};\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tgantt.mixin(gantt.locale[i], locale[i], true);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tgantt.locale[i] = locale[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst labels = gantt.locale.labels;\n\t\t\tlabels.gantt_save_btn = labels.gantt_save_btn || labels.icon_save;\n\t\t\tlabels.gantt_cancel_btn = labels.gantt_cancel_btn || labels.icon_cancel;\n\t\t\tlabels.gantt_delete_btn = labels.gantt_delete_btn || labels.icon_delete;\n\t\t},\n\t\tgetLocale: i18n.getLocale\n\t};\n\tgantt.i18n.setLocale(\"en\");\n\treturn gantt;\n};","export default function(){\n\tvar services = {};\n\tfunction register (name, getter){\n\t\tservices[name] = getter;\n\t}\n\n\tfunction getService(name){\n\t\tif(!services[name]){\n\t\t\treturn null;\n\t\t}\n\t\treturn services[name]();\n\t}\n\n\tfunction dropService(name) {\n\t\tif (services[name]) {\n\t\t\tdelete services[name];\n\t\t}\n\t}\n\n\tvar servicesEnum = {};\n\n\treturn {\n\t\tservices: servicesEnum,\n\t\tsetService: register,\n\t\tgetService: getService,\n\t\tdropService: dropService,\n\t\tdestructor: function(){\n\t\t\tfor(var i in services){\n\t\t\t\tif(services[i]){\n\t\t\t\t\tvar service = services[i];\n\t\t\t\t\tif(service && service.destructor){\n\t\t\t\t\t\tservice.destructor();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tservices = null;\n\t\t}\n\t};\n};\n","import eventable from \"../../utils/eventable\";\nimport * as utils from \"../../utils/utils\";\nimport timeout from \"../../utils/timeout\";\nimport global from \"../../utils/global\";\nimport * as domHelpers from \"../ui/utils/dom_helpers\";\n\nexport default function(gantt){\n\n\tfunction copyDomEvent(e){\n\t\treturn {\n\t\t\ttarget: e.target || e.srcElement,\n\t\t\tpageX: e.pageX,\n\t\t\tpageY: e.pageY,\n\t\t\tclientX: e.clientX,\n\t\t\tclientY: e.clientY,\n\t\t\tmetaKey: e.metaKey,\n\t\t\tshiftKey: e.shiftKey,\n\t\t\tctrlKey: e.ctrlKey,\n\t\t\taltKey: e.altKey\n\t\t};\n\t}\n\n\tfunction DnD(obj, config) {\n\t\tthis._obj = obj;\n\t\tthis._settings = config || {};\n\t\teventable(this);\n\n\t\tvar inputMethods = this.getInputMethods();\n\n\t\tthis._drag_start_timer = null;\n\t\tgantt.attachEvent(\"onGanttScroll\", utils.bind(function (left, top) {\n\t\t\tthis.clearDragTimer();\n\t\t}, this));\n\n\t\tvar lastDown = 0;\n\t\tvar eventParams = {passive: false};\n\t\tfor(var i = 0; i < inputMethods.length; i++){\n\t\t\t(utils.bind(function(input){\n\n\t\t\t\tgantt.event(obj, input.down, utils.bind(function (e) {\n\t\t\t\t\tif(!input.accessor(e)){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof e.button !== 'undefined' && e.button !== 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(config.preventDefault && config.selector && domHelpers.closest(e.target, config.selector)){\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (gantt.config.touch && e.timeStamp && e.timeStamp - lastDown < 300) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._settings.original_target = copyDomEvent(e);\n\n\t\t\t\t\tthis._settings.original_element_sizes = {\n\t\t\t\t\t\t...domHelpers.getRelativeEventPosition(e, domHelpers.getClosestSizedElement(obj)), \n\t\t\t\t\t\twidth: e.target.offsetWidth,\n\t\t\t\t\t\theight: e.target.offsetHeight\n\t\t\t\t\t};\n\n\t\t\t\t\tif (gantt.config.touch) {\n\t\t\t\t\t\tthis.clearDragTimer();\n\t\t\t\t\t\tthis._drag_start_timer = setTimeout(utils.bind(function () {\n\t\t\t\t\t\t\tif(gantt.getState().lightbox){\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.dragStart(obj, e, input);\n\t\t\t\t\t\t}, this), gantt.config.touch_drag);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.dragStart(obj, e, input);\n\t\t\t\t\t}\n\t\t\t\t}, this), eventParams);\n\t\t\t\tvar eventElement = document.body;\n\t\t\t\tgantt.event(eventElement, input.up, utils.bind(function (e) {\n\t\t\t\t\tif(!input.accessor(e)){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.clearDragTimer();\n\t\t\t\t}, this), eventParams);\n\n\t\t\t}, this))(inputMethods[i]);\n\t\t}\n\t}\n\n\tDnD.prototype = {\n\t\ttraceDragEvents: function (domElement, inputMethod) {\n\t\t\tvar mousemove = utils.bind(function (e) {\n\t\t\t\treturn this.dragMove(domElement, e, inputMethod.accessor);\n\t\t\t}, this);\n\t\t\tutils.bind(function (e) {\n\t\t\t\treturn this.dragScroll(domElement, e);\n\t\t\t}, this);\n\n\t\t\tvar limited_mousemove = utils.bind(function (e) {\n\t\t\t\tif (this.config.started && utils.defined(this.config.updates_per_second)) {\n\t\t\t\t\tif (!timeout(this, this.config.updates_per_second))\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar dndActive = mousemove(e);\n\n\t\t\t\tif (dndActive) {\n\t\t\t\t\ttry{\n\t\t\t\t\t\tif (e && e.preventDefault && e.cancelable){//e.cancelable condition - because navigator.vibrate is blocked by Chrome\n\t\t\t\t\t\t\te.preventDefault();//Cancel default action on DND\n\t\t\t\t\t\t} //Cancel default action on DND\n\t\t\t\t\t}catch (e){\n\t\t\t\t\t\t// just suppress the exception, nothing needed to be done here\n\t\t\t\t\t}\n\n\t\t\t\t\t//e.cancelBubble = true;\n\t\t\t\t}\n\n\t\t\t\treturn dndActive;\n\t\t\t}, this);\n\t\t\tvar eventElement = domHelpers.getRootNode(gantt.$root);\n\t\t\tvar mousemoveContainer = this.config.mousemoveContainer || domHelpers.getRootNode(gantt.$root);\n\n\t\t\tvar eventParams = {passive: false};\n\t\t\tvar mouseup = utils.bind(function (e) {\n\t\t\t\tgantt.eventRemove(mousemoveContainer, inputMethod.move, limited_mousemove);\n\t\t\t\tgantt.eventRemove(eventElement, inputMethod.up, mouseup, eventParams);\n\t\t\t\treturn this.dragEnd(domElement);\n\t\t\t}, this);\n\n\t\t\tgantt.event(mousemoveContainer, inputMethod.move, limited_mousemove, eventParams);\n\t\t\tgantt.event(eventElement, inputMethod.up, mouseup, eventParams);\n\t\t},\n\t\tcheckPositionChange: function (pos) {\n\t\t\tvar diff_x = pos.x - this.config.pos.x;\n\t\t\tvar diff_y = pos.y - this.config.pos.y;\n\t\t\tvar distance = Math.sqrt(Math.pow(Math.abs(diff_x), 2) + Math.pow(Math.abs(diff_y), 2));\n\n\t\t\tif (distance > this.config.sensitivity) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tinitDnDMarker: function () {\n\t\t\t// create dnd placeholder and put it in dom\n\t\t\tvar marker = this.config.marker = document.createElement(\"div\");\n\t\t\tmarker.className = \"gantt_drag_marker\";\n\t\t\t// GS-1333: don't show any message when we resize grid columns\n\t\t\tmarker.innerHTML = \"\";\n\t\t\tdocument.body.appendChild(marker);\n\t\t},\n\t\tbackupEventTarget: function (domEvent, getEvent) {\n\t\t\tif (!gantt.config.touch) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// keep original event target in DOM in order to keep dnd on touchmove event\n\t\t\tvar e = getEvent(domEvent);\n\n\t\t\tvar el = e.target || e.srcElement;\n\t\t\tvar copy = el.cloneNode(true);\n\t\t\t//this.config.target.target = copy;\n\t\t\tthis.config.original_target = copyDomEvent(e);\n\t\t\tthis.config.original_target.target = copy;\n\t\t\tthis.config.backup_element = el;\n\t\t\tel.parentNode.appendChild(copy);\n\n\t\t\tel.style.display = \"none\";\n\t\t\tvar mousemoveContainer = this.config.mousemoveContainer || document.body;\n\t\t\tmousemoveContainer.appendChild(el);\n\t\t},\n\t\tgetInputMethods: function () {\n\t\t\t// bind actions to browser events\n\t\t\tvar inputMethods = [];\n\n\t\t\tinputMethods.push({\n\t\t\t\t\"move\": \"mousemove\",\n\t\t\t\t\"down\": \"mousedown\",\n\t\t\t\t\"up\": \"mouseup\",\n\t\t\t\t\"accessor\": function (e) {\n\t\t\t\t\treturn e;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (gantt.config.touch) {\n\n\t\t\t\tvar touchEventsSupported = true;\n\t\t\t\ttry{\n\t\t\t\t\tdocument.createEvent(\"TouchEvent\");\n\t\t\t\t}catch (e){\n\t\t\t\t\ttouchEventsSupported = false;\n\t\t\t\t}\n\n\t\t\t\tif(touchEventsSupported){\n\t\t\t\t\tinputMethods.push({\n\t\t\t\t\t\t\"move\": \"touchmove\",\n\t\t\t\t\t\t\"down\": \"touchstart\",\n\t\t\t\t\t\t\"up\": \"touchend\",\n\t\t\t\t\t\t\"accessor\": function (ev) {\n\t\t\t\t\t\t\tif (ev.touches && ev.touches.length > 1) return null;\n\t\t\t\t\t\t\tif (ev.touches[0])\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\ttarget: document.elementFromPoint(ev.touches[0].clientX, ev.touches[0].clientY),\n\t\t\t\t\t\t\t\t\tpageX: ev.touches[0].pageX,\n\t\t\t\t\t\t\t\t\tpageY: ev.touches[0].pageY,\n\t\t\t\t\t\t\t\t\tclientX: ev.touches[0].clientX,\n\t\t\t\t\t\t\t\t\tclientY: ev.touches[0].clientY\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\treturn ev;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else if(global.navigator.pointerEnabled){\n\t\t\t\t\tinputMethods.push({\n\t\t\t\t\t\t\"move\": \"pointermove\",\n\t\t\t\t\t\t\"down\": \"pointerdown\",\n\t\t\t\t\t\t\"up\": \"pointerup\",\n\t\t\t\t\t\t\"accessor\": function (ev) {\n\t\t\t\t\t\t\tif (ev.pointerType == \"mouse\") return null;\n\t\t\t\t\t\t\treturn ev;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}else if (global.navigator.msPointerEnabled){\n\t\t\t\t\tinputMethods.push({\n\t\t\t\t\t\t\"move\": \"MSPointerMove\",\n\t\t\t\t\t\t\"down\": \"MSPointerDown\",\n\t\t\t\t\t\t\"up\": \"MSPointerUp\",\n\t\t\t\t\t\t\"accessor\": function (ev) {\n\t\t\t\t\t\t\tif (ev.pointerType == ev.MSPOINTER_TYPE_MOUSE) return null;\n\t\t\t\t\t\t\treturn ev;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn inputMethods;\n\t\t},\n\t\tclearDragTimer: function () {\n\t\t\tif (this._drag_start_timer) {\n\t\t\t\tclearTimeout(this._drag_start_timer);\n\t\t\t\tthis._drag_start_timer = null;\n\t\t\t}\n\t\t},\n\t\tdragStart: function (obj, e, inputMethod) {\n\t\t\tif (this.config && this.config.started) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.config = {\n\t\t\t\tobj: obj,\n\t\t\t\tmarker: null,\n\t\t\t\tstarted: false,\n\t\t\t\tpos: this.getPosition(e),\n\t\t\t\tsensitivity: 4\n\t\t\t};\n\t\t\tif (this._settings)\n\t\t\t\tutils.mixin(this.config, this._settings, true);\n\n\n\t\t\tthis.traceDragEvents(obj, inputMethod);\n\n\t\t\tgantt._prevent_touch_scroll = true;\n\t\t\tdocument.body.classList.add(\"gantt_noselect\");\n\n\t\t\tif (gantt.config.touch) {\n\t\t\t\tthis.dragMove(obj, e, inputMethod.accessor);\n\t\t\t}\n\n\t\t},\n\t\tdragMove: function (obj, e, getEvent) {\n\t\t\tvar source = getEvent(e);\n\t\t\tif (!source) return false;\n\n\t\t\tif (!this.config.marker && !this.config.started) {\n\t\t\t\tvar pos = this.getPosition(source);\n\n\t\t\t\tif (gantt.config.touch || this.checkPositionChange(pos)) {\n\t\t\t\t\t// real drag starts here,\n\t\t\t\t\t// when user moves mouse at first time after onmousedown\n\t\t\t\t\tthis.config.started = true;\n\t\t\t\t\tthis.config.ignore = false;\n\t\t\t\t\tgantt._touch_drag = true;\n\t\t\t\t\tif (this.callEvent(\"onBeforeDragStart\", [obj, this.config.original_target]) === false) {\n\t\t\t\t\t\tthis.config.ignore = true;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tthis.backupEventTarget(e, getEvent);\n\t\t\t\t\tthis.initDnDMarker();\n\t\t\t\t\tgantt._touch_feedback();\n\t\t\t\t\tthis.callEvent(\"onAfterDragStart\", [obj, this.config.original_target]);\n\t\t\t\t} else {\n\t\t\t\t\tthis.config.ignore = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!this.config.ignore) {\n\t\t\t\t// GS-1279 Gantt crashes on Mobile Firefox after starting to create a link and moving finger outisde the page.\n\t\t\t\tif (e.targetTouches && !source.target) return;\n\t\t\t\t\n\t\t\t\tsource.pos = this.getPosition(source);\n\t\t\t\tthis.config.marker.style.left = source.pos.x + \"px\";\n\t\t\t\tthis.config.marker.style.top = source.pos.y + \"px\";\n\t\t\t\tthis.callEvent(\"onDragMove\", [obj, source]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\tdragEnd: function (obj) {\n\t\t\tvar target = this.config.backup_element;\n\t\t\tif (target && target.parentNode) {\n\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t}\n\t\t\tgantt._prevent_touch_scroll = false;\n\t\t\tif (this.config.marker) {\n\t\t\t\tthis.config.marker.parentNode.removeChild(this.config.marker);\n\t\t\t\tthis.config.marker = null;\n\n\t\t\t\tthis.callEvent(\"onDragEnd\", []);\n\t\t\t}\n\t\t\tthis.config.started = false;\n\t\t\tgantt._touch_drag = false;\n\t\t\tdocument.body.classList.remove(\"gantt_noselect\");\n\t\t},\n\n\t\tgetPosition: function (e) {\n\t\t\tvar x = 0, y = 0;\n\t\t\tif (e.pageX || e.pageY) {\n\t\t\t\tx = e.pageX;\n\t\t\t\ty = e.pageY;\n\t\t\t} else if (e.clientX || e.clientY) {\n\t\t\t\tx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\n\t\t\t\ty = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\n\t\t\t}\n\t\t\treturn {x: x, y: y};\n\t\t}\n\t};\n\n\treturn DnD;\n};\n","export default function(gantt) {\n\n\tvar regTemplates = {};\n\n\tfunction initTemplate(name, initial, template_name) {\n\t\ttemplate_name = template_name || name;\n\t\tvar config = gantt.config,\n\t\t\ttemplates = gantt.templates;\n\n\t\tif (gantt.config[name] && regTemplates[template_name] != config[name]) {\n\t\t\tif (!(initial && templates[template_name])) {\n\t\t\t\ttemplates[template_name] = gantt.date.date_to_str(config[name]);\n\t\t\t\tregTemplates[template_name] = config[name];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction initTemplates() {\n\t\tvar date = gantt.date;\n\n\t\t//build configuration based templates\n\t\tvar d = date.date_to_str;\n\t\tvar c = gantt.config;\n\t\tvar format_date = d(c.xml_date || c.date_format, c.server_utc);\n\t\tvar parse_date = date.str_to_date(c.xml_date || c.date_format, c.server_utc);\n\n\t\tinitTemplate(\"date_scale\", true, undefined, gantt.config, gantt.templates);\n\t\tinitTemplate(\"date_grid\", true, \"grid_date_format\", gantt.config, gantt.templates);\n\t\tinitTemplate(\"task_date\", true, undefined, gantt.config, gantt.templates);\n\n\t\tgantt.mixin(gantt.templates, {\n\t\t\txml_format: undefined, // deprecated\n\t\t\tformat_date: format_date,\n\n\t\t\txml_date: undefined, // deprecated\n\t\t\tparse_date: parse_date,\n\n\t\t\tprogress_text: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tgrid_header_class: function (column, config) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\n\t\t\ttask_text: function (start, end, task) {\n\t\t\t\treturn task.text;\n\t\t\t},\n\t\t\ttask_class: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttask_end_date: function (date) {\n\t\t\t\treturn gantt.templates.task_date(date);\n\t\t\t},\n\t\t\tgrid_row_class: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttask_row_class: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttimeline_cell_class: function (item, date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttimeline_cell_content: function (item, date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tscale_cell_class: function (date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tscale_row_class: function (date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\n\t\t\tgrid_indent: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_indent'></div>\";\n\t\t\t},\n\t\t\tgrid_folder: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_folder_\" + (item.$open ? \"open\" : \"closed\") + \"'></div>\";\n\t\t\t},\n\t\t\tgrid_file: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_file'></div>\";\n\t\t\t},\n\t\t\tgrid_open: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_\" + (item.$open ? \"close\" : \"open\") + \"'></div>\";\n\t\t\t},\n\t\t\tgrid_blank: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_blank'></div>\";\n\t\t\t},\n\t\t\tdate_grid: function (date, item, column) {\n\t\t\t\tif (item && gantt.isUnscheduledTask(item) && gantt.config.show_unscheduled) {\n\t\t\t\t\treturn gantt.templates.task_unscheduled_time(item);\n\t\t\t\t} else {\n\t\t\t\t\treturn gantt.templates.grid_date_format(date, column);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\ttask_time: function (start, end, ev) {\n\t\t\t\tif (gantt.isUnscheduledTask(ev) && gantt.config.show_unscheduled) {\n\t\t\t\t\treturn gantt.templates.task_unscheduled_time(ev);\n\t\t\t\t} else {\n\t\t\t\t\treturn gantt.templates.task_date(start) + \" - \" + gantt.templates.task_end_date(end);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\ttask_unscheduled_time: function (task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\n\t\t\ttime_picker: d(c.time_picker),\n\t\t\tlink_class: function (link) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tlink_description: function (link) {\n\t\t\t\tvar from = gantt.getTask(link.source),\n\t\t\t\t\tto = gantt.getTask(link.target);\n\n\t\t\t\treturn \"<b>\" + from.text + \"</b> &ndash;  <b>\" + to.text + \"</b>\";\n\t\t\t},\n\n\t\t\tdrag_link: function (from, from_start, to, to_start) {\n\t\t\t\tfrom = gantt.getTask(from);\n\t\t\t\tvar labels = gantt.locale.labels;\n\n\t\t\t\tvar text = \"<b>\" + from.text + \"</b> \" + (from_start ? labels.link_start : labels.link_end) + \"<br/>\";\n\t\t\t\tif (to) {\n\t\t\t\t\tto = gantt.getTask(to);\n\t\t\t\t\ttext += \"<b> \" + to.text + \"</b> \" + (to_start ? labels.link_start : labels.link_end) + \"<br/>\";\n\t\t\t\t}\n\t\t\t\treturn text;\n\t\t\t},\n\t\t\tdrag_link_class: function (from, from_start, to, to_start) {\n\t\t\t\tvar add = \"\";\n\n\t\t\t\tif (from && to) {\n\t\t\t\t\tvar allowed = gantt.isLinkAllowed(from, to, from_start, to_start);\n\t\t\t\t\tadd = \" \" + (allowed ? \"gantt_link_allow\" : \"gantt_link_deny\");\n\t\t\t\t}\n\n\t\t\t\treturn \"gantt_link_tooltip\" + add;\n\t\t\t},\n\n\t\t\t/* used for aria-labels of bar elements and for tooltip.js */\n\t\t\ttooltip_date_format: date.date_to_str(\"%Y-%m-%d\"),\n\t\t\ttooltip_text: function (start, end, event) {\n\t\t\t\treturn `<div>Task: ${event.text}</div>\n\t\t\t\t<div>Start date: ${gantt.templates.tooltip_date_format(start)}</div>\n\t\t\t\t<div>End date: ${gantt.templates.tooltip_date_format(end)}</div>`;\n\t\t\t},\n\t\t\tbaseline_text: function (task, baseline, index) {\n\t\t\t\treturn \"\";\n\t\t\t}\n\t\t});\n\t}\n\n\treturn {\n\t\tinitTemplates: initTemplates,\n\t\tinitTemplate: initTemplate\n\t};\n\n};","import * as utils from \"../../utils/utils\";\nimport facadeFactory from \"./../facades/datastore\";\nimport calculateScaleRange from \"../gantt_data_range\";\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\n\nimport treeHelper from \"../../utils/task_tree_helpers\";\n\nfunction initDataStores(gantt){\n\n\tvar facade = facadeFactory.create();\n\tutils.mixin(gantt, facade);\n\tvar tasksStore = gantt.createDatastore({\n\t\tname: \"task\",\n\t\ttype: \"treeDatastore\",\n\t\trootId: function() { return gantt.config.root_id; },\n\t\tinitItem: utils.bind(_init_task, gantt),\n\t\tgetConfig: function() { return gantt.config; }\n\t});\n\n\tvar linksStore = gantt.createDatastore({\n\t\tname: \"link\",\n\t\tinitItem: utils.bind(_init_link, gantt)\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\ttasksStore.destructor();\n\t\tlinksStore.destructor();\n\t});\n\n\tgantt.attachEvent(\"onLinkValidation\", function(link){\n\t\tif(gantt.isLinkExists(link.id) || link.id === \"predecessor_generated\"){\n\t\t\t// link was already added into gantt\n\t\t\treturn true;\n\t\t}\n\t\tvar source = gantt.getTask(link.source);\n\t\tvar taskLinks = source.$source;\n\t\tfor (var i = 0; i < taskLinks.length; i++) {\n\t\t\tvar existingLink = gantt.getLink(taskLinks[i]);\n\n\t\t\tvar sourceMatch = link.source == existingLink.source;\n\t\t\tvar targetMatch = link.target == existingLink.target;\n\t\t\tvar typeMatch = link.type == existingLink.type;\n\n\t\t\t// prevent creating duplicated links from the UI\n\t\t\tif (sourceMatch && targetMatch && typeMatch) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t});\n\n\ttasksStore.attachEvent(\"onBeforeRefreshAll\", function(){\n\n\t\t// GS-2170 do not recalculate indexes and dates as the event will be called later in the onStoreUpdate event\n\t\tif (tasksStore._skipTaskRecalculation){\n\t\t\treturn;\n\t\t}\n\n\t\tvar order = tasksStore.getVisibleItems();\n\n\t\tfor(var i=0; i < order.length; i++){\n\t\t\tvar item = order[i];\n\t\t\titem.$index = i;\n\t\t\titem.$local_index = gantt.getTaskIndex(item.id);\n\t\t\tgantt.resetProjectDates(item);\n\t\t}\n\n\t});\n\n\ttasksStore.attachEvent(\"onFilterItem\", function(id, task) {\n\t\tif (gantt.config.show_tasks_outside_timescale) {\n\t\t\treturn true;\n\t\t}\n\t\tvar min = null, max = null;\n\t\tif (gantt.config.start_date && gantt.config.end_date) {\n\t\t\tif (gantt._isAllowedUnscheduledTask(task)) return true;\n\t\t\tmin = gantt.config.start_date.valueOf();\n\t\t\tmax = gantt.config.end_date.valueOf();\n\n\t\t\tif (+task.start_date > max || +task.end_date < +min)\n\t\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\n\ttasksStore.attachEvent(\"onIdChange\", function(oldId, newId){\n\t\tgantt._update_flags(oldId, newId);\n\n\t\tvar changedTask = gantt.getTask(newId);\n\t\tif(!tasksStore.isSilent()){\n\t\t\tif(changedTask.$split_subtask || changedTask.rollup){\n\t\t\t\tgantt.eachParent(function(parent){\n\t\t\t\t\tgantt.refreshTask(parent.id);\n\t\t\t\t}, newId);\n\t\t\t}\n\t\t}\n\t});\n\n\ttasksStore.attachEvent(\"onAfterUpdate\", function(id){\n\t\tgantt._update_parents(id);\n\t\tif(gantt.getState(\"batchUpdate\").batch_update){\n\t\t\treturn true;\n\t\t}\n\n\t\tvar task = tasksStore.getItem(id);\n\t\tif (!task.$source) task.$source = [];\n\t\tfor (var i = 0; i < task.$source.length; i++) {\n\t\t\tlinksStore.refresh(task.$source[i]);\n\t\t}\n\t\tif (!task.$target) task.$target = [];\n\t\tfor (var i = 0; i < task.$target.length; i++) {\n\t\t\tlinksStore.refresh(task.$target[i]);\n\t\t}\n\t});\n\n\ttasksStore.attachEvent(\"onBeforeItemMove\", function(sid, parent, tindex){\n\t\t// GS-125. Don't allow users to move the placeholder task\n\t\tif (isPlaceholderTask(sid, gantt, tasksStore)){\n\t\t\t//eslint-disable-next-line\n\t\t\tconsole.log(\"The placeholder task cannot be moved to another position.\");\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t});\n\n\ttasksStore.attachEvent(\"onAfterItemMove\", function(sid, parent, tindex){\n\t\tvar source = gantt.getTask(sid);\n\n\t\tif(this.getNextSibling(sid) !== null){\n\t\t\tsource.$drop_target = this.getNextSibling(sid);\n\t\t} else if(this.getPrevSibling(sid) !== null){\n\t\t\tsource.$drop_target = \"next:\" + this.getPrevSibling(sid);\n\t\t}else{\n\t\t\tsource.$drop_target = \"next:null\";\n\t\t}\n\n\t});\n\n\ttasksStore.attachEvent(\"onStoreUpdated\", function(id, item, action){\n\t\tif(action == \"delete\"){\n\t\t\tgantt._update_flags(id, null);\n\t\t}\n\n\t\tvar state = gantt.$services.getService(\"state\");\n\t\tif(state.getState(\"batchUpdate\").batch_update){\n\t\t\treturn;\n\t\t}\n\n\t\tif(gantt.config.fit_tasks && action !== \"paint\"){\n\t\t\tvar oldState = gantt.getState();\n\t\t\tcalculateScaleRange(gantt);\n\t\t\tvar newState = gantt.getState();\n\n\t\t\t//this._init_tasks_range();\n\t\t\tif (+oldState.min_date != +newState.min_date || +oldState.max_date != +newState.max_date) {\n\t\t\t\tgantt.render();\n\n\t\t\t\tgantt.callEvent(\"onScaleAdjusted\", []);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t}\n\n\t\tif(action == \"add\" || action == \"move\" || action == \"delete\"){\n\t\t\tif(gantt.$layout){\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks in the\n\t\t\t\t// onBeforeResize layout event, but do it later. If lightbox is opened, it will\n\t\t\t\t// trigger the refreshData, so the indexes and dates will be recalculated there\n\t\t\t\tif (this.$config.name == \"task\" && (action == \"add\" || action == \"delete\")){\n\t\t\t\t\tif (this._skipTaskRecalculation != \"lightbox\"){\n\t\t\t\t\t\tthis._skipTaskRecalculation = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgantt.$layout.resize();\n\t\t\t}\n\n\t\t}else if(!id){\n\t\t\tlinksStore.refresh();\n\t\t}\n\n\t});\n\n\tlinksStore.attachEvent(\"onAfterAdd\", function(id, link){\n\t\tsync_link(link);\n\t});\n\tlinksStore.attachEvent(\"onAfterUpdate\", function(id, link){\n\t\tsync_links();\n\t});\n\tlinksStore.attachEvent(\"onAfterDelete\", function(id, link){\n\t\tsync_link_delete(link);\n\t});\n\tlinksStore.attachEvent(\"onAfterSilentDelete\", function(id, link){\n\t\tsync_link_delete(link);\n\t});\n\tlinksStore.attachEvent(\"onBeforeIdChange\", function(oldId, newId){\n\t\tsync_link_delete(gantt.mixin({id:oldId}, gantt.$data.linksStore.getItem(newId)));\n\t\tsync_link(gantt.$data.linksStore.getItem(newId));\n\t});\n\n\tfunction checkLinkedTaskVisibility(taskId){\n\t\tvar isVisible = gantt.isTaskVisible(taskId);\n\t\tif(!isVisible && gantt.isTaskExists(taskId)){\n\t\t\tvar parent = gantt.getParent(taskId);\n\t\t\tif(gantt.isTaskExists(parent) && gantt.isTaskVisible(parent)){\n\t\t\t\tparent = gantt.getTask(parent);\n\t\t\t\tif(gantt.isSplitTask(parent)){\n\t\t\t\t\tisVisible = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn isVisible;\n\t}\n\n\tlinksStore.attachEvent(\"onFilterItem\", function(id, link){\n\t\tif (!gantt.config.show_links) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar sourceVisible = checkLinkedTaskVisibility(link.source);\n\t\tvar targetVisible = checkLinkedTaskVisibility(link.target);\n\n\t\tif (!(sourceVisible && targetVisible) ||\n\t\t\tgantt._isAllowedUnscheduledTask(gantt.getTask(link.source)) || gantt._isAllowedUnscheduledTask(gantt.getTask(link.target)))\n\t\t\treturn false;\n\n\t\treturn gantt.callEvent(\"onBeforeLinkDisplay\", [id, link]);\n\t});\n\n\n\t(function(){\n\t\t// delete all connected links after task is deleted\n\t\tvar deletedLinks = {};\n\n\t\tgantt.attachEvent(\"onBeforeTaskDelete\", function(id, item){\n\t\t\tdeletedLinks[id] = treeHelper.getSubtreeLinks(gantt, id);\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onAfterTaskDelete\", function(id, item) {\n\t\t\tif(deletedLinks[id]){\n\t\t\t\tgantt.$data.linksStore.silent(function(){\n\t\t\t\t\tfor(var i in deletedLinks[id]){\n\t\t\t\t\t\tif (gantt.isLinkExists(i)){\n\t\t\t\t\t\t\tgantt.$data.linksStore.removeItem(i);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsync_link_delete(deletedLinks[id][i]);\n\t\t\t\t\t}\n\n\t\t\t\t\tdeletedLinks[id] = null;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t})();\n\n\tgantt.attachEvent(\"onAfterLinkDelete\", function(id, link) {\n\t\t// GS-1786. Repaint tasks only if they are loaded\n\t\tif(gantt.isTaskExists(link.source)){\n\t\t\tgantt.refreshTask(link.source);\n\t\t}\n\t\tif(gantt.isTaskExists(link.target)){\n\t\t\tgantt.refreshTask(link.target);\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onParse\", sync_links);\n\n\tmapEvents({\n\t\tsource: linksStore,\n\t\ttarget: gantt,\n\t\tevents:{\n\t\t\t\"onItemLoading\":\"onLinkLoading\",\n\t\t\t\"onBeforeAdd\":\"onBeforeLinkAdd\",\n\t\t\t\"onAfterAdd\":\"onAfterLinkAdd\",\n\t\t\t\"onBeforeUpdate\":\"onBeforeLinkUpdate\",\n\t\t\t\"onAfterUpdate\":\"onAfterLinkUpdate\",\n\t\t\t\"onBeforeDelete\":\"onBeforeLinkDelete\",\n\t\t\t\"onAfterDelete\":\"onAfterLinkDelete\",\n\t\t\t\"onIdChange\":\"onLinkIdChange\"\n\t\t}\n\t});\n\n\tmapEvents({\n\t\tsource: tasksStore,\n\t\ttarget: gantt,\n\t\tevents:{\n\t\t\t\"onItemLoading\":\"onTaskLoading\",\n\t\t\t\"onBeforeAdd\":\"onBeforeTaskAdd\",\n\t\t\t\"onAfterAdd\":\"onAfterTaskAdd\",\n\t\t\t\"onBeforeUpdate\":\"onBeforeTaskUpdate\",\n\t\t\t\"onAfterUpdate\":\"onAfterTaskUpdate\",\n\t\t\t\"onBeforeDelete\":\"onBeforeTaskDelete\",\n\t\t\t\"onAfterDelete\":\"onAfterTaskDelete\",\n\t\t\t\"onIdChange\":\"onTaskIdChange\",\n\t\t\t\"onBeforeItemMove\":\"onBeforeTaskMove\",\n\t\t\t\"onAfterItemMove\":\"onAfterTaskMove\",\n\t\t\t\"onFilterItem\":\"onBeforeTaskDisplay\",\n\t\t\t\"onItemOpen\":\"onTaskOpened\",\n\t\t\t\"onItemClose\":\"onTaskClosed\",\n\t\t\t\"onBeforeSelect\":\"onBeforeTaskSelected\",\n\t\t\t\"onAfterSelect\":\"onTaskSelected\",\n\t\t\t\"onAfterUnselect\":\"onTaskUnselected\"\n\t\t}\n\t});\n\n\tgantt.$data = {\n\t\ttasksStore: tasksStore,\n\t\tlinksStore: linksStore\n\t};\n\n\tfunction sync_link(link){\n\t\tif(gantt.isTaskExists(link.source)){\n\t\t\tvar sourceTask = gantt.getTask(link.source);\n\t\t\tsourceTask.$source = sourceTask.$source || [];\n\t\t\tsourceTask.$source.push(link.id);\n\t\t}\n\t\tif(gantt.isTaskExists(link.target)){\n\t\t\tvar targetTask = gantt.getTask(link.target);\n\t\t\ttargetTask.$target = targetTask.$target || [];\n\t\t\ttargetTask.$target.push(link.id);\n\t\t}\n\t}\n\n\tfunction sync_link_delete(link){\n\t\tif(gantt.isTaskExists(link.source)){\n\t\t\tvar sourceTask = gantt.getTask(link.source);\n\t\t\tfor(var i = 0; i < sourceTask.$source.length; i++){\n\t\t\t\tif(sourceTask.$source[i] == link.id){\n\t\t\t\t\tsourceTask.$source.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(gantt.isTaskExists(link.target)){\n\t\t\tvar targetTask = gantt.getTask(link.target);\n\t\t\tfor(var i = 0; i < targetTask.$target.length; i++){\n\t\t\t\tif(targetTask.$target[i] == link.id){\n\t\t\t\t\ttargetTask.$target.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction sync_links() {\n\t\tvar task = null;\n\t\tvar tasks = gantt.$data.tasksStore.getItems();\n\n\t\tfor(var i = 0, len = tasks.length; i < len; i++){\n\t\t\ttask = tasks[i];\n\t\t\ttask.$source = [];\n\t\t\ttask.$target = [];\n\t\t}\n\n\t\tvar links = gantt.$data.linksStore.getItems();\n\t\tfor (var i = 0, len = links.length; i < len; i++) {\n\n\t\t\tvar link = links[i];\n\t\t\tsync_link(link);\n\t\t}\n\t}\n\n\tfunction mapEvents(conf){\n\t\tvar mapFrom = conf.source;\n\t\tvar mapTo = conf.target;\n\t\tfor(var i in conf.events){\n\t\t\t(function(sourceEvent, targetEvent){\n\t\t\t\tmapFrom.attachEvent(sourceEvent, function(){\n\t\t\t\t\treturn mapTo.callEvent(targetEvent, Array.prototype.slice.call(arguments));\n\t\t\t\t}, targetEvent);\n\t\t\t})(i, conf.events[i]);\n\t\t}\n\t}\n\n\tfunction _init_task(task) {\n\t\tif (!this.defined(task.id))\n\t\t\ttask.id = this.uid();\n\n\t\tif (task.start_date)\n\t\t\ttask.start_date = gantt.date.parseDate(task.start_date, \"parse_date\");\n\t\tif (task.end_date)\n\t\t\ttask.end_date = gantt.date.parseDate(task.end_date, \"parse_date\");\n\n\n\t\tvar duration = null;\n\t\tif (task.duration || task.duration === 0) {\n\t\t\ttask.duration = duration = task.duration * 1;\n\t\t}\n\n\t\tif (duration) {\n\t\t\tif (task.start_date && !task.end_date) {\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\n\t\t\t} else if (!task.start_date && task.end_date) {\n\t\t\t\ttask.start_date = this.calculateEndDate({\n\t\t\t\t\tstart_date: task.end_date,\n\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\ttask: task\n\t\t\t\t});\n\t\t\t}\n\t\t\t//task.$calculate_duration = false;\n\t\t}\n\n\t\tif (gantt.config.deadlines !== false && task.deadline){\n\t\t\ttask.deadline = gantt.date.parseDate(task.deadline, \"parse_date\");\n\t\t}\n\n\t\ttask.progress = Number(task.progress) || 0;\n\n\t\tif (this._isAllowedUnscheduledTask(task)) {\n\t\t\tthis._set_default_task_timing(task);\n\t\t}\n\t\tthis._init_task_timing(task);\n\t\tif (task.start_date && task.end_date)\n\t\t\tthis.correctTaskWorkTime(task);\n\n\t\ttask.$source = [];\n\t\ttask.$target = [];\n\n\t\tvar originalTask = this.$data.tasksStore.getItem(task.id);\n\t\tif (originalTask && !utils.defined(task.open)) {\n\t\t\t// if a task with the same id is already in the gantt and the new object doesn't specify the `open` state -\n\t\t\t// restore the `open` state we already have in the chart\n\t\t\ttask.$open = originalTask.$open;\n\t\t}\n\n\t\tif (task.parent === undefined) {\n\t\t\ttask.parent = this.config.root_id;\n\t\t}\n\t\tif(task.open){\n\t\t\ttask.$open = true;\n\t\t}\n\t\treturn task;\n\t}\n\n\tfunction _init_link(link) {\n\t\tif (!this.defined(link.id))\n\t\t\tlink.id = this.uid();\n\t\treturn link;\n\t}\n}\n\n\nexport default initDataStores;\n","import batch_update from \"./batch_update\";\nimport wbs from \"./wbs\";\nimport resources from \"./resources\";\nimport resource_assignments from \"./resource_assignments\";\nimport new_task_placeholder from \"./new_task_placeholder\";\nimport auto_task_types from \"./auto_task_types\";\nimport formatters from \"./formatters\";\nimport empty_state_screen from \"./empty_state_screen\";\nimport baselines from \"./baselines\";\n\nexport default function(gantt){\n\tif(!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tvar modules = [\n\t\tbatch_update,\n\t\twbs,\n\t\tresources,\n\t\tresource_assignments,\n\t\tnew_task_placeholder,\n\t\tauto_task_types,\n\t\tformatters,\n\t\tempty_state_screen,\n\t\tbaselines\n\t];\n\n\tfor(var i = 0; i < modules.length; i++){\n\t\tif(modules[i])\n\t\t\tmodules[i](gantt);\n\t}\n};","import Grid from \"./ui/grid/grid\";\nimport gridColumnApiGPL from \"./grid_column_api.gpl\";\n\nexport default function(gantt) {\n\tgridColumnApiGPL(gantt);\n\tGrid.prototype.getGridColumns = function () {\n\t\tvar config = this.$getConfig();\n\t\tvar columns = config.columns,\n\t\t\tvisibleColumns = [];\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tif (!columns[i].hide)\n\t\t\t\tvisibleColumns.push(columns[i]);\n\t\t}\n\n\t\treturn visibleColumns;\n\t};\n};","export default function(gantt) {\n\tgantt.getGridColumn = function(name) {\n\t\tvar columns = gantt.config.columns;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tif (columns[i].name == name)\n\t\t\t\treturn columns[i];\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tgantt.getGridColumns = function() {\n\t\treturn gantt.config.columns.slice();\n\t};\n};","export default function(gantt) {\n\tgantt.isReadonly = function (item) {\n\n\t\tif((typeof item == \"number\" || typeof item == \"string\") && gantt.isTaskExists(item)){\n\t\t\titem = gantt.getTask(item);\n\t\t}\n\t\tif (item && item[this.config.editable_property]) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn (item && item[this.config.readonly_property]) || this.config.readonly;\n\t\t}\n\t};\n};","import CalendarManager from \"./calendar_manager\";\nimport TimeCalculator from \"./time_calculator\";\nimport worktimeFacadeFactory from \"../facades/worktime_calendars\";\nimport * as utils from \"../../utils/utils\";\n\nexport default function (gantt) {\n\tvar manager = new CalendarManager(gantt),\n\ttimeCalculator = new TimeCalculator(manager);\n\tvar facade = worktimeFacadeFactory.create(manager, timeCalculator);\n\tutils.mixin(gantt, facade);\n};\n","export default function(gantt) {\n\tgantt.getTaskType = function (type) {\n\t\tvar checkType = type;\n\t\tif(type && typeof type == \"object\"){\n\t\t\tcheckType = type.type;\n\t\t}\n\n\t\tfor (var i in this.config.types) {\n\t\t\tif (this.config.types[i] == checkType) {\n\t\t\t\treturn checkType;\n\t\t\t}\n\t\t}\n\t\treturn gantt.config.types.task;\n\t};\n};","/*\n reuse results of functions that can be recalculated during rendering\n greatly increases the rendering speed when critical path enabled\n Sample - 94_dev/critical_path.html\n\n */\nexport default function(gantt){\n\ngantt._cached_functions = {\n\tcache: {},\n\tmode: false,\n\tcritical_path_mode: false,\n\twrap_methods : function(methods, object){\n\t\tif(object._prefetch_originals){\n\t\t\tfor(var i in object._prefetch_originals){\n\t\t\t\tobject[i] = object._prefetch_originals[i];\n\t\t\t}\n\t\t}\n\t\tobject._prefetch_originals = {};\n\t\tfor(var i = 0; i < methods.length; i++)\n\t\t\tthis.prefetch(methods[i], object);\n\n\t},\n\tprefetch : function(methodname, host){\n\t\tvar original = host[methodname];\n\t\tif(original){\n\t\t\tvar optimizer = this;\n\n\t\t\thost._prefetch_originals[methodname] = original;\n\t\t\thost[methodname] = function get_prefetched_value(){\n\n\t\t\t\tvar argumentsArray = new Array(arguments.length);\n\t\t\t\tfor (var i = 0, l = arguments.length; i < l; i++) {\n\t\t\t\t\targumentsArray[i] = arguments[i];\n\t\t\t\t}\n\n\t\t\t\tif(optimizer.active){\n\t\t\t\t\tvar args = optimizer.get_arguments_hash(Array.prototype.slice.call(argumentsArray));\n\t\t\t\t\tif(!optimizer.cache[methodname]){\n\t\t\t\t\t\toptimizer.cache[methodname] = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tvar cached_values = optimizer.cache[methodname];\n\n\t\t\t\t\tif(optimizer.has_cached_value(cached_values, args)){\n\t\t\t\t\t\treturn optimizer.get_cached_value(cached_values, args);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar value = original.apply(this, argumentsArray);\n\t\t\t\t\t\toptimizer.cache_value(cached_values, args, value);\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn original.apply(this, argumentsArray);\n\t\t\t};\n\t\t}\n\t\treturn original;\n\t},\n\tcache_value: function(cache, arguments_hash, value){\n\t\tif(this.is_date(value))\n\t\t\tvalue = new Date(value);\n\t\tcache[arguments_hash] = value;\n\t},\n\thas_cached_value: function(cache, arguments_hash){\n\t\treturn cache.hasOwnProperty(arguments_hash);\n\t},\n\tget_cached_value: function(cache, arguments_hash){\n\t\tvar data = cache[arguments_hash];\n\n\t\t//for cached dates - return copy\n\t\tif(this.is_date(data)){\n\t\t\tdata = new Date(data);\n\t\t}\n\t\treturn data;\n\t},\n\tis_date: function(value){\n\t\treturn (value && value.getUTCDate);\n\t},\n\tget_arguments_hash:function(args){\n\t\tvar values = [];\n\t\tfor(var i = 0; i < args.length; i++){\n\t\t\tvalues.push(this.stringify_argument(args[i]));\n\t\t}\n\t\treturn \"(\" + values.join(\";\") + \")\";\n\t},\n\tstringify_argument: function(value){\n\t\t//expecting task or link, or any other data entries, dates and primitive values\n\t\tvar ret = \"\";\n\t\tif(value.id){\n\t\t\tret = value.id;\n\t\t}else if(this.is_date(value)){\n\t\t\tret = value.valueOf();\n\t\t}else{\n\t\t\tret = value;\n\t\t}\n\t\treturn ret + \"\";\n\t},\n\tactivate: function(){\n\t\tthis.clear();\n\t\tthis.active = true;\n\t},\n\tdeactivate: function(){\n\t\tthis.clear();\n\t\tthis.active = false;\n\t},\n\tclear: function(){\n\t\tthis.cache = {};\n\t},\n\n\tsetup: function(gantt){\n\t\tvar override_gantt = [];\n\n\t\tvar gantt_methods  = [\n\t\t\t'_isProjectEnd',\n\t\t\t'_getProjectEnd',\n\t\t\t'_getSlack'\n\t\t];\n\n\n\n\t\tif(this.mode == 'auto'){\n\t\t\tif(gantt.config.highlight_critical_path){\n\t\t\t\toverride_gantt = gantt_methods;\n\t\t\t}\n\t\t}else if(this.mode === true){\n\t\t\toverride_gantt = gantt_methods;\n\t\t}\n\n\t\tthis.wrap_methods(override_gantt, gantt);\n\n\t},\n\tupdate_if_changed: function(gantt){\n\t\tvar changed = (this.critical_path_mode != gantt.config.highlight_critical_path ||\n\t\t\t\t\t\tthis.mode !== gantt.config.optimize_render);\n\t\tif(changed){\n\t\t\tthis.critical_path_mode = gantt.config.highlight_critical_path;\n\t\t\tthis.mode = gantt.config.optimize_render;\n\t\t\tthis.setup(gantt);\n\t\t}\n\t}\n};\n\nfunction activate(){\n\tgantt._cached_functions.update_if_changed(gantt);\n\tif(!gantt._cached_functions.active){\n\t\tgantt._cached_functions.activate();\n\t}\n\treturn true;\n}\ngantt.attachEvent(\"onBeforeGanttRender\", activate);\ngantt.attachEvent(\"onBeforeDataRender\", activate);\ngantt.attachEvent(\"onBeforeSmartRender\",  function(){\n\tactivate();\n});\ngantt.attachEvent(\"onBeforeParse\", activate);\ngantt.attachEvent(\"onDataRender\", function(){\n\tgantt._cached_functions.deactivate();\n});\nvar deactivTimeout = null;\ngantt.attachEvent(\"onSmartRender\", function(){\n\tif(deactivTimeout)\n\t\tclearTimeout(deactivTimeout);\n\tdeactivTimeout = setTimeout(function(){\n\t\tgantt._cached_functions.deactivate();\n\t}, 1000);\n});\n\ngantt.attachEvent(\"onBeforeGanttReady\", function(){\n\tgantt._cached_functions.update_if_changed(gantt);\n\treturn true;\n});\n\n};","function extend(gantt){\n\n\tgantt.destructor = function(){\n\t\tthis.clearAll();\n\t\tthis.callEvent(\"onDestroy\", []);\n\n\t\tif(this.$root){\n\t\t\tdelete this.$root.gantt;\n\t\t}\n\n\t\tif(this._eventRemoveAll){\n\t\t\tthis._eventRemoveAll();\n\t\t}\n\n\t\tif(this.$layout){\n\t\t\tthis.$layout.destructor();\n\t\t}\n\n\t\tif(this.resetLightbox){\n\t\t\tthis.resetLightbox();\n\t\t}\n\n\t\t// GS-99. Call this here to detach the events\n\t\tif (this.ext.inlineEditors) {\n\t\t\tthis.ext.inlineEditors.destructor();\n\t\t}\n\n\t\tif(this._dp && this._dp.destructor){\n\t\t\tthis._dp.destructor();\n\t\t}\n\t\tthis.$services.destructor();\n\n\t\t// detachAllEvents should be called last, because in components may be attached events\n\t\tthis.detachAllEvents();\n\n\t\tfor(var i in this){\n\t\t\tif(i.indexOf(\"$\") === 0){\n\t\t\t\tdelete this[i];\n\t\t\t}\n\t\t}\n\t\tthis.$destroyed = true;\n\t};\n}\n\nexport default extend;\n","import ar from \"./locale_ar\";\nimport be from \"./locale_be\";\nimport ca from \"./locale_ca\";\nimport cn from \"./locale_cn\";\nimport cs from \"./locale_cs\";\nimport da from \"./locale_da\";\nimport de from \"./locale_de\";\nimport el from \"./locale_el\";\nimport en from \"./locale_en\";\nimport es from \"./locale_es\";\nimport fa from \"./locale_fa\";\nimport fi from \"./locale_fi\";\nimport fr from \"./locale_fr\";\nimport he from \"./locale_he\";\nimport hr from \"./locale_hr\";\nimport hu from \"./locale_hu\";\nimport id from \"./locale_id\";\nimport it from \"./locale_it\";\nimport jp from \"./locale_jp\";\nimport kr from \"./locale_kr\";\n\nimport LocaleManager from \"./locale_manager\";\n\nimport nb from \"./locale_nb\";\nimport nl from \"./locale_nl\";\nimport no from \"./locale_no\";\nimport pl from \"./locale_pl\";\nimport pt from \"./locale_pt\";\nimport ro from \"./locale_ro\";\nimport ru from \"./locale_ru\";\nimport si from \"./locale_si\";\nimport sk from \"./locale_sk\";\nimport sv from \"./locale_sv\";\nimport tr from \"./locale_tr\";\nimport ua from \"./locale_ua\";\n\nexport default function(){\n\treturn new LocaleManager({\n\t\ten,\n\t\tar,\n\t\tbe,\n\t\tca,\n\t\tcn,\n\t\tcs,\n\t\tda,\n\t\tde,\n\t\tel,\n\t\tes,\n\t\tfa,\n\t\tfi,\n\t\tfr,\n\t\the,\n\t\thr,\n\t\thu,\n\t\tid,\n\t\tit,\n\t\tjp,\n\t\tkr,\n\t\tnb,\n\t\tnl,\n\t\tno,\n\t\tpl,\n\t\tpt,\n\t\tro,\n\t\tru,\n\t\tsi,\n\t\tsk,\n\t\tsv,\n\t\ttr,\n\t\tua\n\t});\n}","import * as utils from \"../../utils/utils\";\nimport * as domHelpers from \"./utils/dom_helpers\";\n\nexport default function(gantt) {\n\n\tvar boxAttribute = \"data-dhxbox\";\n\n\tvar _dhx_msg_cfg = null;\n\n\tfunction callback(config, result) {\n\t\tvar usercall = config.callback;\n\t\tmodalBox.hide(config.box);\n\n\t\t_dhx_msg_cfg = config.box = null;\n\t\tif (usercall)\n\t\t\tusercall(result);\n\t}\n\n\tfunction modal_key(event) {\n\t\tif (_dhx_msg_cfg) {\n\n\t\t\tvar code = event.which || event.keyCode;\n\t\t\tvar preventDefault = false;\n\n\t\t\tif (messageBox.keyboard) {\n\t\t\t\tif (code == 13 || code == 32) {\n\t\t\t\t\t// default behavior is to confirm/submit popup on space/enter\n\t\t\t\t\t// if browser focus is set on button element - do button click instead of default behavior\n\t\t\t\t\tvar target = event.target || event.srcElement;\n\t\t\t\t\tif (domHelpers.getClassName(target).indexOf(\"gantt_popup_button\") > -1 && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback(_dhx_msg_cfg, true);\n\t\t\t\t\t\tpreventDefault = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (code == 27) {\n\t\t\t\t\tcallback(_dhx_msg_cfg, false);\n\t\t\t\t\tpreventDefault = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (preventDefault) {\n\t\t\t\tif (event.preventDefault){\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\treturn !(event.cancelBubble = true);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\tvar eventElement = domHelpers.getRootNode(gantt.$root) || document;\n\tgantt.event(eventElement, \"keydown\", modal_key, true);\n\n\tfunction modality(mode) {\n\t\tif (!modality.cover) {\n\t\t\tmodality.cover = document.createElement(\"div\");\n\t\t\t//necessary for IE only\n\t\t\tmodality.cover.onkeydown = modal_key;\n\t\t\tmodality.cover.className = \"dhx_modal_cover\";\n\t\t\tdocument.body.appendChild(modality.cover);\n\t\t}\n\n\t\tmodality.cover.style.display = mode ? \"inline-block\" : \"none\";\n\t}\n\n\tfunction button(text, className, result) {\n\t\tvar buttonAriaAttrs = gantt._waiAria.messageButtonAttrString(text);\n\t\tvar name = className.toLowerCase().replace(/ /g, \"_\");\n\t\tvar button_css = \"gantt_\" + name + \"_button\";\n\t\treturn \"<div \" + buttonAriaAttrs + \" class='gantt_popup_button \" + button_css + \"' data-result='\" + result + \"' result='\" + result + \"' ><div>\" + text + \"</div></div>\";\n\t}\n\n\tfunction info(text) {\n\t\tif (!messageBox.area) {\n\t\t\tmessageBox.area = document.createElement(\"div\");\n\t\t\tmessageBox.area.className = \"gantt_message_area\";\n\t\t\tmessageBox.area.style[messageBox.position] = \"5px\";\n\t\t\tdocument.body.appendChild(messageBox.area);\n\t\t}\n\n\t\tmessageBox.hide(text.id);\n\t\tvar message = document.createElement(\"div\");\n\t\tmessage.innerHTML = \"<div>\" + text.text + \"</div>\";\n\t\tmessage.className = \"gantt-info gantt-\" + text.type;\n\t\tmessage.onclick = function () {\n\t\t\tmessageBox.hide(text.id);\n\t\t\ttext = null;\n\t\t};\n\n\t\tgantt._waiAria.messageInfoAttr(message);\n\n\t\tif (messageBox.position == \"bottom\" && messageBox.area.firstChild)\n\t\t\tmessageBox.area.insertBefore(message, messageBox.area.firstChild);\n\t\telse\n\t\t\tmessageBox.area.appendChild(message);\n\n\t\tif (text.expire > 0)\n\t\t\tmessageBox.timers[text.id] = window.setTimeout(function () {\n\t\t\t\t// GS-1213: We need that when Gantt is destroyed\n\t\t\t\tif (messageBox) messageBox.hide(text.id);\n\t\t\t}, text.expire);\n\n\t\tmessageBox.pull[text.id] = message;\n\t\tmessage = null;\n\n\t\treturn text.id;\n\t}\n\n\tfunction getFirstDefined() {\n\t\tvar values = [].slice.apply(arguments, [0]);\n\n\t\tfor (var i = 0; i < values.length; i++) {\n\t\t\tif (values[i]) {\n\t\t\t\treturn values[i];\n\t\t\t}\n\t\t}\n\n\t}\n\n\tfunction _boxStructure(config, ok, cancel) {\n\t\tvar box = document.createElement(\"div\");\n\n\t\tvar contentId = utils.uid();\n\t\tgantt._waiAria.messageModalAttr(box, contentId);\n\n\n\t\tbox.className = \" gantt_modal_box gantt-\" + config.type;\n\t\tbox.setAttribute(boxAttribute, 1);\n\n\t\tvar inner = '';\n\n\t\tif (config.width)\n\t\t\tbox.style.width = config.width;\n\t\tif (config.height)\n\t\t\tbox.style.height = config.height;\n\t\tif (config.title)\n\t\t\tinner += '<div class=\"gantt_popup_title\">' + config.title + '</div>';\n\t\tinner += '<div class=\"gantt_popup_text\" id=\"' + contentId + '\"><span>' + (config.content ? '' : config.text) + '</span></div><div  class=\"gantt_popup_controls\">';\n\t\tif (ok)\n\t\t\tinner += button(getFirstDefined(config.ok, gantt.locale.labels.message_ok, \"OK\"), \"ok\", true);\n\t\tif (cancel)\n\t\t\tinner += button(getFirstDefined(config.cancel, gantt.locale.labels.message_cancel, \"Cancel\"), \"cancel\", false);\n\n\t\tif (config.buttons) {\n\t\t\tfor (var i = 0; i < config.buttons.length; i++) {\n\t\t\t\tvar btn = config.buttons[i];\n\t\t\t\tif (typeof btn == \"object\") {\n\t\t\t\t\t// Support { label:\"Save\", css:\"main_button\", value:\"save\" }\n\t\t\t\t\tvar label = btn.label;\n\t\t\t\t\tvar css = btn.css || (\"gantt_\" + btn.label.toLowerCase() + \"_button\");\n\t\t\t\t\tvar value = btn.value || i;\n\t\t\t\t\tinner += button(label, css, value);\n\t\t\t\t} else {\n\t\t\t\t\tinner += button(btn, btn, i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinner += '</div>';\n\t\tbox.innerHTML = inner;\n\n\t\tif (config.content) {\n\t\t\tvar node = config.content;\n\t\t\tif (typeof node == \"string\")\n\t\t\t\tnode = document.getElementById(node);\n\t\t\tif (node.style.display == 'none')\n\t\t\t\tnode.style.display = \"\";\n\t\t\tbox.childNodes[config.title ? 1 : 0].appendChild(node);\n\t\t}\n\n\t\tbox.onclick = function (event) {\n\t\t\tvar source = event.target || event.srcElement;\n\t\t\tif (!source.className) source = source.parentNode;\n\t\t\tif (domHelpers.closest(source, \".gantt_popup_button\")) {\n\t\t\t\tvar result = source.getAttribute(\"data-result\");\n\t\t\t\tresult = (result == \"true\") || (result == \"false\" ? false : result);\n\t\t\t\tcallback(config, result);\n\t\t\t}\n\t\t};\n\t\tconfig.box = box;\n\t\tif (ok || cancel)\n\t\t\t_dhx_msg_cfg = config;\n\n\t\treturn box;\n\t}\n\n\tfunction _createBox(config, ok, cancel) {\n\t\tvar box = config.tagName ? config : _boxStructure(config, ok, cancel);\n\n\t\tif (!config.hidden)\n\t\t\tmodality(true);\n\t\tdocument.body.appendChild(box);\n\t\tvar x = Math.abs(Math.floor(((window.innerWidth || document.documentElement.offsetWidth) - box.offsetWidth) / 2));\n\t\tvar y = Math.abs(Math.floor(((window.innerHeight || document.documentElement.offsetHeight) - box.offsetHeight) / 2));\n\t\tif (config.position == \"top\")\n\t\t\tbox.style.top = \"-3px\";\n\t\telse\n\t\t\tbox.style.top = y + 'px';\n\t\tbox.style.left = x + 'px';\n\t\t//necessary for IE only\n\t\tbox.onkeydown = modal_key;\n\n\t\tmodalBox.focus(box);\n\n\t\tif (config.hidden)\n\t\t\tmodalBox.hide(box);\n\n\t\tgantt.callEvent(\"onMessagePopup\", [box]);\n\t\treturn box;\n\t}\n\n\tfunction alertPopup(config) {\n\t\treturn _createBox(config, true, false);\n\t}\n\n\tfunction confirmPopup(config) {\n\t\treturn _createBox(config, true, true);\n\t}\n\n\tfunction boxPopup(config) {\n\t\treturn _createBox(config);\n\t}\n\n\tfunction box_params(text, type, callback) {\n\t\tif (typeof text != \"object\") {\n\t\t\tif (typeof type == \"function\") {\n\t\t\t\tcallback = type;\n\t\t\t\ttype = \"\";\n\t\t\t}\n\t\t\ttext = {text: text, type: type, callback: callback};\n\t\t}\n\t\treturn text;\n\t}\n\n\tfunction params(text, type, expire, id) {\n\t\tif (typeof text != \"object\")\n\t\t\ttext = {text: text, type: type, expire: expire, id: id};\n\t\ttext.id = text.id || utils.uid();\n\t\ttext.expire = text.expire || messageBox.expire;\n\t\treturn text;\n\t}\n\n\tvar alertBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"confirm\";\n\t\treturn alertPopup(text);\n\t};\n\tvar confirmBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"alert\";\n\t\treturn confirmPopup(text);\n\t};\n\tvar modalBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"alert\";\n\t\treturn boxPopup(text);\n\t};\n\tmodalBox.hide = function (node) {\n\t\twhile (node && node.getAttribute && !node.getAttribute(boxAttribute))\n\t\t\tnode = node.parentNode;\n\t\tif (node) {\n\t\t\tnode.parentNode.removeChild(node);\n\t\t\tmodality(false);\n\n\t\t\tgantt.callEvent(\"onAfterMessagePopup\", [node]);\n\t\t}\n\t};\n\n\tmodalBox.focus = function (node) {\n\t\tsetTimeout(function () {\n\t\t\tvar focusable = domHelpers.getFocusableNodes(node);\n\t\t\tif (focusable.length) {\n\t\t\t\tif (focusable[0].focus) focusable[0].focus();\n\t\t\t}\n\t\t}, 1);\n\t};\n\n\tvar messageBox = function (text, type, expire, id) {\n\t\ttext = params.apply(this, arguments);\n\t\ttext.type = text.type || \"info\";\n\n\t\tvar subtype = text.type.split(\"-\")[0];\n\t\tswitch (subtype) {\n\t\t\tcase \"alert\":\n\t\t\t\treturn alertPopup(text);\n\t\t\tcase \"confirm\":\n\t\t\t\treturn confirmPopup(text);\n\t\t\tcase \"modalbox\":\n\t\t\t\treturn boxPopup(text);\n\t\t\tdefault:\n\t\t\t\treturn info(text);\n\t\t}\n\t};\n\n\tmessageBox.seed = (new Date()).valueOf();\n\tmessageBox.uid = utils.uid;\n\tmessageBox.expire = 4000;\n\tmessageBox.keyboard = true;\n\tmessageBox.position = \"top\";\n\tmessageBox.pull = {};\n\tmessageBox.timers = {};\n\n\tmessageBox.hideAll = function () {\n\t\tfor (var key in messageBox.pull)\n\t\t\tmessageBox.hide(key);\n\t};\n\tmessageBox.hide = function (id) {\n\t\tvar obj = messageBox.pull[id];\n\t\tif (obj && obj.parentNode) {\n\t\t\twindow.setTimeout(function () {\n\t\t\t\tobj.parentNode.removeChild(obj);\n\t\t\t\tobj = null;\n\t\t\t}, 2000);\n\t\t\tobj.className += \" hidden\";\n\n\t\t\tif (messageBox.timers[id])\n\t\t\t\twindow.clearTimeout(messageBox.timers[id]);\n\t\t\tdelete messageBox.pull[id];\n\t\t}\n\t};\n\n\tvar popups = [];\n\tgantt.attachEvent(\"onMessagePopup\", function(box){\n\t\tpopups.push(box);\n\t});\n\tgantt.attachEvent(\"onAfterMessagePopup\", function(box){\n\t\tfor(var i = 0; i < popups.length; i++){\n\t\t\tif(popups[i] === box){\n\t\t\t\tpopups.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\tif(modality.cover && modality.cover.parentNode){\n\t\t\tmodality.cover.parentNode.removeChild(modality.cover);\n\t\t}\n\n\t\tfor(var i = 0; i < popups.length; i++){\n\t\t\tif(popups[i].parentNode){\n\t\t\t\tpopups[i].parentNode.removeChild(popups[i]);\n\t\t\t}\n\t\t}\n\t\tpopups = null;\n\n\t\tif(messageBox.area && messageBox.area.parentNode){\n\t\t\tmessageBox.area.parentNode.removeChild(messageBox.area);\n\t\t}\n\t\tmessageBox = null;\n\t});\n\n\treturn {\n\t\talert: alertBox,\n\t\tconfirm: confirmBox,\n\t\tmessage: messageBox,\n\t\tmodalbox: modalBox\n\t};\n};","import * as utils from \"../../utils/utils\";\n\nfunction extendSettings (store, parentSettings){\n\tvar own = this.$config[store];\n\n\tif(own){\n\t\tif(!own.$extendedConfig){\n\t\t\town.$extendedConfig = true;\n\t\t\tObject.setPrototypeOf(own, parentSettings);\n\t\t}\n\t\treturn own;\n\t}else{\n\t\treturn parentSettings;\n\t}\n}\n\nvar configurable = function(parentView){\n\tvar parentConfig,\n\t\tparentTemplates;\n\n\treturn {\n\t\t$getConfig: function(){\n\t\t\tif(!parentConfig){\n\t\t\t\tparentConfig = parentView ? parentView.$getConfig() : this.$gantt.config;\n\t\t\t}\n\t\t\tif(!this.$config.config){\n\t\t\t\treturn parentConfig;\n\t\t\t}else{\n\t\t\t\treturn extendSettings.call(this, \"config\", parentConfig);\n\t\t\t}\n\t\t},\n\t\t$getTemplates: function(){\n\t\t\tif(!parentTemplates){\n\t\t\t\tparentTemplates = parentView ? parentView.$getTemplates() : this.$gantt.templates;\n\t\t\t}\n\t\t\tif(!this.$config.templates){\n\t\t\t\treturn parentTemplates;\n\t\t\t}else{\n\t\t\t\treturn extendSettings.call(this, \"templates\", parentTemplates);\n\t\t\t}\n\t\t}\n\t};\n};\n\nexport default function(obj, parent){\n\tutils.mixin(obj, configurable(parent));\n};","import * as utils from \"../../utils/utils\";\nimport configurable from \"./configurable\";\n\nvar uiFactory = function createFactory(gantt){\n\tvar views = {};\n\n\tfunction ui(cell, parentView) {\n\t\tvar content;\n\t\tvar view = \"cell\";\n\t\tif (cell.view){\n\t\t\tview = \"viewcell\";\n\t\t}else if (cell.resizer) {\n\t\t\tview = \"resizer\";\n\t\t}\n\t\telse if (cell.rows || cell.cols) {\n\t\t\tview = \"layout\";\n\t\t}\n\t\telse if (cell.views) {\n\t\t\tview = \"multiview\";\n\t\t}\n\n\t\tcontent = createView.call(this, view, null, cell, parentView);\n\t\treturn content;\n\t}\n\t\n\tvar createdViews = {};\n\n\tfunction createView(name, parent, config, parentView) {\n\t\tvar creator = views[name];\n\n\t\tif(!creator || !creator.create)\n\t\t\treturn false;\n\n\t\tif(name == \"resizer\" && !config.mode){\n\t\t\tif(parentView.$config.cols){\n\t\t\t\tconfig.mode = \"x\";\n\t\t\t}else{\n\t\t\t\tconfig.mode = \"y\";\n\t\t\t}\n\t\t}\n\n\t\tif(name == \"viewcell\" && config.view == \"scrollbar\" && !config.scroll){\n\t\t\tif(parentView.$config.cols){\n\t\t\t\tconfig.scroll = \"y\";\n\t\t\t}else{\n\t\t\t\tconfig.scroll = \"x\";\n\t\t\t}\n\t\t}\n\n\t\tvar config = utils.copy(config);\n\n\t\tif(!config.id && !createdViews[config.view]){\n\t\t\tconfig.id = config.view;\n\t\t}\n\n\t\tif(config.id && !config.css){\n\t\t\tconfig.css = config.id+\"_cell\";\n\t\t}\n\n\t\tvar view = new creator.create(parent, config, this, gantt);\n\n\t\tif(creator.configure){\n\t\t\tcreator.configure(view);\n\t\t}\n\n\t\tconfigurable(view, parentView);\n\t\tif(!view.$id){\n\t\t\tview.$id = config.id || gantt.uid();\n\t\t}\n\n\t\tif(!view.$parent && typeof parent == \"object\"){\n\t\t\tview.$parent = parent;\n\t\t}\n\t\tif(!view.$config){\n\t\t\tview.$config = config;\n\t\t}\n\n\t\tif(createdViews[view.$id]){\n\t\t\tview.$id = gantt.uid();\n\t\t}\n\n\t\tcreatedViews[view.$id] = view;\n\n\t\treturn view;\n\t}\n\n\tfunction reset(){\n\t\tcreatedViews = {};\n\t}\n\n\tfunction register(name, viewConstructor, configure){\n\t\tviews[name] = {create: viewConstructor, configure: configure};\n\t}\n\n\tfunction getView(id){\n\t\treturn createdViews[id];\n\t}\n\n\tvar factory = {\n\t\tinitUI:ui,\n\t\treset: reset,\n\t\tregisterView: register,\n\t\tcreateView: createView,\n\t\tgetView: getView\n\t};\n\n\treturn factory;\n};\n\nexport default {\n\tcreateFactory: uiFactory\n};\n\n","import * as domHelpers from \"./utils/dom_helpers\";\n\nvar createMouseHandler = (function(domHelpers) {\n\treturn function (gantt) {\n\t\tvar eventHandlers = {\n\t\t\t\"click\": {},\n\t\t\t\"doubleclick\": {},\n\t\t\t\"contextMenu\": {}\n\t\t};\n\n\t\tfunction addEventTarget(event, className, handler, root) {\n\t\t\tif(!eventHandlers[event][className]){\n\t\t\t\teventHandlers[event][className] = [];\n\t\t\t}\n\n\t\t\teventHandlers[event][className].push({\n\t\t\t\thandler: handler,\n\t\t\t\troot: root\n\t\t\t});\n\t\t}\n\n\t\tfunction callHandler(eventName, className, root, args) {\n\t\t\tvar handlers = eventHandlers[eventName][className];\n\t\t\tif(handlers){\n\t\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\t\tif(!(root || handlers[i].root) || handlers[i].root === root){\n\t\t\t\t\t\thandlers[i].handler.apply(this, args);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onClick(e) {\n\t\t\te = e || window.event;\n\t\t\tvar id = gantt.locate(e);\n\n\t\t\tvar handlers = findEventHandlers(e, eventHandlers.click);\n\t\t\tvar res = true;\n\t\t\tif (id !== null) {\n\t\t\t\tres = !gantt.checkEvent(\"onTaskClick\") || gantt.callEvent(\"onTaskClick\", [id, e]);\n\t\t\t} else {\n\t\t\t\tgantt.callEvent(\"onEmptyClick\", [e]);\n\t\t\t}\n\n\t\t\tif (res) {\n\t\t\t\tvar default_action = callEventHandlers(handlers, e, id);\n\t\t\t\tif (!default_action)\n\t\t\t\t\treturn;\n\n\t\t\t\t// GS-1025: if we don't do that, the dropdown or date select will be closed for unselected tasks\n\t\t\t\t// GS-1078: or for the built-in select inline editor\n\t\t\t\tswitch(e.target.nodeName) {\n\t\t\t\t\tcase \"SELECT\":\n\t\t\t\t\tcase 'INPUT':\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//allow task selection when the multiselect plugin is not enabled\n\t\t\t\tif (id && gantt.getTask(id) && !gantt._multiselect && gantt.config.select_task) {\n\t\t\t\t\tgantt.selectTask(id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onContextMenu(e) {\n\t\t\te = e || window.event;\n\t\t\tvar src = e.target || e.srcElement,\n\t\t\t\ttaskId = gantt.locate(src),\n\t\t\t\tlinkId = gantt.locate(src, gantt.config.link_attribute);\n\n\t\t\tvar res = !gantt.checkEvent(\"onContextMenu\") || gantt.callEvent(\"onContextMenu\", [taskId, linkId, e]);\n\t\t\tif (!res) {\n\t\t\t\tif (e.preventDefault)\n\t\t\t\t\te.preventDefault();\n\t\t\t\telse\n\t\t\t\t\te.returnValue = false;\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\n\t\tfunction findEventHandlers(e, hash){\n\t\t\tvar trg = e.target || e.srcElement;\n\t\t\tvar handlers = [];\n\t\t\twhile (trg) {\n\t\t\t\tvar css = domHelpers.getClassName(trg);\n\t\t\t\tif (css) {\n\t\t\t\t\tcss = css.split(\" \");\n\t\t\t\t\tfor (var i = 0; i < css.length; i++) {\n\t\t\t\t\t\tif (!css[i]) continue;\n\t\t\t\t\t\tif (hash[css[i]]) {\n\t\t\t\t\t\t\tvar delegateHandlers = hash[css[i]];\n\n\t\t\t\t\t\t\tfor(var h = 0; h < delegateHandlers.length; h++){\n\t\t\t\t\t\t\t\tif(delegateHandlers[h].root){\n\t\t\t\t\t\t\t\t\tif(!domHelpers.isChildOf(trg, delegateHandlers[h].root)){\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\thandlers.push(delegateHandlers[h].handler);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttrg = trg.parentNode;\n\t\t\t}\n\t\t\treturn handlers;\n\t\t}\n\n\t\tfunction callEventHandlers(handlers, e, id){\n\t\t\tvar res = true;\n\n\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\tvar handlerResult =  handlers[i].call(gantt, e, id, e.target || e.srcElement);\n\t\t\t\tres = res && !(typeof handlerResult != \"undefined\" && handlerResult !== true);\n\t\t\t}\n\n\t\t\treturn res;\n\t\t}\n\n\n\t\tfunction onDoubleClick(e) {\n\t\t\te = e || window.event;\n\t\t\tvar id = gantt.locate(e);\n\n\t\t\tvar handlers = findEventHandlers(e, eventHandlers.doubleclick);\n\t\t\t// when doubleclick fired not on task, id === null\n\t\t\tvar res = !gantt.checkEvent(\"onTaskDblClick\") || id === null || gantt.callEvent(\"onTaskDblClick\", [id, e]);\n\t\t\tif (res) {\n\t\t\t\tvar default_action = callEventHandlers(handlers, e, id);\n\t\t\t\tif (!default_action)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (id !== null && gantt.getTask(id)) {\n\t\t\t\t\tif (res && gantt.config.details_on_dblclick && !gantt.isReadonly(id)) {\n\t\t\t\t\t\tgantt.showLightbox(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onMouseMove(e) {\n\t\t\tif (gantt.checkEvent(\"onMouseMove\")) {\n\t\t\t\tvar id = gantt.locate(e);\n\t\t\t\tgantt._last_move_event = e;\n\t\t\t\tgantt.callEvent(\"onMouseMove\", [id, e]);\n\t\t\t}\n\t\t}\n\n\t\tfunction detach(eventName, className, handler, root) {\n\t\t\tif (eventHandlers[eventName] && eventHandlers[eventName][className]) {\n\t\t\t\tvar handlers = eventHandlers[eventName];\n\t\t\t\tvar elementHandlers = handlers[className];\n\t\t\t\tfor(var i = 0; i < elementHandlers.length; i++){\n\t\t\t\t\tif(elementHandlers[i].root == root){\n\t\t\t\t\t\telementHandlers.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!elementHandlers.length){\n\t\t\t\t\tdelete handlers[className];\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tvar domEvents = gantt._createDomEventScope();\n\n\t\tfunction reset(node){\n\n\t\t\tdomEvents.detachAll();\n\n\t\t\tif(node){\n\t\t\t\tdomEvents.attach(node, \"click\", onClick);\n\t\t\t\tdomEvents.attach(node, \"dblclick\", onDoubleClick);\n\t\t\t\tdomEvents.attach(node, \"mousemove\", onMouseMove);\n\t\t\t\tdomEvents.attach(node, \"contextmenu\", onContextMenu);\n\t\t\t}\n\t\t}\n\n\n\n\t\treturn {\n\t\t\treset: reset,\n\t\t\tglobal: function(event, classname, handler){\n\t\t\t\taddEventTarget(event, classname, handler, null);\n\t\t\t},\n\t\t\tdelegate: addEventTarget,\n\t\t\tdetach: detach,\n\t\t\tcallHandler: callHandler,\n\t\t\tonDoubleClick: onDoubleClick,\n\t\t\tonMouseMove: onMouseMove,\n\t\t\tonContextMenu: onContextMenu,\n\t\t\tonClick: onClick,\n\t\t\tdestructor: function(){\n\t\t\t\treset();\n\t\t\t\teventHandlers = null;\n\t\t\t\tdomEvents = null;\n\t\t\t}\n\n\t\t};\n\t};\n\n})(domHelpers);\n\n\nexport default {\n\tinit:createMouseHandler\n};","export default function(viewport, box, gantt){\n\tif(!box){\n\t\treturn false;\n\t}\n\n\tif(box.left > viewport.x_end || box.left + box.width < viewport.x){\n\t\treturn false;\n\t}\n\n\tif(box.top > viewport.y_end || box.top + box.height < viewport.y){\n\t\treturn false;\n\t}\n\t\n\treturn true;\n};","export default function(gantt){\n\treturn gantt.config.smart_rendering && gantt._smart_render;\n};","export default function(item, view, config){\n\treturn {\n\t\ttop: view.getItemTop(item.id),\n\t\theight: view.getItemHeight(item.id),\n\t\tleft: 0,\n\t\tright: Infinity\n\t};\n};","export default function getVisibleTasksRange(gantt, view, config, datastore, viewport){\n\tvar buffer = 1;\n\tvar start = view.getItemIndexByTopPosition(viewport.y) || 0;\n\tvar end = view.getItemIndexByTopPosition(viewport.y_end) || datastore.count();\n\tvar indexStart = Math.max(0, start - buffer);\n\tvar indexEnd =  Math.min(datastore.count(), end + buffer);\n\t// GS-2481 and GS-1715, need to take into account selected task when using keyboard shortcuts and when the inline editor is opened \n\tconst extraTasksIds= [];\n\tif (gantt.config.keyboard_navigation && gantt.getSelectedId()) {\n\t\tlet task = gantt.getTask(gantt.getSelectedId());\n\t\t//GS-2661: selected task might be collapsed\n\t\tif(task.$expanded_branch) {\n\t\t\textraTasksIds.push(gantt.getSelectedId());\n\t\t}\n\t}\n\tif (gantt.$ui.getView(\"grid\") && gantt.ext.inlineEditors && gantt.ext.inlineEditors.getState().id) {\n\t\tlet inlineEditorId = gantt.ext.inlineEditors.getState().id;\n\t\tif (datastore.exists(inlineEditorId)){\n\t\t\textraTasksIds.push(inlineEditorId);\n\t\t}\n\t}\n\treturn {\n\t\tstart: indexStart,\n\t\tend: indexEnd,\n\t\tids: extraTasksIds \n\t};\n};","import genericViewPortChecker from \"./viewport/is_in_viewport\";\nimport isLegacyRender from \"./is_legacy_smart_render\";\nimport basicGetRectangle from \"./viewport/get_grid_row_rectangle\";\nimport basicGetRange from \"./viewport/get_visible_bars_range\";\nvar rendererFactory = function(gantt){\n\n\t//hash of dom elements is needed to redraw single bar/link\n\tvar task_area_pulls = {},\n\t\ttask_area_renderers = {};\n\n\tfunction getView(layer){\n\t\tvar view = null;\n\t\tif (typeof layer.view === \"string\") {\n\t\t\tview = gantt.$ui.getView(layer.view);\n\t\t} else if (layer.view) {\n\t\t\tview = layer.view;\n\t\t}\n\t\treturn view;\n\t}\n\n\tfunction getRenderer(id, layer, node) {\n\t\t\n\t\tif (task_area_renderers[id])\n\t\t\treturn task_area_renderers[id];\n\n\t\tif (!layer.renderer)\n\t\t\tgantt.assert(false, \"Invalid renderer call\");\n\n\t\tvar renderMethod = null;\n\t\tvar updateMethod = null;\n\t\tvar getRectangle = null;\n\t\tvar renderCallbackMethod = null;\n\t\tvar specializedViewPortChecker = null;\n\n\t\tif(typeof layer.renderer === \"function\"){\n\t\t\trenderMethod = layer.renderer;\n\t\t\tgetRectangle = basicGetRectangle;\n\t\t}else{\n\t\t\trenderMethod = layer.renderer.render;\n\t\t\tupdateMethod = layer.renderer.update;\n\t\t\trenderCallbackMethod = layer.renderer.onrender;\n\t\t\t\n\t\t\tif(layer.renderer.isInViewPort){\n\t\t\t\tspecializedViewPortChecker = layer.renderer.isInViewPort;\n\t\t\t}else{\n\t\t\t\tgetRectangle = layer.renderer.getRectangle;\n\t\t\t}\n\n\t\t\tif (!getRectangle && getRectangle !== null) {\n\t\t\t\tgetRectangle = basicGetRectangle;\n\t\t\t}\n\t\t}\n\n\t\tvar filter = layer.filter;\n\n\t\tif (node)\n\t\t\tnode.setAttribute(gantt.config.layer_attribute, true);\n\n\t\ttask_area_renderers[id] = {\n\t\t\trender_item: function (item, container, viewPort, layerView, viewConfig) {\n\t\t\t\tcontainer = container || node;\n\t\t\t\tif (filter) {\n\t\t\t\t\tif (!filter(item)) {\n\t\t\t\t\t\tthis.remove_item(item.id);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar view = layerView || getView(layer);\n\t\t\t\tvar config = viewConfig || (view ? view.$getConfig() : null);\n\t\t\t\tvar rendererViewPort = viewPort;\n\t\t\t\tif(!rendererViewPort && config && config.smart_rendering){\n\t\t\t\t\trendererViewPort = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tvar dom = null;\n\t\t\t\tif(!isLegacyRender(gantt) && (getRectangle || specializedViewPortChecker) && rendererViewPort){\n\t\t\t\t\tvar isVisible = false;\n\t\t\t\t\tif(specializedViewPortChecker){\n\t\t\t\t\t\tisVisible = specializedViewPortChecker(item, rendererViewPort, view, config, gantt);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tisVisible = genericViewPortChecker(rendererViewPort, getRectangle(item, view, config, gantt), gantt);\n\t\t\t\t\t}\n\t\t\t\t\tif(isVisible){\n\t\t\t\t\t\tdom = renderMethod.call(gantt, item, view, config, rendererViewPort);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tdom = renderMethod.call(gantt, item, view, config, rendererViewPort);\n\t\t\t\t}\n\t\t\t\tthis.append(item, dom, container);\n\n\t\t\t\tvar useBuffer = container.nodeType == 11;//DocumentFragment\n\t\t\t\tif(renderCallbackMethod && !useBuffer && dom) {\n\t\t\t\t\trenderCallbackMethod.call(gantt, item, dom, view);\n\t\t\t\t} \n\t\t\t},\n\n\t\t\tclear: function (container) {\n\n\t\t\t\tthis.rendered = task_area_pulls[id] = {};\n\t\t\t\tif(!layer.append)\n\t\t\t\t\tthis.clear_container(container);\n\t\t\t},\n\t\t\tclear_container: function (container) {\n\t\t\t\tcontainer = container || node;\n\t\t\t\tif (container){\n\t\t\t\t\tcontainer.innerHTML = \"\";\n\t\t\t\t}\n\t\t\t},\n\t\t\tget_visible_range: function(datastore){\n\t\t\t\tvar view = getView(layer);\n\t\t\t\tvar viewport;\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\n\t\t\t\tif(viewConfig && viewConfig.smart_rendering){\n\t\t\t\t\tviewport = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tvar range;\n\t\t\t\tif(view && viewport){\n\t\t\t\t\tif(typeof layer.renderer === \"function\"){\n\t\t\t\t\t\trange = basicGetRange(gantt, view, viewConfig, datastore, viewport);\n\t\t\t\t\t}else if(layer.renderer && layer.renderer.getVisibleRange){\n\t\t\t\t\t\trange = layer.renderer.getVisibleRange(gantt, view, viewConfig, datastore, viewport);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!range){\n\t\t\t\t\trange = {\n\t\t\t\t\t\tstart: 0,\n\t\t\t\t\t\tend: datastore.count()\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn range;\n\t\t\t},\n\t\t\tprepare_data: function(items){\n\t\t\t\tif(layer.renderer && layer.renderer.prepareData){\n\t\t\t\t\treturn layer.renderer.prepareData(items, gantt, layer);\n\t\t\t\t}\n\t\t\t},\n\t\t\trender_items: function (items, container) {\n\t\t\t\tcontainer = container || node;\n\n\t\t\t\tvar buffer = document.createDocumentFragment();\n\t\t\t\tthis.clear(container);\n\n\t\t\t\tvar viewPort = null;\n\t\t\t\tvar view = getView(layer);\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\n\t\t\t\tif(viewConfig && viewConfig.smart_rendering){\n\t\t\t\t\tviewPort = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tfor (var i = 0, vis = items.length; i < vis; i++) {\n\t\t\t\t\tthis.render_item(items[i], buffer, viewPort, view, viewConfig);\n\t\t\t\t}\n\n\t\t\t\tcontainer.appendChild(buffer, container);\n\n\t\t\t\tvar itemsSearch = {};\n\t\t\t\titems.forEach(function(item){\n\t\t\t\t\titemsSearch[item.id] = item;\n\t\t\t\t});\n\t\t\t\tvar renderedItems = {};\n\t\t\t\tif (renderCallbackMethod) {\n\t\t\t\t\tvar newElements = {};\n\t\t\t\t\tfor(var i in this.rendered) {\n\t\t\t\t\t\tif(!renderedItems[i]){\n\t\t\t\t\t\t\tnewElements[i] = this.rendered[i];\n\t\t\t\t\t\t\trenderCallbackMethod.call(gantt, itemsSearch[i], this.rendered[i], view);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate_items: function (items, container) {\n\t\t\t\tvar view = getView(layer);\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\n\t\t\t\tif(!view || !view.$getConfig().smart_rendering || isLegacyRender(gantt)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif(!this.rendered){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif(!(getRectangle || specializedViewPortChecker)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcontainer = container || node;\n\n\t\t\t\tvar buffer = document.createDocumentFragment();\n\n\t\t\t\tvar viewPort = null;\n\t\t\t\tif(view){\n\t\t\t\t\tviewPort = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tvar itemsSearch = {};\n\t\t\t\titems.forEach(function(item){\n\t\t\t\t\titemsSearch[item.id] = item;\n\t\t\t\t});\n\t\t\t\tvar renderedItems = {};\n\n\t\t\t\tvar nodesToRemove = {};\n\t\t\t\tfor(var i in this.rendered){\n\t\t\t\t\tnodesToRemove[i] = true;\n\t\t\t\t\trenderedItems[i] = true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar renderCalledFor = {};\n\t\t\t\tfor (var i = 0, vis = items.length; i < vis; i++) {\n\t\t\t\t\tvar item = items[i];\n\t\t\t\t\tvar itemNode = this.rendered[item.id];\n\t\t\t\t\tnodesToRemove[item.id] = false;\n\t\t\t\t\tif (itemNode && itemNode.parentNode) {\n\t\t\t\t\t\tvar isVisible = false;\n\t\t\t\t\t\tif(specializedViewPortChecker){\n\t\t\t\t\t\t\tisVisible = specializedViewPortChecker(item, viewPort, view, viewConfig, gantt);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tisVisible = genericViewPortChecker(viewPort, getRectangle(item, view, viewConfig, gantt), gantt);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!isVisible) {\n\t\t\t\t\t\t\tnodesToRemove[item.id] = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(updateMethod){\n\t\t\t\t\t\t\t\tupdateMethod.call(gantt, item, itemNode, view, viewConfig, viewPort);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.restore(item, buffer);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\trenderCalledFor[items[i].id] = true;\n\t\t\t\t\t\tthis.render_item(items[i], buffer, viewPort, view, viewConfig);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor(var i in nodesToRemove){\n\t\t\t\t\tif(nodesToRemove[i]){\n\t\t\t\t\t\tthis.hide(i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(buffer.childNodes.length){\n\t\t\t\t\tcontainer.appendChild(buffer, container);\n\t\t\t\t}\n\n\t\t\t\tif (renderCallbackMethod) {\n\t\t\t\t\tvar newElements = {};\n\t\t\t\t\tfor(var i in this.rendered) {\n\t\t\t\t\t\tif(!renderedItems[i] || renderCalledFor[i]){\n\t\t\t\t\t\t\tnewElements[i] = this.rendered[i];\n\t\t\t\t\t\t\trenderCallbackMethod.call(gantt, itemsSearch[i], this.rendered[i], view);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tappend: function (item, node, container) {\n\t\t\t\tif(!this.rendered){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!node) {\n\t\t\t\t\tif (this.rendered[item.id]) {\n\t\t\t\t\t\tthis.remove_item(item.id);\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.rendered[item.id] && this.rendered[item.id].parentNode) {\n\t\t\t\t\tthis.replace_item(item.id, node);\n\t\t\t\t} else {\n\t\t\t\t\tcontainer.appendChild(node);\n\t\t\t\t}\n\t\t\t\tthis.rendered[item.id] = node;\n\t\t\t},\n\t\t\treplace_item: function (item_id, newNode) {\n\t\t\t\tvar item = this.rendered[item_id];\n\t\t\t\tif (item && item.parentNode) {\n\t\t\t\t\titem.parentNode.replaceChild(newNode, item);\n\n\t\t\t\t}\n\t\t\t\tthis.rendered[item_id] = newNode;\n\t\t\t},\n\t\t\tremove_item: function (item_id) {\n\t\t\t\tthis.hide(item_id);\n\t\t\t\tdelete this.rendered[item_id];\n\t\t\t},\n\t\t\thide: function (item_id) {\n\t\t\t\tvar item = this.rendered[item_id];\n\t\t\t\tif (item && item.parentNode) {\n\t\t\t\t\titem.parentNode.removeChild(item);\n\t\t\t\t}\n\t\t\t},\n\t\t\trestore: function (item, container) {\n\t\t\t\tvar dom = this.rendered[item.id];\n\t\t\t\tif (dom) {\n\t\t\t\t\tif (!dom.parentNode) {\n\t\t\t\t\t\tthis.append(item, dom, container || node);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.render_item(item, container || node);\n\t\t\t\t}\n\t\t\t},\n\t\t\tchange_id: function (oldid, newid) {\n\t\t\t\tthis.rendered[newid] = this.rendered[oldid];\n\t\t\t\tdelete this.rendered[oldid];\n\t\t\t},\n\t\t\trendered: task_area_pulls[id],\n\t\t\tnode: node,\n\t\t\tdestructor: function () {\n\t\t\t\tthis.clear();\n\t\t\t\tdelete task_area_renderers[id];\n\t\t\t\tdelete task_area_pulls[id];\n\t\t\t}\n\t\t};\n\n\t\treturn task_area_renderers[id];\n\t}\n\n\n\tfunction clearRenderers() {\n\t\tfor (var i in task_area_renderers) {\n\t\t\tgetRenderer(i).destructor();\n\t\t}\n\t}\n\n\treturn {\n\t\tgetRenderer: getRenderer,\n\t\tclearRenderers: clearRenderers\n\t};\n\n};\n\nexport default rendererFactory;","import renderFactoryProvider from \"./render_factory\";\nimport * as utils from \"../../../utils/utils\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport isLegacyRender from \"./is_legacy_smart_render\";\n\nvar layerFactory = function(gantt){\n\n\tvar renderFactory = renderFactoryProvider(gantt);\n\treturn {\n\tcreateGroup: function (getContainer, relativeRoot, defaultFilters, initLayer) {\n\n\t\tvar renderGroup = {\n\t\t\ttempCollection: [],\n\t\t\trenderers: {},\n\t\t\tcontainer: getContainer,\n\t\t\tfilters: [],\n\t\t\tgetLayers: function () {\n\t\t\t\tthis._add();// add pending layers\n\n\t\t\t\tvar res = [];\n\t\t\t\tfor (var i in this.renderers) {\n\t\t\t\t\tres.push(this.renderers[i]);\n\t\t\t\t}\n\t\t\t\treturn res;\n\t\t\t},\n\t\t\tgetLayer: function (id) {\n\t\t\t\treturn this.renderers[id];\n\t\t\t},\n\t\t\t_add: function (layer) {\n\t\t\t\tif (layer) {\n\t\t\t\t\tlayer.id = layer.id || utils.uid();\n\t\t\t\t\tthis.tempCollection.push(layer);\n\t\t\t\t}\n\n\t\t\t\tvar container = this.container();\n\n\t\t\t\tvar pending = this.tempCollection;\n\t\t\t\tfor (var i = 0; i < pending.length; i++) {\n\t\t\t\t\tlayer = pending[i];\n\n\t\t\t\t\tif (!this.container() && !(layer && layer.container && domHelpers.isChildOf(layer.container, document.body))) continue;\n\n\t\t\t\t\tvar node = layer.container,\n\t\t\t\t\t\tid = layer.id,\n\t\t\t\t\t\ttopmost = layer.topmost;\n\t\t\t\t\tif (!node.parentNode) {\n\t\t\t\t\t\t//insert on top or below the tasks\n\t\t\t\t\t\tif (topmost) {\n\t\t\t\t\t\t\tcontainer.appendChild(node);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar rel = relativeRoot ? relativeRoot() : container.firstChild;\n\t\t\t\t\t\t\t// GS-1274: if we don't add the second check, Gantt stops working if\n\t\t\t\t\t\t\t// we add the task layer without the timeline and switch to a layout with the timeline\n\t\t\t\t\t\t\tif (rel && rel.parentNode == container)\n\t\t\t\t\t\t\t\tcontainer.insertBefore(node, rel);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tcontainer.appendChild(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.renderers[id] = renderFactory.getRenderer(\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tlayer,\n\t\t\t\t\t\tnode\n\t\t\t\t\t);\n\n\t\t\t\t\tif (initLayer) {\n\t\t\t\t\t\tinitLayer(layer, gantt);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.tempCollection.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t},\n\t\t\taddLayer: function (config) {\n\t\t\t\tif(config){\n\t\t\t\t\tif(typeof config == \"function\"){\n\t\t\t\t\t\tconfig = {renderer: config};\n\t\t\t\t\t}\n\n\t\t\t\t\tif(config.filter === undefined){\n\t\t\t\t\t\tconfig.filter = mergeFilters(defaultFilters || []);\n\t\t\t\t\t}else if(config.filter instanceof Array){\n\t\t\t\t\t\tconfig.filter.push(defaultFilters);\n\t\t\t\t\t\tconfig.filter = mergeFilters(config.filter);\n\t\t\t\t\t}\n\n\t\t\t\t\tif(!config.container){\n\t\t\t\t\t\tconfig.container = document.createElement(\"div\");\n\t\t\t\t\t}\n\t\t\t\t\tvar self = this;\n\t\t\t\t\tconfig.requestUpdate = function(){\n\t\t\t\t\t\tif(gantt.config.smart_rendering && !isLegacyRender(gantt)){\n\t\t\t\t\t\t\tif(self.renderers[config.id]){\n\t\t\t\t\t\t\t\tself.onUpdateRequest(self.renderers[config.id]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tthis._add(config);\n\t\t\t\treturn (config ? config.id : undefined);\n\t\t\t},\n\t\t\tonUpdateRequest: function(layer){\n\n\t\t\t},\n\n\t\t\teachLayer: function(code){\n\t\t\t\tfor (var i in this.renderers) {\n\t\t\t\t\tcode(this.renderers[i]);\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoveLayer: function (id) {\n\t\t\t\tif(!this.renderers[id])\n\t\t\t\t\treturn;\n\t\t\t\tthis.renderers[id].destructor();\n\t\t\t\tdelete this.renderers[id];\n\t\t\t},\n\t\t\tclear: function () {\n\t\t\t\tfor (var i in this.renderers) {\n\t\t\t\t\tthis.renderers[i].destructor();\n\t\t\t\t}\n\t\t\t\tthis.renderers = {};\n\t\t\t}//,\n\t\t\t//prepareConfig: prepareConfig\n\t\t};\n\n\t\tgantt.attachEvent(\"onDestroy\", function(){\n\t\t\trenderGroup.clear();\n\t\t\trenderGroup = null;\n\t\t});\n\n\t\treturn renderGroup;\n\t}\n};};\n\n\nfunction mergeFilters(filter_methods){\n\tif(!(filter_methods instanceof Array)){\n\t\tfilter_methods = Array.prototype.slice.call(arguments, 0);\n\t}\n\n\treturn function(obj){\n\t\tvar res = true;\n\t\tfor(var i = 0, len = filter_methods.length; i < len; i++){\n\t\t\tvar filter_method = filter_methods[i];\n\t\t\tif(filter_method){\n\t\t\t\tres = res && (filter_method(obj.id, obj) !== false);\n\t\t\t}\n\t\t}\n\n\t\treturn res;\n\t};\n}\n\n\nexport default layerFactory;\n","export default function(item, view, config){\n\tif(!item.start_date || !item.end_date){\n\t\treturn null;\n\t}\n\tvar padding = 200;\n\tvar startCoord = view.posFromDate(item.start_date);\n\tvar endCoord = view.posFromDate(item.end_date);\n\tvar left = Math.min(startCoord, endCoord) - padding;\n\tvar right = Math.max(startCoord, endCoord) + padding;\n\treturn {\n\t\ttop: view.getItemTop(item.id),\n\t\theight: view.getItemHeight(item.id),\n\t\tleft: left,\n\t\twidth: right - left\n\t};\n};","import getLinkRectangle from \"../get_link_rectangle\";\n\nexport default function(){\n\tvar coordinates = [];\n\tvar calculated = false;\n\n\tfunction clearCache(){\n\t\tcoordinates = [];\n\t\tcalculated = false;\n\t}\n\n\tfunction buildCache(datastore, view, gantt){\n\t\tvar config = view.$getConfig();\n\t\tvar visibleItems = datastore.getVisibleItems();\n\t\t//datastore.eachItem(function(link){\n\t\tvisibleItems.forEach(function(link){\n\t\t\tvar rec = getLinkRectangle(link, view, config, gantt);\n\t\t\tif(!rec){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcoordinates.push({id: link.id, rec: rec});\n\t\t});\n\n\t\tcoordinates.sort(function(a, b){\n\t\t\tif(a.rec.right < b.rec.right){\n\t\t\t\treturn -1;\n\t\t\t}else {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t});\n\n\t\tcalculated = true;\n\t}\n\n\tvar initialized = false;\n\tfunction init(datastore){\n\t\tif(initialized){\n\t\t\treturn;\n\t\t}\n\t\tinitialized = true;\n\t\tdatastore.attachEvent(\"onPreFilter\", clearCache);\n\t\tdatastore.attachEvent(\"onStoreUpdated\", clearCache);\n\t\tdatastore.attachEvent(\"onClearAll\", clearCache);\n\t\tdatastore.attachEvent(\"onBeforeStoreUpdate\", clearCache);\n\t}\n\n\treturn function getVisibleLinksRange(gantt, view, config, datastore, viewport){\n\t\tinit(datastore);\n\t\tif(!calculated){\n\t\t\tbuildCache(datastore, view, gantt);\n\t\t}\n\n\t\tvar visibleBoxes = [];\n\t\tfor(var i = 0; i < coordinates.length; i++){\n\t\t\tvar item = coordinates[i];\n\t\t\tvar box = item.rec;\n\t\t\tif(box.right < viewport.x){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(box.left < viewport.x_end && box.right > viewport.x && box.top < viewport.y_end && box.bottom > viewport.y){\n\t\t\t\tvisibleBoxes.push(item.id);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn {\n\t\t\tids: visibleBoxes\n\t\t};\n\t};\n};","\n\nimport barRectangle from \"./get_bar_rectangle\";\n\nexport default function getLinkBox(item, view, config, gantt){\n\tif(!gantt.isTaskExists(item.source)){\n\t\treturn null;\n\t}\n\n\tif(!gantt.isTaskExists(item.target)){\n\t\treturn null;\n\t}\n\tvar sourceBox = barRectangle(gantt.getTask(item.source), view, gantt);\n\tvar targetBox = barRectangle(gantt.getTask(item.target), view, gantt);\n\n\tif(!sourceBox || !targetBox){\n\t\treturn null;\n\t}\n\n\tvar padding = 100;\n\tvar left = Math.min(sourceBox.left, targetBox.left) - padding;\n\tvar right = Math.max(sourceBox.left + sourceBox.width, targetBox.left + targetBox.width) + padding;\n\tvar top = Math.min(sourceBox.top, targetBox.top) - padding;\n\tvar bottom = Math.max(sourceBox.top + sourceBox.height, targetBox.top + targetBox.height) + padding;\n\n\treturn {\n\t\ttop: top,\n\t\theight: bottom - top,\n\t\tbottom,\n\t\tleft: left,\n\t\twidth: right - left,\n\t\tright\n\t};\n};\n","\n// optimized checker for links smart rendering\n\n// first check the vertical position since it's easier to calculate\n\nexport default function isLinkInViewPort(item, viewport, view, config, gantt){\n\tvar source = view.$gantt.getTask(item.source);\n\tvar target = view.$gantt.getTask(item.target);\n\t// check vertical visibility first since it's a lighter check\n\tvar sourceTop = view.getItemTop(source.id);\n\tvar sourceHeight = view.getItemHeight(source.id);\n\n\tvar targetTop = view.getItemTop(target.id);\n\tvar targetHeight = view.getItemHeight(target.id);\n\n\tif(viewport.y > sourceTop + sourceHeight &&\n\t\tviewport.y > targetTop + targetHeight){\n\t\treturn false;\n\t}\n\n\tif(viewport.y_end < targetTop &&\n\t\tviewport.y_end < sourceTop){\n\t\treturn false;\n\t}\n\n\tvar padding = 100;\n\tvar sourceLeft = view.posFromDate(source.start_date);\n\tvar sourceRight = view.posFromDate(source.end_date);\n\tvar targetLeft = view.posFromDate(target.start_date);\n\tvar targetRight = view.posFromDate(target.end_date);\n\n\tif(sourceLeft > sourceRight){\n\t\t// rtl\n\t\tvar tmp = sourceRight;\n\t\tsourceRight = sourceLeft;\n\t\tsourceLeft = tmp;\n\t}\n\tif(targetLeft > targetRight){\n\t\t// rtl\n\t\tvar tmp = targetRight;\n\t\ttargetRight = targetLeft;\n\t\ttargetLeft = tmp;\n\t}\n\tsourceLeft += -padding; // add buffer for custom elements\n\tsourceRight += padding;\n\ttargetLeft += -padding; // add buffer for custom elements\n\ttargetRight += padding;\n\n\tif(viewport.x > sourceRight &&\n\t\tviewport.x > targetRight){\n\t\treturn false;\n\t}\n\n\tif(viewport.x_end < sourceLeft &&\n\t\tviewport.x_end < targetLeft){\n\t\treturn false;\n\t}\n\treturn true;\n};\n","import createLayerFactory from \"./render/layer_engine\";\n\nimport getVisibleTaskRange from \"./render/viewport/get_visible_bars_range\";\nimport getVisibleLinksRangeFactory from \"./render/viewport/factory/get_visible_link_range\";\n\nimport isLinkInViewport from \"./render/viewport/is_link_in_viewport\";\n\nfunction initLayer(layer, gantt){\n\tif(!layer.view){\n\t\treturn;\n\t}\n\n\tvar view = layer.view;\n\tif(typeof view === \"string\"){\n\t\tview = gantt.$ui.getView(view);\n\t}\n\n\tif(view && view.attachEvent){\n\t\tview.attachEvent(\"onScroll\", function(){\n\t\t\tvar state = gantt.$services.getService(\"state\");\n\t\t\t// don't repaint if we're inside batchUpdate, a complete repaint will be called afterwards\n\t\t\tif(!state.getState(\"batchUpdate\").batch_update && !view.$config.$skipSmartRenderOnScroll){\n\t\t\t\tif(layer.requestUpdate){\n\t\t\t\t\tlayer.requestUpdate();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nvar createLayerEngine = function(gantt){\n\tvar factory = createLayerFactory(gantt);\n\treturn {\n\t\tgetDataRender: function(name){\n\t\t\treturn gantt.$services.getService(\"layer:\" + name) || null;\n\t\t},\n\t\tcreateDataRender: function(config){\n\t\t\tvar name = config.name,\n\t\t\t\tdefaultContainer = config.defaultContainer,\n\t\t\t\tpreviusSiblingContainer = config.defaultContainerSibling;\n\n\t\t\tvar layers = factory.createGroup(\n\t\t\t\tdefaultContainer,\n\t\t\t\tpreviusSiblingContainer,\n\t\t\t\tfunction(itemId, item){\n\t\t\t\t\tif(layers.filters){\n\t\t\t\t\t\tfor(var i = 0; i < layers.filters.length; i++){\n\t\t\t\t\t\t\tif(layers.filters[i](itemId, item) === false){\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinitLayer\n\t\t\t);\n\n\t\t\tgantt.$services.setService(\"layer:\" + name, function(){\n\t\t\t\treturn layers;\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onGanttReady\", function () {\n\t\t\t\tlayers.addLayer();// init layers on start\n\t\t\t});\n\n\t\t\treturn layers;\n\t\t},\n\t\tinit: function(){\n\t\t\tvar taskLayers = this.createDataRender({\n\t\t\t\tname: \"task\",\n\t\t\t\tdefaultContainer: function(){\n\t\t\t\t\tif(gantt.$task_data){\n\t\t\t\t\t\treturn gantt.$task_data;\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_data;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdefaultContainerSibling: function(){\n\t\t\t\t\tif(gantt.$task_links){\n\t\t\t\t\t\treturn gantt.$task_links;\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_links;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfilter: function(item){\n\n\t\t\t\t}\n\t\t\t}, gantt);\n\n\t\t\tvar linkLayers = this.createDataRender({\n\t\t\t\tname: \"link\",\n\t\t\t\tdefaultContainer: function(){\n\t\t\t\t\tif(gantt.$task_data){\n\t\t\t\t\t\treturn gantt.$task_data;\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_data;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, gantt);\n\n\t\t\treturn {\n\t\t\t\taddTaskLayer: function(config){\n\t\t\t\t\tconst rangeFunction = getVisibleTaskRange;\n\t\t\t\t\tif(typeof config === \"function\"){\n\t\t\t\t\t\tconfig = {\n\t\t\t\t\t\t\trenderer: {\n\t\t\t\t\t\t\t\trender: config,\n\t\t\t\t\t\t\t\tgetVisibleRange: rangeFunction\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(config.renderer && !config.renderer.getVisibleRange){\n\t\t\t\t\t\t\tconfig.renderer.getVisibleRange = rangeFunction;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconfig.view = \"timeline\";\n\n\t\t\t\t\treturn taskLayers.addLayer(config);\n\t\t\t\t},\n\n\t\t\t\t_getTaskLayers: function(){\n\t\t\t\t\treturn taskLayers.getLayers();\n\t\t\t\t},\n\t\t\t\tremoveTaskLayer: function(id){\n\t\t\t\t\ttaskLayers.removeLayer(id);\n\t\t\t\t},\n\n\t\t\t\t_clearTaskLayers: function(){\n\t\t\t\t\ttaskLayers.clear();\n\t\t\t\t},\n\t\t\t\taddLinkLayer: function(config){\n\t\t\t\t\tconst rangeFunction = getVisibleLinksRangeFactory();\n\t\t\t\t\tif(typeof config === \"function\"){\n\t\t\t\t\t\tconfig = {\n\t\t\t\t\t\t\trenderer: {\n\t\t\t\t\t\t\t\trender: config,\n\t\t\t\t\t\t\t\tgetVisibleRange: rangeFunction\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(config.renderer && !config.renderer.getVisibleRange){\n\t\t\t\t\t\t\tconfig.renderer.getVisibleRange = rangeFunction;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconfig.view = \"timeline\";\n\t\t\t\t\tif(config && config.renderer){\n\t\t\t\t\t\tif(!config.renderer.getRectangle && !config.renderer.isInViewPort){\n\t\t\t\t\t\t\tconfig.renderer.isInViewPort = isLinkInViewport;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn linkLayers.addLayer(config);\n\t\t\t\t},\n\n\t\t\t\t_getLinkLayers: function(){\n\t\t\t\t\treturn linkLayers.getLayers();\n\t\t\t\t},\n\t\t\t\tremoveLinkLayer: function(id){\n\t\t\t\t\tlinkLayers.removeLayer(id);\n\t\t\t\t},\n\n\t\t\t\t_clearLinkLayers: function(){\n\t\t\t\t\tlinkLayers.clear();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t};\n};\n\nexport default createLayerEngine;","import * as utils from \"../../../utils/utils\";\nimport eventable from \"../../../utils/eventable\";\nimport * as domHelpers from \"../utils/dom_helpers\";\n\nvar Cell = (function () {\n\t\"use strict\";\n\n\tfunction Cell(parent, config, factory, gantt) {\n\t\tif (parent) {\n\t\t\tthis.$container = domHelpers.toNode(parent);\n\t\t\tthis.$parent = parent;\n\t\t}\n\t\t// save config\n\t\tthis.$config = utils.mixin(config, {\n\t\t\theaderHeight: 33\n\t\t});\n\t\tthis.$gantt = gantt;\n\t\tthis.$domEvents = gantt._createDomEventScope();\n\t\t// set id\n\t\tthis.$id = config.id || \"c\" + utils.uid();\n\n\t\tthis.$name = \"cell\";\n\t\tthis.$factory = factory;\n\n\t\teventable(this);\n\n\t}\n\n\tCell.prototype.destructor = function () {\n\t\tthis.$parent = this.$container = this.$view = null;\n\t\tvar mouse = this.$gantt.$services.getService(\"mouseEvents\");\n\t\tmouse.detach(\"click\", \"gantt_header_arrow\", this._headerClickHandler);\n\t\tthis.$domEvents.detachAll();\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\t};\n\tCell.prototype.cell = function (id) {\n\t\treturn null;\n\t};\n\n\tCell.prototype.scrollTo = function(left, top){\n\n\t\t//GS-333 Add a way to scroll the HTML views:\n\t\tvar cell = this.$view;\n\t\tif (this.$config.html) cell = this.$view.firstChild;\n\n\t\tif (left*1 == left){\n\t\t\tcell.scrollLeft = left;\n\t\t}\n\t\tif(top*1 == top){\n\t\t\tcell.scrollTop = top;\n\t\t}\n\t};\n\n\tCell.prototype.clear = function(){\n\t\tthis.getNode().innerHTML = \"\";\n\t\tthis.getNode().className = \"gantt_layout_content\";\n\t\tthis.getNode().style.padding = \"0\";\n\t};\n\n\tCell.prototype.resize = function (final) {\n\t\tif (this.$parent) {\n\t\t\treturn this.$parent.resize(final);\n\t\t}\n\n\t\tif(final === false){\n\t\t\tthis.$preResize = true;\n\t\t}\n\n\t\tvar topCont = this.$container;\n\t\tvar x = topCont.offsetWidth;\n\t\tvar y = topCont.offsetHeight;\n\t\tvar topSize = this.getSize();\n\t\tif (topCont === document.body) {\n\t\t\tx = document.body.offsetWidth;\n\t\t\ty = document.body.offsetHeight;\n\t\t}\n\t\tif (x < topSize.minWidth) {\n\t\t\tx = topSize.minWidth;\n\t\t}\n\t\tif (x > topSize.maxWidth) {\n\t\t\tx = topSize.maxWidth;\n\t\t}\n\t\tif (y < topSize.minHeight) {\n\t\t\ty = topSize.minHeight;\n\t\t}\n\t\tif (y > topSize.maxHeight) {\n\t\t\ty = topSize.maxHeight;\n\t\t}\n\t\tthis.setSize(x, y);\n\n\t\tif(!this.$preResize){\n\t\t//\tself.callEvent(\"onResize\", [x, y]);\n\t\t}\n\t\tthis.$preResize = false;\n\t};\n\n\tCell.prototype.hide = function () {\n\t\tthis._hide(true);\n\t\tthis.resize();\n\t};\n\tCell.prototype.show = function (force) {\n\t\tthis._hide(false);\n\t\tif (force && this.$parent) {\n\t\t\tthis.$parent.show();\n\t\t}\n\t\tthis.resize();\n\t};\n\tCell.prototype._hide = function (mode) {\n\t\tif (mode === true && this.$view.parentNode) {\n\t\t\tthis.$view.parentNode.removeChild(this.$view);\n\t\t}\n\t\telse if (mode === false && !this.$view.parentNode) {\n\t\t\tvar index = this.$parent.cellIndex(this.$id);\n\t\t\tthis.$parent.moveView(this, index);\n\t\t}\n\t\tthis.$config.hidden = mode;\n\t};\n\tCell.prototype.$toHTML = function (content, css) {\n\t\tif (content === void 0) { content = \"\"; }\n\t\tcss = [(css || \"\"), (this.$config.css || \"\")].join(\" \");\n\t\tvar obj = this.$config;\n\t\tvar header = \"\";\n\t\tif (obj.raw) {\n\t\t\tcontent = typeof obj.raw === \"string\" ? obj.raw : \"\";\n\t\t}\n\t\telse {\n\t\t\tif (!content) {\n\t\t\t\tcontent = \"<div class='gantt_layout_content' \"+(css ? \" class='\"+css+\"' \" : \"\")+\" >\" + (obj.html || \"\") + \"</div>\";\n\t\t\t}\n\t\t\tif (obj.header) {\n\t\t\t\tvar collapseIcon = obj.canCollapse ? \"<div class='gantt_layout_header_arrow'></div>\" : \"\";\n\t\t\t\theader = \"<div class='gantt_layout_header'>\" + collapseIcon + \"<div class='gantt_layout_header_content'>\" + obj.header + \"</div></div>\";\n\t\t\t}\n\t\t}\n\t\treturn \"<div class='gantt_layout_cell \" + css + \"' data-cell-id='\" + this.$id + \"'>\" + header + content + \"</div>\";\n\t};\n\tCell.prototype.$fill = function (node, parent) {\n\t\tthis.$view = node;\n\t\tthis.$parent = parent;\n\t\tthis.init();\n\t};\n\tCell.prototype.getNode = function () {\n\t\treturn (this.$view.querySelector(\"gantt_layout_cell\") || this.$view);\n\t};\n\tCell.prototype.init = function () {\n\t\t// [NOT-GOOD] code is executed for each component, while it still has only one handler, it is no good\n\n\t\tvar self = this;\n\n\t\tthis._headerClickHandler = function(e){\n\t\t\tvar cellId = domHelpers.locateAttribute(e, \"data-cell-id\");\n\t\t\tif(cellId == self.$id){\n\t\t\t\tself.toggle();\n\t\t\t}\n\t\t};\n\n\t\tvar mouse = this.$gantt.$services.getService(\"mouseEvents\");\n\t\tmouse.delegate(\"click\", \"gantt_header_arrow\", this._headerClickHandler);\n\n\t\tthis.callEvent(\"onReady\", []);\n\t};\n\tCell.prototype.toggle = function () {\n\t\tthis.$config.collapsed = !this.$config.collapsed;\n\t\tthis.resize();\n\t};\n\tCell.prototype.getSize = function () {\n\t\tvar size = {\n\t\t\theight: this.$config.height || 0,\n\t\t\twidth: this.$config.width || 0,\n\t\t\tgravity: this.$config.gravity || 1,\n\t\t\tminHeight: this.$config.minHeight || 0,\n\t\t\tminWidth: this.$config.minWidth || 0,\n\t\t\tmaxHeight: this.$config.maxHeight || 100000000000,\n\t\t\tmaxWidth: this.$config.maxWidth || 100000000000\n\t\t};\n\t\tif (this.$config.collapsed) {\n\t\t\tvar mode = this.$config.mode === \"x\";\n\t\t\tsize[mode ? \"width\" : \"height\"] = size[mode ? \"maxWidth\" : \"maxHeight\"] = this.$config.headerHeight;\n\t\t}\n\t\treturn size;\n\t};\n\n\tCell.prototype.getContentSize = function(){\n\n\t\tvar width = this.$lastSize.contentX;\n\t\tif(width !== width*1){\n\t\t\twidth = this.$lastSize.width;\n\t\t}\n\n\t\tvar height = this.$lastSize.contentY;\n\t\tif(height !== height*1){\n\t\t\theight = this.$lastSize.height;\n\t\t}\n\n\t\treturn {\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t};\n\t};\n\n\tCell.prototype._getBorderSizes = function(){\n\t\tvar borders = {\n\t\t\ttop: 0,\n\t\t\tright: 0,\n\t\t\tbottom: 0,\n\t\t\tleft: 0,\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t\tif(this._currentBorders){\n\t\t\tif(this._currentBorders[this._borders.left]){\n\t\t\t\tborders.left = 1;\n\t\t\t\tborders.horizontal++;\n\t\t\t}\n\n\t\t\tif(this._currentBorders[this._borders.right]){\n\t\t\t\tborders.right = 1;\n\t\t\t\tborders.horizontal++;\n\t\t\t}\n\n\t\t\tif(this._currentBorders[this._borders.top]){\n\t\t\t\tborders.top = 1;\n\t\t\t\tborders.vertical++;\n\t\t\t}\n\n\t\t\tif(this._currentBorders[this._borders.bottom]){\n\t\t\t\tborders.bottom = 1;\n\t\t\t\tborders.vertical++;\n\t\t\t}\n\t\t}\n\n\t\treturn borders;\n\n\t};\n\n\tCell.prototype.setSize = function (x, y) {\n\t\tthis.$view.style.width = x + \"px\";\n\t\tthis.$view.style.height = y + \"px\";\n\n\t\tvar borders = this._getBorderSizes();\n\t\tvar contentY = y - borders.vertical;\n\t\tvar contentX = x - borders.horizontal;\n\n\t\tthis.$lastSize = { x: x, y: y, contentX: contentX, contentY: contentY };\n\t\tif (this.$config.header) {\n\t\t\tthis._sizeHeader();\n\t\t}else{\n\t\t\tthis._sizeContent();\n\t\t}\n\t};\n\n\tCell.prototype._borders = {\n\t\t\"left\":\"gantt_layout_cell_border_left\",\n\t\t\"right\":\"gantt_layout_cell_border_right\",\n\t\t\"top\":\"gantt_layout_cell_border_top\",\n\t\t\"bottom\":\"gantt_layout_cell_border_bottom\"\n\t};\n\n\tCell.prototype._setBorders = function(css, view){\n\t\tif(!view) {\n\t\t\tview = this;\n\t\t}\n\t\tvar node = view.$view;\n\n\t\tfor( var i in this._borders){\n\t\t\tdomHelpers.removeClassName(node, this._borders[i]);\n\t\t}\n\n\t\tif(typeof css == \"string\"){\n\t\t\tcss = [css];\n\t\t}\n\n\t\tvar cssHash = {};\n\n\t\tfor(var i = 0; i < css.length; i++){\n\t\t\tdomHelpers.addClassName(node, css[i]);\n\t\t\tcssHash[css[i]] = true;\n\t\t}\n\n\t\tview._currentBorders = cssHash;\n\t};\n\n\n\tCell.prototype._sizeContent = function(){\n\t\tvar content = this.$view.childNodes[0];\n\t\tif(content && content.className == \"gantt_layout_content\"){\n\t\t\tcontent.style.height = this.$lastSize.contentY + \"px\";\n\t\t}\n\t};\n\n\tCell.prototype._sizeHeader = function () {\n\t\tvar size = this.$lastSize;\n\t\tsize.contentY -= this.$config.headerHeight;\n\t\tvar header = this.$view.childNodes[0];\n\t\tvar content = this.$view.childNodes[1];\n\t\tvar xLayout = this.$config.mode === \"x\";\n\t\tif (this.$config.collapsed) {\n\t\t\tcontent.style.display = \"none\";\n\t\t\tif (xLayout) {\n\t\t\t\theader.className = \"gantt_layout_header collapsed_x\";\n\t\t\t\theader.style.width = size.y + \"px\";\n\t\t\t\tvar d = Math.floor(size.y / 2 - size.x / 2);\n\t\t\t\theader.style.transform = \"rotate(90deg) translate(\" + d + \"px, \" + d + \"px)\";\n\t\t\t\tcontent.style.display = \"none\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\theader.className = \"gantt_layout_header collapsed_y\";\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (xLayout) {\n\t\t\t\theader.className = \"gantt_layout_header\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\theader.className = \"gantt_layout_header vertical\";\n\t\t\t}\n\t\t\theader.style.width = 'auto';\n\t\t\theader.style.transform = '';\n\t\t\tcontent.style.display = \"\";\n\t\t\tcontent.style.height = size.contentY + \"px\";\n\t\t}\n\t\theader.style.height = this.$config.headerHeight + \"px\";\n\t};\n\treturn Cell;\n}());\n\nexport default Cell;\n","export default function (d, b) {\n\tfor (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\tfunction __() { this.constructor = d; }\n\td.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};","import __extends from \"../../../utils/extends\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport Cell from \"./cell\";\n\nvar Layout = (function (_super) {\n\t\"use strict\";\n\n\t__extends(Layout, _super);\n\tfunction Layout(parent, config, factory) {\n\t\tvar _this = _super.apply(this, arguments) || this;\n\n\t\tif(parent)\n\t\t\t_this.$root = true;\n\n\t\t_this._parseConfig(config);\n\t\t_this.$name = \"layout\";\n\t\treturn _this;\n\t}\n\n\tLayout.prototype.destructor = function () {\n\t\tif (this.$container && this.$view) {\n\t\t\tdomHelpers.removeNode(this.$view);\n\t\t}\n\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tvar child = this.$cells[i];\n\t\t\tchild.destructor();\n\t\t}\n\t\tthis.$cells = [];\n\n\t\t_super.prototype.destructor.call(this);\n\t};\n\n\tLayout.prototype._resizeScrollbars = function(autosize, scrollbars){\n\t\tvar scrollChanged = false;\n\t\tvar visibleScrollbars = [],\n\t\t\thiddenScrollbars = [];\n\n\t\tconst scrollbarsToHide = [];\n\n\t\tfunction showScrollbar(scrollbar){\n\t\t\tscrollbar.$parent.show();\n\t\t\tscrollChanged = true;\n\t\t\tvisibleScrollbars.push(scrollbar);\n\t\t}\n\t\tfunction hideScrollbar(scrollbar){\n\t\t\tscrollbar.$parent.hide();\n\t\t\tscrollChanged = true;\n\t\t\thiddenScrollbars.push(scrollbar);\n\t\t}\n\n\t\tvar scrollbar;\n\t\tfor(var i = 0; i < scrollbars.length; i++){\n\t\t\tscrollbar = scrollbars[i];\n\n\t\t\tif(autosize[scrollbar.$config.scroll]) {\n\t\t\t\thideScrollbar(scrollbar);\n\t\t\t}else if(scrollbar.shouldHide()){\n\t\t\t\t//hideScrollbar(scrollbar);\n\t\t\t\tscrollbarsToHide.push(scrollbar);\n\t\t\t}else if(scrollbar.shouldShow()){\n\t\t\t\tshowScrollbar(scrollbar);\n\t\t\t}else{\n\t\t\t\tif(scrollbar.isVisible()){\n\t\t\t\t\tvisibleScrollbars.push(scrollbar);\n\t\t\t\t}else{\n\t\t\t\t\thiddenScrollbars.push(scrollbar);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar visibleGroups = {};\n\t\tfor(var i = 0; i < visibleScrollbars.length; i++){\n\t\t\tif(visibleScrollbars[i].$config.group){\n\t\t\t\tvisibleGroups[visibleScrollbars[i].$config.group] = true;\n\t\t\t}\n\t\t}\n\n\t\t// GS-2220\n\t\tscrollbarsToHide.forEach(function(scrollbar){\n\t\t\tif(!(scrollbar.$config.group && visibleGroups[scrollbar.$config.group])){\n\t\t\t\thideScrollbar(scrollbar);\n\t\t\t}\n\t\t});\n\n\t\tfor(var i = 0; i < hiddenScrollbars.length; i++){\n\t\t\tscrollbar = hiddenScrollbars[i];\n\n\t\t\tif(scrollbar.$config.group && visibleGroups[scrollbar.$config.group]){\n\t\t\t\tshowScrollbar(scrollbar);\n\t\t\t\t// GS-707 If the scrollbar was hidden then showed, the container resize shouldn't happen because of that\n\t\t\t\tfor(var j = 0; j < visibleScrollbars.length; j++){\n\t\t\t\t\tif(visibleScrollbars[j] == scrollbar){\n\t\t\t\t\t\tthis.$gantt.$scrollbarRepaint = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn scrollChanged;\n\t};\n\n\tLayout.prototype.getScrollbarsInfo = function(){\n\t\tconst scrollbars = this.getCellsByType(\"scroller\");\n\t\tconst scrollbarsInfo = [];\n\t\tscrollbars.forEach(scrollbar => {\n\t\t\tlet obj = {};\n\t\t\tconst {visible, direction, size, scrollSize, position} = scrollbar.getScrollState();\n\t\t\tlet linkedViews = scrollbar._getLinkedViews();\n\t\t\tlet boundViews = linkedViews.map(view => view.$config.id);\n\n\t\t\tobj.id = scrollbar.$id;\n\t\t\tobj.visible = visible;\n\t\t\tobj.boundViews = boundViews;\n\t\t\tif(direction === \"x\"){\n\t\t\t\tobj.x = size;\n\t\t\t\tobj.x_inner = scrollSize;\n\t\t\t\tobj.x_pos = position || 0;\n\t\t\t} else {\n\t\t\t\tobj.y = size;\n\t\t\t\tobj.y_inner = scrollSize;\n\t\t\t\tobj.y_pos = position || 0;\n\t\t\t}\n\t\t\tscrollbarsInfo.push(obj);\n\t\t});\n\t\treturn scrollbarsInfo;\n\t};\n\n\tLayout.prototype._syncCellSizes = function(groupName, newSize){\n\t\tif(!groupName)\n\t\t\treturn;\n\n\t\tvar groups = {};\n\n\t\tthis._eachChild(function(cell){\n\t\t\tif(cell.$config.group && cell.$name != \"scrollbar\" && cell.$name != \"resizer\"){\n\t\t\t\tif(!groups[cell.$config.group]){\n\t\t\t\t\tgroups[cell.$config.group] = [];\n\t\t\t\t}\n\t\t\t\tgroups[cell.$config.group].push(cell);\n\t\t\t}\n\t\t});\n\n\t\tif(groups[groupName]){\n\t\t\tthis._syncGroupSize(groups[groupName], newSize);\n\t\t}\n\t\treturn groups[groupName];\n\t};\n\n\tLayout.prototype._syncGroupSize = function(cells, newSize){\n\t\tif(!cells.length) return;\n\n\t\tvar property = cells[0].$parent._xLayout ? \"width\" : \"height\";\n\t\tvar direction = cells[0].$parent.getNextSibling(cells[0].$id) ? 1 : -1;\n\n\t\tvar newSizeValue = newSize.value;\n\t\tvar isGravity = newSize.isGravity;\n\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\tvar ownSize = cells[i].getSize();\n\n\t\t\tvar resizeSibling = direction > 0 ? cells[i].$parent.getNextSibling(cells[i].$id) : cells[i].$parent.getPrevSibling(cells[i].$id);\n\t\t\tif(resizeSibling.$name == \"resizer\"){\n\t\t\t\tresizeSibling = direction > 0 ? resizeSibling.$parent.getNextSibling(resizeSibling.$id) : resizeSibling.$parent.getPrevSibling(resizeSibling.$id);\n\t\t\t}\n\t\t\tvar siblingSize = resizeSibling.getSize();\n\n\t\t\tif(!isGravity) {\n\t\t\t\tif(resizeSibling[property]){\n\t\t\t\t\tvar totalGravity = ownSize.gravity + siblingSize.gravity;\n\t\t\t\t\tvar totalSize = ownSize[property] + siblingSize[property];\n\t\t\t\t\tvar k = totalGravity / totalSize;\n\t\t\t\t\tcells[i].$config.gravity = k * newSizeValue;\n\n\t\t\t\t\tresizeSibling.$config[property] = totalSize - newSizeValue;\n\t\t\t\t\tresizeSibling.$config.gravity = totalGravity - k * newSizeValue;\n\t\t\t\t}else{\n\t\t\t\t\tcells[i].$config[property] = newSizeValue;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tcells[i].$config.gravity = newSizeValue;\n\t\t\t}\n\n\t\t\tvar mainGrid = this.$gantt.$ui.getView(\"grid\");\n\t\t\tif(mainGrid && cells[i].$content === mainGrid && !mainGrid.$config.scrollable && !isGravity){\n\t\t\t\tthis.$gantt.config.grid_width = newSizeValue;\n\t\t\t}\n\t\t}\n\t};\n\n\tLayout.prototype.resize = function(startStage){\n\t\tvar mainCall = false;\n\t\tif(this.$root && !this._resizeInProgress){\n\t\t\tthis.callEvent(\"onBeforeResize\", []);\n\t\t\tmainCall = true;\n\t\t\tthis._resizeInProgress = true;\n\t\t}\n\n\t\t_super.prototype.resize.call(this, true);\n\t\t_super.prototype.resize.call(this, false);\n\n\t\tif(mainCall){\n\n\t\t\tvar contentViews = [];\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"viewCell\"));\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"viewLayout\"));\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"hostCell\"));\n\n\t\t\tvar scrollbars = this.getCellsByType(\"scroller\");\n\n\t\t\tfor(var i = 0; i < contentViews.length; i++){\n\t\t\t\tif(!contentViews[i].$config.hidden)\n\t\t\t\t\tcontentViews[i].setContentSize();\n\t\t\t}\n\n\t\t\tvar autosize = this._getAutosizeMode(this.$config.autosize);\n\n\t/* // possible to rollback set content size when autisize is disabled, not sure if need to\n\t\t\tcontentViews.forEach(function(view){\n\t\t\t\tconst parent = view.$parent;\n\t\t\t\tif(!autosize.x){\n\t\t\t\t\tif(parent.$config.$originalWidthStored){\n\t\t\t\t\t\tparent.$config.$originalWidthStored = false;\n\t\t\t\t\t\tparent.$config.width = parent.$config.$originalWidth;\n\t\t\t\t\t\tparent.$config.$originalWidth = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(!autosize.y){\n\t\t\t\t\tif(parent.$config.$originalHeightStored){\n\t\t\t\t\t\tparent.$config.$originalHeightStored = false;\n\t\t\t\t\t\tparent.$config.height = parent.$config.$originalHeight;\n\t\t\t\t\t\tparent.$config.$originalHeight = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});*/\n\t\t\t\n\t\t\tvar scrollChanged = this._resizeScrollbars(autosize, scrollbars);\n\n\t\t\tif(this.$config.autosize){\n\t\t\t\tthis.autosize(this.$config.autosize);\n\t\t\t\tcontentViews.forEach(function(view){\n\t\t\t\t\tconst parent = view.$parent;\n\t\t\t\t\tconst sizes = parent.getContentSize(autosize);\n\t\t\t\t\tif(autosize.x){\n\t\t\t\t\t\tif(!parent.$config.$originalWidthStored){\n\t\t\t\t\t\t\tparent.$config.$originalWidthStored = true;\n\t\t\t\t\t\t\tparent.$config.$originalWidth = parent.$config.width;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparent.$config.width = sizes.width;\n\t\t\t\t\t}\n\t\t\t\t\tif(autosize.y){\n\t\t\t\t\t\tif(!parent.$config.$originalHeightStored){\n\t\t\t\t\t\t\tparent.$config.$originalHeightStored = true;\n\t\t\t\t\t\t\tparent.$config.$originalHeight = parent.$config.height;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparent.$config.height = sizes.height;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tscrollChanged = true;\n\t\t\t}\n\n\t\t\tif(scrollChanged){\n\t\t\t\tthis.resize();\n\t\t\t\tfor(var i = 0; i < contentViews.length; i++){\n\t\t\t\t\tif(!contentViews[i].$config.hidden)\n\t\t\t\t\t\tcontentViews[i].setContentSize();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onResize\", []);\n\t\t}\n\t\tif(mainCall){\n\t\t\tthis._resizeInProgress = false;\n\t\t}\n\t};\n\n\tLayout.prototype._eachChild = function(code, cell){\n\t\tcell = cell || this;\n\t\tcode(cell);\n\t\tif(cell.$cells){\n\t\t\tfor(var i = 0; i < cell.$cells.length; i++){\n\t\t\t\tthis._eachChild(code, cell.$cells[i]);\n\t\t\t}\n\t\t}\n\t};\n\n\tLayout.prototype.isChild = function(view){\n\t\tvar res = false;\n\t\tthis._eachChild(function(child){\n\t\t\tif(child === view || child.$content === view){\n\t\t\t\tres = true;\n\t\t\t}\n\t\t});\n\t\treturn res;\n\t};\n\n\tLayout.prototype.getCellsByType = function(type){\n\t\tvar res = [];\n\t\tif(type === this.$name){\n\t\t\tres.push(this);\n\t\t}\n\n\t\tif(this.$content && this.$content.$name == type){\n\t\t\tres.push(this.$content);\n\t\t}\n\n\t\tif(this.$cells){\n\t\t\tfor(var i = 0; i < this.$cells.length; i++){\n\t\t\t\tvar children = Layout.prototype.getCellsByType.call(this.$cells[i], type);\n\t\t\t\tif(children.length){\n\t\t\t\t\tres.push.apply(res, children);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t};\n\n\tLayout.prototype.getNextSibling = function(cellId){\n\t\tvar index = this.cellIndex(cellId);\n\t\tif(index >= 0 && this.$cells[index + 1]){\n\t\t\treturn this.$cells[index + 1];\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t};\n\n\tLayout.prototype.getPrevSibling = function(cellId){\n\t\tvar index = this.cellIndex(cellId);\n\t\tif(index >= 0 && this.$cells[index - 1]){\n\t\t\treturn this.$cells[index - 1];\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t};\n\n\n\tLayout.prototype.cell = function (id) {\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tvar child = this.$cells[i];\n\t\t\tif (child.$id === id) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tvar sub = child.cell(id);\n\t\t\tif (sub) {\n\t\t\t\treturn sub;\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype.cellIndex = function (id) {\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tif (this.$cells[i].$id === id) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t};\n\tLayout.prototype.moveView = function (view, ind) {\n\t\tif (this.$cells[ind] !== view) {\n\t\t\treturn window.alert(\"Not implemented\");\n\t\t}\n\t\telse {\n\t\t\tind += this.$config.header ? 1 : 0;\n\t\t\tvar node = this.$view;\n\t\t\tif (ind >= node.childNodes.length) {\n\t\t\t\tnode.appendChild(view.$view);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnode.insertBefore(view.$view, node.childNodes[ind]);\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype._parseConfig = function (config) {\n\t\tthis.$cells = [];\n\t\tthis._xLayout = !config.rows;\n\t\tvar cells = config.rows || config.cols || config.views;\n\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\tvar cell = cells[i];\n\t\t\tcell.mode = this._xLayout ? \"x\" : \"y\";\n\t\t\tvar $content = this.$factory.initUI(cell, this);\n\t\t\tif(!$content){\n\t\t\t\tcells.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}else{\n\t\t\t\t$content.$parent = this;\n\t\t\t\tthis.$cells.push($content);\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype.getCells = function () {\n\t\treturn this.$cells;\n\t};\n\tLayout.prototype.render = function () {\n\t\tvar view = domHelpers.insertNode(this.$container, this.$toHTML());\n\t\tthis.$fill(view, null);\n\t\tthis.callEvent(\"onReady\", []);\n\t\tthis.resize();\n\n\t\t// do simple repaint after the first call\n\t\tthis.render = this.resize;\n\t};\n\tLayout.prototype.$fill = function (node, parent) {\n\t\tthis.$view = node;\n\t\tthis.$parent = parent;\n\t\tvar cells = domHelpers.getChildNodes(node, \"gantt_layout_cell\");\n\t\tfor (var i = cells.length - 1; i >= 0; i--) {\n\t\t\tvar sub = this.$cells[i];\n\t\t\tsub.$fill(cells[i], this);\n\t\t\t// initially hidden cell\n\t\t\tif (sub.$config.hidden) {\n\t\t\t\tsub.$view.parentNode.removeChild(sub.$view);\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype.$toHTML = function () {\n\t\tvar mode = this._xLayout ? \"x\" : \"y\";\n\t\tvar html = [];\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\thtml.push(this.$cells[i].$toHTML());\n\t\t}\n\t\treturn _super.prototype.$toHTML.call(this, html.join(\"\"), (this.$root ? \"gantt_layout_root \" : \"\") + \"gantt_layout gantt_layout_\" + mode);\n\t};\n\n\tLayout.prototype.getContentSize = function(mode){\n\t\tvar contentWidth = 0,\n\t\t\tcontentHeight = 0;\n\n\t\tvar cellSize, cell, borders;\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tcell = this.$cells[i];\n\t\t\tif(cell.$config.hidden)\n\t\t\t\tcontinue;\n\n\t\t\tcellSize = cell.getContentSize(mode);\n\n\t\t\tif(cell.$config.view === \"scrollbar\" && mode[cell.$config.scroll]){\n\t\t\t\tcellSize.height = 0;\n\t\t\t\tcellSize.width = 0;\n\t\t\t}\n\n\t\t\tif(cell.$config.resizer){\n\t\t\t\tif(this._xLayout){\n\t\t\t\t\tcellSize.height = 0;\n\t\t\t\t}else{\n\t\t\t\t\tcellSize.width = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tborders = cell._getBorderSizes();\n\n\t\t\tif(this._xLayout){\n\t\t\t\tcontentWidth += (cellSize.width + borders.horizontal);\n\t\t\t\tcontentHeight = Math.max(contentHeight, (cellSize.height + borders.vertical));\n\t\t\t}else{\n\t\t\t\tcontentWidth = Math.max(contentWidth, cellSize.width + borders.horizontal);\n\t\t\t\tcontentHeight += cellSize.height + borders.vertical;\n\t\t\t}\n\t\t}\n\n\t\tborders = this._getBorderSizes();\n\t\tcontentWidth += borders.horizontal;\n\t\tcontentHeight += borders.vertical;\n\n\t\t// GS-149 & GS-150: By default this code only increases the container sizes, because of that, the cell sizes\n\t\t// are also increased. Keep this code here in the case if something goes wrong\n\t\t/*\n\t\tif(this.$root){\n\t\t\tcontentWidth += 1;\n\t\t\tcontentHeight += 1;\n\t\t}\n\t\t*/\n\t\treturn {\n\t\t\twidth: contentWidth,\n\t\t\theight: contentHeight\n\t\t};\n\t};\n\n\tLayout.prototype._cleanElSize = function(value){\n\t\treturn ((value || \"\").toString().replace(\"px\", \"\") * 1 || 0);\n\t};\n\tLayout.prototype._getBoxStyles = function(div){\n\t\tvar computed = null;\n\t\tif(window.getComputedStyle){\n\t\t\tcomputed = window.getComputedStyle(div, null);\n\t\t}else{\n\t\t\t//IE with elem.currentStyle does not calculate sizes from %, so will use the default approach\n\t\t\tcomputed = {\n\t\t\t\t\"width\":div.clientWidth,\n\t\t\t\t\"height\":div.clientHeight\n\t\t\t};\n\t\t}\n\t\tvar properties = [\n\t\t\t\"width\",\n\t\t\t\"height\",\n\n\t\t\t\"paddingTop\",\n\t\t\t\"paddingBottom\",\n\t\t\t\"paddingLeft\",\n\t\t\t\"paddingRight\",\n\n\t\t\t\"borderLeftWidth\",\n\t\t\t\"borderRightWidth\",\n\t\t\t\"borderTopWidth\",\n\t\t\t\"borderBottomWidth\"\n\t\t];\n\t\tvar styles = {\n\t\t\tboxSizing:(computed.boxSizing == \"border-box\")\n\t\t};\n\n\t\tif(computed.MozBoxSizing){\n\t\t\tstyles.boxSizing = (computed.MozBoxSizing == \"border-box\");\n\t\t}\n\t\tfor(var i =0; i < properties.length; i++){\n\t\t\tstyles[properties[i]] = computed[properties[i]] ? this._cleanElSize(computed[properties[i]]) : 0;\n\t\t}\n\n\n\t\tvar box = {\n\t\t\thorPaddings : (styles.paddingLeft + styles.paddingRight + styles.borderLeftWidth + styles.borderRightWidth),\n\t\t\tvertPaddings : (styles.paddingTop + styles.paddingBottom + styles.borderTopWidth + styles.borderBottomWidth),\n\t\t\tborderBox: styles.boxSizing,\n\t\t\tinnerWidth : styles.width,\n\t\t\tinnerHeight : styles.height,\n\t\t\touterWidth : styles.width,\n\t\t\touterHeight : styles.height\n\t\t};\n\n\n\t\tif(box.borderBox){\n\t\t\tbox.innerWidth -= box.horPaddings;\n\t\t\tbox.innerHeight -= box.vertPaddings;\n\t\t}else{\n\t\t\tbox.outerWidth += box.horPaddings;\n\t\t\tbox.outerHeight += box.vertPaddings;\n\t\t}\n\n\t\treturn box;\n\t};\n\n\tLayout.prototype._getAutosizeMode = function(config){\n\t\tvar res = {x:false, y:false};\n\t\tif(config === \"xy\"){\n\t\t\tres.x = res.y = true;\n\t\t}else if(config === \"y\" || config === true){\n\t\t\tres.y = true;\n\t\t}else if(config === \"x\"){\n\t\t\tres.x = true;\n\t\t}\n\t\treturn res;\n\t};\n\n\tLayout.prototype.autosize = function(mode) {\n\t\tvar res = this._getAutosizeMode(mode);\n\t\tvar boxSizes = this._getBoxStyles(this.$container);\n\t\tvar contentSizes = this.getContentSize(mode);\n\n\t\tvar node = this.$container;\n\t\tif(res.x){\n\t\t\tif(boxSizes.borderBox){\n\t\t\t\tcontentSizes.width += boxSizes.horPaddings;\n\t\t\t}\n\t\t\tnode.style.width = contentSizes.width + \"px\";\n\t\t}\n\t\tif(res.y){\n\t\t\tif(boxSizes.borderBox){\n\t\t\t\tcontentSizes.height += boxSizes.vertPaddings;\n\t\t\t}\n\t\t\tnode.style.height = contentSizes.height + \"px\";\n\t\t}\n\t};\n\n\tLayout.prototype.getSize = function () {\n\t\tthis._sizes = [];\n\t\tvar width = 0;\n\t\tvar minWidth = 0;\n\t\tvar maxWidth = 100000000000;\n\t\tvar height = 0;\n\t\tvar maxHeight = 100000000000;\n\t\tvar minHeight = 0;\n\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\n\t\t\tvar size = this._sizes[i] = this.$cells[i].getSize();\n\t\t\tif (this.$cells[i].$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (this._xLayout) {\n\t\t\t\tif (!size.width && size.minWidth) {\n\t\t\t\t\twidth += size.minWidth;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\twidth += size.width;\n\t\t\t\t}\n\t\t\t\tmaxWidth += size.maxWidth;\n\t\t\t\tminWidth += size.minWidth;\n\t\t\t\theight = Math.max(height, size.height);\n\t\t\t\tmaxHeight = Math.min(maxHeight, size.maxHeight); // min of maxHeight\n\t\t\t\tminHeight = Math.max(minHeight, size.minHeight); // max of minHeight\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!size.height && size.minHeight) {\n\t\t\t\t\theight += size.minHeight;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\theight += size.height;\n\t\t\t\t}\n\t\t\t\tmaxHeight += size.maxHeight;\n\t\t\t\tminHeight += size.minHeight;\n\t\t\t\twidth = Math.max(width, size.width);\n\t\t\t\tmaxWidth = Math.min(maxWidth, size.maxWidth); // min of maxWidth\n\t\t\t\tminWidth = Math.max(minWidth, size.minWidth); // max of minWidth\n\t\t\t}\n\t\t}\n\t\tvar self = _super.prototype.getSize.call(this);\n\t\t// maxWidth\n\t\tif (self.maxWidth >= 100000) {\n\t\t\tself.maxWidth = maxWidth;\n\t\t}\n\t\t// maxHeight\n\t\tif (self.maxHeight >= 100000) {\n\t\t\tself.maxHeight = maxHeight;\n\t\t}\n\t\t// minWidth\n\t\tself.minWidth = self.minWidth !== self.minWidth ? 0 : self.minWidth;// || self.width || Math.max(minWidth, width);\n\t\t// minHeight\n\t\tself.minHeight = self.minHeight !== self.minHeight ? 0 : self.minHeight;//self.minHeight || self.height || Math.max(minHeight, height);\n\t\t// sizes with paddings and margins\n\t\tif (this._xLayout) {\n\t\t\tself.minWidth += this.$config.margin * (this.$cells.length) || 0;\n\t\t\tself.minWidth += this.$config.padding * 2 || 0;\n\t\t\tself.minHeight += (this.$config.padding * 2) || 0;\n\t\t}\n\t\telse {\n\t\t\tself.minHeight += this.$config.margin * (this.$cells.length) || 0;\n\t\t\tself.minHeight += (this.$config.padding * 2) || 0;\n\t\t}\n\t\t\n\t\treturn self;\n\t};\n\t// calc total gravity and free space\n\tLayout.prototype._calcFreeSpace = function (s, cell, xLayout) {\n\t\tvar min = xLayout ? cell.minWidth : cell.minHeight;\n\t\tvar max = xLayout ? cell.maxWidth : cell.maxWidth;\n\t\tvar side = s;\n\t\tif (!side) {\n\t\t\tside = Math.floor(this._free / this._gravity * cell.gravity);\n\t\t\tif (side > max) {\n\t\t\t\tside = max;\n\t\t\t\tthis._free -= side;\n\t\t\t\tthis._gravity -= cell.gravity;\n\t\t\t}\n\t\t\tif (side < min) {\n\t\t\t\tside = min;\n\t\t\t\tthis._free -= side;\n\t\t\t\tthis._gravity -= cell.gravity;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (side > max) {\n\t\t\t\tside = max;\n\t\t\t}\n\t\t\tif (side < min) {\n\t\t\t\tside = min;\n\t\t\t}\n\t\t\tthis._free -= side;\n\t\t}\n\t\treturn side;\n\t};\n\tLayout.prototype._calcSize = function (s, size, xLayout) {\n\t\tvar side = s;\n\t\tvar min = xLayout ? size.minWidth : size.minHeight;\n\t\tvar max = xLayout ? size.maxWidth : size.maxHeight;\n\t\tif (!side) {\n\t\t\tside = Math.floor(this._free / this._gravity * size.gravity);\n\t\t}\n\t\tif (side > max) {\n\t\t\tside = max;\n\t\t}\n\t\tif (side < min) {\n\t\t\tside = min;\n\t\t}\n\t\treturn side;\n\t};\n\n\tLayout.prototype._configureBorders = function(){\n\t\tif(this.$root){\n\t\t\tthis._setBorders([\n\t\t\t\tthis._borders.left,\n\t\t\t\tthis._borders.top,\n\t\t\t\tthis._borders.right,\n\t\t\t\tthis._borders.bottom\n\t\t\t],\n\t\t\tthis);\n\t\t}\n\n\t\tvar borderClass = this._xLayout ? this._borders.right : this._borders.bottom;\n\n\t\tvar cells = this.$cells;\n\n\t\tvar lastVisibleIndex = cells.length - 1;\n\t\tfor(var i = lastVisibleIndex; i >= 0; i--){\n\t\t\tif (!cells[i].$config.hidden) {\n\t\t\t\tlastVisibleIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\tif (cells[i].$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar lastCell = i >= lastVisibleIndex;\n\t\t\tvar borderColorClass = \"\";\n\t\t\tif(!lastCell && cells[i + 1]){\n\t\t\t\tif(cells[i + 1].$config.view == \"scrollbar\"){\n\t\t\t\t\tif(this._xLayout){\n\t\t\t\t\t\tlastCell = true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tborderColorClass = \"gantt_layout_cell_border_transparent\";\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tthis._setBorders(lastCell ? [] : [borderClass, borderColorClass], cells[i]);\n\t\t}\n\t};\n\n\tLayout.prototype._updateCellVisibility = function(){\n\t\tvar oldVisibleCells = this._visibleCells || {};\n\t\tvar firstCall = !this._visibleCells;\n\t\tvar visibleCells = {};\n\t\tvar cell = null;\n\t\tvar parentVisibility = [];\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\n\t\t\tcell = this.$cells[i];\n\t\t\tif (cell.$config.hide_empty){\n\t\t\t\tparentVisibility.push(cell);\n\t\t\t}\n\n\t\t\tif (!firstCall && cell.$config.hidden && oldVisibleCells[cell.$id]) {\n\t\t\t\tcell._hide(true);\n\t\t\t}else if(!cell.$config.hidden && !oldVisibleCells[cell.$id]){\n\t\t\t\tcell._hide(false);\n\t\t\t}\n\n\t\t\tif(!cell.$config.hidden){\n\t\t\t\tvisibleCells[cell.$id] = true;\n\t\t\t}\n\t\t}\n\t\tthis._visibleCells = visibleCells;\n\n\t\t// GS-27. A way to hide the whole cell if all its children are hidden\n\t\tfor (var i = 0; i < parentVisibility.length; i++) {\n\t\t\tvar cell = parentVisibility[i];\n\t\t\tvar children = cell.$cells;\n\t\t\tvar hideCell = true;\n\t\t\tchildren.forEach(function(child){\n\t\t\t\tif (!child.$config.hidden && !child.$config.resizer){\n\t\t\t\t\thideCell = false;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tcell.$config.hidden = hideCell;\n\t\t}\n\t};\n\n\tLayout.prototype.setSize = function (x, y) {\n\t\tthis._configureBorders();\n\t\t_super.prototype.setSize.call(this, x, y);\n\t\ty = this.$lastSize.contentY;\n\t\tx = this.$lastSize.contentX;\n\n\t\tvar padding = (this.$config.padding || 0);\n\t\tthis.$view.style.padding = padding + \"px\";\n\t\tthis._gravity = 0;\n\t\tthis._free = this._xLayout ? x : y;\n\t\tthis._free -= padding * 2;\n\t\t// calc all gravity\n\n\t\tvar cell,\n\t\t\tsize;\n\n\t\tthis._updateCellVisibility();\n\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\n\t\t\tcell = this.$cells[i];\n\n\t\t\tif (cell.$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar margin = (this.$config.margin || 0);\n\t\t\tif(cell.$name == \"resizer\" && !margin){\n\t\t\t\tmargin = -1;\n\t\t\t}\n\n\t\t\t// set margins to child cell\n\t\t\tvar cellView = cell.$view;\n\n\t\t\tvar marginSide = this._xLayout ? \"marginRight\" : \"marginBottom\";\n\t\t\tif (i !== this.$cells.length - 1) {\n\t\t\t\tcellView.style[marginSide] = margin + \"px\";\n\t\t\t\tthis._free -= margin; // calc free space without margin\n\t\t\t}\n\t\t\tsize = this._sizes[i];\n\t\t\tif (this._xLayout) {\n\t\t\t\tif (!size.width) {\n\t\t\t\t\tthis._gravity += size.gravity;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!size.height) {\n\t\t\t\t\tthis._gravity += size.gravity;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\n\t\t\tcell = this.$cells[i];\n\n\t\t\tif (cell.$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tsize = this._sizes[i];\n\t\t\tvar width = size.width;\n\t\t\tvar height = size.height;\n\t\t\tif (this._xLayout) {\n\t\t\t\tthis._calcFreeSpace(width, size, true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._calcFreeSpace(height, size, false);\n\t\t\t}\n\t\t}\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tcell = this.$cells[i];\n\n\t\t\tif (cell.$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tsize = this._sizes[i];\n\t\t\tvar dx = void 0;\n\t\t\tvar dy = void 0;\n\t\t\tif (this._xLayout) {\n\t\t\t\tdx = this._calcSize(size.width, size, true);\n\t\t\t\tdy = y - padding * 2; // layout height without paddings\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdx = x - padding * 2; // layout width without paddings\n\t\t\t\tdy = this._calcSize(size.height, size, false);\n\t\t\t}\n\n\t\t\tcell.setSize(dx, dy);\n\t\t}\n\n\t};\n\n\treturn Layout;\n}(Cell));\n\nexport default Layout;","import __extends from \"../../../utils/extends\";\nimport Layout from \"./layout\";\nimport Cell from \"./cell\";\n\nvar ViewLayout = (function (_super) {\n\t\"use strict\";\n\n\t__extends(ViewLayout, _super);\n\tfunction ViewLayout(parent, config, factory) {\n\t\tvar _this = _super.apply(this, arguments) || this;\n\t\tfor (var i = 0; i < _this.$cells.length; i++) {\n\t\t\t_this.$cells[i].$config.hidden = (i !== 0);\n\t\t}\n\t\t_this.$cell = _this.$cells[0];\n\t\t_this.$name = \"viewLayout\";\n\n\t\treturn _this;\n\t}\n\tViewLayout.prototype.cell = function (id) {\n\t\tvar cell = _super.prototype.cell.call(this, id);\n\t\tif (!cell.$view) {\n\t\t\tthis.$fill(null, this);\n\t\t}\n\t\treturn cell;\n\t};\n\tViewLayout.prototype.moveView = function (view) {\n\t\tvar body = this.$view;\n\t\tif (this.$cell) {\n\t\t\tthis.$cell.$config.hidden = true;\n\t\t\tbody.removeChild(this.$cell.$view);\n\t\t}\n\t\tthis.$cell = view;\n\t\tbody.appendChild(view.$view);\n\t};\n\tViewLayout.prototype.setSize = function (x, y) {\n\t\tCell.prototype.setSize.call(this, x, y);\n\t};\n\n\tViewLayout.prototype.setContentSize = function(){\n\t\tvar size = this.$lastSize;\n\t\tthis.$cell.setSize(size.contentX, size.contentY);\n\t};\n\n\tViewLayout.prototype.getSize = function () {\n\t\tvar sizes = _super.prototype.getSize.call(this);\n\t\tif (this.$cell) {\n\t\t\tvar cellSize = this.$cell.getSize();\n\t\t\tif (this.$config.byMaxSize) {\n\t\t\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\t\t\tvar otherCell = this.$cells[i].getSize();\n\t\t\t\t\tfor (var cell in cellSize) {\n\t\t\t\t\t\tcellSize[cell] = Math.max(cellSize[cell], otherCell[cell]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (var size in sizes) {\n\t\t\t\tsizes[size] = sizes[size] || cellSize[size];\n\t\t\t}\n\t\t\tsizes.gravity = Math.max(sizes.gravity, cellSize.gravity);\n\t\t}\n\t\treturn sizes;\n\t};\n\treturn ViewLayout;\n}(Layout));\n\nexport default ViewLayout;","import __extends from \"../../../utils/extends\";\nimport * as utils from \"../../../utils/utils\";\nimport Cell from \"./cell\";\n\nvar ViewCell = (function (_super) {\n\t\"use strict\";\n\n\t__extends(ViewCell, _super);\n\tfunction ViewCell(parent, config, factory) {\n\n\t\tvar _this = _super.apply(this, arguments) || this;\n\n\t\tif(config.view){\n\t\t\tif(config.id){\n\t\t\t\t// pass id to the nested view\n\t\t\t\tthis.$id = utils.uid();\n\t\t\t}\n\t\t\tvar childConfig = utils.copy(config);\n\t\t\tdelete childConfig.config;\n\t\t\tdelete childConfig.templates;\n\n\t\t\tthis.$content = this.$factory.createView(config.view, this, childConfig, this);\n\t\t\tif(!this.$content)\n\t\t\t\treturn false;\n\t\t}\n\n\t\t_this.$name = \"viewCell\";\n\t\treturn _this;\n\t}\n\n\tViewCell.prototype.destructor = function(){\n\t\tthis.clear();\n\t\t_super.prototype.destructor.call(this);\n\t};\n\n\tViewCell.prototype.clear = function(){\n\n\t\tthis.$initialized = false;\n\n\t\t// call destructor\n\t\tif (this.$content){\n\t\t\tvar method = this.$content.unload || this.$content.destructor;\n\t\t\tif (method){\n\t\t\t\tmethod.call(this.$content);\n\t\t\t}\n\t\t}\n\n\t\t_super.prototype.clear.call(this);\n\n\t};\n\n\tViewCell.prototype.scrollTo = function(left, top){\n\n\t\tif(this.$content && this.$content.scrollTo){\n\t\t\tthis.$content.scrollTo(left, top);\n\t\t}else{\n\t\t\t_super.prototype.scrollTo.call(this, left, top);\n\t\t}\n\t};\n\n\tViewCell.prototype._setContentSize = function(x, y){\n\t\tvar borders = this._getBorderSizes();\n\t\tif(typeof x === \"number\"){\n\t\t\tvar outerX = x + borders.horizontal;\n\t\t\tthis.$config.width = outerX;\n\t\t}\n\t\tif(typeof y === \"number\"){\n\t\t\tvar outerY = y + borders.vertical;\n\t\t\tthis.$config.height = outerY;\n\t\t}\n\t};\n\n\tViewCell.prototype.setSize = function(x, y){\n\t\t_super.prototype.setSize.call(this, x, y);\n\n\t\tif(!this.$preResize && this.$content) {\n\t\t\tif (!this.$initialized) {\n\t\t\t\tthis.$initialized = true;\n\t\t\t\tvar header = this.$view.childNodes[0];\n\t\t\t\tvar content = this.$view.childNodes[1];\n\t\t\t\tif(!content) content = header;\n\n\t\t\t\t/*if(this.$content.$config){\n\t\t\t\t\tthis.$content.$config.width = this.$lastSize.contentX;\n\t\t\t\t\tthis.$content.$config.height = this.$lastSize.contentY;\n\t\t\t\t}*/\n\t\t\t\tthis.$content.init(content);\n\t\t\t}\n\t\t}\n\t};\n\n\tViewCell.prototype.setContentSize = function(){\n\t\tif(!this.$preResize && this.$content) {\n\t\t\tif (this.$initialized) {\n\t\t\t\tthis.$content.setSize(this.$lastSize.contentX, this.$lastSize.contentY);\n\t\t\t}\n\t\t}\n\t};\n\n\n\tViewCell.prototype.getContentSize = function(){\n\t\tvar size = _super.prototype.getContentSize.call(this);\n\n\t\tif(this.$content && this.$initialized){\n\t\t\tvar childSize = this.$content.getSize();\n\t\t\tsize.width = childSize.contentX === undefined ? childSize.width : childSize.contentX;\n\t\t\tsize.height = childSize.contentY === undefined ? childSize.height : childSize.contentY;\n\t\t}\n\n\t\tvar borders = this._getBorderSizes();\n\t\tsize.width += borders.horizontal;\n\t\tsize.height += borders.vertical;\n\n\t\treturn size;\n\t};\n\n\treturn ViewCell;\n}(Cell));\n\nexport default ViewCell;","import __extends from \"../../../utils/extends\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport Cell from \"./cell\";\n\nvar ResizerCell = (function (_super) {\n\t\"use strict\";\n\n\t__extends(ResizerCell, _super);\n\tfunction ResizerCell(parent, config, factory) {\n\t\tvar _this = _super.apply(this, arguments) || this;\n\n\t\tvar startBackSize, startFrontSize;\n\n\t\tfunction getPageCoordinates(e){\n\t\t\tvar x = e.pageX;\n\t\t\tvar y = e.pageY;\n\n\t\t\tif (e.touches){\n\t\t\t\tx =  e.touches[0].pageX;\n\t\t\t\ty =  e.touches[0].pageY;\n\t\t\t}\n\n\t\t\treturn {x:x,y:y};\n\t\t}\n\n\t\t_this._moveHandler = function (e) {\n\t\t\t_this._moveResizer(_this._resizer, getPageCoordinates(e).x, getPageCoordinates(e).y);\n\t\t};\n\t\t_this._upHandler = function (e) {\n\t\t\tvar newSizes = _this._getNewSizes();\n\t\t\tif(_this.callEvent(\"onResizeEnd\", [startBackSize, startFrontSize, newSizes ? newSizes.back : 0, newSizes ? newSizes.front : 0]) !== false){\n\t\t\t\t_this._setSizes();\n\t\t\t}\n\n\t\t\t_this._setBackground(false);\n\t\t\t_this._clearResizer();\n\t\t\t_this._clearListeneres();\n\n\t\t\tif (e.touches) _this.$gantt._prevent_touch_scroll = false;\n\t\t};\n\n\t\t_this._clearListeneres = function(){\n\t\t\tthis.$domEvents.detach(document, \"mouseup\", _this._upHandler);\n\t\t\tthis.$domEvents.detach(document, \"mousemove\", _this._moveHandler);\n\t\t\tthis.$domEvents.detach(document, \"mousemove\", _this._startOnMove);\n\t\t\tthis.$domEvents.detach(document, \"mouseup\", _this._cancelDND);\n\n\t\t\tthis.$domEvents.detach(document, \"touchend\", _this._upHandler);\n\t\t\tthis.$domEvents.detach(document, \"touchmove\", _this._startOnMove);\n\t\t\tthis.$domEvents.detach(document, \"touchstart\", _this._downHandler);\n\t\t};\n\n\t\t_this._callStartDNDEvent = function(){\n\t\t\tif (this._xMode) {\n\t\t\t\tstartBackSize = this._behind.$config.width || this._behind.$view.offsetWidth;\n\t\t\t\tstartFrontSize = this._front.$config.width || this._front.$view.offsetWidth;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstartBackSize = this._behind.$config.height || this._behind.$view.offsetHeight;\n\t\t\t\tstartFrontSize = this._front.$config.height || this._front.$view.offsetHeight;\n\t\t\t}\n\n\t\t\tif(_this.callEvent(\"onResizeStart\", [startBackSize, startFrontSize]) === false){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\n\t\t_this._startDND = function(e){\n\t\t\tvar res = this._callStartDNDEvent();\n\t\t\tif(res === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar stop = false;\n\t\t\tthis._eachGroupItem(function(resizer){\n\t\t\t\tresizer._getSiblings();\n\t\t\t\tif(resizer._callStartDNDEvent() === false){\n\t\t\t\t\tstop = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(stop){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_this._moveHandler(e);\n\n\t\t\t_this.$domEvents.attach(document, \"mousemove\", _this._moveHandler);\n\t\t\t_this.$domEvents.attach(document, \"mouseup\", _this._upHandler);\n\t\t};\n\n\t\t_this._cancelDND = function(){\n\t\t\t_this._setBackground(false);\n\t\t\t_this._clearResizer();\n\t\t\t_this._clearListeneres();\n\t\t};\n\n\t\t_this._startOnMove = function(e){\n\t\t\t// don't scroll the timeline on touch devices\n\t\t\tif (e.touches){\n\t\t\t\t_this.$gantt._touch_drag = true;\n\t\t\t\t// GS-45. Don't scroll the timeline while dragging something on touch devices (e.g. resizer)\n\t\t\t\t_this.$gantt._prevent_touch_scroll = true;\n\t\t\t}\n\n\t\t\tif(_this._isPosChanged(e)){\n\t\t\t\t_this._clearListeneres();\n\t\t\t\t_this._startDND(e);\n\t\t\t}\n\t\t};\n\n\t\t_this._downHandler = function (e) {\n\t\t\t_this._getSiblings();\n\n\t\t\tif (_this._behind.$config.collapsed || _this._front.$config.collapsed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_this._setBackground(true);\n\t\t\t_this._resizer = _this._setResizer();\n\n\t\t\t_this._positions = {\n\t\t\t\tx: getPageCoordinates(e).x,\n\t\t\t\ty: getPageCoordinates(e).y,\n\t\t\t\ttimestamp: Date.now()\n\t\t\t};\n\n\t\t\t_this.$domEvents.attach(document, \"mousemove\", _this._startOnMove);\n\t\t\t_this.$domEvents.attach(document, \"mouseup\", _this._cancelDND);\n\t\t};\n\t\t_this.$name = \"resizer\";\n\t\treturn _this;\n\t}\n\tResizerCell.prototype.init = function () {\n\t\tvar _this = this;\n\t\t_super.prototype.init.call(this);\n\t\tthis._xMode = this.$config.mode === \"x\";\n\t\tif (this._xMode && !this.$config.width) {\n\t\t\tthis.$config.width = this.$config.minWidth = 1;\n\t\t}\n\t\telse if (!this._xMode && !this.$config.height) {\n\t\t\tthis.$config.height = this.$config.minHeight = 1;\n\t\t}\n\n\t\tthis.$config.margin = -1;\n\n\t\tthis.$domEvents.attach(this.$view, \"mousedown\", _this._downHandler);\n\n\t\tthis.$domEvents.attach(this.$view, \"touchstart\", _this._downHandler);\n\t\tthis.$domEvents.attach(this.$view, \"touchmove\",  _this._startOnMove);\n\t\tthis.$domEvents.attach(this.$view, \"touchend\",  _this._upHandler);\n\t};\n\tResizerCell.prototype.$toHTML = function () {\n\t\tvar mode = this.$config.mode;\n\t\tvar css = this.$config.css || \"\";\n\t\treturn \"<div class='gantt_layout_cell gantt_resizer gantt_resizer_\"+mode+\"'><div class='gantt_layout_content gantt_resizer_\" + mode + (css ? (\" \" + css) : \"\") + \"'></div></div>\";\n\t};\n\n\tResizerCell.prototype._clearResizer = function(){\n\t\tif(this._resizer){\n\t\t\tif(this._resizer.parentNode){\n\t\t\t\tthis._resizer.parentNode.removeChild(this._resizer);\n\t\t\t}\n\t\t\tthis._resizer = null;\n\t\t}\n\t};\n\n\tResizerCell.prototype._isPosChanged = function(e){\n\t\tif(!this._positions){\n\t\t\treturn false;\n\t\t}\n\n\t\tif(Math.abs(this._positions.x - e.pageX) > 3 || Math.abs(this._positions.y - e.pageY) > 3){\n\t\t\treturn true;\n\t\t}\n\n\t\tif(Date.now() - this._positions.timestamp > 300){\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tResizerCell.prototype._getSiblings = function () {\n\t\tvar cells = this.$parent.getCells();\n\n\t\tif(this.$config.prev){\n\t\t\tthis._behind = this.$factory.getView(this.$config.prev);\n\t\t\tif(!(this._behind instanceof Cell)){\n\t\t\t\tthis._behind = this._behind.$parent;\n\t\t\t}\n\t\t}\n\t\tif(this.$config.next){\n\t\t\tthis._front = this.$factory.getView(this.$config.next);\n\t\t\tif(!(this._front instanceof Cell)){\n\t\t\t\tthis._front = this._behind.$parent;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\tif (this === cells[i]) {\n\t\t\t\tif(!this._behind)\n\t\t\t\t\tthis._behind = cells[i - 1];\n\t\t\t\tif(!this._front)\n\t\t\t\t\tthis._front = cells[i + 1];\n\t\t\t}\n\t\t}\n\t};\n\tResizerCell.prototype._setBackground = function (state) {\n\t\tvar classes = \"gantt_resizing\";\n\t\tif (!state) {\n\t\t\tdomHelpers.removeClassName(this._behind.$view, classes);\n\t\t\tdomHelpers.removeClassName(this._front.$view, classes);\n\t\t\tdocument.body.classList.remove(\"gantt_noselect\");\n\t\t\treturn;\n\t\t}\n\t\tdomHelpers.addClassName(this._behind.$view, classes, true);\n\t\tdomHelpers.addClassName(this._front.$view, classes, true);\n\t\tdocument.body.classList.add(\"gantt_noselect\");\n\t};\n\tResizerCell.prototype._setResizer = function () {\n\t\tvar resizer = document.createElement(\"div\");\n\t\tresizer.className = \"gantt_resizer_stick\";\n\t\tthis.$view.appendChild(resizer);\n\t\tthis.$view.style.overflow = \"visible\";\n\t\tresizer.style.height = this.$view.style.height;\n\t\treturn resizer;\n\t};\n\n\tResizerCell.prototype._getDirection = function(x, y){\n\t\tvar shift;\n\t\tif (this._xMode) {\n\t\t\tshift = x - this._positions.x;\n\t\t}else{\n\t\t\tshift = y - this._positions.y;\n\t\t}\n\t\treturn shift ? shift < 0 ? -1 : 1 : 0;\n\t};\n\n\tResizerCell.prototype._getResizePosition = function(x, y){\n\t\tvar size;\n\t\tvar behindSide;\n\t\tvar behindMin;\n\t\tvar frontSide;\n\t\tvar frontMin;\n\t\tif (this._xMode) {\n\t\t\tsize = x - this._positions.x;\n\t\t\tbehindSide = this._behind.$config.width || this._behind.$view.offsetWidth;\n\t\t\tfrontSide = this._front.$config.width || this._front.$view.offsetWidth;\n\t\t\tbehindMin = this._behind.$config.minWidth;\n\t\t\tfrontMin = this._front.$config.minWidth;\n\t\t}\n\t\telse {\n\t\t\tsize = y - this._positions.y;\n\t\t\tbehindSide = this._behind.$config.height || this._behind.$view.offsetHeight;\n\t\t\tfrontSide = this._front.$config.height || this._front.$view.offsetHeight;\n\t\t\tbehindMin = this._front.$config.minHeight;\n\t\t\tfrontMin = this._front.$config.minHeight;\n\t\t}\n\t\tvar direction = this._getDirection(x, y);\n\t\tvar newBehindSide,\n\t\t\tnewFrontSide;\n\n\t\tif (direction === -1) {\n\t\t\tnewFrontSide = frontSide - size;\n\t\t\tnewBehindSide = behindSide - Math.abs(size);\n\n\t\t\tif (frontSide - size > this._front.$config.maxWidth) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (Math.abs(size) >= behindSide) {\n\t\t\t\tsize = -Math.abs(behindSide - 2);\n\t\t\t}\n\t\t\t// if min width\n\t\t\tif (behindSide - Math.abs(size) <= behindMin) {\n\t\t\t\t//this._resizer.style.background = \"red\";\n\t\t\t\tsize = -Math.abs(behindSide - behindMin);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tnewFrontSide = frontSide - Math.abs(size);\n\t\t\tnewBehindSide = behindSide + size;\n\n\t\t\tif (behindSide + size > this._behind.$config.maxWidth) {\n\t\t\t\tsize = this._behind.$config.maxWidth - behindSide;\n\t\t\t\t// return;\n\t\t\t}\n\t\t\tif (Math.abs(size) >= frontSide) {\n\t\t\t\tsize = frontSide - 2;\n\t\t\t}\n\t\t\t// if min width\n\t\t\tif (frontSide - Math.abs(size) <= frontMin) {\n\t\t\t\tsize = Math.abs(frontSide - frontMin);\n\t\t\t}\n\t\t}\n\n\t\tif (direction === -1) {\n\t\t\tnewFrontSide = frontSide - size;\n\t\t\tnewBehindSide = behindSide - Math.abs(size);\n\t\t} else {\n\t\t\tnewFrontSide = frontSide - Math.abs(size);\n\t\t\tnewBehindSide = behindSide + size;\n\t\t}\n\n\t\treturn {\n\t\t\tsize: size,\n\t\t\tnewFrontSide: newFrontSide,\n\t\t\tnewBehindSide: newBehindSide\n\t\t};\n\t};\n\n\tResizerCell.prototype._getGroupName = function(){\n\t\tthis._getSiblings();\n\t\treturn this._front.$config.group || this._behind.$config.group;\n\t};\n\n\tResizerCell.prototype._eachGroupItem = function(callback, master){\n\t\tvar layout = this.$factory.getView(\"main\");\n\n\t\tvar group = this._getGroupName();\n\n\t\tvar resizers = layout.getCellsByType(\"resizer\");\n\t\tfor(var i = 0; i < resizers.length; i++) {\n\t\t\tif (resizers[i]._getGroupName() == group && resizers[i] != this) {\n\t\t\t\tcallback.call(master || this, resizers[i]);\n\t\t\t}\n\t\t}\n\t};\n\n\tResizerCell.prototype._getGroupResizePosition = function(x, y){\n\t\tvar sizes = this._getResizePosition(x, y);\n\n\t\tif(!this._getGroupName()){\n\t\t\treturn sizes;\n\t\t}\n\n\t\tvar positions = [sizes];\n\n\t\tthis._eachGroupItem(function(resizer){\n\t\t\tresizer._getSiblings();\n\t\t\tvar pos = utils.copy(this._positions);\n\t\t\tif(this._xMode){\n\t\t\t\tpos.x += (resizer._behind.$config.width - this._behind.$config.width);\n\t\t\t}else{\n\t\t\t\tpos.y += (resizer._behind.$config.height - this._behind.$config.height);\n\t\t\t}\n\t\t\tresizer._positions = pos;\n\t\t\tpositions.push(resizer._getResizePosition(x, y));\n\t\t});\n\n\t\tvar minMax;\n\t\tfor(var i =0; i < positions.length; i++){\n\t\t\tif(!positions[i]) return;\n\t\t\tif(minMax === undefined){\n\t\t\t\tminMax = positions[i];\n\t\t\t}else if(positions[i].newBehindSide > minMax.newBehindSide){\n\t\t\t\tminMax = positions[i];\n\t\t\t}\n\t\t}\n\n\t/*\tif(minMax != sizes){\n\t\t\tminMax.size = minMax.size;\n\t\t}*/\n\n\t\treturn minMax;\n\t};\n\n\tResizerCell.prototype._moveResizer = function (av, x, y) {\n\t\tif (x === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar sizes = this._getGroupResizePosition(x, y);\n\t\tif(!sizes)\n\t\t\treturn;\n\n\t\tif (Math.abs(sizes.size) === 1) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._xMode) {\n\t\t\tav.style.left = sizes.size + 'px';\n\t\t\tthis._positions.nextX = sizes.size || 0;\n\t\t}\n\t\telse {\n\t\t\tav.style.top = sizes.size + 'px';\n\t\t\tthis._positions.nextY = sizes.size || 0;\n\t\t}\n\n\t\tthis.callEvent(\"onResize\", [sizes.newBehindSide, sizes.newFrontSide]);\n\t};\n\tResizerCell.prototype._setGravity = function (cell) {\n\t\tvar size = this._xMode ? \"offsetWidth\" : \"offsetHeight\";\n\t\tvar position = this._xMode ? this._positions.nextX : this._positions.nextY;\n\t\tvar frontSize = this._front.$view[size];\n\t\tvar behindSize = this._behind.$view[size];\n\t\tvar frontG = this._front.getSize().gravity;\n\t\tvar behindG = this._behind.getSize().gravity;\n\t\tvar newFrontG = (frontSize - position) / frontSize * frontG;\n\t\tvar newBehindG = (behindSize + position) / behindSize * behindG;\n\t\tif (cell !== \"front\") {\n\t\t\tthis._front.$config.gravity = newFrontG;\n\t\t}\n\t\tif (cell !== \"behind\") {\n\t\t\tthis._behind.$config.gravity = newBehindG;\n\t\t}\n\t};\n\n/*\tResizerCell.prototype.setSize = function(){\n\t\t_super.apply(this, arguments)\n\t};*/\n\n\tResizerCell.prototype._getNewSizes = function(){\n\t\tvar behindSize, frontSize, position;\n\n\t\tif(this._xMode){\n\t\t\tbehindSize = this._behind.$config.width;\n\t\t\tfrontSize = this._front.$config.width;\n\t\t\tposition = this._positions.nextX;\n\t\t}else{\n\t\t\tbehindSize = this._behind.$config.height;\n\t\t\tfrontSize = this._front.$config.height;\n\t\t\tposition = this._positions.nextY;\n\t\t}\n\n\t\tif(!frontSize && !behindSize){\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tfront: frontSize ? ((frontSize - position) || 1) : 0,\n\t\t\tback: behindSize ? ((behindSize + position) || 1) : 0\n\t\t};\n\t};\n\n\tResizerCell.prototype._assignNewSizes = function(newSizes){\n\t\tthis._getSiblings();\n\t\tvar side = this._xMode ? 'width' : 'height';\n\n\t\t// if only gravity cells\n\t\tif (!newSizes) {\n\t\t\tthis._setGravity();\n\t\t}\n\t\telse {\n\t\t\tif (!newSizes.front) {\n\t\t\t\tthis._setGravity(\"behind\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._front.$config[side] = newSizes.front;\n\t\t\t}\n\t\t\tif (!newSizes.back) {\n\t\t\t\tthis._setGravity(\"front\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._behind.$config[side] = newSizes.back;\n\t\t\t}\n\t\t}\n\n\t};\n\n\tResizerCell.prototype._setSizes = function () {\n\t\tif (this._resizer) {\n\t\t\tthis.$view.removeChild(this._resizer);\n\t\t}\n\t\tvar newSizes = this._getNewSizes();\n\n\t\tif (this._positions.nextX || this._positions.nextY) {\n\t\t\tthis._assignNewSizes(newSizes);\n\n\t\t\tvar side = this._xMode ? 'width' : 'height';\n\t\t\tvar resizeValue;\n\t\t\tif(!newSizes || !newSizes.front){\n\t\t\t\tif(this._front.$config.group){\n\t\t\t\t\tresizeValue = {\n\t\t\t\t\t\tvalue: this._front.$config.gravity,\n\t\t\t\t\t\tisGravity: true\n\t\t\t\t\t};\n\t\t\t\t\tthis.$gantt.$layout._syncCellSizes(this._front.$config.group, resizeValue);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!newSizes || !newSizes.back){\n\t\t\t\tif(this._behind.$config.group){\n\t\t\t\t\tresizeValue = {\n\t\t\t\t\t\tvalue: this._behind.$config.gravity,\n\t\t\t\t\t\tisGravity: true\n\t\t\t\t\t};\n\t\t\t\t\tthis.$gantt.$layout._syncCellSizes(this._behind.$config.group, resizeValue);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(newSizes){\n\t\t\t\tif(newSizes.front){\n\t\t\t\t\tif(this._front.$config.group){\n\t\t\t\t\t\tresizeValue = {\n\t\t\t\t\t\t\tvalue: this._front.$config[side],\n\t\t\t\t\t\t\tisGravity: false\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.$gantt.$layout._syncCellSizes(this._front.$config.group, resizeValue);\n\t\t\t\t\t}\n\t\t\t\t} else if(newSizes.back){\n\t\t\t\t\tif(this._behind.$config.group){\n\t\t\t\t\t\tresizeValue = {\n\t\t\t\t\t\t\tvalue: this._behind.$config[side],\n\t\t\t\t\t\t\tisGravity: false\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.$gantt.$layout._syncCellSizes(this._behind.$config.group, resizeValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this._getGroupName()){\n\t\t\t\tthis.$factory.getView(\"main\").resize();\n\t\t\t}else{\n\t\t\t\tthis.$parent.resize();\n\t\t\t}\n\n\t\t}\n\t};\n\treturn ResizerCell;\n}(Cell));\n\nexport default ResizerCell;","import __extends from \"../../../utils/extends\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport env from \"../../../utils/env\";\nimport Cell from \"./cell\";\n\nvar ScrollbarCell = (function (_super) {\n\t\"use strict\";\n\n\tvar SCROLL_MODIFIER_KEYS = [\"altKey\", \"shiftKey\", \"metaKey\"]; // it's no way to disable ctrl+wheel\n\t__extends(ScrollbarCell, _super);\n\tfunction ScrollbarCell(parent, config, factory, gantt) {\n\n\t\tvar _this = _super.apply(this, arguments) || this;\n\t\tthis.$config = utils.mixin(config, {scroll: \"x\"});\n\t\t_this._scrollHorizontalHandler = utils.bind(_this._scrollHorizontalHandler, _this);\n\t\t_this._scrollVerticalHandler = utils.bind(_this._scrollVerticalHandler, _this);\n\t\t_this._outerScrollVerticalHandler = utils.bind(_this._outerScrollVerticalHandler, _this);\n\t\t_this._outerScrollHorizontalHandler = utils.bind(_this._outerScrollHorizontalHandler, _this);\n\t\t_this._mouseWheelHandler = utils.bind(_this._mouseWheelHandler, _this);\n\n\t\tthis.$config.hidden = true;\n\t\tvar size = gantt.config.scroll_size;\n\n\t\tif(gantt.env.isIE){\n\t\t\t// full element height/width must be bigger than just a browser scrollbar,\n\t\t\t// otherwise the scrollbar element won't be scrolled on click\n\t\t\tsize += 1;\n\t\t}\n\n\t\tif(this._isHorizontal()){\n\t\t\t_this.$config.height = size;\n\t\t\t_this.$parent.$config.height = size;\n\t\t}else{\n\t\t\t_this.$config.width = size;\n\t\t\t_this.$parent.$config.width = size;\n\t\t}\n\n\t\tthis.$config.scrollPosition = 0;\n\n\t\t_this.$name = \"scroller\";\n\t\treturn _this;\n\t}\n\n\tScrollbarCell.prototype.init = function(container){\n\t\tcontainer.innerHTML = this.$toHTML();\n\t\tthis.$view = container.firstChild;\n\n\t\tif(!this.$view){\n\t\t\tthis.init();\n\t\t}\n\t\tif(this._isVertical()){\n\t\t\tthis._initVertical();\n\t\t}else{\n\t\t\tthis._initHorizontal();\n\t\t}\n\t\tthis._initMouseWheel();\n\t\tthis._initLinkedViews();\n\t};\n\n\tScrollbarCell.prototype.$toHTML = function () {\n\t\tvar className = this._isHorizontal() ? \"gantt_hor_scroll\" : \"gantt_ver_scroll\";\n\t\treturn \"<div class='gantt_layout_cell \"+className+\"'><div style='\"+(this._isHorizontal() ? \"width:2000px\" : \"height:2000px\")+\"'></div></div>\";\n\t};\n\n\tScrollbarCell.prototype._getRootParent = function(){\n\t\tvar parent = this.$parent;\n\t\twhile(parent && parent.$parent){\n\t\t\tparent = parent.$parent;\n\t\t}\n\t\tif(parent){\n\t\t\treturn parent;\n\t\t}\n\t};\n\n\n\tfunction eachCell(root, res){\n\t\tres.push(root);\n\t\tif(root.$cells){\n\t\t\tfor(var i = 0; i < root.$cells.length; i++){\n\t\t\t\teachCell(root.$cells[i], res);\n\t\t\t}\n\t\t}\n\t}\n\tScrollbarCell.prototype._eachView = function(){\n\t\tvar res = [];\n\t\teachCell(this._getRootParent(), res);\n\t\treturn res;\n\t};\n\n\tScrollbarCell.prototype._getLinkedViews = function(){\n\t\tvar views = this._eachView();\n\t\tvar res = [];\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\tif(views[i].$config && ((this._isVertical() && views[i].$config.scrollY == this.$id) || (this._isHorizontal() && views[i].$config.scrollX == this.$id)) ){\n\t\t\t\tres.push(views[i]);\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t};\n\n\n\tScrollbarCell.prototype._initHorizontal = function(){\n\t\tthis.$scroll_hor = this.$view;\n\t\tthis.$domEvents.attach(this.$view, \"scroll\", this._scrollHorizontalHandler);\n\n\t};\n\n\tScrollbarCell.prototype._initLinkedViews = function(){\n\t\tvar views = this._getLinkedViews();\n\t\tvar css = this._isVertical() ?\"gantt_layout_outer_scroll gantt_layout_outer_scroll_vertical\" : \"gantt_layout_outer_scroll gantt_layout_outer_scroll_horizontal\";\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\t//views[i].$config.css = [views[i].$config.css || \"\", css].join(\" \");\n\t\t\tdomHelpers.addClassName(views[i].$view || views[i].getNode(), css);\n\t\t}\n\t};\n\n\tScrollbarCell.prototype._initVertical = function(){\n\t\tthis.$scroll_ver = this.$view;\n\t\tthis.$domEvents.attach(this.$view, \"scroll\", this._scrollVerticalHandler);\n\t};\n\n\tScrollbarCell.prototype._updateLinkedViews = function(){\n\t};\n\n\tScrollbarCell.prototype._initMouseWheel = function(){\n\t\tvar ff = env.isFF;\n\t\tif (ff)\n\t\t\tthis.$domEvents.attach(this._getRootParent().$view, \"wheel\", this._mouseWheelHandler, {passive: false});\n\t\telse\n\t\t\tthis.$domEvents.attach(this._getRootParent().$view, \"mousewheel\", this._mouseWheelHandler, {passive: false});\n\t};\n\n\n\n\n\tScrollbarCell.prototype.scrollHorizontally = function(left){\n\t\tif(this._scrolling) return;\n\t\tthis._scrolling = true;\n\n\t\tthis.$scroll_hor.scrollLeft = left;\n\t\tthis.$config.codeScrollLeft = left;\n\t\tleft = this.$scroll_hor.scrollLeft;\n\n\t\tvar views = this._getLinkedViews();\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\tif(views[i].scrollTo){\n\t\t\t\tviews[i].scrollTo(left, undefined);\n\t\t\t}\n\t\t}\n\t\tvar oldSize = this.$config.scrollPosition;\n\t\tthis.$config.scrollPosition = left;\n\t\tthis.callEvent(\"onScroll\", [oldSize, left, this.$config.scroll]);\n\t\tthis._scrolling = false;\n\t};\n\tScrollbarCell.prototype.scrollVertically = function(top){\n\t\tif(this._scrolling) return;\n\t\tthis._scrolling = true;\n\n\t\tthis.$scroll_ver.scrollTop = top;\n\t\ttop = this.$scroll_ver.scrollTop;\n\n\t\tvar views = this._getLinkedViews();\n\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\tif(views[i].scrollTo){\n\t\t\t\tviews[i].scrollTo(undefined, top);\n\t\t\t}\n\t\t}\n\t\tvar oldSize = this.$config.scrollPosition;\n\t\tthis.$config.scrollPosition = top;\n\t\tthis.callEvent(\"onScroll\", [oldSize, top, this.$config.scroll]);\n\t\tthis._scrolling = false;\n\t};\n\n\tScrollbarCell.prototype._isVertical = function(){\n\t\treturn this.$config.scroll == \"y\";\n\t};\n\tScrollbarCell.prototype._isHorizontal = function(){\n\t\treturn this.$config.scroll == \"x\";\n\t};\n\tScrollbarCell.prototype._scrollHorizontalHandler = function (e) {\n\t\tif(this._isVertical() || this._scrolling){\n\t\t\treturn;\n\t\t}\n\n\t\t//in safari we can catch previous onscroll after setting new value from mouse-wheel event\n\t\t//set delay to prevent value drifiting\n\t\tif ((new Date()) - ( this._wheel_time || 0 ) < 100) return true;\n\t\t//if (this.$gantt._touch_scroll_active) return;\n\t\tvar left = this.$scroll_hor.scrollLeft;\n\n\t\tthis.scrollHorizontally(left);\n\n\t\tthis._oldLeft = this.$scroll_hor.scrollLeft;\n\t};\n\tScrollbarCell.prototype._outerScrollHorizontalHandler = function(e){\n\t\tif(this._isVertical()){\n\t\t\treturn;\n\t\t}\n\t};\n\n\tScrollbarCell.prototype.show = function(){\n\t\tthis.$parent.show();\n\t};\n\tScrollbarCell.prototype.hide = function(){\n\t\tthis.$parent.hide();\n\t};\n\n\tScrollbarCell.prototype._getScrollSize = function(){\n\t\tvar scrollSize = 0;\n\t\tvar outerSize = 0;\n\t\tvar isHorizontal = this._isHorizontal();\n\n\t\tvar linked = this._getLinkedViews();\n\t\tvar view;\n\t\tvar scrollProperty = isHorizontal ? \"scrollWidth\" : \"scrollHeight\",\n\t\t\tinnerSizeProperty = isHorizontal ? \"contentX\" : \"contentY\";\n\t\tvar outerProperty = isHorizontal ? \"x\" : \"y\";\n\t\tvar offset = this._getScrollOffset();\n\n\t\tfor(var i = 0; i < linked.length; i++){\n\t\t\tview = linked[i];\n\t\t\tif(!(view && view.$content && view.$content.getSize && !view.$config.hidden)) continue;\n\n\t\t\tvar sizes = view.$content.getSize();\n\t\t\tvar cellScrollSize;\n\t\t\tif(sizes.hasOwnProperty(scrollProperty)){\n\t\t\t\tcellScrollSize = sizes[scrollProperty];\n\t\t\t}else{\n\t\t\t\tcellScrollSize = sizes[innerSizeProperty];\n\t\t\t}\n\n\t\t\tif(offset){\n\t\t\t\t// precalculated vertical/horizontal offsets of scrollbar to emulate 4.x look\n\t\t\t\tif(sizes[innerSizeProperty] > sizes[outerProperty] && sizes[innerSizeProperty] > scrollSize && (cellScrollSize > (sizes[outerProperty] - offset + 2))){\n\t\t\t\t\tscrollSize = cellScrollSize + (isHorizontal ? 0 : 2);\n\t\t\t\t\touterSize = sizes[outerProperty];\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tvar nonScrollableSize = Math.max(sizes[innerSizeProperty] - cellScrollSize, 0);\n\t\t\t\tvar scrollableViewPortSize = Math.max(sizes[outerProperty] - nonScrollableSize, 0);\n\t\t\t\tcellScrollSize = cellScrollSize + nonScrollableSize;\n\n\t\t\t\tif(cellScrollSize > scrollableViewPortSize && (cellScrollSize > scrollSize) ){\n\t\t\t\t\t//|| (cellScrollSize === scrollSize && sizes[outerProperty] < outerSize) // same scroll width but smaller scrollable view port\n\n\t\t\t\t\tscrollSize = cellScrollSize;\n\t\t\t\t\touterSize = sizes[outerProperty];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\touterScroll: outerSize,\n\t\t\tinnerScroll: scrollSize\n\t\t};\n\t};\n\n\tScrollbarCell.prototype.scroll = function(position){\n\t\tif(this._isHorizontal()){\n\t\t\tthis.scrollHorizontally(position);\n\t\t}else{\n\t\t\tthis.scrollVertically(position);\n\t\t}\n\t};\n\n\tScrollbarCell.prototype.getScrollState = function(){\n\t\treturn {\n\t\t\tvisible: this.isVisible(),\n\t\t\tdirection: this.$config.scroll,\n\t\t\tsize: this.$config.outerSize,\n\t\t\tscrollSize: this.$config.scrollSize || 0,\n\t\t\tposition: this.$config.scrollPosition || 0\n\t\t};\n\t};\n\n\tScrollbarCell.prototype.setSize = function(width, height){\n\t\t_super.prototype.setSize.apply(this, arguments);\n\n\t\tvar scrollSizes = this._getScrollSize();\n\n\t\tvar ownSize = (this._isVertical() ? height : width) - this._getScrollOffset() + (this._isHorizontal() ? 1 : 0);\n\n\t\tif(scrollSizes.innerScroll && ownSize > scrollSizes.outerScroll){\n\t\t\tscrollSizes.innerScroll += (ownSize - scrollSizes.outerScroll);\n\t\t}\n\t\tthis.$config.scrollSize = scrollSizes.innerScroll;\n\n\t\tthis.$config.width = width;\n\t\tthis.$config.height = height;\n\t\tthis._setScrollSize(scrollSizes.innerScroll);\n\t};\n\n\tScrollbarCell.prototype.isVisible = function(){\n\t\treturn !!(this.$parent && this.$parent.$view.parentNode);\n\t};\n\n\tScrollbarCell.prototype.shouldShow = function(){\n\t\tvar scrollSizes = this._getScrollSize();\n\t\tif(!scrollSizes.innerScroll && (this.$parent && this.$parent.$view.parentNode)){\n\t\t\treturn false;\n\t\t}else if(scrollSizes.innerScroll && !(this.$parent && this.$parent.$view.parentNode)){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tScrollbarCell.prototype.shouldHide = function(){\n\t\tvar scrollSizes = this._getScrollSize();\n\t\tif(!scrollSizes.innerScroll && (this.$parent && this.$parent.$view.parentNode)){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t};\n\n\n\tScrollbarCell.prototype.toggleVisibility = function(){\n\t\tif(this.shouldHide()){\n\t\t\tthis.hide();\n\t\t}else if(this.shouldShow()){\n\t\t\tthis.show();\n\t\t}\n\t};\n\n\tScrollbarCell.prototype._getScaleOffset = function(view){\n\t\tvar offset = 0;\n\t\tif(view && (view.$config.view == \"timeline\" || view.$config.view == \"grid\")){\n\t\t\toffset = view.$content.$getConfig().scale_height;\n\t\t}\n\t\treturn offset;\n\t};\n\n\tScrollbarCell.prototype._getScrollOffset = function(){\n\t\tvar offset = 0;\n\t\tif(this._isVertical()){\n\t\t\tvar parentLayout = this.$parent.$parent;\n\t\t\toffset = Math.max(\n\t\t\t\tthis._getScaleOffset(parentLayout.getPrevSibling(this.$parent.$id)),\n\t\t\t\tthis._getScaleOffset(parentLayout.getNextSibling(this.$parent.$id))\n\t\t\t\t);\n\t\t}else{\n\t\t\tvar linked = this._getLinkedViews();\n\n\t\t\tfor (var i = 0; i < linked.length; i++) {\n\t\t\t\tvar view = linked[i],\n\t\t\t\t\tvparent = view.$parent;\n\t\t\t\tvar cells = vparent.$cells;\n\n\t\t\t\tvar last = cells[cells.length - 1];\n\n\t\t\t\tif (last && last.$config.view == \"scrollbar\" && last.$config.hidden === false) {\n\t\t\t\t\toffset = last.$config.width;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\treturn offset || 0;\n\t};\n\n\tScrollbarCell.prototype._setScrollSize = function(size){\n\t\tvar property = this._isHorizontal() ? \"width\" : \"height\";\n\t\tvar scrollbar = this._isHorizontal() ? this.$scroll_hor : this.$scroll_ver;\n\n\t\tvar offset = this._getScrollOffset();\n\n\t\tvar node = scrollbar.firstChild;\n\n\t\tif(offset){\n\t\t\tif(this._isVertical()){\n\n\t\t\t\tthis.$config.outerSize = (this.$config.height - offset + 3);\n\t\t\t\tscrollbar.style.height = this.$config.outerSize + \"px\";\n\t\t\t\tscrollbar.style.top = (offset-1) + \"px\";\n\t\t\t\tdomHelpers.addClassName(scrollbar, this.$parent._borders.top);\n\t\t\t\tdomHelpers.addClassName(scrollbar.parentNode, \"gantt_task_vscroll\");\n\t\t\t}else{\n\t\t\t\tthis.$config.outerSize = (this.$config.width - offset + 1);\n\t\t\t\tscrollbar.style.width = this.$config.outerSize + \"px\";\n\t\t\t\t//domHelpers.addClassName(scrollbar, this.$parent._borders.right);\n\t\t\t}\n\t\t}else{\n\t\t\tscrollbar.style.top = \"auto\";\n\t\t\tdomHelpers.removeClassName(scrollbar, this.$parent._borders.top);\n\t\t\tdomHelpers.removeClassName(scrollbar.parentNode, \"gantt_task_vscroll\");\n\t\t\tthis.$config.outerSize = this.$config.height;\n\t\t}\n\n\t\tnode.style[property] = size + \"px\";\n\t};\n\n\tScrollbarCell.prototype._scrollVerticalHandler = function (e) {\n\t\tif(this._scrollHorizontalHandler() || this._scrolling){\n\t\t\treturn;\n\t\t}\n\n\t\t//if (this.$gantt._touch_scroll_active) return;\n\t\tvar top = this.$scroll_ver.scrollTop;\n\t\tvar prev = this._oldTop;\n\t\tif(top == prev) return;\n\n\t\tthis.scrollVertically(top);\n\n\t\tthis._oldTop = this.$scroll_ver.scrollTop;\n\n\t};\n\tScrollbarCell.prototype._outerScrollVerticalHandler = function(e){\n\t\tif(this._scrollHorizontalHandler()){\n\t\t\treturn;\n\t\t}\n\t};\n\n\tScrollbarCell.prototype._checkWheelTarget = function(targetNode){\n\t\tvar connectedViews = this._getLinkedViews().concat(this);\n\n\t\tfor(var i = 0; i < connectedViews.length; i++){\n\t\t\tvar node = connectedViews[i].$view;\n\t\t\tif(domHelpers.isChildOf(targetNode, node)){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tScrollbarCell.prototype._mouseWheelHandler = function(e){\n\t\tvar target = e.target || e.srcElement;\n\n\t\tif(!this._checkWheelTarget(target))\n\t\t\treturn;\n\n\t\tthis._wheel_time = new Date();\n\n\t\tvar res = {};\n\n\t\tvar wheelSpeed = {x: 1, y: 1};\n\t\tvar wheelSpeedConfig = this.$gantt.config.wheel_scroll_sensitivity;\n\n\t\tif (typeof wheelSpeedConfig == \"number\" && !!wheelSpeedConfig) {\n\t\t\twheelSpeed = {x: wheelSpeedConfig, y: wheelSpeedConfig};\n\t\t}\n\t\telse if (({}).toString.apply(wheelSpeedConfig) == \"[object Object]\") {\n\t\t\twheelSpeed = {x: wheelSpeedConfig.x, y: wheelSpeedConfig.y};\n\t\t}\n\n\t\tvar ff = env.isFF;\n\t\tvar deltaX = ff ? (e.deltaX) : e.wheelDeltaX;\n\t\tvar deltaY = ff ? (e.deltaY) : e.wheelDelta;\n\n\t\tvar multiplier = -20;\n\t\tif (ff) {\n\t\t\tif (e.deltaMode !== 0) {\n\t\t\t\tmultiplier = -40;\n\t\t\t} else {\n\t\t\t\tmultiplier = -10;\n\t\t\t}\n\t\t}\n\n\t\tvar wx = ff ? (deltaX * multiplier * wheelSpeed.x) : deltaX * 2 * wheelSpeed.x;\n\t\tvar wy = ff ? (deltaY * multiplier * wheelSpeed.y) : deltaY * wheelSpeed.y;\n\n\t\tvar horizontalScrollModifier = this.$gantt.config.horizontal_scroll_key;\n\n\t\tif (horizontalScrollModifier !== false) {\n\t\t\tif (SCROLL_MODIFIER_KEYS.indexOf(horizontalScrollModifier) >= 0) {\n\t\t\t\tif(e[horizontalScrollModifier] && !(e.deltaX || e.wheelDeltaX)){\n\t\t\t\t\t// shift+mousewheel for horizontal scroll\n\t\t\t\t\twx = wy*2;\n\t\t\t\t\twy = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\tif (wx && Math.abs(wx) > Math.abs(wy)){\n\t\t\tif(this._isVertical()){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(res.x) return true;//no horisontal scroll, must not block scrolling\n\t\t\tif(!this.$scroll_hor || !this.$scroll_hor.offsetWidth) return true;\n\n\t\t\tvar dir  = wx/-40;\n\t\t\tvar oldLeft = this._oldLeft;\n\t\t\tvar left = oldLeft+dir*30;\n\t\t\tthis.scrollHorizontally(left);\n\t\t\tthis.$scroll_hor.scrollLeft = left;\n\t\t\t// not block scroll if position hasn't changed\n\t\t\tif(oldLeft == this.$scroll_hor.scrollLeft){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis._oldLeft = this.$scroll_hor.scrollLeft;\n\t\t} else {\n\t\t\tif(this._isHorizontal()){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(res.y) return true;//no vertical scroll, must not block scrolling\n\t\t\tif(!this.$scroll_ver || !this.$scroll_ver.offsetHeight) return true;\n\n\t\t\tvar dir  = wy/-40;\n\t\t\tif (typeof wy == \"undefined\")\n\t\t\t\tdir = e.detail;\n\n\t\t\tvar oldTop = this._oldTop;\n\t\t\tvar top = this.$scroll_ver.scrollTop+dir*30;\n\n\t\t\t//if(!this.$gantt.config.prevent_default_scroll &&\n\t\t\t//\t(this.$gantt._cached_scroll_pos && ((this.$gantt._cached_scroll_pos.y == top) || (this.$gantt._cached_scroll_pos.y <= 0 && top <= 0)))) return true;\n\n\n\t\t\tthis.scrollVertically(top);\n\t\t\tthis.$scroll_ver.scrollTop = top;\n\n\t\t\t// not block scroll if position hasn't changed\n\t\t\tif(oldTop == this.$scroll_ver.scrollTop){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tthis._oldTop = this.$scroll_ver.scrollTop;\n\t\t}\n\n\t\tif (e.preventDefault)\n\t\t\te.preventDefault();\n\t\te.cancelBubble=true;\n\t\treturn false;\n\t};\n\n\treturn ScrollbarCell;\n})(Cell);\n\nexport default ScrollbarCell;","import * as utils from \"../../../utils/utils\";\nimport env from \"../../../utils/env\";\n\nvar createStaticBgHelper = function(utils, env){\n\n\tvar canvasBgCache = {};\n\tvar staticBgStyleId = \"gantt-static-bg-styles-\" + utils.uid();\n\n\tfunction renderBgCanvas(targetNode, config, scale, totalHeight, itemHeight) {\n\t\tif (!config.static_background && !config.timeline_placeholder) return;\n\n\t\tvar canvas = document.createElement(\"canvas\");\n\t\tif (!canvas.getContext) return; // if canvas is not supported (for IE8)\n\n\t\t// clear previous bg data\n\t\ttargetNode.innerHTML = \"\";\n\n\t\tvar styleParams = getCellStyles(targetNode);\n\t\tvar png = createBackgroundTiles(styleParams, config, scale, itemHeight);\n\t\tvar bgDivs = createBgDivs(png, config, scale, totalHeight);\n\n\t\tvar fragment = document.createDocumentFragment();\n\n\t\tbgDivs.forEach(function (div) {\n\t\t\tfragment.appendChild(div);\n\t\t});\n\n\t\ttargetNode.appendChild(fragment);\n\t}\n\n\tfunction getColumnWidths(scale) {\n\t\tvar widths = scale.width;\n\t\tvar differentWidths = {};\n\t\tfor (var i = 0; i < widths.length; i++) {\n\t\t\tif (widths[i] * 1)\n\t\t\t\tdifferentWidths[widths[i]] = true;\n\t\t}\n\t\treturn differentWidths;\n\t}\n\n\tfunction parseRgb(rgbCss) {\n\t\tvar result = /^rgba?\\(([\\d]{1,3}), *([\\d]{1,3}), *([\\d]{1,3}) *(,( *[\\d.]+ *))?\\)$/i.exec(rgbCss);\n\t\treturn result ? {\n\t\t\tr: result[1] * 1,\n\t\t\tg: result[2] * 1,\n\t\t\tb: result[3] * 1,\n\t\t\ta: (result[5] * 255) || 255\n\t\t} : null;\n\t}\n\n\tfunction getUrlFromCache(key) {\n\t\treturn canvasBgCache[key] || null;\n\t}\n\n\tfunction getHashKey(width, height, cellStyles) {\n\t\treturn (width + '' + height + cellStyles.bottomBorderColor + cellStyles.rightBorderColor).replace(/[^\\w\\d]/g, '');\n\t}\n\n\tfunction getStyleElement() {\n\t\tvar style = document.getElementById(staticBgStyleId);\n\n\t\tif (!style) {\n\t\t\tstyle = document.createElement(\"style\");\n\t\t\tstyle.id = staticBgStyleId;\n\t\t\tdocument.body.appendChild(style);\n\t\t}\n\t\treturn style;\n\t}\n\n\tfunction cleanup() {\n\t\tvar style = document.getElementById(staticBgStyleId);\n\t\tif (style && style.parentNode) {\n\t\t\tstyle.parentNode.removeChild(style);\n\t\t}\n\t}\n\n\tfunction cacheUrl(key, url) {\n\t\tcanvasBgCache[key] = url;\n\t}\n\n\tfunction generateBgUrl(width, height, cellStyles) {\n\t\t// use relatively big bg image about 500*500px in order to reduce misalignments due browser zoom\n\t\tvar cols = Math.floor(500 / width) || 1;\n\t\tvar rows = Math.floor(500 / height) || 1;\n\n\t\tvar canvas = document.createElement(\"canvas\");\n\t\tcanvas.height = height * rows;\n\t\tcanvas.width = width * cols;\n\n\t\tvar context = canvas.getContext(\"2d\");\n\n\t\tdrawGrid(height, width, rows, cols, context, cellStyles);\n\n\t\treturn canvas.toDataURL();\n\n\t\tfunction drawGrid(rowHeight, colWidth, rows, cols, context, styles) {\n\t\t\t// paint pixels manually instead of using lineTo in order to prevent canvas aliasing\n\t\t\tvar image = context.createImageData(colWidth * cols, rowHeight * rows);\n\t\t\timage.imageSmoothingEnabled = false;\n\n\t\t\tvar verticalLineWidth = styles.rightBorderWidth * 1;\n\t\t\tvar verticalLineColor = parseRgb(styles.rightBorderColor);\n\n\t\t\tvar x = 0,\n\t\t\t\ty = 0,\n\t\t\t\tw = 0;\n\n\t\t\tfor (var col = 1; col <= cols; col++) {\n\t\t\t\tx = col * colWidth - 1;\n\t\t\t\tfor (w = 0; w < verticalLineWidth; w++) {\n\t\t\t\t\tfor (y = 0; y < rowHeight * rows; y++) {\n\t\t\t\t\t\tdrawDot(x - w, y, verticalLineColor, image);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar horizontalLineWidth = styles.bottomBorderWidth * 1;\n\t\t\tvar horizontalLineColor = parseRgb(styles.bottomBorderColor);\n\n\t\t\ty = 0;\n\t\t\tfor (var row = 1; row <= rows; row++) {\n\t\t\t\ty = row * rowHeight - 1;\n\t\t\t\tfor (w = 0; w < horizontalLineWidth; w++) {\n\t\t\t\t\tfor (x = 0; x < colWidth * cols; x++) {\n\t\t\t\t\t\tdrawDot(x, y - w, horizontalLineColor, image);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcontext.putImageData(image, 0, 0);\n\t\t}\n\n\t\tfunction drawDot(x, y, color, matrix) {\n\t\t\tvar rowLength = width * cols;\n\n\t\t\tvar index = (y * rowLength + x) * 4;\n\n\t\t\tmatrix.data[index] = color.r;\n\t\t\tmatrix.data[index + 1] = color.g;\n\t\t\tmatrix.data[index + 2] = color.b;\n\t\t\tmatrix.data[index + 3] = color.a;\n\t\t}\n\t}\n\n\tfunction getCssClass(key) {\n\t\treturn \"gantt-static-bg-\" + key;\n\t}\n\n\tfunction createBackgroundTiles(cellStyles, config, scale, itemHeight) {\n\t\tvar data = {};\n\t\tvar widths = getColumnWidths(scale),\n\t\t\theight = itemHeight;\n\n\t\tvar styleHTML = \"\";\n\t\tfor (var i in widths) {\n\n\t\t\tvar width = i * 1;\n\t\t\tvar key = getHashKey(width, height, cellStyles);\n\t\t\tvar cachedUrl = getUrlFromCache(key);\n\n\t\t\tif (!cachedUrl) {\n\t\t\t\tvar bgImage = generateBgUrl(width, height, cellStyles);\n\t\t\t\tcacheUrl(key, bgImage);\n\t\t\t\tstyleHTML += \".\" + getCssClass(key) + \"{ background-image: url('\" + bgImage + \"');}\";\n\t\t\t}\n\n\t\t\tdata[i] = getCssClass(key);\n\t\t}\n\n\t\tif (styleHTML) {\n\t\t\tvar style = getStyleElement();\n\t\t\tstyle.innerHTML += styleHTML;\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tfunction createBgDivs(bgTiles, config, scale, dataHeight) {\n\t\tvar divs = [];\n\t\tvar tile,\n\t\t\tprevWidth = 0,\n\t\t\tprevCell;\n\n\t\tvar widths = scale.width.filter(function (i) {\n\t\t\treturn !!i;\n\t\t});\n\n\t\tvar leftPos = 0;\n\n\t\t//TODO: fixme\n\t\t// bg image misalignments on horizontal scroll on very large time scales, especially in IE/Edge browsers\n\t\t// limiting max tile width seems to solve the issue, but can increase rendering time\n\t\tvar maxTileSize = 100000;\n\t\tif (env.isIE) {\n\t\t\t// special case for IE11 on win7x and probably 8x\n\t\t\tvar appVersion = navigator.appVersion || \"\";\n\t\t\tif (appVersion.indexOf(\"Windows NT 6.2\") != -1 ||\n\t\t\t\tappVersion.indexOf(\"Windows NT 6.1\") != -1 ||\n\t\t\t\tappVersion.indexOf(\"Windows NT 6.0\") != -1) {\n\n\t\t\t\tmaxTileSize = 20000;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < widths.length; i++) {\n\t\t\t//var currentWidth = cells[i].clientWidth;\n\t\t\tvar cell = widths[i];\n\n\t\t\tif ((cell != prevCell && prevCell !== undefined) || (i == widths.length - 1) || (prevWidth > maxTileSize)) {\n\n\t\t\t\tvar totalHeight = dataHeight,\n\t\t\t\t\tcurrentTop = 0,\n\t\t\t\t\trowHeight = Math.floor(maxTileSize / config.row_height) * config.row_height;\n\n\t\t\t\tvar tileWidth = prevWidth;\n\n\t\t\t\twhile (totalHeight > 0) {\n\t\t\t\t\tvar currentHeight = Math.min(totalHeight, rowHeight);\n\t\t\t\t\ttotalHeight -= rowHeight;\n\n\t\t\t\t\ttile = document.createElement(\"div\");\n\n\t\t\t\t\ttile.style.height = currentHeight + \"px\";\n\t\t\t\t\ttile.style.position = \"absolute\";\n\t\t\t\t\ttile.style.top = currentTop + \"px\";\n\t\t\t\t\ttile.style.left = leftPos + \"px\";\n\t\t\t\t\ttile.style.pointerEvents = \"none\";\n\n\t\t\t\t\ttile.style.whiteSpace = \"no-wrap\";\n\t\t\t\t\ttile.className = bgTiles[prevCell || cell];\n\n\t\t\t\t\t// if last - short by 1 px (bug fix)\n\t\t\t\t\tif (i == widths.length - 1) {\n\t\t\t\t\t\ttileWidth = cell + tileWidth - 1;\n\t\t\t\t\t}\n\t\t\t\t\ttile.style.width = tileWidth + \"px\";\n\n\t\t\t\t\tdivs.push(tile);\n\t\t\t\t\tcurrentTop += currentHeight;\n\t\t\t\t}\n\t\t\t\tprevWidth = 0;\n\t\t\t\tleftPos += tileWidth;\n\n\t\t\t\t//cell = 0;\n\t\t\t}\n\t\t\tif (cell) {\n\t\t\t\tprevWidth += cell;\n\t\t\t\tprevCell = cell;\n\t\t\t}\n\n\t\t}\n\n\t\treturn divs;\n\t}\n\n\n\tfunction createProbeElement(){\n\t\tvar cell = document.createElement(\"div\");\n\t\tcell.className = \"gantt_task_cell\";\n\t\tvar row = document.createElement(\"div\");\n\t\trow.className = \"gantt_task_row\";\n\t\trow.appendChild(cell);\n\t\treturn row;\n\t}\n\tfunction getCellStyles(targetNode) {\n\t\t// creating temp DOM structure for resolving style parameters. Will be removed after calculating.\n\t\t// Add two rows and read styles from the first one. \n\t\t// Some skins (e.g. material) define special styles for the last row, so we add a couple and read styles from one which is not the :last-child;\n\t\tvar firstRow = createProbeElement();\n\t\tvar secondRow = createProbeElement();\n\n\t\ttargetNode.appendChild(firstRow);\n\t\ttargetNode.appendChild(secondRow);\n\n\t\tvar firstRowCell = firstRow.firstChild;\n\n\t\tvar rowStyles = getComputedStyle(firstRow),\n\t\t\tcellStyles = getComputedStyle(firstRowCell);\n\n\t\tvar params = {\n\t\t\tbottomBorderWidth: rowStyles.getPropertyValue(\"border-bottom-width\").replace(\"px\", \"\"),\n\t\t\trightBorderWidth: cellStyles.getPropertyValue(\"border-right-width\").replace(\"px\", \"\"),\n\t\t\tbottomBorderColor: rowStyles.getPropertyValue(\"border-bottom-color\"),\n\t\t\trightBorderColor: cellStyles.getPropertyValue(\"border-right-color\")\n\t\t};\n\n\t\ttargetNode.removeChild(firstRow);\n\t\ttargetNode.removeChild(secondRow);\n\n\t\treturn params;\n\t}\n\n\treturn {\n\t\trender: renderBgCanvas,\n\t\tdestroy: cleanup\n\t};\n};\n\nexport default {\n\tcreate: function(){\n\t\treturn createStaticBgHelper(utils, env);\n\t}\n};\n\n","import ScaleHelper from \"./scales_ignore\";\nimport eventable from \"../../../utils/eventable\";\nimport * as utils from \"../../../utils/utils\";\nimport * as helpers from \"../../../utils/helpers\";\nimport topPositionMixin from \"../row_position_mixin\";\nimport canvasRender from \"./tasks_canvas_render\";\nimport createLayerConfig from \"./timeline_layers\";\n\nvar Timeline = function(parent, config, factory, gantt){\n\tthis.$config = utils.mixin({}, config || {});\n\tthis.$scaleHelper = new ScaleHelper(gantt);\n\tthis.$gantt = gantt;\n\tthis._posFromDateCache = {};\n\tthis._timelineDragScroll = null;\n\tutils.mixin(this, topPositionMixin(this));\n\teventable(this);\n};\n\nTimeline.prototype = {\n\tinit: function(container) {\n\t\tcontainer.innerHTML += \"<div class='gantt_task' style='width:inherit;height:inherit;'></div>\";\n\t\tthis.$task = container.childNodes[0];\n\n\t\tthis.$task.innerHTML = \"<div class='gantt_task_scale'></div><div class='gantt_data_area'></div>\";\n\t\tthis.$task_scale = this.$task.childNodes[0];\n\n\t\tthis.$task_data = this.$task.childNodes[1];\n\t\tconst taskBg = \"<div class='gantt_task_bg'></div>\";\n\t\tconst links = \"<div class='gantt_links_area'></div>\";\n\t\tconst taskBars = \"<div class='gantt_bars_area'></div>\";\n\n\t\tconst taskConstraints = \"<div class='gantt_task_constraints'></div>\";\n\t\tconst taskDeadlines = \"<div class='gantt_task_deadlines'></div>\";\n\t\tconst taskBaselines = \"<div class='gantt_task_baselines'></div>\";\n\n\t\tthis.$task_data.innerHTML = taskBg + taskBaselines + links + taskBars + taskConstraints + taskDeadlines;\n\n\t\tthis.$task_bg = this.$task_data.childNodes[0];\n\t\tthis.$task_baselines = this.$task_data.childNodes[1];\n\t\tthis.$task_links = this.$task_data.childNodes[2];\n\t\tthis.$task_bars = this.$task_data.childNodes[3];\n\t\tthis.$task_constraints = this.$task_data.childNodes[4];\n\t\tthis.$task_deadlines = this.$task_data.childNodes[5];\n\n\t\tthis._tasks = {\n\t\t\tcol_width: 0,\n\t\t\twidth: [], // width of each column\n\t\t\tfull_width: 0, // width of all columns\n\t\t\ttrace_x: [],\n\t\t\trendered: {}\n\t\t};\n\n\t\tvar config = this.$getConfig();\n\t\tvar attr = config[this.$config.bind + \"_attribute\"];\n\t\tvar linksAttr = config[this.$config.bindLinks + \"_attribute\"];\n\t\tif(!attr && this.$config.bind){\n\t\t\tattr = \"data-\" + this.$config.bind + \"-id\";\n\t\t}\n\t\tif(!linksAttr && this.$config.bindLinks){\n\t\t\tlinksAttr = \"data-\" + this.$config.bindLinks + \"-id\";\n\t\t}\n\t\tthis.$config.item_attribute = attr || null;\n\t\tthis.$config.link_attribute = linksAttr || null;\n\n\t\tvar layers = this._createLayerConfig();\n\t\tif(!this.$config.layers){\n\t\t\tthis.$config.layers = layers.tasks;\n\t\t}\n\t\tif(!this.$config.linkLayers){\n\t\t\tthis.$config.linkLayers = layers.links;\n\t\t}\n\n\t\tthis._attachLayers(this.$gantt);\n\n\t\tthis.callEvent(\"onReady\", []);\n\t\t//this.refresh();\n\t\tif (this.$gantt.ext.dragTimeline) {\n\t\t\tthis._timelineDragScroll = this.$gantt.ext.dragTimeline.create();\n\t\t\tthis._timelineDragScroll.attach(this);\n\t\t}\n\t},\n\n\tsetSize: function(width, height){\n\t\tvar config = this.$getConfig();\n\n\t\tif(width*1 === width){\n\t\t\tthis.$config.width = width;\n\t\t}\n\t\tif(height*1 === height){\n\n\t\t\tthis.$config.height = height;\n\t\t\tvar dataHeight = Math.max(this.$config.height - config.scale_height);\n\t\t\tthis.$task_data.style.height = dataHeight + 'px';\n\t\t}\n\n\t\tthis.refresh();\n\t\tthis.$task_bg.style.backgroundImage = \"\";\n\n\t\tif(config.smart_rendering && this.$config.rowStore){\n\t\t\tthis.$task_bg.style.height = this.getTotalHeight() +\"px\";\n\t\t}else{\n\t\t\tthis.$task_bg.style.height = \"\";\n\t\t}\n\n\t\tvar scale = this._tasks;\n\t\t//timeline area layers\n\t\tvar data_els = this.$task_data.childNodes;\n\t\tfor(var i= 0, len = data_els.length; i < len; i++){\n\t\t\tvar el = data_els[i];\n\t\t\tif(el.hasAttribute(\"data-layer\") && el.style)\n\t\t\t\tel.style.width = scale.full_width + \"px\";\n\t\t}\n\t},\n\n\tisVisible: function(){\n\t\tif(this.$parent && this.$parent.$config){\n\t\t\treturn !this.$parent.$config.hidden;\n\t\t}else{\n\t\t\treturn this.$task.offsetWidth;\n\t\t}\n\t},\n\n\tgetSize: function(){\n\t\tvar config = this.$getConfig();\n\t\tvar store = this.$config.rowStore;\n\n\t\tvar contentHeight = store ? this.getTotalHeight() : 0,\n\t\t\tcontentWidth = this.isVisible() ? this._tasks.full_width : 0;\n\n\t\treturn {\n\t\t\tx: this.isVisible() ? this.$config.width : 0,\n\t\t\ty: this.isVisible() ? this.$config.height : 0,\n\t\t\tcontentX: this.isVisible() ? contentWidth : 0,\n\t\t\tcontentY: this.isVisible() ? (config.scale_height + contentHeight) : 0,\n\t\t\tscrollHeight: this.isVisible() ? contentHeight : 0,\n\t\t\tscrollWidth: this.isVisible() ? contentWidth : 0\n\t\t};\n\t},\n\n\tscrollTo: function(left, top){\n\t\tif(!this.isVisible())\n\t\t\treturn;\n\n\t\tvar scrolled = false;\n\n\t\tthis.$config.scrollTop = this.$config.scrollTop || 0;\n\t\tthis.$config.scrollLeft = this.$config.scrollLeft || 0;\n\t\tif(top*1 === top){\n\t\t\tthis.$config.scrollTop = top;\n\t\t\tthis.$task_data.scrollTop = this.$config.scrollTop;\n\t\t\tscrolled = true;\n\t\t}\n\t\tif (left*1 === left){\n\t\t\tthis.$task.scrollLeft = left;\n\t\t\tthis.$config.scrollLeft = this.$task.scrollLeft;\n\t\t\tthis._refreshScales();\n\t\t\tscrolled = true;\n\t\t}\n\n\t\tif(scrolled){\n\t\t\tthis.callEvent(\"onScroll\", [this.$config.scrollLeft, this.$config.scrollTop]);\n\t\t}\n\t},\n\n\t_refreshScales: function _refreshScales() {\n\t\tif(!this.isVisible())\n\t\t\treturn;\n\n\t\tvar config = this.$getConfig();\n\t\tif (!config.smart_scales) return;\n\n\t\tvar viewPort = this.getViewPort();\n\n\t\tvar scales = this._scales;\n\t\tthis.$task_scale.innerHTML = this._getScaleChunkHtml(scales, viewPort.x, viewPort.x_end);\n\t},\n\n\tgetViewPort: function(){\n\t\tvar scrollLeft = this.$config.scrollLeft || 0;\n\t\tvar scrollTop = this.$config.scrollTop || 0;\n\t\tvar height = this.$config.height || 0;\n\t\tvar width = this.$config.width || 0;\n\t\treturn {\n\t\t\ty: scrollTop,\n\t\t\ty_end: scrollTop + height,\n\t\t\tx: scrollLeft,\n\t\t\tx_end: scrollLeft + width,\n\t\t\theight: height,\n\t\t\twidth: width\n\t\t};\n\t},\n\n\t_createLayerConfig: createLayerConfig,\n\n\t_attachLayers: function(gantt){\n\t\tthis._taskLayers = [];\n\t\tthis._linkLayers = [];\n\n\t\tvar self = this;\n\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\n\t\tif(this.$config.bind){\n\n\t\t\tthis._bindStore();\n\t\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\n\t\t\tif(!taskRenderer){\n\t\t\t\ttaskRenderer = layers.createDataRender({\n\t\t\t\t\tname: this.$config.bind,\n\t\t\t\t\tdefaultContainer: function(){ return self.$task_data;}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttaskRenderer.container = function(){ return self.$task_data;};\n\n\t\t\tvar taskLayers = this.$config.layers;\n\t\t\tfor(var i = 0; taskLayers && i < taskLayers.length; i++){\n\t\t\t\tvar layer = taskLayers[i];\n\n\t\t\t\tif(typeof layer == \"string\"){\n\t\t\t\t\tlayer = this.$gantt.$ui.layers[layer]();\n\t\t\t\t}\n\n\t\t\t\tif(typeof layer == \"function\" || (layer && layer.render && layer.update)){\n\t\t\t\t\tlayer = {renderer: layer};\n\t\t\t\t}\n\n\t\t\t\tlayer.view = this;\n\n\t\t\t\tvar bar_layer = taskRenderer.addLayer(layer);\n\t\t\t\tthis._taskLayers.push(bar_layer);\n\t\t\t\tif(layer.expose){\n\t\t\t\t\tthis._taskRenderer = taskRenderer.getLayer(bar_layer);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._initStaticBackgroundRender();\n\t\t}\n\n\t\tif(this.$config.bindLinks){\n\t\t\tself.$config.linkStore = self.$gantt.getDatastore(self.$config.bindLinks);\n\n\t\t\tvar linkRenderer = layers.getDataRender(this.$config.bindLinks);\n\n\t\t\tif(!linkRenderer){\n\t\t\t\tlinkRenderer = layers.createDataRender({\n\t\t\t\t\tname: this.$config.bindLinks,\n\t\t\t\t\tdefaultContainer: function(){ return self.$task_data;}\n\t\t\t\t});\n\t\t\t}\n\t\t\tvar linkLayers = this.$config.linkLayers;\n\t\t\tfor(var i = 0; linkLayers && i < linkLayers.length; i++){\n\n\t\t\t\tif(typeof layer == \"string\"){\n\t\t\t\t\tlayer = this.$gantt.$ui.layers[layer]();\n\t\t\t\t}\n\n\t\t\t\tvar layer = linkLayers[i];\n\t\t\t\tlayer.view = this;\n\t\t\t//\tlayer.getViewPort = getViewPort;\n\t\t\t//\tsubscribeSmartRender(layer);\n\t\t\t\tvar linkLayer = linkRenderer.addLayer(layer);\n\t\t\t\tthis._taskLayers.push(linkLayer);\n\t\t\t\tif(linkLayers[i].expose){\n\t\t\t\t\tthis._linkRenderer = linkRenderer.getLayer(linkLayer);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_initStaticBackgroundRender: function(){\n\t\tvar self = this;\n\t\tvar staticRender = canvasRender.create();\n\t\tvar store = self.$config.rowStore;\n\t\tif(!store) return;\n\n\t\tthis._staticBgHandler = store.attachEvent(\"onStoreUpdated\", function(id, item, mode){\n\t\t\tif(id !== null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(!self.isVisible())\n\t\t\t\treturn;\n\t\t\tvar config = self.$getConfig();\n\t\t\tif(config.static_background || config.timeline_placeholder) {\n\t\t\t\tvar store = self.$gantt.getDatastore(self.$config.bind);\n\t\t\t\tvar staticBgContainer = self.$task_bg_static;\n\t\t\t\tif(!staticBgContainer){\n\t\t\t\t\tstaticBgContainer = document.createElement(\"div\");\n\t\t\t\t\tstaticBgContainer.className = \"gantt_task_bg\";\n\t\t\t\t\tself.$task_bg_static = staticBgContainer;\n\t\t\t\t\tif(self.$task_bg.nextSibling){\n\t\t\t\t\t\tself.$task_data.insertBefore(staticBgContainer, self.$task_bg.nextSibling);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tself.$task_data.appendChild(staticBgContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (store) {\n\t\t\t\t\tvar staticBackgroundHeight = self.getTotalHeight();\n\t\t\t\t\tif (config.timeline_placeholder){\n\t\t\t\t\t\tstaticBackgroundHeight = config.timeline_placeholder.height || self.$task_data.offsetHeight || 99999;\n\t\t\t\t\t}\n\t\t\t\t\tstaticRender.render(staticBgContainer, config, self.getScale(), staticBackgroundHeight, self.getItemHeight(item ? item.id : null));\n\t\t\t\t}\n\t\t\t}else if(config.static_background){\n\t\t\t\tif(self.$task_bg_static && self.$task_bg_static.parentNode){\n\t\t\t\t\tself.$task_bg_static.parentNode.removeChild(self.$task_bg_static);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.attachEvent(\"onDestroy\", function () {\n\t\t\tstaticRender.destroy();\n\t\t});\n\t\tthis._initStaticBackgroundRender = function(){};//init once\n\t},\n\n\t_clearLayers: function(gantt){\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\t\tvar linkRenderer = layers.getDataRender(this.$config.bindLinks);\n\n\t\tif (this._taskLayers) {\n\t\t\tfor(var i = 0; i < this._taskLayers.length; i++){\n\t\t\t\ttaskRenderer.removeLayer(this._taskLayers[i]);\n\t\t\t}\n\t\t}\n\t\tif (this._linkLayers) {\n\t\t\tfor(var i = 0; i < this._linkLayers.length; i++){\n\t\t\t\tlinkRenderer.removeLayer(this._linkLayers[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis._linkLayers = [];\n\t\tthis._taskLayers = [];\n\t},\n\n\t_render_tasks_scales: function _render_tasks_scales() {\n\t\tvar config = this.$getConfig();\n\n\t\tvar scales_html = \"\",\n\t\t\touter_width = 0,\n\t\t\tscale_height = 0;\n\n\t\tvar state = this.$gantt.getState();\n\n\t\tif (this.isVisible()) {\n\t\t\tvar helpers = this.$scaleHelper;\n\t\t\tvar scales = this._getScales();\n\t\t\tscale_height = config.scale_height;\n\n\t\t\tvar availWidth = this.$config.width;\n\t\t\tif(config.autosize == \"x\" || config.autosize == \"xy\"){\n\t\t\t\tavailWidth = Math.max(config.autosize_min_width, 0);\n\t\t\t}\n\n\t\t\tvar cfgs = helpers.prepareConfigs(scales, config.min_column_width, availWidth, scale_height - 1, state.min_date, state.max_date, config.rtl);\n\t\t\tvar cfg = this._tasks = cfgs[cfgs.length - 1];\n\t\t\tthis._scales = cfgs;\n\t\t\tthis._posFromDateCache = {};\n\n\t\t\tscales_html = this._getScaleChunkHtml(cfgs, 0, this.$config.width);\n\n\t\t\touter_width = cfg.full_width + \"px\";//cfg.full_width + (this._scroll_sizes().y ? scrollSizes.scroll_size : 0) + \"px\";\n\t\t\tscale_height += \"px\";\n\t\t}\n\n\t\tthis.$task_scale.style.height = scale_height;\n\n\t\tthis.$task_data.style.width =\n\t\t\tthis.$task_scale.style.width = outer_width;\n\n\t\tthis.$task_scale.innerHTML = scales_html;\n\n\t},\n\n\t_getScaleChunkHtml: function _get_scale_chunk_html (scales, fromPos, toPos) {\n\t\tvar templates = this.$gantt.templates;\n\t\tvar html = [];\n\n\t\tvar css = templates.scale_row_class;\n\t\tfor (var i = 0; i < scales.length; i++) {\n\t\t\tvar cssClass = \"gantt_scale_line\";\n\t\t\tvar tplClass = css(scales[i]);\n\t\t\tif (tplClass) {\n\t\t\t\tcssClass += \" \" + tplClass;\n\t\t\t}\n\n\t\t\thtml.push(\"<div class=\\\"\" + cssClass + \"\\\" style=\\\"height:\" + (scales[i].height) +\n\t\t\t\t\"px;position:relative;line-height:\" + (scales[i].height) + \"px\\\">\" + this._prepareScaleHtml(scales[i], fromPos, toPos, i) + \"</div>\");\n\t\t}\n\n\t\treturn html.join(\"\");\n\t},\n\t_prepareScaleHtml: function _prepare_scale_html(config, fromPos, toPos, index) {\n\t\tvar globalConfig = this.$getConfig();\n\t\tvar globalTemplates = this.$gantt.templates;\n\n\t\tvar cells = [];\n\t\tvar date = null, css = null;\n\n\t\tvar content = config.format || config.template || config.date;\n\n\t\tif(typeof content === \"string\"){\n\t\t\tcontent = this.$gantt.date.date_to_str(content);\n\t\t}\n\n\t\tvar startIndex = 0,\n\t\t\tendIndex = config.count;\n\n\t\tif (globalConfig.smart_scales && (!isNaN(fromPos) && !isNaN(toPos))) {\n\t\t\tstartIndex = helpers.findBinary(config.left, fromPos);\n\t\t\tendIndex = helpers.findBinary(config.left, toPos) + 1;\n\t\t}\n\n\t\tcss = config.css || function () {\n\t\t\t};\n\t\tif (!config.css && globalConfig.inherit_scale_class) {\n\t\t\tcss = globalTemplates.scale_cell_class;\n\t\t}\n\n\t\tfor (var i = startIndex; i < endIndex; i++) {\n\t\t\tif (!config.trace_x[i]) break;\n\n\t\t\tdate = new Date(config.trace_x[i]);\n\t\t\tvar value = content.call(this, date),\n\t\t\t\twidth = config.width[i],\n\t\t\t\theight = config.height,\n\t\t\t\tleft = config.left[i],\n\t\t\t\tstyle = \"\",\n\t\t\t\ttemplate = \"\",\n\t\t\t\tcssclass = \"\";\n\n\t\t\tif (width) {\n\t\t\t\tvar position = globalConfig.smart_scales ? (\"position:absolute;left:\" + left + \"px\") : \"\";\n\n\t\t\t\tstyle = \"width:\" + (width) + \"px;\" + position;\n\t\t\t\t// GS-1188: Display the scale value in the viewport for long cells\n\t\t\t\tconst viewPort = this.getViewPort();\n\t\t\t\tconst floatConfig = (globalConfig.scales[index] || {}).sticky; // for old scale settings\n\n\t\t\t\tlet labelPosition = '';\n\t\t\t\tconst approxLabelWidth = 70;\n\t\t\t\t// if sticky config is not specified - sticky labels are enabled for long cells only\n\t\t\t\tif ((floatConfig !== false && width > approxLabelWidth) || floatConfig === true) {\n\t\t\t\t\t\n\t\t\t\t\tif (left < viewPort.x && left + width/2 - approxLabelWidth/2 < viewPort.x){\n\t\t\t\t\t\tlabelPosition = ` style='position:absolute;left: ${viewPort.x  - left + 10}px;' `;\n\t\t\t\t\t} else if(left + width/2 + approxLabelWidth/2 > viewPort.x_end && width > approxLabelWidth){\n\t\t\t\t\t\tlet labelPos = viewPort.x_end - left - 10;\n\t\t\t\t\t\tlet translateValue = \"-100%\";\n\t\t\t\t\t\tif(labelPos < approxLabelWidth) {\n\t\t\t\t\t\t\tlabelPos = approxLabelWidth;\n\t\t\t\t\t\t\ttranslateValue = `-${labelPos}px`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlabelPosition = ` style='position:absolute;left: ${labelPos}px;transform: translate(${translateValue},0);' `;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcssclass = \"gantt_scale_cell\" + (i == config.count - 1 ? \" gantt_last_cell\" : \"\");\n\n\t\t\t\ttemplate = css.call(this, date);\n\t\t\t\tif (template) cssclass += \" \" + template;\n\n\t\t\t\tvar ariaAttr = this.$gantt._waiAria.getTimelineCellAttr(value);\n\t\t\t\tvar cell = `<div class='${cssclass}' ${ariaAttr} style='${style}'><span ${labelPosition}>${value}</span></div>`;\n\t\t\t\tcells.push(cell);\n\t\t\t} else {\n\t\t\t\t//do not render ignored cells\n\t\t\t}\n\n\t\t}\n\t\treturn cells.join(\"\");\n\t},\n\tdateFromPos: function dateFromPos(x) {\n\t\tvar scale = this._tasks;\n\t\tif (x < 0 || x > scale.full_width || !scale.full_width) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar ind = helpers.findBinary(this._tasks.left, x);\n\t\tvar summ = this._tasks.left[ind];\n\n\t\tvar col_width = scale.width[ind] || scale.col_width;\n\t\tvar part = 0;\n\t\tif (col_width) {\n\t\t\tpart = (x - summ) / col_width;\n\t\t\tif(scale.rtl){\n\t\t\t\tpart = 1 - part;\n\t\t\t}\n\n\t\t}\n\n\t\tvar unit = 0;\n\t\tif (part) {\n\t\t\tunit = this._getColumnDuration(scale, scale.trace_x[ind]);\n\t\t}\n\n\t\tvar date = new Date(scale.trace_x[ind].valueOf() + Math.round(part * unit));\n\t\treturn date;\n\t},\n\tposFromDate: function posFromDate(date) {\n\t\tif (!this.isVisible())\n\t\t\treturn 0;\n\n\t\tif(!date){\n\t\t\treturn 0;\n\t\t}\n\n\t\tvar dateValue = String(date.valueOf());\n\n\t\tif(this._posFromDateCache[dateValue] !== undefined){\n\t\t\treturn this._posFromDateCache[dateValue];\n\t\t}\n\t\tvar ind = this.columnIndexByDate(date);\n\t\tthis.$gantt.assert(ind >= 0, \"Invalid day index\");\n\n\t\tvar wholeCells = Math.floor(ind);\n\t\tvar partCell = ind % 1;\n\n\t\tvar pos = this._tasks.left[Math.min(wholeCells, this._tasks.width.length - 1)];\n\t\tif (wholeCells == this._tasks.width.length)\n\t\t\tpos += this._tasks.width[this._tasks.width.length - 1];\n\t\t//for(var i=1; i <= wholeCells; i++)\n\t\t//\tpos += gantt._tasks.width[i-1];\n\n\t\tif (partCell) {\n\t\t\tif (wholeCells < this._tasks.width.length) {\n\t\t\t\tpos += this._tasks.width[wholeCells] * (partCell % 1);\n\t\t\t} else {\n\t\t\t\tpos += 1;\n\t\t\t}\n\n\t\t}\n\n\t\tvar roundPos = Math.round(pos);\n\t\tthis._posFromDateCache[dateValue] = roundPos;\n\t\treturn Math.round(roundPos);\n\t},\n\n\t_getNextVisibleColumn: function (startIndex, columns, ignores) {\n\t\t// iterate columns to the right\n\t\tvar date = +columns[startIndex];\n\t\tvar visibleDateIndex = startIndex;\n\t\twhile (ignores[date]) {\n\t\t\tvisibleDateIndex++;\n\t\t\tdate = +columns[visibleDateIndex];\n\t\t}\n\n\t\treturn visibleDateIndex;\n\t},\n\t_getPrevVisibleColumn: function (startIndex, columns, ignores) {\n\t\t// iterate columns to the left\n\t\tvar date = +columns[startIndex];\n\t\tvar visibleDateIndex = startIndex;\n\t\twhile (ignores[date]) {\n\t\t\tvisibleDateIndex--;\n\t\t\tdate = +columns[visibleDateIndex];\n\t\t}\n\t\treturn visibleDateIndex;\n\t},\n\t_getClosestVisibleColumn: function (startIndex, columns, ignores) {\n\t\tvar visibleDateIndex = this._getNextVisibleColumn(startIndex, columns, ignores);\n\t\tif (!columns[visibleDateIndex]) {\n\t\t\tvisibleDateIndex =  this._getPrevVisibleColumn(startIndex, columns, ignores);\n\t\t}\n\t\treturn visibleDateIndex;\n\t},\n\tcolumnIndexByDate: function columnIndexByDate(date) {\n\t\tvar pos = new Date(date).valueOf();\n\t\tvar days = this._tasks.trace_x_ascending,\n\t\t\tignores = this._tasks.ignore_x;\n\n\t\tvar state = this.$gantt.getState();\n\n\t\tif (pos <= state.min_date) {\n\t\t\tif(this._tasks.rtl){\n\t\t\t\treturn days.length;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t}\n\n\t\tif (pos >= state.max_date) {\n\t\t\tif(this._tasks.rtl){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn days.length;\n\t\t\t}\n\t\t}\n\n\t\tvar dateIndex = helpers.findBinary(days, pos);\n\n\t\tvar visibleIndex = this._getClosestVisibleColumn(dateIndex, days, ignores);\n\t\tvar visibleDate = days[visibleIndex];\n\t\tvar transition = this._tasks.trace_index_transition;\n\n\t\tif(!visibleDate){\n\t\t\tif(transition){\n\t\t\t\treturn transition[0];\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\n\t\tvar part = ((date - days[visibleIndex]) / this._getColumnDuration(this._tasks, days[visibleIndex]));\n\t\tif(transition){\n\t\t\treturn transition[visibleIndex] + (1 - part);\n\t\t}else{\n\t\t\treturn visibleIndex + part;\n\t\t}\n\t},\n\tgetItemPosition:function (task, start_date, end_date) {\n\t\tvar xLeft, xRight, width;\n\n\t\tlet displayStart = start_date || task.start_date || task.$auto_start_date;\n\t\tlet displayEnd = end_date || task.end_date || task.$auto_end_date;\n\t\tif(this._tasks.rtl){\n\t\t\txRight = this.posFromDate(displayStart);\n\t\t\txLeft = this.posFromDate(displayEnd);\n\t\t}else{\n\t\t\txLeft = this.posFromDate(displayStart);\n\t\t\txRight = this.posFromDate(displayEnd);\n\t\t}\n\t\twidth =  Math.max((xRight - xLeft), 0);\n\n\t\tvar y = this.getItemTop(task.id);\n\n\t\tvar height = this.getBarHeight(task.id);\n\t\tvar rowHeight = this.getItemHeight(task.id);\n\t\treturn {\n\t\t\tleft: xLeft,\n\t\t\ttop: y,\n\t\t\theight: height,\n\t\t\twidth: width,\n\t\t\trowHeight: rowHeight\n\t\t};\n\t},\n\n\tgetBarHeight: function(taskId, isMilestoneRender){\n\t\tvar config = this.$getConfig();\n\n\t\tvar task = this.$config.rowStore.getItem(taskId);\n\t\t// height of the bar item\n\t\tvar height = task.task_height || task.bar_height || config.bar_height || config.task_height;\n\t\tvar rowHeight = this.getItemHeight(taskId);\n\n\t\tif (height == \"full\") {\n\t\t\tvar offset = config.bar_height_padding || 3;\n\t\t\theight = rowHeight - offset;\n\t\t}\n\t\t//item height cannot be bigger than row height\n\t\theight = Math.min(height, rowHeight);\n\t\tif (isMilestoneRender) { // to get correct height for addapting Milestone to the row\n\t\t\theight = Math.round(height / Math.sqrt(2));\n\t\t}\n\t\treturn Math.max(height, 0);\n\t},\n\n\tgetScale: function(){\n\t\treturn this._tasks;\n\t},\n\n\t_getScales: function _get_scales() {\n\t\tvar config = this.$getConfig();\n\t\tvar helpers = this.$scaleHelper;\n\t\tvar scales = [helpers.primaryScale(config)].concat(helpers.getSubScales(config));\n\n\t\thelpers.sortScales(scales);\n\t\treturn scales;\n\t},\n\n\t_getColumnDuration: function _get_coll_duration(scale, date) {\n\t\treturn this.$gantt.date.add(date, scale.step, scale.unit) - date;\n\t},\n\t_bindStore: function () {\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tthis.$config.rowStore = rowStore;\n\t\t\tif(rowStore && !rowStore._timelineCacheAttached){\n\t\t\t\tvar self = this;\n\t\t\t\trowStore._timelineCacheAttached = rowStore.attachEvent(\"onBeforeFilter\", function(){\n\t\t\t\t\tself._resetTopPositionHeight();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\t_unbindStore: function(){\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tif(rowStore && rowStore._timelineCacheAttached){\n\t\t\t\trowStore.detachEvent(rowStore._timelineCacheAttached);\n\t\t\t\trowStore._timelineCacheAttached = false;\n\t\t\t}\n\t\t}\n\t},\n\trefresh: function(){\n\t\tthis._bindStore();\n\n\t\tif(this.$config.bindLinks) {\n\t\t\tthis.$config.linkStore = this.$gantt.getDatastore(this.$config.bindLinks);\n\t\t}\n\n\t\tthis._resetTopPositionHeight();\n\t\tthis._resetHeight();\n\t\tthis._initStaticBackgroundRender();\n\t\tthis._render_tasks_scales();\n\t},\n\n\tdestructor: function(){\n\t\tvar gantt = this.$gantt;\n\t\tthis._clearLayers(gantt);\n\t\tthis._unbindStore();\n\t\tthis.$task = null;\n\t\tthis.$task_scale = null;\n\t\tthis.$task_data = null;\n\t\tthis.$task_bg = null;\n\t\tthis.$task_links = null;\n\t\tthis.$task_bars = null;\n\n\t\tthis.$gantt = null;\n\n\t\tif(this.$config.rowStore){\n\t\t\tthis.$config.rowStore.detachEvent(this._staticBgHandler);\n\t\t\tthis.$config.rowStore = null;\n\t\t}\n\t\tif(this.$config.linkStore){\n\t\t\tthis.$config.linkStore = null;\n\t\t}\n\n\t\tif(this._timelineDragScroll) {\n\t\t\tthis._timelineDragScroll.destructor();\n\t\t\tthis._timelineDragScroll = null;\n\t\t}\n\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\n\t}\n};\n\nexport default Timeline;","import * as helpers from \"../../utils/helpers\";\n\nfunction clearTaskStoreHandler(self) {\n\tif (self._delayRender) {\n\t\tself._delayRender.$cancelTimeout();\n\t}\n\n\tif (!self.$gantt) {\n\t\treturn;\n\t}\n\n\tvar tasks = self.$gantt.$data.tasksStore;\n\tvar ownStore = self.$config.rowStore;\n\n\tvar handlerIdProperty = \"_attached_\" + ownStore.$config.name;\n\tif (self[handlerIdProperty]) {\n\t\ttasks.detachEvent(self[handlerIdProperty]);\n\t\tself[handlerIdProperty] = null;\n\t}\n\n\tif (ownStore.$attachedResourceViewHandler) {\n\t\townStore.detachEvent(ownStore.$attachedResourceViewHandler);\n\t\townStore.$attachedResourceViewHandler = null;\n\n\t\ttasks.detachEvent(ownStore.$attachedTaskStoreHandler);\n\t\townStore.$attachedTaskStoreHandler = null;\n\t}\n}\n\nfunction createMixin(_super){\n\n\tvar initGrid = _super.prototype.init,\n\t\tdestroyGrid = _super.prototype.destructor;\n\n\treturn {\n\t\tinit: function() {\n\t\t\tinitGrid.apply(this, arguments);\n\t\t\tthis._linkToTaskStore();\n\t\t},\n\n\t\tdestructor: function() {\n\t\t\tclearTaskStoreHandler(this);\n\t\t\tdestroyGrid.apply(this, arguments);\n\t\t},\n\n\t\tpreviousDragId: null,\n\t\trelevantResources: null,\n\n\t\t_linkToTaskStore: function () {\n\t\t\tif (this.$config.rowStore && this.$gantt.$data.tasksStore) {\n\t\t\t\tvar tasks = this.$gantt.$data.tasksStore;\n\t\t\t\tvar ownStore = this.$config.rowStore;\n\t\t\t\tclearTaskStoreHandler(this);\n\n\t\t\t\tvar self = this;\n\t\t\t\tvar delayRender = helpers.delay(function() {\n\t\t\t\t\tif (self.$gantt.getState().lightbox) {\n\t\t\t\t\t\tdelayRender();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst linkedStore = self.$config.rowStore;\n\n\t\t\t\t\t\t// Repaint only relevant resources for task drag\n\t\t\t\t\t\tconst repaintStack = self._getRelevantResources();\n\t\t\t\t\t\tif (repaintStack){\n\t\t\t\t\t\t\tif (repaintStack == \"nothing_to_repaint\"){\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlinkedStore._quick_refresh = true;\n\t\t\t\t\t\t\tself.relevantResources.forEach(function(id){\n\t\t\t\t\t\t\t\tlinkedStore.refresh(id);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tlinkedStore._quick_refresh = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// because rowstore could be changed during timeout\n\t\t\t\t\t\t\tlinkedStore.refresh();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, 300);\n\t\t\t\tthis._delayRender = delayRender;\n\t\t\t\tvar handlerIdProperty = \"_attached_\" + ownStore.$config.name;\n\n\t\t\t\tif (!self[handlerIdProperty]) {\n\t\t\t\t\tself[handlerIdProperty] = tasks.attachEvent(\"onStoreUpdated\", function(){\n\t\t\t\t\t\tif(!delayRender.$pending && !this._skipResourceRepaint){\n\t\t\t\t\t\t\t// don't repaint if we update progress\n\t\t\t\t\t\t\tconst state = self.$gantt.getState();\n\t\t\t\t\t\t\tif (state.drag_mode == \"progress\"){\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t} else if (state.drag_mode && state.drag_id){\n\t\t\t\t\t\t\t\t// we need it here because if you started dragging a task and quickly stopped the drag_id is removed \n\t\t\t\t\t\t\t\t// from the state before we record it, so we cannot repaint only the relevant resources\n\t\t\t\t\t\t\t\tself.previousDragId = state.drag_id;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdelayRender();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.$gantt.attachEvent(\"onDestroy\", function() {\n\t\t\t\t\t// detach events to don't call delayed tasks\n\t\t\t\t\tclearTaskStoreHandler(self);\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\n\t\t\t\tif (!ownStore.$attachedResourceViewHandler) {\n\t\t\t\t\townStore.$attachedResourceViewHandler = ownStore.attachEvent(\"onBeforeFilter\", function() {\n\t\t\t\t\t\tif (self.$gantt.getState().lightbox) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (delayRender.$pending) {\n\t\t\t\t\t\t\tdelayRender.$cancelTimeout();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself._updateNestedTasks();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t});\n\n\t\t\t\t\townStore.$attachedTaskStoreHandler = tasks.attachEvent(\"onAfterDelete\", function(){\n\t\t\t\t\t\townStore._mark_recompute = true;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_getRelevantResources: function (){\n\t\t\t// GS-2199. process_resource_assignments is disabled,\n\t\t\t// so we cannot get only the relevant assignment resources\n\t\t\tif (!this.$gantt.getTaskAssignments){\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst state = this.$gantt.getState();\n\t\t\tconst linkedStore = this.$config.rowStore;\n\n\t\t\tlet resourceIds = [];\n\t\t\tif (state.drag_mode && state.drag_id){\n\t\t\t\tif (this.previousDragId == state.drag_id){ // we continue dragging the task\n\t\t\t\t\tif (this.relevantResources) {\n\t\t\t\t\t\treturn this.relevantResources;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresourceIds = this._getIdsFromAssignments(this.previousDragId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // we started the task drag\n\t\t\t\t\tthis.previousDragId = state.drag_id;\n\t\t\t\t\tresourceIds = this._getIdsFromAssignments(this.previousDragId);\n\t\t\t\t}\n\t\t\t} else if (this.previousDragId){ // finished task drag, but the resources are still the same\n\t\t\t\tresourceIds = this._getIdsFromAssignments(this.previousDragId);\n\t\t\t\tthis.previousDragId = null;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif (!resourceIds.length){\n\t\t\t\treturn this.relevantResources = \"nothing_to_repaint\";\n\t\t\t}\n\t\t\t\n\t\t\tresourceIds.forEach(function(resourceId){\n\t\t\t\tlinkedStore.eachParent(function(parent){\n\t\t\t\t\tresourceIds.push(parent.id);\n\t\t\t\t}, resourceId);\n\t\t\t});\n\n\t\t\treturn this.relevantResources = [...new Set(resourceIds)];\n\t\t},\n\n\t\t_getIdsFromAssignments: function(id){\n\t\t\tconst gantt = this.$gantt;\n\t\t\tconst resourceIds = [];\n\n\t\t\tconst task = gantt.getTask(id);\n\t\t\tlet assignments = gantt.getTaskAssignments(id);\n\t\t\tassignments.forEach(function(assignment){\n\t\t\t\tresourceIds.push(assignment.resource_id);\n\t\t\t});\n\n\t\t\t// get child assignments when dragging project task\n\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project) {\n\t\t\t\tgantt.eachTask(function(child){\n\t\t\t\t\tconst childAssignments = gantt.getTaskAssignments(child.id);\n\t\t\t\t\tchildAssignments.forEach(function(assignment){\n\t\t\t\t\t\tresourceIds.push(assignment.resource_id);\n\t\t\t\t\t});\n\t\t\t\t}, id);\n\t\t\t}\n\n\t\t\t// get assignments of other selected tasks\n\t\t\tif (gantt.config.drag_multiple && gantt.getSelectedTasks){\n\t\t\t\tconst selectedIds = gantt.getSelectedTasks();\n\t\t\t\tselectedIds.forEach(function(selectedId){\n\t\t\t\t\tconst selectedAssignments = gantt.getTaskAssignments(selectedId);\n\t\t\t\t\tselectedAssignments.forEach(function(assignment){\n\t\t\t\t\t\tresourceIds.push(assignment.resource_id);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn resourceIds;\n\t\t},\n\n\t\t_updateNestedTasks: function(){\n\t\t\tvar gantt = this.$gantt;\n\t\t\tvar resourceStore = gantt.getDatastore(gantt.config.resource_store);\n\t\t\tif (!resourceStore.$config.fetchTasks) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tresourceStore.silent(function(){\n\t\t\t\tvar toAddArray = [];\n\t\t\t\tvar toAdd = {};\n\t\t\t\tvar toDelete = {};\n\n\t\t\t\tresourceStore.eachItem(function(resource){\n\t\t\t\t\tif (resource.$role == \"task\") {\n\t\t\t\t\t\ttoDelete[resource.id] = true;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar assignments = gantt.getResourceAssignments(resource.id);\n\t\t\t\t\tvar addedTasks = {};\n\n\t\t\t\t\t// GS-1505. We need to sort assignments before updating tasks. \n\t\t\t\t\t// Iterating them without that will affect the order of featched tasks in the resource store\n\t\t\t\t\tassignments.sort(function (a, b) {\n\t\t\t\t\t\tconst resourceData = resourceStore.pull;\n\t\t\t\t\t\tconst resource1 = resourceData[`${a.task_id}_${a.resource_id}`];\n\t\t\t\t\t\tconst resource2 = resourceData[`${b.task_id}_${b.resource_id}`];\n\t\t\t\t\t\tif (resource1 && resource2) {\n\t\t\t\t\t\t\treturn resource1.$local_index - resource2.$local_index;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tassignments.forEach(function(a) {\n\t\t\t\t\t\tif(addedTasks[a.task_id] || !gantt.isTaskExists(a.task_id)){\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\taddedTasks[a.task_id] = true;\n\n\t\t\t\t\t\tvar task = gantt.getTask(a.task_id);\n\t\t\t\t\t\tvar copy;\n\t\t\t\t\t\t//GS-2711: deep copy from task\n\t\t\t\t\t\tif(resourceStore.$config.copyOnParse){\n\t\t\t\t\t\t\tcopy = gantt.copy(task);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcopy = Object.create(task);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcopy.id = task.id + '_' + resource.id;\n\n\t\t\t\t\t\tcopy.$task_id = task.id;\n\t\t\t\t\t\tcopy.$resource_id = resource.id;\n\t\t\t\t\t\tcopy[resourceStore.$parentProperty] = resource.id;\n\t\t\t\t\t\tcopy.$role = \"task\";\n\t\t\t\t\t\ttoAddArray.push(copy);\n\t\t\t\t\t\ttoAdd[copy.id] = true;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tfor (var id in toDelete) {\n\t\t\t\t\tif (!toAdd[id]) {\n\t\t\t\t\t\tresourceStore.removeItem(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(toAddArray.length){\n\t\t\t\t\tresourceStore.parse(toAddArray);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n}\n\nexport default createMixin;","\nexport default function(){\n\tvar self = this;\n\tvar taskFilter = function(){\n\t\treturn self.isVisible();\n\t};\n\n\tvar barVisible = function(id, task){\n\t\treturn !task.hide_bar;\n\t};\n\n\tconst gantt = this.$gantt;\n\n\tconst isTimedProject = function(id, task){\n\t\treturn task.type === gantt.config.types.project && task.auto_scheduling === false;\n\t};\n\tconst isNotTimedProject = function(id, task){\n\t\treturn !isTimedProject(id, task);\n\t};\n\n\tvar taskLayers = [\n\t\t{\n\t\t\texpose: true,\n\t\t\trenderer: this.$gantt.$ui.layers.taskBar(),\n\t\t\tcontainer: this.$task_bars,\n\t\t\tfilter: [taskFilter, barVisible, isNotTimedProject]\n\t\t},\n\t\t{\n\t\t\trenderer: this.$gantt.$ui.layers.timedProjectBar(),\n\t\t\tfilter: [taskFilter, isTimedProject],\n\t\t\tcontainer: this.$task_bars,\n\t\t\tappend: true\n\t\t},\n\t\t{\n\t\t\trenderer: this.$gantt.$ui.layers.taskSplitBar(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_bars,\n\t\t\tappend: true\n\t\t},\n\t\t{\n\t\t\trenderer: this.$gantt.$ui.layers.taskRollupBar(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_bars,\n\t\t\tappend: true\n\t\t},\n\t\t{\n\t\t\trenderer: this.$gantt.$ui.layers.taskConstraints(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_constraints,\n\t\t\tappend: false\n\t\t}\n\t];\n\n\tif(gantt.config.deadlines){\n\t\ttaskLayers.push({\n\t\t\trenderer: this.$gantt.$ui.layers.taskDeadline(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_deadlines,\n\t\t\tappend: false\n\t\t});\n\t}\n\n\tif(gantt.config.baselines){\n\t\ttaskLayers.push({\n\t\t\trenderer: this.$gantt.$ui.layers.taskBaselines(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_baselines,\n\t\t\tappend: false\n\t\t});\n\t}\n\n\ttaskLayers.push({\n\t\trenderer: this.$gantt.$ui.layers.taskBg(),\n\t\tcontainer: this.$task_bg,\n\t\tfilter: [\n\t\t\t//function(){\n\t\t\t//\treturn !self.$getConfig().static_background;\n\t\t\t//},\n\t\t\ttaskFilter\n\t\t]\n\t});\n\n\tvar linkLayers = [\n\t\t{\n\t\t\texpose: true,\n\t\t\trenderer: this.$gantt.$ui.layers.link(),\n\t\t\tcontainer: this.$task_links,\n\t\t\tfilter: [taskFilter]\n\t\t}\n\t];\n\n\treturn {\n\t\ttasks: taskLayers,\n\t\tlinks: linkLayers\n\t};\n\n};","import * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport resourceStoreMixin from \"../resource_store_mixin\";\nimport Grid from \"./grid\";\nimport __extends from \"../../../utils/extends\";\n\nvar ResourceGrid = (function (_super) {\n\n\tfunction ResourceGrid(parent, config, factory, gantt) {\n\t\treturn _super.apply(this, arguments) || this;\n\t}\n\n\t__extends(ResourceGrid, _super);\n\n\tutils.mixin(ResourceGrid.prototype, {\n\t\tinit: function(){\n\t\t\tif(this.$config.bind === undefined){\n\t\t\t\tthis.$config.bind = this.$getConfig().resource_store;\n\t\t\t}\n\t\t\t_super.prototype.init.apply(this, arguments);\n\t\t},\n\n\t\t_initEvents: function(){\n\t\t\tvar gantt = this.$gantt;\n\t\t\t_super.prototype._initEvents.apply(this, arguments);\n\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_row\", gantt.bind(function (e, id, trg) {\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tif(!store) return true;\n\n\t\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\n\t\t\t\tif(target){\n\t\t\t\t\tstore.select(target.getAttribute(this.$config.item_attribute));\n\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}, this), this.$grid);\n\n\t\t}\n\n\t}, true);\n\n\tutils.mixin(ResourceGrid.prototype, resourceStoreMixin(ResourceGrid), true);\n\n\treturn ResourceGrid;\n})(Grid);\n\nexport default ResourceGrid;","import * as utils from \"../../../utils/utils\";\nimport Timeline from \"./timeline\";\nimport resourceStoreMixin from \"../resource_store_mixin\";\nimport __extends from \"../../../utils/extends\";\n\nvar ResourceTimeline = (function (_super) {\n\n\tfunction ResourceTimeline(parent, config, factory, gantt) {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\tself.$config.bindLinks = null;\n\t\treturn self;\n\t}\n\n\t__extends(ResourceTimeline, _super);\n\n\tutils.mixin(ResourceTimeline.prototype, {\n\t\tinit: function(){\n\t\t\t\n\t\t\tif(this.$config.bind === undefined){\n\t\t\t\tthis.$config.bind = this.$getConfig().resource_store;\n\t\t\t}\n\t\t\t_super.prototype.init.apply(this, arguments);\n\t\t},\n\t\t_createLayerConfig: function() {\n\t\t\tvar self = this;\n\t\t\tvar taskFilter = function() {\n\t\t\t\treturn self.isVisible();\n\t\t\t};\n\n\t\t\tvar taskLayers = [\n\t\t\t\t{\n\t\t\t\t\trenderer: this.$gantt.$ui.layers.resourceRow(),\n\t\t\t\t\tcontainer: this.$task_bars,\n\t\t\t\t\tfilter: [taskFilter]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trenderer: this.$gantt.$ui.layers.taskBg(),\n\t\t\t\t\tcontainer: this.$task_bg,\n\t\t\t\t\tfilter: [taskFilter]\n\t\t\t\t}\n\t\t\t];\n\n\t\t\tvar linkLayers = [];\n\n\t\t\treturn {\n\t\t\t\ttasks: taskLayers,\n\t\t\t\tlinks: linkLayers\n\t\t\t};\n\t\t}\n\n\t}, true);\n\n\tutils.mixin(ResourceTimeline.prototype, resourceStoreMixin(ResourceTimeline), true);\n\n\treturn ResourceTimeline;\n})(Timeline);\n\n\nexport default ResourceTimeline;\n\n\n","import * as utils from \"../../../utils/utils\";\nimport ResourceTimeline from \"./resource_timeline\";\nimport resourceStoreMixin from \"../resource_store_mixin\";\nimport __extends from \"../../../utils/extends\";\n\nvar ResourceHistogram = (function (_super) {\n\n\tfunction ResourceHistogram(parent, config, factory, gantt) {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\tself.$config.bindLinks = null;\n\t\treturn self;\n\t}\n\n\t__extends(ResourceHistogram, _super);\n\n\tutils.mixin(ResourceHistogram.prototype, {\n\t\t_createLayerConfig: function(){\n\t\t\tvar self = this;\n\t\t\tvar taskFilter = function(){\n\t\t\t\treturn self.isVisible();\n\t\t\t};\n\n\t\t\tvar taskLayers = [\n\t\t\t\t{\n\t\t\t\t\trenderer: this.$gantt.$ui.layers.resourceHistogram(),\n\t\t\t\t\tcontainer: this.$task_bars,\n\t\t\t\t\tfilter: [taskFilter]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trenderer: this.$gantt.$ui.layers.taskBg(),\n\t\t\t\t\tcontainer: this.$task_bg,\n\t\t\t\t\tfilter: [taskFilter]\n\t\t\t\t}\n\t\t\t];\n\n\t\t\tvar linkLayers = [];\n\n\t\t\treturn {\n\t\t\t\ttasks: taskLayers,\n\t\t\t\tlinks: linkLayers\n\t\t\t};\n\t\t}\n\n\t}, true);\n\n\tutils.mixin(ResourceHistogram.prototype, resourceStoreMixin(_super), true);\n\n\treturn ResourceHistogram;\n})(ResourceTimeline);\n\n\nexport default ResourceHistogram;\n\n\n","export default {\n\tinit: function (controller, grid) {\n\t\tvar gantt = grid.$gantt;\n\n\t\tgantt.attachEvent(\"onTaskClick\", function (id, e) {\n\t\t\tif (gantt._is_icon_open_click(e))\n\t\t\t\treturn true;\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\n\t\t\tif (cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\tif (controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName) {\n\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t} else {\n\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onEmptyClick\", function () {\n\t\t\tif (controller.isVisible() && controller.isChanged()) {\n\t\t\t\tcontroller.save();\n\t\t\t} else {\n\t\t\t\tcontroller.hide();\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskDblClick\", function (id, e) {\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\t\t\tif (cell && controller.isVisible() && cell.columnName == state.columnName) {\n\t\t\t\t//GS-933 probably, we don't need to hide the inline editor because the lightbox cannot be opened if you double-click on an inline editor\n\t\t\t\t//remove this code later if people don't complain\n\t\t\t\t//controller.hide();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t},\n\n\tonShow: function (controller, placeholder, grid) {\n\t\tvar gantt = grid.$gantt;\n\t\t\n\n\t\tif(gantt.ext && gantt.ext.keyboardNavigation){\n\t\t\tvar keyNav = gantt.ext.keyboardNavigation;\n\t\t\tkeyNav.attachEvent(\"onKeyDown\", function(command, e){\n\t\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\t\tvar keyCode = e.keyCode;\n\t\t\t\tvar preventKeyNav = false;\n\n\t\t\t\tswitch (keyCode){\n\t\t\t\t\tcase keyboard.SPACE:\n\t\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (preventKeyNav){\n\t\t\t\t\treturn false;\n\t\t\t\t} else{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t\tplaceholder.onkeydown = function (e) {\n\t\t\te = e || window.event;\n\n\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\tif (e.defaultPrevented || (e.shiftKey && e.keyCode != keyboard.TAB)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar shouldPrevent = true;\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase gantt.keys.edit_save:\n\t\t\t\t\tcontroller.save();\n\t\t\t\t\tbreak;\n\t\t\t\tcase gantt.keys.edit_cancel:\n\t\t\t\t\tcontroller.hide();\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.UP:\n\t\t\t\tcase keyboard.DOWN:\n\t\t\t\t\tif (controller.isVisible()) {\n\t\t\t\t\t\tcontroller.hide();\n\t\t\t\t\t\tshouldPrevent = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.TAB:\n\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\tcontroller.editPrevCell(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontroller.editNextCell(true);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tshouldPrevent = false;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (shouldPrevent) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t};\n\t},\n\tonHide: function () {\n\n\t},\n\n\tdestroy: function () {\n\n\t}\n};\n\n","export default {\n\tinit: function(controller, grid){\n\t\tvar self = controller;\n\t\tvar gantt = grid.$gantt;\n\n\t\tvar onBlurDelay = null;\n\t\tvar keyNav = gantt.ext.keyboardNavigation;\n\t\tkeyNav.attachEvent(\"onBeforeFocus\", function (node) {\n\t\t\tvar activeCell = controller.locateCell(node);\n\t\t\tclearTimeout(onBlurDelay);\n\t\t\tif (activeCell) {\n\t\t\t\tvar columnName = activeCell.columnName;\n\t\t\t\tvar id = activeCell.id;\n\n\t\t\t\tvar editorState = self.getState();\n\t\t\t\tif(self.isVisible()){\n\t\t\t\t\tif(editorState.id == id && editorState.columnName === columnName) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tkeyNav.attachEvent(\"onFocus\", function (node) {\n\t\t\tvar activeCell = controller.locateCell(node);\n\t\t\tvar state = controller.getState();\n\t\t\tclearTimeout(onBlurDelay);\n\t\t\tif (activeCell && !(activeCell.id == state.id && activeCell.columnName == state.columnName)) {\n\t\t\t\tif(self.isVisible()){\n\t\t\t\t\tself.save();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tcontroller.attachEvent(\"onHide\", function(){\n\t\t\tclearTimeout(onBlurDelay);\n\t\t});\n\n\t\tkeyNav.attachEvent(\"onBlur\", function () {\n\t\t\tonBlurDelay = setTimeout(function(){\n\t\t\t\tself.save();\n\t\t\t});\n\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskDblClick\", function(id,e){\n\t\t\t// block lightbox on double click inside editor\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\t\t\tif(cell && controller.isVisible() && cell.columnName == state.columnName){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskClick\", function (id, e) {\n\t\t\tif(gantt._is_icon_open_click(e))\n\t\t\t\treturn true;\n\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\n\t\t\tif (cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\tif(controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName){\n\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t}else{\n\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\tgantt.attachEvent(\"onEmptyClick\", function () {\n\t\t\tself.save();\n\t\t\treturn true;\n\t\t});\n\n\t\tkeyNav.attachEvent(\"onKeyDown\", function(command, e){\n\t\t\tvar activeCell = controller.locateCell(e.target);\n\t\t\tvar hasEditor = activeCell ? controller.getEditorConfig(activeCell.columnName) : false;\n\n\t\t\tvar state = controller.getState();\n\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\tvar keyCode = e.keyCode;\n\t\t\tvar preventKeyNav = false;\n\n\t\t\tswitch (keyCode){\n\t\t\t\tcase keyboard.ENTER:\n\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\tcontroller.save();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}else if(hasEditor && !(e.ctrlKey || e.metaKey || e.shiftKey)){\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.ESC:\n\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\tcontroller.hide();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.UP:\n\t\t\t\tcase keyboard.DOWN:\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.LEFT:\n\t\t\t\tcase keyboard.RIGHT:\n\t\t\t\t\tif((hasEditor && controller.isVisible()) || state.editorType === \"date\"){\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.SPACE:\n\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(hasEditor && !controller.isVisible()){\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.DELETE:\n\t\t\t\t\tif(hasEditor && !controller.isVisible()){\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t} else if(hasEditor && controller.isVisible()){\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.TAB:\n\t\t\t\t\tif(controller.isVisible()){\n\n\t\t\t\t\t\tif(e.shiftKey){\n\t\t\t\t\t\t\tcontroller.editPrevCell(true);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcontroller.editNextCell(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar newState = controller.getState();\n\t\t\t\t\t\tif(newState.id){\n\t\t\t\t\t\t\tkeyNav.focus({type:\"taskCell\", id: newState.id, column:newState.columnName});\n\t\t\t\t\t\t}\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif(controller.isVisible())\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\telse{\n\n\t\t\t\t\t\t// start editing on character key\n\t\t\t\t\t\tif((keyCode >= 48 && keyCode <= 57) || // [0-9]\n\t\t\t\t\t\t\t(keyCode > 95 && keyCode < 112) || // numpad\n\t\t\t\t\t\t\t(keyCode >= 64 && keyCode <= 91) || // [a-z]\n\t\t\t\t\t\t\t(keyCode > 185 && keyCode < 193) || //;=-,etc\n\t\t\t\t\t\t\t(keyCode > 218  && keyCode < 223)\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\tvar modifiers = command.modifiers;\n\n\t\t\t\t\t\t\tvar anyModifier = modifiers.alt || modifiers.ctrl || modifiers.meta || modifiers.shift;\n\t\t\t\t\t\t\tif(modifiers.alt){\n\t\t\t\t\t\t\t\t// don't start editing on alt+key\n\t\t\t\t\t\t\t}else if (anyModifier && keyNav.getCommandHandler(command, \"taskCell\")){\n\t\t\t\t\t\t\t\t// don't start editing if command already have a keyboard shortcut\n\t\t\t\t\t\t\t}else if(hasEditor && !controller.isVisible()){\n\t\t\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (preventKeyNav){\n\t\t\t\treturn false;\n\t\t\t} else{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t});\n\t},\n\tonShow: function(controller, placeholder, grid){},\n\tonHide: function(controller, placeholder, grid){\n\t\tconst gantt = grid.$gantt;\n\t\tif (gantt){\n\t\t\tgantt.focus();\n\t\t}\n\n\t},\n\tdestroy: function(){}\n};\n\n","export default function (gantt) {\n\n\tvar BaseEditor = function () {\n\t};\n\n\tBaseEditor.prototype = {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t},\n\t\thide: function () {\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tthis.get_input(node).value = value;\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn this.get_input(node).value || \"\";\n\t\t},\n\t\tis_changed: function (value, id, column, node) {\n\t\t\tvar currentValue = this.get_value(id, column, node);\n\t\t\tif (currentValue && value && currentValue.valueOf && value.valueOf) {\n\t\t\t\treturn currentValue.valueOf() != value.valueOf();\n\t\t\t} else {\n\t\t\t\treturn currentValue != value;\n\t\t\t}\n\t\t},\n\t\tis_valid: function (value, id, column, node) {\n\t\t\treturn true;\n\t\t},\n\n\t\tsave: function (id, column, node) {\n\n\t\t},\n\t\tget_input: function (node) {\n\t\t\treturn node.querySelector(\"input\");\n\t\t},\n\t\tfocus: function (node) {\n\t\t\tvar input = this.get_input(node);\n\t\t\tif (!input) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (input.focus) {\n\t\t\t\tinput.focus();\n\t\t\t}\n\n\t\t\tif (input.select) {\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t};\n\treturn BaseEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction TextEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(TextEditor, BaseEditor);\n\n\tutils.mixin(TextEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\t\t}\n\t}, true);\n\n\treturn TextEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction NumberEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(NumberEditor, BaseEditor);\n\n\tutils.mixin(NumberEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar min = config.min || 0,\n\t\t\t\tmax = config.max || 100;\n\n\t\t\tvar html = `<div role='cell'><input type='number' min='${min}' max='${max}' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\n\t\t\t// GS-1914. Do not allow entering alues beyond min and max via keyboard\n\t\t\tplaceholder.oninput = function (e) {\n\t\t\t\tif (+e.target.value < min) {\n\t\t\t\t\te.target.value = min;\n\t\t\t\t}\n\t\t\t\tif (+e.target.value > max) {\n\t\t\t\t\te.target.value = max;\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn this.get_input(node).value || \"\";\n\t\t},\n\t\tis_valid: function (value, id, column, node) {\n\t\t\treturn !isNaN(parseInt(value, 10));\n\t\t}\n\t}, true);\n\n\treturn NumberEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction SelectEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(SelectEditor, BaseEditor);\n\n\tutils.mixin(SelectEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><select name='${column.name}' title='${column.name}'>`;\n\t\t\tvar optionsHtml = [],\n\t\t\t\toptions = config.options || [];\n\n\t\t\tfor (var i = 0; i < options.length; i++) {\n\t\t\t\toptionsHtml.push(\"<option value='\" + config.options[i].key + \"'>\" + options[i].label + \"</option>\");\n\t\t\t}\n\n\t\t\thtml += optionsHtml.join(\"\") + \"</select></div>\";\n\t\t\tplaceholder.innerHTML = html;\n\t\t},\n\t\tget_input: function (node) {\n\t\t\treturn node.querySelector(\"select\");\n\t\t}\n\t}, true);\n\n\treturn SelectEditor;\n};","import * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\nimport BaseFactory from \"./base\";\n\nexport default function (gantt) {\n\tvar BaseEditor = BaseFactory(gantt);\n\t\n\t\n\n\tvar html5DateFormat = \"%Y-%m-%d\";\n\n\tvar dateToStr = null;\n\tvar strToDate = null;\n\n\tfunction init() {\n\t\tif (!dateToStr) {\n\t\t\tdateToStr = gantt.date.date_to_str(html5DateFormat);\n\t\t}\n\t\tif (!strToDate) {\n\t\t\tstrToDate = gantt.date.str_to_date(html5DateFormat);\n\t\t}\n\t}\n\n\tfunction DateEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(DateEditor, BaseEditor);\n\n\tutils.mixin(DateEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tinit();\n\t\t\tvar minValue = null;\n\t\t\tvar maxValue = null;\n\n\t\t\tif(typeof config.min === \"function\"){\n\t\t\t\tminValue = config.min(id, column);\n\t\t\t}else{\n\t\t\t\tminValue = config.min;\n\t\t\t}\n\n\t\t\tif(typeof config.max === \"function\"){\n\t\t\t\tmaxValue = config.max(id, column);\n\t\t\t}else{\n\t\t\t\tmaxValue = config.max;\n\t\t\t}\n\n\t\t\tvar minAttr = minValue ? \" min='\" + dateToStr(minValue)+\"' \"  : \"\";\n\t\t\tvar maxAttr = maxValue ? \" max='\" + dateToStr(maxValue)+\"' \"  : \"\";\n\t\t\tvar html = `<div style='width:140px' role='cell'><input type='date' ${minAttr} ${maxAttr} name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\n\t\t\t// GS-1914. Do not allow entering alues beyond min and max via keyboard\n\t\t\tplaceholder.oninput = function (e) {\n\t\t\t\tif (e.target.value && (minValue || maxValue)){\n\t\t\t\t\tif (+gantt.date.str_to_date(\"%Y-%m-%d\")(e.target.value) < +minValue) {\n\t\t\t\t\t\te.target.value = gantt.date.date_to_str(\"%Y-%m-%d\")(minValue);\n\t\t\t\t\t}\n\t\t\t\t\tif (+gantt.date.str_to_date(\"%Y-%m-%d\")(e.target.value) > +maxValue) {\n\t\t\t\t\t\te.target.value = gantt.date.date_to_str(\"%Y-%m-%d\")(maxValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tif (value && value.getFullYear) {\n\t\t\t\tthis.get_input(node).value = dateToStr(value);\n\t\t\t} else {\n\t\t\t\tthis.get_input(node).value = value;\n\t\t\t}\n\t\t},\n\t\tis_valid: function (value, id, column, node) {\n\t\t\tif (!value || isNaN(value.getTime()))\n\t\t\t\treturn false;\n\t\t\treturn true;\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\tvar parsed;\n\t\t\ttry {\n\t\t\t\tparsed = strToDate(this.get_input(node).value || \"\");\n\t\t\t} catch (e) {\n\t\t\t\tparsed = null;// return null will cancel changes\n\t\t\t}\n\n\t\t\treturn parsed;\n\t\t}\n\t}, true);\n\n\treturn DateEditor;\n};\n","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction PredecessorEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(PredecessorEditor, BaseEditor);\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || gantt.ext.formatters.linkFormatter();\n\t}\n\n\tfunction parseInputString(value, config) {\n\t\tvar predecessors = (value || \"\").split(config.delimiter || \",\");\n\t\tfor (var i = 0; i < predecessors.length; i++) {\n\t\t\tvar val = predecessors[i].trim();\n\t\t\tif (val) {\n\t\t\t\tpredecessors[i] = val;\n\t\t\t} else {\n\t\t\t\tpredecessors.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\tpredecessors.sort();\n\t\treturn predecessors;\n\t}\n\n\tfunction formatPredecessors(task, config, gantt) {\n\t\tvar links = task.$target;\n\t\tvar labels = [];\n\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\tvar link = gantt.getLink(links[i]);\n\t\t\tlabels.push(getFormatter(config).format(link));\n\t\t}\n\t\treturn labels.join((config.delimiter || \",\") + \" \");\n\t}\n\n\tfunction getSelectedLinks(taskId, predecessorCodes, config) {\n\t\tvar links = [];\n\t\t// select only unique codes GS-1439\n\t\t[...new Set(predecessorCodes)].forEach(function (code) {\n\t\t\tvar link = getFormatter(config).parse(code);\n\t\t\tif(link){\n\t\t\t\tlink.target = taskId;\n\t\t\t\t// GS-1290 A way to preserve the link. Otherwise validation will return false\n\t\t\t\t// because the existing link ID is not passed there\n\t\t\t\tlink.id = \"predecessor_generated\";\n\t\t\t\tif (gantt.isLinkAllowed(link)) {\n\t\t\t\t\tlink.id = undefined;\n\t\t\t\t\tlinks.push(link);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn links;\n\t}\n\n\tfunction formatLinkKey(link){\n\t\treturn link.source + \"_\" + link.target + \"_\" + link.type + \"_\" + (link.lag||0);\n\t}\n\n\tfunction getLinksDiff(task, predecessorCodes, config) {\n\t\tvar selectedLinks = getSelectedLinks(task.id, predecessorCodes, config);\n\t\tvar existingLinksSearch = {};\n\t\ttask.$target.forEach(function (linkId) {\n\t\t\tvar link = gantt.getLink(linkId);\n\t\t\texistingLinksSearch[formatLinkKey(link)] = link.id;\n\t\t});\n\n\t\tvar linksToAdd = [];\n\t\tselectedLinks.forEach(function (link) {\n\t\t\tvar linkKey = formatLinkKey(link);\n\t\t\tif (!existingLinksSearch[linkKey]) {\n\t\t\t\tlinksToAdd.push(link);\n\t\t\t} else {\n\t\t\t\tdelete existingLinksSearch[linkKey];\n\t\t\t}\n\t\t});\n\n\t\tvar linksToDelete = [];\n\t\tfor (var i in existingLinksSearch) {\n\t\t\tlinksToDelete.push(existingLinksSearch[i]);\n\t\t}\n\n\t\treturn {\n\t\t\tadd: linksToAdd,\n\t\t\tremove: linksToDelete\n\t\t};\n\t}\n\n\tutils.mixin(PredecessorEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\t\t},\n\t\thide: function () {\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tthis.get_input(node).value = formatPredecessors(value, column.editor, gantt);\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn parseInputString((this.get_input(node).value || \"\"), column.editor);\n\t\t},\n\t\tsave: function (id, column, node) {\n\t\t\tvar task = gantt.getTask(id);\n\n\t\t\tvar linksDiff = getLinksDiff(task, this.get_value(id, column, node), column.editor);\n\n\t\t\tif (linksDiff.add.length || linksDiff.remove.length) {\n\t\t\t\tgantt.batchUpdate(function () {\n\t\t\t\t\tlinksDiff.add.forEach(function (link) {\n\t\t\t\t\t\tgantt.addLink(link);\n\t\t\t\t\t});\n\t\t\t\t\tlinksDiff.remove.forEach(function (linkId) {\n\t\t\t\t\t\tgantt.deleteLink(linkId);\n\t\t\t\t\t});\n\n\t\t\t\t\tif (gantt.autoSchedule)\n\t\t\t\t\t\tgantt.autoSchedule();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tis_changed: function (value, id, column, node) {\n\t\t\tvar inputPredecessors = this.get_value(id, column, node);\n\t\t\tvar taskPredecessors = parseInputString(formatPredecessors(value, column.editor, gantt), column.editor);\n\n\t\t\treturn inputPredecessors.join() !== taskPredecessors.join();\n\t\t}\n\t}, true);\n\n\treturn PredecessorEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction TextEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(TextEditor, BaseEditor);\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || gantt.ext.formatters.durationFormatter();\n\t}\n\tutils.mixin(TextEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tthis.get_input(node).value = getFormatter(column.editor).format(value);\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn getFormatter(column.editor).parse(this.get_input(node).value || \"\");\n\t\t}\n\t}, true);\n\n\treturn TextEditor;\n};","export default function (gantt) {\n\treturn function processTaskDateProperties(item, mapTo, mode) {\n\t\tif (mode == \"keepDates\") {\n\t\t\tkeepDatesOnEdit(item, mapTo);\n\t\t} else if (mode == \"keepDuration\") {\n\t\t\tkeepDurationOnEdit(item, mapTo);\n\t\t} else {\n\t\t\tdefaultActionOnEdit(item, mapTo);\n\t\t}\n\t};\n\n\t// resize task\n\t// resize task when start/end/duration changes\n\tfunction keepDatesOnEdit(item, mapTo) {\n\t\tif (mapTo == \"duration\") {\n\t\t\titem.end_date = gantt.calculateEndDate(item);\n\t\t} else if (mapTo == \"end_date\" || mapTo == \"start_date\") {\n\t\t\titem.duration = gantt.calculateDuration(item);\n\t\t}\n\t}\n\n\t// move task(before 6.2)\n\t// move task when start/end dates changes\n\t// resize task when duration changes\n\tfunction keepDurationOnEdit(item, mapTo) {\n\t\tif (mapTo == \"end_date\") {\n\t\t\titem.start_date = decreaseStartDate(item);\n\t\t} else if (mapTo == \"start_date\" || mapTo == \"duration\") {\n\t\t\titem.end_date = gantt.calculateEndDate(item);\n\t\t}\n\t}\n\n\t// default behavior\n\t// move task when start date changes\n\t// resize task when end date/duration changes\n\tfunction defaultActionOnEdit(item, mapTo) {\n\t\tif (gantt.config.schedule_from_end){\n\t\t\tif (mapTo == \"end_date\" || mapTo == \"duration\") {\n\t\t\t\titem.start_date = decreaseStartDate(item);\n\t\t\t} else if (mapTo == \"start_date\") {\n\t\t\t\titem.duration = gantt.calculateDuration(item);\n\t\t\t}\n\t\t} else {\n\t\t\tif (mapTo == \"start_date\" || mapTo == \"duration\") {\n\t\t\t\titem.end_date = gantt.calculateEndDate(item);\n\t\t\t} else if (mapTo == \"end_date\") {\n\t\t\t\titem.duration = gantt.calculateDuration(item);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction decreaseStartDate(item){\n\t\treturn gantt.calculateEndDate({\n\t\t\tstart_date: item.end_date,\n\t\t\tduration: -item.duration,\n\t\t\ttask: item\n\t\t});\n\t}\n};","import getKeyboardMapping from \"./keyboard_mappings\";\nimport textEditorFactory from \"./editors/text\";\nimport numberEditorFactory from \"./editors/number\";\nimport selectEditorFactory from \"./editors/select\";\nimport dateEditorFactory from \"./editors/date\";\nimport predecessorEditorFactory from \"./editors/predecessor\";\nimport durationEditorFactory from \"./editors/duration\";\nimport * as utils from \"../../../../utils/utils\";\nimport * as domHelpers from \"../../utils/dom_helpers\";\nimport eventable from \"../../../../utils/eventable\";\nimport linkedPropertiesProcessor from \"./linked_properties\";\n\nfunction initConfigs(gantt){\n\tgantt.config.editor_types = {\n\t\ttext: new (textEditorFactory(gantt))(),\n\t\tnumber: new (numberEditorFactory(gantt))(),\n\t\tselect: new (selectEditorFactory(gantt))(),\n\t\tdate: new (dateEditorFactory(gantt))(),\n\t\tpredecessor: new (predecessorEditorFactory(gantt))(),\n\t\tduration: new (durationEditorFactory(gantt))()\n\t};\n}\n\nfunction create(gantt){\n\tvar keyboardMapping = getKeyboardMapping(gantt);\n\n\tvar eventBus = {};\n\teventable(eventBus);\n\n\tfunction createGridEditors(grid) {\n\n\t\tfunction _getGridCellFromNode(node){\n\t\t\tif(!domHelpers.isChildOf(node, grid.$grid)){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar row = domHelpers.locateAttribute(node, grid.$config.item_attribute);\n\t\t\tvar cell = domHelpers.locateAttribute(node, \"data-column-name\");\n\t\t\tif(row && cell){\n\t\t\t\tvar columnName = cell.getAttribute(\"data-column-name\");\n\t\t\t\tvar id = row.getAttribute(grid.$config.item_attribute);\n\t\t\t\treturn {\n\t\t\t\t\tid: id,\n\t\t\t\t\tcolumnName: columnName\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn null;\n\n\t\t}\n\n\t\tfunction _getEditorPosition(itemId, columnName) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar top = grid.getItemTop(itemId);\n\t\t\tvar height = grid.getItemHeight(itemId);\n\t\t\tvar cols = grid.getGridColumns();\n\t\t\tvar left = 0,\n\t\t\t\tright = 0,\n\t\t\t\twidth = 0;\n\n\t\t\tfor (var i = 0; i < cols.length; i++) {\n\t\t\t\tif (cols[i].name == columnName) {\n\t\t\t\t\twidth = cols[i].width;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (config.rtl) {\n\t\t\t\t\tright += cols[i].width;\n\t\t\t\t}\telse {\n\t\t\t\t\tleft += cols[i].width;\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif (config.rtl) {\n\t\t\t\treturn {\n\t\t\t\t\ttop: top,\n\t\t\t\t\tright: right,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: width\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\ttop: top,\n\t\t\t\t\tleft: left,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: width\n\t\t\t\t};\n\t\t\t}\n\n\t\t}\n\n\t\tfunction findVisibleIndex(grid, columnName) {\n\t\t\tvar columns = grid.getGridColumns();\n\t\t\tfor (var i = 0; i < columns.length; i++){\n\t\t\t\tif(columns[i].name == columnName){\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn 0;\n\t\t}\n\n\t\tfunction _createPlaceholder(itemId, columnName) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar pos = _getEditorPosition(itemId, columnName);\n\t\t\tvar el = document.createElement(\"div\");\n\t\t\tel.className = \"gantt_grid_editor_placeholder\";\n\t\t\tel.setAttribute(grid.$config.item_attribute, itemId);\n\t\t\tel.setAttribute(grid.$config.bind + \"_id\", itemId);// for backward compatibility\n\n\t\t\tel.setAttribute(\"data-column-name\", columnName);\n\n\t\t\tvar visibleIndex = findVisibleIndex(grid, columnName);\n\t\t\tel.setAttribute(\"data-column-index\", visibleIndex);\n\n\t\t\tgantt._waiAria.inlineEditorAttr(el);\n\n\t\t\tif (config.rtl) {\n\t\t\t\tel.style.cssText = [\n\t\t\t\t\t\"top:\" + pos.top + \"px\",\n\t\t\t\t\t\"right:\" + pos.right + \"px\",\n\t\t\t\t\t\"width:\" + pos.width + \"px\",\n\t\t\t\t\t\"height:\" + pos.height + \"px\"\n\t\t\t\t].join(\";\");\n\t\t\t} else {\n\t\t\t\tel.style.cssText = [\n\t\t\t\t\t\"top:\" + pos.top + \"px\",\n\t\t\t\t\t\"left:\" + pos.left + \"px\",\n\t\t\t\t\t\"width:\" + pos.width + \"px\",\n\t\t\t\t\t\"height:\" + pos.height + \"px\"\n\t\t\t\t].join(\";\");\n\t\t\t}\n\n\t\t\treturn el;\n\t\t}\n\n\t\tvar updateTaskDateProperties = linkedPropertiesProcessor(gantt);\n\n\t\tvar handlers = [];\n\t\tvar ganttHandlers = [];\n\t\tvar store = null;\n\t\tvar controller = {\n\t\t\t_itemId: null,\n\t\t\t_columnName: null,\n\t\t\t_editor: null,\n\t\t\t_editorType: null,\n\t\t\t_placeholder: null,\n\n\t\t\tlocateCell: _getGridCellFromNode,\n\t\t\tgetEditorConfig: function (columnName) {\n\t\t\t\tvar column = grid.getColumn(columnName);\n\t\t\t\treturn column.editor;\n\t\t\t},\n\n\t\t\tinit: function () {\n\t\t\t\tvar mapping = keyboardMapping.getMapping();\n\t\t\t\tif(mapping.init){\n\t\t\t\t\tmapping.init(this, grid);\n\t\t\t\t}\n\n\t\t\t\tstore = grid.$gantt.getDatastore(grid.$config.bind);\n\n\t\t\t\tvar self = this;\n\n\t\t\t\thandlers.push(store.attachEvent(\"onIdChange\", function(oldId, newId){\n\t\t\t\t\tif(self._itemId == oldId){\n\t\t\t\t\t\tself._itemId = newId;\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t\thandlers.push(store.attachEvent(\"onStoreUpdated\", function(){\n\t\t\t\t\tif(grid.$gantt.getState(\"batchUpdate\").batch_update){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(self.isVisible() && !store.isVisible(self._itemId)){\n\t\t\t\t\t\tself.hide();\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tganttHandlers.push(gantt.attachEvent(\"onDataRender\", function(){\n\t\t\t\t\tif(self._editor && self._placeholder && !domHelpers.isChildOf(self._placeholder, gantt.$root)){\n\t\t\t\t\t\tgrid.$grid_data.appendChild(self._placeholder);\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis.init = function(){};\n\t\t\t},\n\n\t\t\tgetState: function(){\n\t\t\t\treturn {\n\t\t\t\t\teditor: this._editor,\n\t\t\t\t\teditorType: this._editorType,\n\t\t\t\t\tplaceholder: this._placeholder,\n\t\t\t\t\tid: this._itemId,\n\t\t\t\t\tcolumnName: this._columnName\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tstartEdit: function(itemId, columnName) {\n\t\t\t\tif (this.isVisible()) {\n\t\t\t\t\tthis.save();\n\t\t\t\t}\n\n\t\t\t\tif(!store.exists(itemId)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar editorState = {id: itemId, columnName: columnName};\n\t\t\t\tif (gantt.isReadonly(store.getItem(itemId))) {\n\t\t\t\t\tthis.callEvent(\"onEditPrevent\", [editorState]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.callEvent(\"onBeforeEditStart\", [editorState]) === false) {\n\t\t\t\t\tthis.callEvent(\"onEditPrevent\", [editorState]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.show(editorState.id, editorState.columnName);\n\t\t\t\tthis.setValue();\n\n\t\t\t\tthis.callEvent(\"onEditStart\", [editorState]);\n\t\t\t},\n\t\t\tisVisible: function(){\n\t\t\t\treturn !!(this._editor && domHelpers.isChildOf(this._placeholder, gantt.$root));\n\t\t\t},\n\t\t\tshow: function (itemId, columnName) {\n\t\t\t\tif (this.isVisible()) {\n\t\t\t\t\tthis.save();\n\t\t\t\t}\n\t\t\t\tvar editorState = {id: itemId, columnName: columnName};\n\n\t\t\t\tvar column = grid.getColumn(editorState.columnName);\n\t\t\t\tvar editorConfig = this.getEditorConfig(column.name);\n\t\t\t\tif(!editorConfig)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar editor = grid.$getConfig().editor_types[editorConfig.type];\n\n\t\t\t\tvar placeholder = _createPlaceholder(editorState.id, editorState.columnName);\n\t\t\t\tgrid.$grid_data.appendChild(placeholder);\n\t\t\t\teditor.show(editorState.id, column, editorConfig, placeholder);\n\t\t\t\tthis._editor = editor;\n\t\t\t\tthis._placeholder = placeholder;\n\t\t\t\tthis._itemId = editorState.id;\n\t\t\t\tthis._columnName = editorState.columnName;\n\t\t\t\tthis._editorType = editorConfig.type;\n\n\t\t\t\tvar mapping = keyboardMapping.getMapping();\n\t\t\t\tif(mapping.onShow){\n\t\t\t\t\tmapping.onShow(this, placeholder, grid);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tsetValue: function () {\n\t\t\t\tvar state = this.getState();\n\t\t\t\tvar itemId = state.id,\n\t\t\t\t\tcolumnName = state.columnName;\n\n\t\t\t\tvar column = grid.getColumn(columnName);\n\t\t\t\tvar item = store.getItem(itemId);\n\t\t\t\tvar editorConfig = this.getEditorConfig(columnName);\n\n\t\t\t\tif(!editorConfig)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar value = item[editorConfig.map_to];\n\t\t\t\tif(editorConfig.map_to == \"auto\"){\n\t\t\t\t\tvalue = store.getItem(itemId);\n\t\t\t\t}\n\n\t\t\t\tthis._editor.set_value(value, itemId, column, this._placeholder);\n\t\t\t\tthis.focus();\n\t\t\t},\n\n\t\t\tfocus: function(){\n\t\t\t\tthis._editor.focus(this._placeholder);\n\t\t\t},\n\n\t\t\tgetValue: function () {\n\t\t\t\tvar column = grid.getColumn(this._columnName);\n\t\t\t\treturn this._editor.get_value(this._itemId, column, this._placeholder);\n\t\t\t},\n\n\t\t\t_getItemValue: function() {\n\t\t\t\tvar editorConfig = this.getEditorConfig(this._columnName);\n\n\t\t\t\tif(!editorConfig)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar item = gantt.getTask(this._itemId);\n\t\t\t\tvar value = item[editorConfig.map_to];\n\t\t\t\tif(editorConfig.map_to == \"auto\"){\n\t\t\t\t\tvalue = store.getItem(this._itemId);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t},\n\n\t\t\tisChanged: function(){\n\n\t\t\t\tvar column = grid.getColumn(this._columnName);\n\n\t\t\t\tvar value = this._getItemValue();\n\n\t\t\t\treturn this._editor.is_changed(value, this._itemId, column, this._placeholder);\n\t\t\t},\n\n\t\t\thide: function () {\n\t\t\t\tif(!this._itemId)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar itemId = this._itemId,\n\t\t\t\t\tcolumnName = this._columnName;\n\n\t\t\t\tvar mapping = keyboardMapping.getMapping();\n\t\t\t\tif(mapping.onHide){\n\t\t\t\t\tmapping.onHide(this, this._placeholder, grid);\n\t\t\t\t}\n\n\t\t\t\tthis._itemId = null;\n\t\t\t\tthis._columnName = null;\n\t\t\t\tthis._editorType = null;\n\t\t\t\tif (!this._placeholder) return;\n\n\t\t\t\tif (this._editor && this._editor.hide) {\n\t\t\t\t\tthis._editor.hide(this._placeholder);\n\t\t\t\t}\n\t\t\t\tthis._editor = null;\n\t\t\t\tif (this._placeholder.parentNode) {\n\t\t\t\t\tthis._placeholder.parentNode.removeChild(this._placeholder);\n\t\t\t\t}\n\t\t\t\tthis._placeholder = null;\n\n\t\t\t\tthis.callEvent(\"onEditEnd\", [{id: itemId, columnName: columnName}]);\n\t\t\t},\n\t\t\tsave: function () {\n\t\t\t\tif(!(this.isVisible() && store.exists(this._itemId) && this.isChanged())) {\n\t\t\t\t\tthis.hide();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar itemId = this._itemId,\n\t\t\t\t\tcolumnName = this._columnName;\n\n\t\t\t\tif(!store.exists(itemId)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar item = store.getItem(itemId);\n\t\t\t\tvar editorConfig = this.getEditorConfig(columnName);\n\t\t\t\tvar editorState = {\n\t\t\t\t\tid: itemId,\n\t\t\t\t\tcolumnName: columnName,\n\t\t\t\t\tnewValue: this.getValue(),\n\t\t\t\t\toldValue: this._getItemValue()\n\t\t\t\t};\n\t\t\t\tif (this.callEvent(\"onBeforeSave\", [editorState]) !== false) {\n\t\t\t\t\tif (!this._editor.is_valid || this._editor.is_valid(editorState.newValue, editorState.id, grid.getColumn(columnName), this._placeholder)) {\n\n\t\t\t\t\t\tvar mapTo = editorConfig.map_to;\n\t\t\t\t\t\tvar value = editorState.newValue;\n\t\t\t\t\t\tif (mapTo != \"auto\") {\n\t\t\t\t\t\t\titem[mapTo] = value;\n\t\t\t\t\t\t\tupdateTaskDateProperties(item, mapTo, gantt.config.inline_editors_date_processing);\n\n\t\t\t\t\t\t\tstore.updateItem(itemId);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._editor.save(itemId, grid.getColumn(columnName), this._placeholder);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.callEvent(\"onSave\", [editorState]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.hide();\n\t\t\t},\n\n\t\t\t_findEditableCell: function findEditableCell(start, direction){\n\t\t\t\tvar nextIndex = start;\n\t\t\t\tvar columns = grid.getGridColumns();\n\t\t\t\tvar nextColumn = columns[nextIndex];\n\n\t\t\t\tvar columnName = nextColumn ? nextColumn.name : null;\n\t\t\t\tif(columnName){\n\t\t\t\t\twhile(columnName && !this.getEditorConfig(columnName)){\n\t\t\t\t\t\tcolumnName = this._findEditableCell(start + direction, direction);\n\t\t\t\t\t}\n\t\t\t\t\treturn columnName;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tgetNextCell: function moveCell(dir){\n\t\t\t\t// GS-1257. true means to exclude hidden columns\n\t\t\t\treturn this._findEditableCell(grid.getColumnIndex(this._columnName, true) + dir, dir);\n\t\t\t},\n\n\t\t\tgetFirstCell: function getFirstCell(){\n\t\t\t\treturn this._findEditableCell(0, 1);\n\t\t\t},\n\n\t\t\tgetLastCell: function getLastCell(){\n\t\t\t\treturn this._findEditableCell(grid.getGridColumns().length - 1, -1);\n\t\t\t},\n\n\t\t\teditNextCell: function nextCell(canChangeRow){\n\t\t\t\tvar cell = this.getNextCell(1);\n\t\t\t\tif(cell){\n\t\t\t\t\tvar nextColumn = this.getNextCell(1);\n\t\t\t\t\tif(nextColumn && this.getEditorConfig(nextColumn)){\n\t\t\t\t\t\tthis.startEdit(this._itemId, nextColumn);\n\t\t\t\t\t}\n\t\t\t\t}else if(canChangeRow && this.moveRow(1)){\n\t\t\t\t\tvar task = this.moveRow(1);\n\t\t\t\t\tcell = this.getFirstCell();\n\t\t\t\t\tif(cell && this.getEditorConfig(cell)){\n\t\t\t\t\t\tthis.startEdit(task, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\teditPrevCell: function prevCell(canChangeRow){\n\t\t\t\tvar cell = this.getNextCell(-1);\n\t\t\t\tif(cell){\n\t\t\t\t\tvar nextColumn = this.getNextCell(-1);\n\t\t\t\t\tif(nextColumn && this.getEditorConfig(nextColumn)){\n\t\t\t\t\t\tthis.startEdit(this._itemId, nextColumn);\n\t\t\t\t\t}\n\t\t\t\t}else if(canChangeRow && this.moveRow(-1)){\n\t\t\t\t\tvar task = this.moveRow(-1);\n\t\t\t\t\tcell = this.getLastCell();\n\t\t\t\t\tif(cell && this.getEditorConfig(cell)){\n\t\t\t\t\t\tthis.startEdit(task, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tmoveRow: function moveRow(dir) {\n\t\t\t\tvar moveTask = dir > 0 ? gantt.getNext : gantt.getPrev;\n\t\t\t\tmoveTask = gantt.bind(moveTask, gantt);\n\n\t\t\t\tvar nextItem = moveTask(this._itemId);\n\t\t\t\t// skip readonly rows\n\t\t\t\twhile (gantt.isTaskExists(nextItem) && gantt.isReadonly(gantt.getTask(nextItem))) {\n\t\t\t\t\tnextItem = moveTask(nextItem);\n\t\t\t\t}\n\t\t\t\treturn nextItem;\n\t\t\t},\n\n\t\t\teditNextRow: function nextRow(skipReadonly){\n\t\t\t\tvar id = this.getState().id;\n\t\t\t\tif (!gantt.isTaskExists(id)) return;\n\n\t\t\t\tvar next = null;\n\t\t\t\tif (skipReadonly){\n\t\t\t\t\tnext = this.moveRow(1);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnext = gantt.getNext(id);\n\t\t\t\t}\n\n\t\t\t\tif (gantt.isTaskExists(next)){\n\t\t\t\t\tthis.startEdit(next, this._columnName);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\teditPrevRow: function prevRow(skipReadonly){\n\t\t\t\tvar id = this.getState().id;\n\t\t\t\tif (!gantt.isTaskExists(id)) return;\n\n\t\t\t\tvar prev = null;\n\t\t\t\tif (skipReadonly){\n\t\t\t\t\tprev = this.moveRow(-1);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tprev = gantt.getPrev(id);\n\t\t\t\t}\n\n\t\t\t\tif (gantt.isTaskExists(prev)){\n\t\t\t\t\tthis.startEdit(prev, this._columnName);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdetachStore: function(){\n\t\t\t\thandlers.forEach(function(handlerId){\n\t\t\t\t\tstore.detachEvent(handlerId);\n\t\t\t\t});\n\n\t\t\t\tganttHandlers.forEach(function(handlerId){\n\t\t\t\t\tgantt.detachEvent(handlerId);\n\t\t\t\t});\n\t\t\t\thandlers = [];\n\t\t\t\tganttHandlers = [];\n\n\t\t\t\tstore = null;\n\t\t\t\tthis.hide();\n\t\t\t},\n\t\t\tdestructor: function(){\n\t\t\t\tthis.detachStore();\n\t\t\t\tthis.detachAllEvents();\n\t\t\t}\n\t\t};\n\n\t\tutils.mixin(controller, keyboardMapping);\n\t\tutils.mixin(controller, eventBus);\n\n\t\treturn controller;\n\t}\n\n\n\tvar inlineEditController = {\n\t\tinit: initConfigs,\n\t\tcreateEditors: createGridEditors\n\t};\n\n\tutils.mixin(inlineEditController, keyboardMapping);\n\tutils.mixin(inlineEditController, eventBus);\n\n\treturn inlineEditController;\n}\n\n\n\n\nexport default create;","import defaultMapping from \"./keyboard_mappings/default\";\nimport keyNavMappings from \"./keyboard_mappings/keyboard_navigation\";\n\nexport default function(gantt){\n\n\tvar mapping = null;\n\n\treturn {\n\t\tsetMapping: function(map){\n\t\t\tmapping = map;\n\t\t},\n\t\tgetMapping: function(){\n\n\t\t\tif(mapping){\n\t\t\t\treturn mapping;\n\t\t\t}else if(gantt.config.keyboard_navigation_cells && gantt.ext.keyboardNavigation){\n\t\t\t\treturn keyNavMappings;\n\t\t\t}else{\n\t\t\t\treturn defaultMapping;\n\t\t\t}\n\t\t}\n\t};\n};\n","// optimized checker for task bars smart rendering\n\n// first check the vertical position since it's easier to calculate\nexport default function isBarInViewport(item, viewport, view, config, gantt){\n\tif(!item.start_date || !item.end_date){\n\t\treturn null;\n\t}\n\n\tvar top = view.getItemTop(item.id);\n\tvar height = view.getItemHeight(item.id);\n\n\tif(top > viewport.y_end || top + height < viewport.y){\n\t\treturn false;\n\t}\n\n\tvar padding = 200;\n\tvar startCoord = view.posFromDate(item.start_date);\n\tvar endCoord = view.posFromDate(item.end_date);\n\tvar left = Math.min(startCoord, endCoord) - padding;\n\tvar right = Math.max(startCoord, endCoord) + padding;\n\n\tif(left > viewport.x_end || right < viewport.x){\n\t\treturn false;\n\t}\n\n\treturn true;\n};","function createTaskRenderer(gantt) {\n\n\tfunction _render_task_element(task, view, config) {\n\t\tvar config = view.$getConfig();\n\t\tvar painters = config.type_renderers;\n\t\tvar renderer = painters[gantt.getTaskType(task.type)],\n\t\t\tdefaultRenderer = _task_default_render;\n\n\t\tif (!renderer) {\n\t\t\treturn defaultRenderer.call(gantt, task, view, config);\n\t\t}else{\n\t\t\treturn renderer.call(gantt, task, function(task){ return defaultRenderer.call(gantt, task, view, config);}, view);\n\t\t}\n\t}\n\n\tfunction _task_default_render(task, view, config) {\n\t\tif (gantt._isAllowedUnscheduledTask(task))\n\t\t\treturn;\n\n\t\tif (!gantt._isTaskInTimelineLimits(task)) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar pos = view.getItemPosition(task);\n\n\t\tvar cfg = config,\n\t\t\ttemplates = view.$getTemplates();\n\n\t\tvar taskType = gantt.getTaskType(task.type);\n\t\tvar height = view.getBarHeight(task.id, taskType == cfg.types.milestone);\n\n\t\tvar controlsMargin = 0;\n\t\tif (taskType == cfg.types.milestone) {\n\t\t\tcontrolsMargin = (height - pos.height)/2;\n\t\t}\n\n\t\tvar padd = Math.floor((view.getItemHeight(task.id) - height) / 2);\n\t\tconst hasBaselines = gantt.config.baselines && task.baselines && task.baselines.length;\n\t\tconst baselinesOnDifferentRow = gantt.config.baselines && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\n\t\tif (hasBaselines && baselinesOnDifferentRow){\n\t\t\tif (task.bar_height !== \"full\" && task.bar_height < task.row_height){\n\t\t\t\tif (taskType === cfg.types.milestone){\n\t\t\t\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\n\t\t\t\t\tlet milestoneWidth = Math.sqrt(2 * milestoneHeight * milestoneHeight);\n\t\t\t\t\tpadd = Math.floor((milestoneWidth - height) / 2) + 2;\n\t\t\t\t} else {\n\t\t\t\t\tpadd = 2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t//\tif(task.type == cfg.types.milestone){\n\t//\t\tpadd -= 1;\n\t//\t}\n\t//\tif (taskType == cfg.types.milestone && cfg.link_line_width > 1) {\n\t//\t\t//little adjust milestone position, so horisontal corners would match link arrow when thickness of link line is more than 1px\n\t//\t\tpadd += 1;\n\t//\t}\n\n\t\tif (taskType == cfg.types.milestone) {\n\t\t\tpos.left -= Math.round(height / 2);\n\t\t\tpos.width = height;\n\t\t}\n\n\t\tvar div = document.createElement(\"div\");\n\n\t\tvar width = Math.round(pos.width);\n\n\t\tif(view.$config.item_attribute) {\n\t\t\tdiv.setAttribute(view.$config.item_attribute, task.id);\n\t\t\tdiv.setAttribute(view.$config.bind + \"_id\", task.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\tif (cfg.show_progress && taskType != cfg.types.milestone) {\n\t\t\t_render_task_progress(task, div, width, cfg, templates);\n\t\t}\n\n\t\t//use separate div to display content above progress bar\n\t\tvar content = _render_task_content(task, width, templates);\n\n\t\tdiv.appendChild(content);\n\n\t\tvar css = _combine_item_class(\"gantt_task_line\",\n\t\t\ttemplates.task_class(task.start_date, task.end_date, task),\n\t\t\ttask.id,\n\t\t\tview);\n\t\tif (task.color || task.progressColor || task.textColor) {\n\t\t\tcss += \" gantt_task_inline_color\";\n\t\t}\n\t\tif (pos.width < 20){\n\t\t\tcss += \" gantt_thin_task\";\n\t\t}\n\t\tdiv.className = css;\n\n\t\tvar styles = [\n\t\t\t\"left:\" + pos.left + \"px\",\n\t\t\t\"top:\" + (padd + pos.top) + 'px',\n\t\t\t\"height:\" + (height) + 'px',\n\t\t\t\"line-height:\" + (Math.max(height < 30 ? height - 2 : height, 0)) + 'px',\n\t\t\t\"width:\" + width + 'px'\n\t\t];\n\n\t\tdiv.style.cssText = styles.join(\";\");\n\t\tif (task.color) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-background\", task.color);\n\t\t}\n\t\tif (task.textColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-color\", task.textColor);\n\t\t}\n\n\t\tif (task.progressColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-progress-color\", task.progressColor);\n\t\t}\n\n\t\t\n\t\tvar side = _render_leftside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) div.appendChild(side);\n\n\t\tside = _render_rightside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) div.appendChild(side);\n\n\t\tgantt._waiAria.setTaskBarAttr(task, div);\n\n\t\tvar state = gantt.getState();\n\t\tconst taskEditable = !gantt.isReadonly(task);\n\t\tconst timelineDrag = gantt.ext.dragTimeline && gantt.ext.dragTimeline._isDragInProgress();\n\n\t\tif (taskEditable || timelineDrag) {\n\t\t\tif (cfg.drag_resize && !gantt.isSummaryTask(task) && taskType != cfg.types.milestone) {\n\t\t\t\t_render_pair(div, \"gantt_task_drag\", task, function (css) {\n\t\t\t\t\tvar el = document.createElement(\"div\");\n\t\t\t\t\tel.className = css;\n\t\t\t\t\treturn el;\n\t\t\t\t}, cfg);\n\t\t\t}\n\t\t\tif (cfg.drag_links && cfg.show_links) {\n\t\t\t\t_render_pair(div, \"gantt_link_control\", task, function (css) {\n\t\t\t\t\tvar outer = document.createElement(\"div\");\n\t\t\t\t\touter.className = css;\n\t\t\t\t\touter.style.cssText = [\n\t\t\t\t\t\t\"height:\" + height + 'px',\n\t\t\t\t\t\t\"line-height:\" + height + 'px'\n\t\t\t\t\t].join(\";\");\n\t\t\t\t\tvar inner = document.createElement(\"div\");\n\t\t\t\t\tinner.className = \"gantt_link_point\";\n\n\t\t\t\t\tvar showLinkPoints = false;\n\t\t\t\t\tif(state.link_source_id && cfg.touch){\n\t\t\t\t\t\tshowLinkPoints = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tinner.style.display = showLinkPoints ? \"block\" : \"\";\n\t\t\t\t\touter.appendChild(inner);\n\t\t\t\t\treturn outer;\n\t\t\t\t}, cfg, controlsMargin);\n\t\t\t}\n\t\t}\n\t\treturn div;\n\t}\n\n\tfunction _render_side_content(task, template, cssClass, marginStyle) {\n\t\tif (!template) return null;\n\n\t\tvar text = template(task.start_date, task.end_date, task);\n\t\tif (!text) return null;\n\t\tvar content = document.createElement(\"div\");\n\t\tcontent.className = \"gantt_side_content \" + cssClass;\n\t\tcontent.innerHTML = text;\n\t\tif(marginStyle){\n\t\t\tcontent.style[marginStyle.type] = Math.abs(marginStyle.value) + \"px\";\n\t\t}\n\t\treturn content;\n\t}\n\n\tfunction _render_leftside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_left \" + _get_link_crossing_css(!cfg.rtl ? true : false, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginRight\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.leftside_text, css, marginStyle);\n\t}\n\n\tfunction _render_rightside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_right \" + _get_link_crossing_css(!cfg.rtl ? false : true, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginLeft\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.rightside_text, css, marginStyle);\n\t}\n\n\tfunction _get_link_crossing_css(left, task) {\n\t\tvar cond = _get_conditions(left);\n\n\t\tfor (var i in cond) {\n\t\t\tvar links = task[i];\n\t\t\tfor (var ln = 0; ln < links.length; ln++) {\n\t\t\t\tvar link = gantt.getLink(links[ln]);\n\n\t\t\t\tfor (var tp = 0; tp < cond[i].length; tp++) {\n\t\t\t\t\tif (link.type == cond[i][tp]) {\n\t\t\t\t\t\treturn \"gantt_link_crossing\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\n\tfunction _render_task_content(task, width, templates) {\n\t\tvar content = document.createElement(\"div\");\n\t\tif (gantt.getTaskType(task.type) != gantt.config.types.milestone){\n\t\t\tcontent.innerHTML = templates.task_text(task.start_date, task.end_date, task);\n\t\t} else if(gantt.getTaskType(task.type) == gantt.config.types.milestone && width) {\n\t\t\tcontent.style.height = content.style.width = width + \"px\";\n\t\t}\n\t\tcontent.className = \"gantt_task_content\";\n\t\t//content.style.width = width + 'px';\n\t\treturn content;\n\t}\n\n\tfunction _render_task_progress(task, element, maxWidth, cfg, templates) {\n\t\tvar done = task.progress * 1 || 0;\n\n\t\tmaxWidth = Math.max(maxWidth - 2, 0);//2px for borders\n\t\tvar pr = document.createElement(\"div\");\n\t\tvar width = Math.round(maxWidth * done);\n\n\t\twidth = Math.min(maxWidth, width);\n\n\t\tpr.style.width = width + 'px';\n\t\tpr.className = \"gantt_task_progress\";\n\t\tpr.innerHTML = templates.progress_text(task.start_date, task.end_date, task);\n\n\t\tif(cfg.rtl){\n\t\t\tpr.style.position = \"absolute\";\n\t\t\tpr.style.right = \"0px\";\n\t\t}\n\n\t\tvar wrapper = document.createElement(\"div\");\n\t\twrapper.className = \"gantt_task_progress_wrapper\";\n\t\twrapper.appendChild(pr);\n\t\telement.appendChild(wrapper);\n\n\t\tconst taskEditable = !gantt.isReadonly(task);\n\t\tconst timelineDrag = gantt.ext.dragTimeline && gantt.ext.dragTimeline._isDragInProgress();\n\n\t\tif (gantt.config.drag_progress && (taskEditable || timelineDrag)) {\n\t\t\tvar drag = document.createElement(\"div\");\n\n\t\t\tvar markerPos = width;\n\t\t\tif(cfg.rtl){\n\t\t\t\tmarkerPos = maxWidth - width;\n\t\t\t}\n\n\t\t\tdrag.style.left = markerPos + 'px';\n\t\t\tdrag.className = \"gantt_task_progress_drag\";\n\t\t\tdrag.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"9\" viewBox=\"0 0 12 9\" fill=\"none\">\n<path d=\"M5.58397 1.52543C5.78189 1.22856 6.21811 1.22856 6.41602 1.52543L10.5475 7.72265C10.769 8.05493 10.5308 8.5 10.1315 8.5L1.86852 8.5C1.46917 8.5 1.23097 8.05493 1.45249 7.72265L5.58397 1.52543Z\" fill=\"var(--dhx-gantt-progress-handle-background)\" stroke=\"var(--dhx-gantt-progress-handle-border)\"/>\n</svg>`;\n\t\t\tpr.appendChild(drag);\n\t\t\telement.appendChild(drag);\n\t\t}\n\t}\n\n\tfunction _get_conditions(leftside) {\n\t\tif (leftside) {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.start_to_start\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.start_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_start\n\t\t\t\t]\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.finish_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t]\n\t\t\t};\n\t\t}\n\t}\n\n\tfunction _combine_item_class(basic, template, itemId, view) {\n\t\tvar cfg = view.$getConfig();\n\t\tvar css = [basic];\n\t\tif (template)\n\t\t\tcss.push(template);\n\n\t\tvar state = gantt.getState();\n\n\t\tvar task = gantt.getTask(itemId);\n\n\t\tif (gantt.getTaskType(task.type) == cfg.types.milestone) {\n\t\t\tcss.push(\"gantt_milestone\");\n\t\t}else if (gantt.getTaskType(task.type) == cfg.types.project) {\n\t\t\tcss.push(\"gantt_project\");\n\t\t}\n\n\t\tcss.push(\"gantt_bar_\" + gantt.getTaskType(task.type));\n\n\n\t\tif (gantt.isSummaryTask(task))\n\t\t\tcss.push(\"gantt_dependent_task\");\n\n\t\tif (gantt.isSplitTask(task) && ((cfg.open_split_tasks && !task.$open) || !cfg.open_split_tasks)) {\n\t\t\tcss.push(\"gantt_split_parent\");\n\t\t}\n\n\t\tif (cfg.select_task && gantt.isSelectedTask(itemId)) {\n\t\t\tcss.push(\"gantt_selected\");\n\t\t}\n\n\t\tif (itemId == state.drag_id) {\n\t\t\tcss.push(\"gantt_drag_\" + state.drag_mode);\n\t\t\tif (state.touch_drag) {\n\t\t\t\tcss.push(\"gantt_touch_\" + state.drag_mode);\n\t\t\t}\n\t\t}\n\n\t\tif (state.link_source_id == itemId){\n\t\t\tcss.push(\"gantt_link_source\");\n\t\t\tif(state.link_from_start) {\n\t\t\t\tcss.push(\"gantt_link_from_start\");\n\t\t\t}else{\n\t\t\t\tcss.push(\"gantt_link_from_end\");\n\t\t\t}\n\t\t}\n\n\t\tif (state.link_target_id == itemId)\n\t\t\tcss.push(\"gantt_link_target\");\n\n\n\t\tif (cfg.highlight_critical_path && gantt.isCriticalTask) {\n\t\t\tif (gantt.isCriticalTask(task))\n\t\t\t\tcss.push(\"gantt_critical_task\");\n\t\t}\n\n\t\tif (state.link_landing_area &&\n\t\t\t(state.link_target_id && state.link_source_id) &&\n\t\t\t(state.link_target_id != state.link_source_id) &&\n\t\t\t(state.link_target_id == itemId || state.link_source_id == itemId)) {\n\n\t\t\tvar from_id = state.link_source_id;\n\t\t\tvar from_start = state.link_from_start;\n\t\t\tvar to_start = state.link_to_start;\n\n\t\t\tvar allowDrag = gantt.isLinkAllowed(from_id, itemId, from_start, to_start);\n\n\t\t\tvar dragClass = \"\";\n\t\t\tif (allowDrag) {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_allow\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_allow\";\n\t\t\t} else {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_deny\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_deny\";\n\t\t\t}\n\t\t\tcss.push(dragClass);\n\t\t}\n\t\treturn css.join(\" \");\n\t}\n\n\tfunction _render_pair(parent, css, task, content, config, margin) {\n\t\tvar state = gantt.getState();\n\t\tvar className, element;\n\t\tif (+task.start_date >= +state.min_date) {\n\t\t\tclassName = [css, config.rtl ? \"task_right\" : \"task_left\", \"task_start_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"start_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginLeft = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t\tif (+task.end_date <= +state.max_date){\n\t\t\tclassName = [css, config.rtl ? \"task_left\" : \"task_right\", \"task_end_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"end_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginRight = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t}\n\n\treturn _render_task_element;\n}\n\nexport default createTaskRenderer;","// optimized checker for task bars smart rendering\n\n// first check the vertical position since it's easier to calculate\nexport default function isBarInViewport(item, viewport, view, config, gantt){\n\tif(!((item.start_date && item.end_date) || (item.$auto_start_date && item.$auto_end_date))){\n\t\treturn null;\n\t}\n\n\tvar top = view.getItemTop(item.id);\n\tvar height = view.getItemHeight(item.id);\n\n\tif(top > viewport.y_end || top + height < viewport.y){\n\t\treturn false;\n\t}\n\n\tvar padding = 200;\n\n\tconst coords = [];\n\tif(item.start_date){\n\t\tcoords.push(view.posFromDate(item.start_date));\n\t}\n\tif(item.end_date){\n\t\tcoords.push(view.posFromDate(item.end_date));\n\t}\n\tif(item.$auto_start_date){\n\t\tcoords.push(view.posFromDate(item.$auto_start_date));\n\t}\n\tif(item.$auto_end_date){\n\t\tcoords.push(view.posFromDate(item.$auto_end_date));\n\t}\n\t\n\tvar left = Math.min(...coords) - padding;\n\tvar right = Math.max(...coords) + padding;\n\n\tif(left > viewport.x_end || right < viewport.x){\n\t\treturn false;\n\t}\n\n\treturn true;\n};","function createTaskRenderer(gantt) {\n\n\tfunction _render_task_element(task, view, config) {\n\t\n\t\tvar config = view.$getConfig();\n\t\tvar painters = config.type_renderers;\n\t\tvar renderer = painters[gantt.getTaskType(task.type)],\n\t\t\tdefaultRenderer = _task_default_render;\n\n\t\tif (!renderer) {\n\t\t\treturn defaultRenderer.call(gantt, task, view, config);\n\t\t}else{\n\t\t\treturn renderer.call(gantt, task, function(task){ return defaultRenderer.call(gantt, task, view, config);}, view);\n\t\t}\n\t}\n\n\tfunction _task_default_render(task, view, config) {\n\t\tif (gantt._isAllowedUnscheduledTask(task))\n\t\t\treturn;\n\n\t\tif (!gantt._isTaskInTimelineLimits(task)) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar pos = view.getItemPosition(task);\n\n\t\tvar cfg = config,\n\t\t\ttemplates = view.$getTemplates();\n\n\t\tvar taskType = gantt.getTaskType(task.type);\n\t\tvar height = view.getBarHeight(task.id, taskType == cfg.types.milestone);\n\n\t\tvar controlsMargin = 0;\n\t\tif (taskType == cfg.types.milestone) {\n\t\t\tcontrolsMargin = (height - pos.height)/2;\n\t\t}\n\n\t\tvar padd = Math.floor((view.getItemHeight(task.id) - height) / 2);\n\n\t\tconst hasBaselines = gantt.config.baselines && task.baselines && task.baselines.length;\n\t\tconst baselinesOnDifferentRow = gantt.config.baselines && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\n\t\tif (hasBaselines && baselinesOnDifferentRow){\n\t\t\tif (task.bar_height !== \"full\" && task.bar_height < task.row_height){\n\t\t\t\tif (taskType === cfg.types.milestone){\n\t\t\t\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\n\t\t\t\t\tlet milestoneWidth = Math.sqrt(2 * milestoneHeight * milestoneHeight);\n\t\t\t\t\tpadd = Math.floor((milestoneWidth - height) / 2) + 2;\n\t\t\t\t} else {\n\t\t\t\t\tpadd = 2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar div = document.createElement(\"div\");\n\n\t\tvar width = Math.round(pos.width);\n\n\t\tif(view.$config.item_attribute) {\n\t\t\tdiv.setAttribute(view.$config.item_attribute, task.id);\n\t\t\tdiv.setAttribute(view.$config.bind + \"_id\", task.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\t// generate outline bracket with planned dates\n\n\t\tconst planned = document.createElement(\"div\");\n\t\t\n\t\tplanned.classList.add(\"gantt_task_line_planned\", \"gantt_task_line\" , \"gantt_project\");\n\t\tconst plannedCoords = view.getItemPosition(task, task.start_date, task.end_date);\n\t\tconst barHeight = 5;\n\t\tplanned.style.cssText = [\n\t\t\t\"position:absolute\",\n\t\t\t\"left:\" + plannedCoords.left + \"px\",\n\t\t\t\"top:\" + (padd/2 + 1) + 'px',\n\t\t\t\"height:\" + barHeight + 'px',\n\t\t\t\"width:\" + plannedCoords.width + 'px'\n\t\t].join(\";\");\n\t\tplanned.style.setProperty('--dhx-gantt-scheduled-summary-bracket-size', \"10px\");\n\n\t\tdiv.appendChild(planned);\n\t\t// generate element with actual dates & progress\n\n\t\tconst actual = document.createElement(\"div\");\n\t\tconst actualCoords = view.getItemPosition(task, task.$auto_start_date || task.start_date, task.$auto_end_date || task.end_date);\n\t\tactual.classList.add(\"gantt_task_line_actual\", \"gantt_task_line\" , \"gantt_project\");\n\t\tactual.style.cssText = [\n\t\t\t\"position:absolute\",\n\t\t\t\"left:\" + actualCoords.left + \"px\",\n\t\t\t\"top:\" + (barHeight*2 + 6) + 'px',\n\t\t\t\"height:\" + (barHeight + 3) + 'px',\n\t\t\t\"width:\" + actualCoords.width + 'px'\n\t\t].join(\";\");\n\n\t\tdiv.appendChild(actual);\n\n\t\tif (cfg.show_progress && taskType != cfg.types.milestone) {\n\t\t\t_render_task_progress(task, actual, width, cfg, templates);\n\t\t}\n\n\t\t//use separate div to display content above progress bar\n\t\t// var content = _render_task_content(task, width, templates);\n\n\t\t// actual.appendChild(content);\n\n\t\tvar css = _combine_item_class(\"gantt_task_line\",\n\t\t\ttemplates.task_class(task.$auto_start_date || task.start_date, task.$auto_end_date || task.end_date, task),\n\t\t\ttask.id,\n\t\t\tview);\n\t\tif (task.color || task.progressColor || task.textColor) {\n\t\t\tcss += \" gantt_task_inline_color\";\n\t\t}\n\t\tif (pos.width < 20){\n\t\t\tcss += \" gantt_thin_task\";\n\t\t}\n\n\n\t\tif(task.start_date > task.$auto_start_date || task.end_date < task.$auto_end_date){\n\t\t\tcss += \" gantt_project_scheduling_conflict\";\n\t\t}\n\n\t\tdiv.className = css;\n\n\t\tdiv.style.top = (padd + pos.top) + 'px';\n\t\tdiv.style.height = (taskType == cfg.types.milestone ? pos.height : height) + 'px';\n\t\tif (task.color) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-background\", task.color);\n\t\t}\n\t\tif (task.textColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-color\", task.textColor);\n\t\t}\n\n\t\tif (task.progressColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-progress-color\", task.progressColor);\n\t\t}\n\n\n\t\tvar side = _render_leftside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) planned.appendChild(side);\n\n\t\tside = _render_rightside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) planned.appendChild(side);\n\n\t\tgantt._waiAria.setTaskBarAttr(task, div);\n\n\t\tvar state = gantt.getState();\n\n\t\tif (!gantt.isReadonly(task)) {\n\t\t\tif (cfg.drag_resize) {\n\t\t\t\t_render_pair(planned, \"gantt_task_drag\", task, function (css) {\n\t\t\t\t\tvar el = document.createElement(\"div\");\n\t\t\t\t\tel.className = css;\n\t\t\t\t\treturn el;\n\t\t\t\t}, cfg);\n\t\t\t}\n\t\t\tif (cfg.drag_links && cfg.show_links) {\n\t\t\t\t_render_pair(planned, \"gantt_link_control\", task, function (css) {\n\t\t\t\t\tvar outer = document.createElement(\"div\");\n\t\t\t\t\touter.className = css;\n\t\t\t\t\touter.style.cssText = [\n\t\t\t\t\t\t\"height:\" + height + 'px',\n\t\t\t\t\t\t\"line-height:\" + height + 'px'\n\t\t\t\t\t].join(\";\");\n\t\t\t\t\tvar inner = document.createElement(\"div\");\n\t\t\t\t\tinner.className = \"gantt_link_point\";\n\n\t\t\t\t\tvar showLinkPoints = false;\n\t\t\t\t\tif(state.link_source_id && cfg.touch){\n\t\t\t\t\t\tshowLinkPoints = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tinner.style.display = showLinkPoints ? \"block\" : \"\";\n\t\t\t\t\touter.appendChild(inner);\n\t\t\t\t\treturn outer;\n\t\t\t\t}, cfg, controlsMargin);\n\t\t\t}\n\t\t}\n\t\treturn div;\n\t}\n\n\tfunction _render_side_content(task, template, cssClass, marginStyle) {\n\t\tif (!template) return null;\n\n\t\tvar text = template(task.start_date, task.end_date, task);\n\t\tif (!text) return null;\n\t\tvar content = document.createElement(\"div\");\n\t\tcontent.className = \"gantt_side_content \" + cssClass;\n\t\tcontent.innerHTML = text;\n\t\tif(marginStyle){\n\t\t\tcontent.style[marginStyle.type] = Math.abs(marginStyle.value) + \"px\";\n\t\t}\n\t\treturn content;\n\t}\n\n\tfunction _render_leftside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_left \" + _get_link_crossing_css(!cfg.rtl ? true : false, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginRight\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.leftside_text, css, marginStyle);\n\t}\n\n\tfunction _render_rightside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_right \" + _get_link_crossing_css(!cfg.rtl ? false : true, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginLeft\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.rightside_text, css, marginStyle);\n\t}\n\n\tfunction _get_link_crossing_css(left, task) {\n\t\tvar cond = _get_conditions(left);\n\n\t\tfor (var i in cond) {\n\t\t\tvar links = task[i];\n\t\t\tfor (var ln = 0; ln < links.length; ln++) {\n\t\t\t\tvar link = gantt.getLink(links[ln]);\n\n\t\t\t\tfor (var tp = 0; tp < cond[i].length; tp++) {\n\t\t\t\t\tif (link.type == cond[i][tp]) {\n\t\t\t\t\t\treturn \"gantt_link_crossing\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\n\t// function _render_task_content(task, width, templates) {\n\t// \tvar content = document.createElement(\"div\");\n\t// \tif (gantt.getTaskType(task.type) != gantt.config.types.milestone){\n\t// \t\tcontent.innerHTML = templates.task_text(task.start_date, task.end_date, task);\n\t// \t} else if(gantt.getTaskType(task.type) == gantt.config.types.milestone && width) {\n\t// \t\tcontent.style.height = content.style.width = width + \"px\";\n\t// \t}\n\t// \tcontent.className = \"gantt_task_content\";\n\t// \t//content.style.width = width + 'px';\n\t// \treturn content;\n\t// }\n\n\tfunction _render_task_progress(task, element, maxWidth, cfg, templates) {\n\t\tvar done = task.progress * 1 || 0;\n\n\t\tmaxWidth = Math.max(maxWidth - 2, 0);//2px for borders\n\t\tvar pr = document.createElement(\"div\");\n\t\tvar width = Math.round(maxWidth * done);\n\n\t\twidth = Math.min(maxWidth, width);\n\t\tif (task.progressColor) {\n\t\t\tpr.style.backgroundColor = task.progressColor;\n\t\t\tpr.style.opacity = 1;\n\t\t}\n\t\tpr.style.width = width + 'px';\n\t\tpr.className = \"gantt_task_progress\";\n\t\tpr.innerHTML = templates.progress_text(task.start_date, task.end_date, task);\n\n\t\tif(cfg.rtl){\n\t\t\tpr.style.position = \"absolute\";\n\t\t\tpr.style.right = \"0px\";\n\t\t}\n\n\t\tvar wrapper = document.createElement(\"div\");\n\t\twrapper.className = \"gantt_task_progress_wrapper\";\n\t\twrapper.appendChild(pr);\n\t\telement.appendChild(wrapper);\n\n\t\tif (gantt.config.drag_progress && !gantt.isReadonly(task)) {\n\t\t\tvar drag = document.createElement(\"div\");\n\n\t\t\tvar markerPos = width;\n\t\t\tif(cfg.rtl){\n\t\t\t\tmarkerPos = maxWidth - width;\n\t\t\t}\n\n\t\t\tdrag.style.left = markerPos + 'px';\n\t\t\tdrag.className = \"gantt_task_progress_drag\";\n\t\t\tpr.appendChild(drag);\n\t\t\telement.appendChild(drag);\n\t\t}\n\t}\n\n\tfunction _get_conditions(leftside) {\n\t\tif (leftside) {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.start_to_start\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.start_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_start\n\t\t\t\t]\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.finish_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t]\n\t\t\t};\n\t\t}\n\t}\n\n\tfunction _combine_item_class(basic, template, itemId, view) {\n\t\tvar cfg = view.$getConfig();\n\t\tvar css = [basic];\n\t\tif (template)\n\t\t\tcss.push(template);\n\n\t\tvar state = gantt.getState();\n\n\t\tvar task = gantt.getTask(itemId);\n\n\t\tif (gantt.getTaskType(task.type) == cfg.types.milestone) {\n\t\t\tcss.push(\"gantt_milestone\");\n\t\t}else if (gantt.getTaskType(task.type) == cfg.types.project) {\n\t\t\tcss.push(\"gantt_project\");\n\t\t}\n\n\t\tcss.push(\"gantt_bar_\" + gantt.getTaskType(task.type));\n\n\n\t\tif (gantt.isSummaryTask(task))\n\t\t\tcss.push(\"gantt_dependent_task\");\n\n\t\tif (gantt.isSplitTask(task) && ((cfg.open_split_tasks && !task.$open) || !cfg.open_split_tasks)) {\n\t\t\tcss.push(\"gantt_split_parent\");\n\t\t}\n\n\t\tif (cfg.select_task && gantt.isSelectedTask(itemId)) {\n\t\t\tcss.push(\"gantt_selected\");\n\t\t}\n\n\t\tif (itemId == state.drag_id) {\n\t\t\tcss.push(\"gantt_drag_\" + state.drag_mode);\n\t\t\tif (state.touch_drag) {\n\t\t\t\tcss.push(\"gantt_touch_\" + state.drag_mode);\n\t\t\t}\n\t\t}\n\n\t\tif (state.link_source_id == itemId)\n\t\t\tcss.push(\"gantt_link_source\");\n\n\t\tif (state.link_target_id == itemId)\n\t\t\tcss.push(\"gantt_link_target\");\n\n\n\t\tif (cfg.highlight_critical_path && gantt.isCriticalTask) {\n\t\t\tif (gantt.isCriticalTask(task))\n\t\t\t\tcss.push(\"gantt_critical_task\");\n\t\t}\n\n\t\tif (state.link_landing_area &&\n\t\t\t(state.link_target_id && state.link_source_id) &&\n\t\t\t(state.link_target_id != state.link_source_id) &&\n\t\t\t(state.link_target_id == itemId || state.link_source_id == itemId)) {\n\n\t\t\tvar from_id = state.link_source_id;\n\t\t\tvar from_start = state.link_from_start;\n\t\t\tvar to_start = state.link_to_start;\n\n\t\t\tvar allowDrag = gantt.isLinkAllowed(from_id, itemId, from_start, to_start);\n\n\t\t\tvar dragClass = \"\";\n\t\t\tif (allowDrag) {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_allow\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_allow\";\n\t\t\t} else {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_deny\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_deny\";\n\t\t\t}\n\t\t\tcss.push(dragClass);\n\t\t}\n\t\treturn css.join(\" \");\n\t}\n\n\tfunction _render_pair(parent, css, task, content, config, margin) {\n\t\tvar state = gantt.getState();\n\t\tvar className, element;\n\t\tif (+task.start_date >= +state.min_date) {\n\t\t\tclassName = [css, config.rtl ? \"task_right\" : \"task_left\", \"task_start_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"start_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginLeft = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t\tif (+task.end_date <= +state.max_date){\n\t\t\tclassName = [css, config.rtl ? \"task_left\" : \"task_right\", \"task_end_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"end_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginRight = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t}\n\n\treturn _render_task_element;\n}\n\nexport default createTaskRenderer;","import isBarInViewport from \"./is_bar_in_viewport\";\nexport default function isSplitTaskInViewport(item, viewport, view, config, gantt){\n\tif (!gantt.isSplitTask(item)) {\n\t\treturn false;\n\t}\n\n\tvar range = gantt.getSubtaskDates(item.id);\n\n\treturn isBarInViewport({\n\t\tid: item.id,\n\t\tstart_date: range.start_date,\n\t\tend_date: range.end_date,\n\t\tparent: item.parent\n\t}, viewport, view, gantt);\n};","export default function(item, view, config){\n\treturn {\n\t\ttop: view.getItemTop(item.id),\n\t\theight: view.getItemHeight(item.id),\n\t\tleft: 0,\n\t\tright: Infinity\n\t};\n};","export default function getVisibleCellsRange(scale, viewport){\n\tvar firstCellIndex = 0;\n\tvar lastCellIndex = scale.left.length - 1;\n\tif(viewport){\n\t\tfor(var i = 0; i < scale.left.length; i++){\n\t\t\tvar left = scale.left[i];\n\t\t\tif(left < viewport.x){\n\t\t\t\tfirstCellIndex = i;\n\t\t\t}\n\t\t\tif(left > viewport.x_end){\n\t\t\t\tlastCellIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\tstart: firstCellIndex,\n\t\tend: lastCellIndex\n\t};\n};","import isLegacyRender from \"../is_legacy_smart_render\";\n\nexport default function isColumnVisible(columnIndex, scale, viewPort, gantt){\n\tvar width = scale.width[columnIndex];\n\tif(width <= 0){\n\t\treturn false;\n\t}\n\tif(!gantt.config.smart_rendering || isLegacyRender(gantt)){\n\t\treturn true;\n\t}\n\tvar cellLeftCoord = scale.left[columnIndex] - width;\n\tvar cellRightCoord = scale.left[columnIndex] + width;\n\treturn (cellLeftCoord <= viewPort.x_end && cellRightCoord >= viewPort.x);//do not render skipped columns\n};","export default function (items, gantt){\n\tvar placeholderConfig = gantt.config.timeline_placeholder;\n\titems = items || [];\n\tif (placeholderConfig && items.filter(e => e.id === 'timeline_placeholder_task').length === 0){\n\t\tvar state = gantt.getState();\n\t\tvar lastTaskId = null;\n\t\tvar start_date = state.min_date;\n\t\tvar end_date = state.max_date;\n\t\tif (items.length){\n\t\t\tlastTaskId = items[items.length -1].id;\n\t\t}\n\t\tvar placeholderTask = {\n\t\t\tstart_date: start_date, \n\t\t\tend_date: end_date, \n\t\t\trow_height: placeholderConfig.height || 0,\n\t\t\tid: \"timeline_placeholder_task\", \n\t\t\tunscheduled: true,\n\t\t\tlastTaskId: lastTaskId, \n\t\t\tcalendar_id: placeholderConfig.calendar || \"global\",\n\t\t\t$source:[], \n\t\t\t$target: []\n\t\t};\n\t\titems.push(placeholderTask);\n\t}\n};","import isInViewPort from \"./viewport/is_link_in_viewport\";\nimport getVisibleRange from \"./viewport/factory/get_visible_link_range\";\nimport { childrenHaveBaselines, getMaxParentHeight } from \"./baseline_helper\";\n\n\nfunction createLinkRender(gantt){\n\nfunction _render_link_element(link, view, config) {\n\tvar source = gantt.getTask(link.source);\n\tif(source.hide_bar){\n\t\treturn;\n\t}\n\n\tvar target = gantt.getTask(link.target);\n\tif(target.hide_bar){\n\t\treturn;\n\t}\n\n\tvar pt = path_builder.get_endpoint(link, view, source, target);\n\tvar dy = pt.e_y - pt.y;\n\tvar dx = pt.e_x - pt.x;\n\tif(!dx && !dy){\n\t\treturn null;\n\t}\n\n\n\tvar dots = path_builder.get_points(link, view, source, target);\n\tconst lines = drawer.get_lines(dots, view);\n\n\tconst shapes = transform_lines_to_shapes(lines.filter(l => l.size > 0), config);\n  \n\tconst div = render_shapes(shapes, view, link, config);\n\n\n\tvar css = \"gantt_task_link\";\n\n\tif (link.color) {\n\t\tcss += \" gantt_link_inline_color\";\n\t}\n\tvar cssTemplate = gantt.templates.link_class ? gantt.templates.link_class(link) : \"\";\n\tif (cssTemplate) {\n\t\tcss += \" \" + cssTemplate;\n\t}\n\n\tif (config.highlight_critical_path && gantt.isCriticalLink) {\n\t\tif (gantt.isCriticalLink(link))\n\t\t\tcss += \" gantt_critical_link\";\n\t}\n\n\tdiv.className = css;\n\n\tif(view.$config.link_attribute){\n\t\tdiv.setAttribute(view.$config.link_attribute, link.id);\n\t\tdiv.setAttribute(\"link_id\", link.id);\n\t}\n\tif (link.color) {\n\t\tdiv.style.setProperty(\"--dhx-gantt-link-background\", link.color);\n\t}\n\n\tgantt._waiAria.linkAttr(link, div);\n\n\treturn div;\n}\n\n\tfunction render_shapes(shapes, view, link, config) {\n\t\tconst container = document.createElement(\"div\");\n\n\t\tshapes.forEach(shape => {\n\t\t\tlet element;\n\t\t\tif (shape.type === 'line') {\n\t\t\t\telement = drawer.render_line(shape.data, null, view, link.source);\n\t\t\t} else if (shape.type === 'corner') {\n\t\t\t\telement = drawer.render_corner(shape.data, view);\n\t\t\t}else if (shape.type === 'arrow') {\n\t\t\t\telement = drawer.render_arrow(shape.data, config);\n\t\t\t}\n\n\t\t\tcontainer.appendChild(element);\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tfunction transform_lines_to_shapes(lines, config) {\n\t\tconst radius = config.link_radius || 4;\n\t\tconst arrowSize = config.link_arrow_size || 6; // Arrow size from config\n\t\tconst shapes = [];\n\t\n\t\tfor (let i = 0; i < lines.length; i++) {\n\t\t\tconst line = lines[i];\n\t\t\tconst nextLine = lines[i + 1];\n\t\n\t\t\tif (!nextLine || config.link_radius <= 1) {\n\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\t\t\tcontinue;\n\t\t\t}\n\t\n\t\t\tif (line.direction !== nextLine.direction) {\n\t\t\t\tif(line.size < radius || nextLine.size < radius){\n\t\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tline.size -= radius;\n\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\n\t\t\t\tlet cornerX = line.x;\n\t\t\t\tlet cornerY = line.y - config.link_line_width / 2;\n\t\n\t\t\t\tswitch (line.direction) {\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tcornerX += line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'left':\n\t\t\t\t\t\tcornerX -= line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'down':\n\t\t\t\t\t\tcornerY += line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'up':\n\t\t\t\t\t\tcornerY -= line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\n\t\t\t\tconst corner = {\n\t\t\t\t\tx: cornerX,\n\t\t\t\t\ty: cornerY,\n\t\t\t\t\tdirection: { from: line.direction, to: nextLine.direction },\n\t\t\t\t\tradius\n\t\t\t\t};\n\t\t\t\tshapes.push({ type: 'corner', data: corner });\n\t\n\t\t\t\tswitch (nextLine.direction) {\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tnextLine.x += radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'left':\n\t\t\t\t\t\tnextLine.x -= radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'down':\n\t\t\t\t\t\tnextLine.y += radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'up':\n\t\t\t\t\t\tnextLine.y -= radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\t\t}\n\t\t}\n\t\n\t\tconst lastLine = lines[lines.length - 1];\n\t\n\t\tif (lastLine.direction === 'right' || lastLine.direction === 'left') {\n\t\t\tlastLine.size -= arrowSize*3/4; \n\t\n\t\t\tlet arrowX = lastLine.direction === 'right' ? (lastLine.x + lastLine.size) : lastLine.x - lastLine.size - arrowSize/2;\n\t\t\tlet arrowY = lastLine.y - (config.link_line_width / 2) - (arrowSize / 2) + 1;\n\t\n\t\t\tif(lastLine.direction === 'left'){\n\t\t\t\tarrowY -= 1;// left pointing arrows for some reason need adjustments\n\t\t\t\tarrowX -= 2;\n\t\t\t}else{\n\t\t\t\tarrowX -= 1;\n\t\t\t}\n\t\t\tconst arrow = {\n\t\t\t\tx: arrowX,\n\t\t\t\ty: arrowY,\n\t\t\t\tsize: arrowSize,\n\t\t\t\tdirection: lastLine.direction\n\t\t\t};\n\t\n\t\t\tshapes.push({ type: 'line', data: lastLine });\n\t\t\tshapes.push({ type: 'arrow', data: arrow });\n\t\t} else {\n\t\t\tshapes.push({ type: 'line', data: lastLine });\n\t\t}\n\t\n\t\treturn shapes;\n\t}\n\t\n\n\nvar drawer = {\n\tcurrent_pos: null,\n\tdirs: {\"left\": 'left', \"right\": 'right', \"up\": 'up', \"down\": 'down'},\n\tpath: [],\n\tclear: function () {\n\t\tthis.current_pos = null;\n\t\tthis.path = [];\n\t},\n\tpoint: function (pos) {\n\t\tthis.current_pos = gantt.copy(pos);\n\t},\n\tget_lines: function (dots) {\n\t\tthis.clear();\n\t\tthis.point(dots[0]);\n\t\tfor (var i = 1; i < dots.length; i++) {\n\t\t\tthis.line_to(dots[i]);\n\t\t}\n\t\treturn this.get_path();\n\t},\n\tline_to: function (pos) {\n\t\tvar next = gantt.copy(pos);\n\t\tvar prev = this.current_pos;\n\n\t\tvar line = this._get_line(prev, next);\n\t\tthis.path.push(line);\n\t\tthis.current_pos = next;\n\t},\n\tget_path: function () {\n\t\treturn this.path;\n\t},\n\tget_wrapper_sizes: function (v, view, itemId) {\n\t\tvar config = view.$getConfig();\n\t\tvar res,\n\t\t\twrapper_size = config.link_wrapper_width,\n\t\t\ty = v.y - (wrapper_size) / 2;\n\t\tswitch (v.direction) {\n\t\t\tcase this.dirs.left:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y,\n\t\t\t\t\theight: wrapper_size,\n\t\t\t\t\tlineHeight: wrapper_size,\n\t\t\t\t\tleft: v.x - v.size - wrapper_size / 2,\n\t\t\t\t\twidth: v.size + wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.right:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y,\n\t\t\t\t\tlineHeight: wrapper_size,\n\t\t\t\t\theight: wrapper_size,\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\n\t\t\t\t\twidth: v.size + wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.up:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y - v.size,\n\t\t\t\t\tlineHeight: v.size + wrapper_size,\n\t\t\t\t\theight: v.size + wrapper_size,\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\n\t\t\t\t\twidth: wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.down:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y /*- wrapper_size/2*/,\n\t\t\t\t\tlineHeight: v.size + wrapper_size,\n\t\t\t\t\theight: v.size + wrapper_size,\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\n\t\t\t\t\twidth: wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn res;\n\t},\n\tget_line_sizes: function (v, view) {\n\t\tvar config = view.$getConfig();\n\t\tvar res,\n\t\t\tline_size = config.link_line_width,\n\t\t\twrapper_size = config.link_wrapper_width,\n\t\t\tsize = v.size + line_size;\n\t\tswitch (v.direction) {\n\t\t\tcase this.dirs.left:\n\t\t\tcase this.dirs.right:\n\t\t\t\tres = {\n\t\t\t\t\theight: line_size,\n\t\t\t\t\twidth: size,\n\t\t\t\t\tmarginTop: (wrapper_size - line_size) / 2,\n\t\t\t\t\tmarginLeft: (wrapper_size - line_size) / 2\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.up:\n\t\t\tcase this.dirs.down:\n\t\t\t\tres = {\n\t\t\t\t\theight: size,\n\t\t\t\t\twidth: line_size,\n\t\t\t\t\tmarginTop: (wrapper_size - line_size) / 2,\n\t\t\t\t\tmarginLeft: (wrapper_size - line_size) / 2\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\n\t\treturn res;\n\t},\n\trender_line: function (v, end, view, itemId) {\n\t\tvar pos = this.get_wrapper_sizes(v, view, itemId);\n\t\tvar wrapper = document.createElement(\"div\");\n\t\twrapper.style.cssText = [\n\t\t\t\"top:\" + pos.top + \"px\",\n\t\t\t\"left:\" + pos.left + \"px\",\n\t\t\t\"height:\" + pos.height + \"px\",\n\t\t\t\"width:\" + pos.width + \"px\"\n\t\t].join(';');\n\t\twrapper.className = \"gantt_line_wrapper\";\n\n\t\tvar innerPos = this.get_line_sizes(v, view);\n\t\tvar inner = document.createElement(\"div\");\n\t\tinner.style.cssText = [\n\t\t\t\"height:\" + innerPos.height + \"px\",\n\t\t\t\"width:\" + innerPos.width + \"px\",\n\t\t\t\"margin-top:\" + innerPos.marginTop + \"px\",\n\t\t\t\"margin-left:\" + innerPos.marginLeft + \"px\"\n\t\t].join(\";\");\n\n\t\tinner.className = \"gantt_link_line_\" + v.direction;\n\t\twrapper.appendChild(inner);\n\n\t\treturn wrapper;\n\t},\n\n\trender_corner: function (corner, view) {\n\t\tconst radius = corner.radius;\n\t\tconst config = view.$getConfig();\n\t\tconst lineWidth = config.link_line_width || 2;\n\t\tconst cornerDiv = document.createElement(\"div\");\n\t\n\t\tcornerDiv.classList.add(\"gantt_link_corner\");\n\t\tcornerDiv.classList.add(`gantt_link_corner_${corner.direction.from}_${corner.direction.to}`);\n\t\n\t\tcornerDiv.style.width = `${radius}px`;\n\t\tcornerDiv.style.height = `${radius}px`;\n\t\n\t\tlet borderVertical;\n\t\tlet borderHorizontal;\n\n\t\tif (corner.direction.from === 'right' && corner.direction.to === 'down') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'down' && corner.direction.to === 'right') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'right' && corner.direction.to === 'up') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t} else if (corner.direction.from === 'up' && corner.direction.to === 'right') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t} else if (corner.direction.from === 'left' && corner.direction.to === 'down') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'down' && corner.direction.to === 'left') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'left' && corner.direction.to === 'up') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t} else if (corner.direction.from === 'up' && corner.direction.to === 'left') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t}\n\n\t\tcornerDiv.style[`border${borderHorizontal}Width`] = `${lineWidth}px`;\n\t\tcornerDiv.style[`border${borderVertical}Width`] = `${lineWidth}px`;\n\t\tcornerDiv.style[`border${borderVertical}Style`] = `solid`;\n\t\tcornerDiv.style[`border${borderHorizontal}Style`] = `solid`;\n\t\tcornerDiv.style[`border${borderHorizontal}${borderVertical}Radius`] = `${radius}px`;\n\n\t\n\t\treturn cornerDiv;\n\t},\n\n\trender_arrow(arrow, config) {\n\t\tvar div = document.createElement(\"div\");\n\t\tvar top = arrow.y;\n\t\tvar left = arrow.x;\n\t\n\t\tvar size = config.link_arrow_size;\n\t\tdiv.style.setProperty(\"--dhx-gantt-icon-size\", `${size}px`);\n\t\n\t\tvar className = \"gantt_link_arrow gantt_link_arrow_\" + arrow.direction;\n\n\t\tdiv.style.top = top + \"px\";\n\t\tdiv.style.left = left + 'px';\n\t\tdiv.className = className;\n\t\n\t\treturn div;\n\t},\n\t\n\t_get_line: function (from, to) {\n\t\tvar direction = this.get_direction(from, to);\n\t\tvar vect = {\n\t\t\tx: from.x,\n\t\t\ty: from.y,\n\t\t\tdirection: this.get_direction(from, to)\n\t\t};\n\t\tif (direction == this.dirs.left || direction == this.dirs.right) {\n\t\t\tvect.size = Math.abs(from.x - to.x);\n\t\t} else {\n\t\t\tvect.size = Math.abs(from.y - to.y);\n\t\t}\n\t\treturn vect;\n\t},\n\tget_direction: function (from, to) {\n\t\tvar direction = 0;\n\t\tif (to.x < from.x) {\n\t\t\tdirection = this.dirs.left;\n\t\t} else if (to.x > from.x) {\n\t\t\tdirection = this.dirs.right;\n\t\t} else if (to.y > from.y) {\n\t\t\tdirection = this.dirs.down;\n\t\t} else {\n\t\t\tdirection = this.dirs.up;\n\t\t}\n\t\treturn direction;\n\t}\n\n};\n\nvar path_builder = {\n\n\tpath: [],\n\tclear: function () {\n\t\tthis.path = [];\n\t},\n\tcurrent: function () {\n\t\treturn this.path[this.path.length - 1];\n\t},\n\tpoint: function (next) {\n\t\tif (!next)\n\t\t\treturn this.current();\n\n\t\tthis.path.push(gantt.copy(next));\n\t\treturn next;\n\t},\n\tpoint_to: function (direction, diff, point) {\n\t\tif (!point)\n\t\t\tpoint = gantt.copy(this.point());\n\t\telse\n\t\t\tpoint = {x: point.x, y: point.y};\n\t\tvar dir = drawer.dirs;\n\t\tswitch (direction) {\n\t\t\tcase (dir.left):\n\t\t\t\tpoint.x -= diff;\n\t\t\t\tbreak;\n\t\t\tcase (dir.right):\n\t\t\t\tpoint.x += diff;\n\t\t\t\tbreak;\n\t\t\tcase (dir.up):\n\t\t\t\tpoint.y -= diff;\n\t\t\t\tbreak;\n\t\t\tcase (dir.down):\n\t\t\t\tpoint.y += diff;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn this.point(point);\n\t},\n\tget_points: function (link, view, source, target) {\n\t\tvar pt = this.get_endpoint(link, view, source, target);\n\t\tvar xy = gantt.config;\n\n\t\tvar dy = pt.e_y - pt.y;\n\t\tvar dx = pt.e_x - pt.x;\n\n\t\tvar dir = drawer.dirs;\n\n\t\tvar rowHeight = view.getItemHeight(link.source);\n\n\t\tthis.clear();\n\t\tthis.point({x: pt.x, y: pt.y});\n\n\t\tvar shiftX = 2 * xy.link_arrow_size;//just random size for first line\n\t\tvar lineType = this.get_line_type(link, view.$getConfig());\n\n\t\tvar forward = (pt.e_x > pt.x);\n\t\tif (lineType.from_start && lineType.to_start) {\n\t\t\tthis.point_to(dir.left, shiftX);\n\t\t\tif (forward) {\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t} else {\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t}\n\t\t\tthis.point_to(dir.right, shiftX);\n\n\t\t} else if (!lineType.from_start && lineType.to_start) {\n\t\t\t// GS-2619. No need to add loops for the split tasks (zero dy means the tasks are on the same line)\n\t\t\tif (dy !== 0){\n\t\t\t\tforward = (pt.e_x > (pt.x + 2 * shiftX));\n\t\t\t}\n\t\t\tthis.point_to(dir.right, shiftX);\n\t\t\tif (forward) {\n\t\t\t\tdx -= shiftX;\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t} else {\n\t\t\t\tdx -= 2 * shiftX;\n\t\t\t\tvar sign = dy > 0 ? 1 : -1;\n\n\t\t\t\tthis.point_to(dir.down, sign * (rowHeight / 2));\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, sign * ( Math.abs(dy) - (rowHeight / 2)));\n\t\t\t\tthis.point_to(dir.right, shiftX);\n\t\t\t}\n\n\t\t} else if (!lineType.from_start && !lineType.to_start) {\n\t\t\tthis.point_to(dir.right, shiftX);\n\t\t\tif (forward) {\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t} else {\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t}\n\t\t\tthis.point_to(dir.left, shiftX);\n\t\t} else if (lineType.from_start && !lineType.to_start) {\n\t\t\t// GS-2619. No need to add loops for the split tasks (zero dy means the tasks are on the same line)\n\t\t\tif (dy !== 0){\n\t\t\t\tforward = (pt.e_x > (pt.x - 2 * shiftX));\n\t\t\t}\n\t\t\tthis.point_to(dir.left, shiftX);\n\n\t\t\tif (!forward) {\n\t\t\t\tdx += shiftX;\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t} else {\n\t\t\t\tdx += 2 * shiftX;\n\t\t\t\tvar sign = dy > 0 ? 1 : -1;\n\t\t\t\tthis.point_to(dir.down, sign * (rowHeight / 2));\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, sign * ( Math.abs(dy) - (rowHeight / 2)));\n\t\t\t\tthis.point_to(dir.left, shiftX);\n\t\t\t}\n\n\t\t}\n\n\t\treturn this.path;\n\t},\n\tget_line_type: function(link, config){\n\t\tvar types = config.links;\n\t\tvar from_start = false, to_start = false;\n\t\tif (link.type == types.start_to_start) {\n\t\t\tfrom_start = to_start = true;\n\t\t} else if (link.type == types.finish_to_finish) {\n\t\t\tfrom_start = to_start = false;\n\t\t} else if (link.type == types.finish_to_start) {\n\t\t\tfrom_start = false;\n\t\t\tto_start = true;\n\t\t} else if (link.type == types.start_to_finish) {\n\t\t\tfrom_start = true;\n\t\t\tto_start = false;\n\t\t} else {\n\t\t\tgantt.assert(false, \"Invalid link type\");\n\t\t}\n\n\t\tif(config.rtl){\n\t\t\tfrom_start = !from_start;\n\t\t\tto_start = !to_start;\n\t\t}\n\n\t\treturn {from_start: from_start, to_start: to_start};\n\t},\n\n\tget_endpoint: function (link, view, source, target) {\n\t\tvar config = view.$getConfig();\n\n\t\tvar lineType = this.get_line_type(link, config);\n\t\tvar from_start = lineType.from_start,\n\t\t\tto_start = lineType.to_start;\n\n\t\tvar from = getMilestonePosition(source, view, config),\n\t\t\tto = getMilestonePosition(target, view, config);\n\n\t\treturn {\n\t\t\tx: from_start ? from.left : (from.left + from.width),\n\t\t\te_x: to_start ? to.left : (to.left + to.width),\n\t\t\ty: from.top + (from.rowHeight/2) - 1,\n\t\t\te_y: to.top + (to.rowHeight/2) - 1\n\t\t};\n\t}\n};\n\nfunction getMilestonePosition(task, view, config){\n\tvar pos = view.getItemPosition(task);\n\n\t// GS-2270: Link to the split children shouldn't exceed the parent row height\n\tlet splitParams = getMaxParentHeight(gantt, view, task);\n\tlet maxHeight = splitParams.maxHeight;\n\n\tlet splitChild = splitParams.splitChild;\n\tconst baselinesOnDifferentRow = gantt.config.baselines && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\n\tconst baselines = baselinesOnDifferentRow && task.baselines && task.baselines.length;\n\n\tif (splitParams.shrinkHeight){\n\t\tpos.rowHeight = maxHeight;\n\t}\n\n\tlet milestoneWidth;\n\tlet milestoneTask = gantt.getTaskType(task.type) == config.types.milestone;\n\tif(milestoneTask){\n\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\n\t\tmilestoneWidth = Math.sqrt(2*milestoneHeight*milestoneHeight);\n\t\tif (splitParams.shrinkHeight && maxHeight < milestoneHeight){\n\t\t\tmilestoneHeight = maxHeight;\n\t\t\tmilestoneWidth = maxHeight;\n\t\t}\n\t\tpos.left -= milestoneWidth / 2;\n\t\tpos.width = milestoneWidth;\n\t} \n\tif (splitChild){\n\t\tif (maxHeight >= pos.height) {\n\t\t\tconst siblingBaselines = childrenHaveBaselines(gantt, task.parent);\n\t\t\tif (baselines || siblingBaselines){\n\t\t\t\tif (milestoneTask){\n\t\t\t\t\tpos.rowHeight = pos.height + 4;\n\t\t\t\t\tpos.left += (pos.width - pos.rowHeight + 4) / 2;\n\t\t\t\t\tpos.width = pos.rowHeight - 3;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tpos.rowHeight = pos.height + 6;\n\t\t\t\t}\n\t\t\t} else if (milestoneTask) {\n\t\t\t\tpos.left += (milestoneWidth - pos.height) / 2;\n\t\t\t}\n\t\t} else {\n\t\t\tpos.rowHeight = maxHeight + 2;\n\t\t\tif (milestoneTask){\n\t\t\t\tpos.left += (pos.width - pos.rowHeight + 4) / 2;\n\t\t\t\tpos.width = pos.rowHeight - 3;\n\t\t\t}\n\t\t}\n\t} else if (baselines){\n\t\tpos.rowHeight = pos.height + 4;\n\t}\n\n\treturn pos;\n}\n\n\nreturn {\n\trender: _render_link_element,\n\tupdate: null,\n\t//getRectangle: getLinkRectangle\n\tisInViewPort: isInViewPort,\n\tgetVisibleRange: getVisibleRange()\n};\n}\n\nexport default createLinkRender;","export default function(item, viewport, view, config, gantt){\n    // GS-2481 and GS-1715, don't remove selected task when using keyboard shortcuts and when the inline editor is opened\n    if(gantt.$ui.getView(\"grid\") && ((gantt.config.keyboard_navigation && gantt.getSelectedId()) || (gantt.ext.inlineEditors && gantt.ext.inlineEditors.getState().id))) {\n\t\t//GS-2661: selected task might be collapsed\n\t\tif(!item.$expanded_branch) return false;\n\t\treturn true;\n\t}\n    var top = view.getItemTop(item.id);\n\tvar height = view.getItemHeight(item.id);\n\n\tif(top > viewport.y_end || top + height < viewport.y){\n\t\treturn false;\n\t}\n\n\treturn true;\n};","import * as helpers from \"../utils/helpers\";\n\nexport default function createResourceTimelineBuilder(gantt){\n\n\tlet resourceTaskCache = {};\n\n\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(){\n\t\tresourceTaskCache = {};\n\t});\n\n\tfunction getResourceLoad(resource, resourceProperty, scale, timeline){\n\t\tconst cacheKey = resource.id + \"_\" + resourceProperty  + \"_\" + scale.unit + \"_\" + scale.step;\n\t\tlet res;\n\t\tif (!resourceTaskCache[cacheKey]) {\n\t\t\tres = resourceTaskCache[cacheKey] = calculateResourceLoad(resource, resourceProperty, scale, timeline);\n\n\t\t} else {\n\t\t\tres = resourceTaskCache[cacheKey];\n\t\t}\n\t\treturn res;\n\t}\n\n\tfunction calculateResourceLoadFromAssignments(items, scale, assignmentsPassed){\n\t\tconst scaleUnit = scale.unit;\n\t\tconst scaleStep = scale.step;\n\t\tconst timegrid = {};\n\n\t\tconst precalculatedTimes = {};\n\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\tconst item = items[i];\n\t\t\tlet task = item;\n\t\t\tif(assignmentsPassed){\n\t\t\t\ttask = gantt.getTask(item.task_id);\n\t\t\t}\n\t\t\tif (task.unscheduled){\n\t\t\t\tcontinue; // do not process assignments for unscheduled tasks\n\t\t\t}\n\t\t\tlet minDate = (item.start_date || task.start_date);\n\t\t\tlet maxDate = (item.end_date || task.end_date);\n\t\t\tif(assignmentsPassed){\n\t\t\t\tif(item.start_date){\n\t\t\t\t\tminDate = new Date(Math.max(item.start_date.valueOf(), task.start_date.valueOf()));\n\t\t\t\t}\n\t\t\t\tif(item.end_date){\n\t\t\t\t\tmaxDate = new Date(Math.min(item.end_date.valueOf(), task.end_date.valueOf()));\n\t\t\t\t}\n\t\t\t\t// GS-2063: handle case with fixedDates mode\n\t\t\t\tif(item.mode && item.mode == \"fixedDates\"){\n\t\t\t\t\tminDate = item.start_date;\n\t\t\t\t\tmaxDate = item.end_date;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet firstColumn = helpers.findBinary(scale.trace_x, minDate.valueOf());\n\t\t\tlet minScaleDate = new Date(scale.trace_x[firstColumn] || gantt.date[scaleUnit + \"_start\"](new Date(minDate)));\n\t\t\t// GS-2307: need to take into account that task could start before the min scale date\n\t\t\t// so the task would be added to timegrid\n\t\t\tlet currDate = new Date(Math.min(minDate.valueOf(), minScaleDate.valueOf())); \n\n\t\t\tlet calendar = gantt.config.work_time ? gantt.getTaskCalendar(task) : gantt;\n\t\t\tprecalculatedTimes[calendar.id] = {};\n\t\t\twhile (currDate < maxDate) {\n\t\t\t\tconst cachedTimes = precalculatedTimes[calendar.id];\n\n\t\t\t\tlet date = currDate;\n\t\t\t\tconst timestamp = date.valueOf();\n\n\t\t\t\tcurrDate = gantt.date.add(currDate, scaleStep, scaleUnit);\n\n\t\t\t\tif(cachedTimes[timestamp] === false){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!timegrid[timestamp]){\n\t\t\t\t\ttimegrid[timestamp] = {tasks: [], assignments: []};\n\t\t\t\t}\n\n\t\t\t\ttimegrid[timestamp].tasks.push(task);\n\t\t\t\tif(assignmentsPassed){\n\t\t\t\t\ttimegrid[timestamp].assignments.push(item);\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\treturn timegrid;\n\t}\n\n\tfunction calculateResourceLoad(resource, resourceProperty, scale, timeline) {\n\n\t\tlet items;\n\t\tlet assignmentsPassed = false;\n\t\tlet timegrid = {};\n\n\t\tif(gantt.config.process_resource_assignments && resourceProperty === gantt.config.resource_property){\n\t\t\tif(resource.$role == \"task\"){\n\t\t\t\titems = gantt.getResourceAssignments(resource.$resource_id, resource.$task_id);\n\t\t\t}else{\n\t\t\t\titems = gantt.getResourceAssignments(resource.id);\n\t\t\t}\n\n\t\t\tassignmentsPassed = true;\n\t\t}else if(resource.$role == \"task\"){\n\t\t\titems = [];\n\t\t}else{\n\t\t\titems = gantt.getTaskBy(resourceProperty, resource.id);\n\t\t}\n\n\t\ttimegrid = calculateResourceLoadFromAssignments(items, scale, assignmentsPassed);\n\t\tconst scaleUnit = scale.unit;\n\t\tconst scaleStep = scale.step;\n\n\t\tconst timetable = [];\n\t\tlet start, end, tasks, assignments, cell;\n\t\tconst config = timeline.$getConfig();\n\n\t\tfor(let i = 0; i < scale.trace_x.length; i++){\n\t\t\tstart = new Date(scale.trace_x[i]);\n\t\t\tend = gantt.date.add(start, scaleStep, scaleUnit);\n\t\t\tcell = timegrid[start.valueOf()] || {};\n\t\t\ttasks = cell.tasks || [];\n\t\t\tassignments = cell.assignments || [];\n\t\t\tif(tasks.length || config.resource_render_empty_cells){\n\t\t\t\ttimetable.push({\n\t\t\t\t\tstart_date: start,\n\t\t\t\t\tend_date: end,\n\t\t\t\t\ttasks: tasks,\n\t\t\t\t\tassignments: assignments\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\ttimetable.push(null);\n\t\t\t}\n\t\t}\n\n\t\treturn timetable;\n\t}\n\n\n\n\treturn getResourceLoad;\n};","import getRectangle from \"./viewport/get_bg_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\nimport isColumnVisible from \"./viewport/is_column_visible\";\nimport resourceTimetable from \"../../resource_timetable_builder\";\n\nfunction renderBar(level, start, end, timeline){\n\tvar top = (1 - (level*1||0))*100;\n\tvar left = timeline.posFromDate(start);\n\tvar right = timeline.posFromDate(end);\n\tvar element = document.createElement(\"div\");\n\telement.className = \"gantt_histogram_hor_bar\";\n\telement.style.top = top + '%';\n\telement.style.left = left + \"px\";\n\telement.style.width = (right - left + 1) + \"px\";\n\treturn element;\n}\nfunction renderConnection(prevLevel, nextLevel, left){\n\tif(prevLevel === nextLevel){\n\t\treturn null;\n\t}\n\n\tvar top = 1 - Math.max(prevLevel, nextLevel);\n\tvar height = Math.abs(prevLevel - nextLevel);\n\tvar element = document.createElement(\"div\");\n\telement.className = \"gantt_histogram_vert_bar\";\n\telement.style.top = top*100 + \"%\";\n\telement.style.height = height*100 + \"%\";\n\telement.style.left = left + \"px\";\n\n\treturn element;\n}\n\nfunction generateRenderResourceHistogram(gantt){\n\tvar getResourceLoad = resourceTimetable(gantt);\n\tvar renderedHistogramCells = {};\n\tvar renderedHistogramRows = {};\n\tvar renderedHistogramCapacity = {};\n\n\tfunction detachRenderedHistogramCell(id, index){\n\n\t\tvar renderedRow = renderedHistogramCells[id];\n\t\tif(renderedRow && renderedRow[index] &&\n\t\t\trenderedRow[index].parentNode\n\t\t\t){\n\t\t\t\trenderedRow[index].parentNode.removeChild(renderedRow[index]);\n\t\t\t}\n\t}\n\n\tfunction renderHistogramLine(capacity, timeline, maxCapacity, viewport){\n\t\tvar scale = timeline.getScale();\n\n\t\tvar el = document.createElement(\"div\");\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\t\tfor (var i = range.start; i <= range.end; i++) {\n\t\t\tvar colStart = scale.trace_x[i];\n\t\t\tvar colEnd = scale.trace_x[i + 1] || gantt.date.add(colStart, scale.step, scale.unit);\n\t\t\tvar col = scale.trace_x[i].valueOf();\n\t\t\tvar level = Math.min(capacity[col]/maxCapacity, 1) || 0;\n\t\t\t// do not render histogram for lines with below zero capacity, as it's reserved for folders\n\t\t\tif(level < 0){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar nextLevel = Math.min(capacity[colEnd.valueOf()]/maxCapacity, 1) || 0;\n\t\t\tvar bar = renderBar(level, colStart, colEnd, timeline);\n\t\t\tif(bar){\n\t\t\t\tel.appendChild(bar);\n\t\t\t}\n\t\t\tvar connection = renderConnection(level, nextLevel, timeline.posFromDate(colEnd));\n\t\t\tif(connection){\n\t\t\t\tel.appendChild(connection);\n\t\t\t}\n\n\t\t}\n\t\treturn el;\n\t}\n\n\tfunction renderCapacityElement(resource, sizes, capacityMatrix, config, timeline, maxCapacity, viewport){\n\n\t\tvar renderedElement = renderedHistogramCapacity[resource.id];\n\t\tif(renderedElement && renderedElement.parentNode){\n\t\t\trenderedElement.parentNode.removeChild(renderedElement);\n\t\t}\n\n\t\tvar capacityElement = renderHistogramLine(capacityMatrix, timeline, maxCapacity, viewport);\n\t\tif (capacityElement && sizes) {\n\t\t\tcapacityElement.setAttribute(\"data-resource-id\", resource.id);\n\t\t\tcapacityElement.setAttribute(timeline.$config.item_attribute, resource.id);\n\t\t\tcapacityElement.style.position = \"absolute\";\n\t\t\tcapacityElement.style.top = (sizes.top + 1) + \"px\";\n\t\t\tcapacityElement.style.height = (timeline.getItemHeight(resource.id) - 1) + \"px\";\n\t\t\tcapacityElement.style.left = 0;\n\t\t}\n\t\treturn capacityElement;\n\t}\n\n\tfunction renderHistogramCell(resource, sizes, maxCapacity, config, templates, day, timeline){\n\t\tvar css = templates.histogram_cell_class(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar content = templates.histogram_cell_label(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar fill = templates.histogram_cell_allocated(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar height = timeline.getItemHeight(resource.id) - 1;\n\t\tif(css || content){\n\t\t\tvar el = document.createElement('div');\n\t\t\tel.className = [\"gantt_histogram_cell\", css].join(\" \");\n\t\t\tel.setAttribute(timeline.$config.item_attribute, resource.id);\n\t\t\tel.style.cssText = [\n\t\t\t\t'left:' + sizes.left + 'px',\n\t\t\t\t'width:' + sizes.width + 'px',\n\t\t\t\t'height:' + (height) + 'px',\n\t\t\t\t'line-height:' + (height) + 'px',\n\t\t\t\t'top:' + (sizes.top + 1) + 'px'\n\t\t\t].join(\";\");\n\n\n\t\t\tif (content) {\n\t\t\t\tcontent = \"<div class='gantt_histogram_label'>\" + content +\"</div>\";\n\t\t\t}\n\n\t\t\tif (fill) {\n\t\t\t\tcontent = \"<div class='gantt_histogram_fill' style='height:\"+(Math.min(fill/maxCapacity||0, 1)*100)+\"%;'></div>\" + content;\n\t\t\t}\n\n\t\t\tif (content) {\n\t\t\t\tel.innerHTML = content;\n\t\t\t}\n\n\t\t\treturn el;\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction renderResourceHistogram(resource, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, scale, timeline);\n\n\t\tvar cells = [];\n\t\tvar capacityMatrix = {};\n\t\tvar maxCapacity = resource.capacity || timeline.$config.capacity || 24;\n\t\trenderedHistogramCells[resource.id] = {};\n\t\trenderedHistogramRows[resource.id] = null;\n\t\trenderedHistogramCapacity[resource.id] = null;\n\n\t\tvar smartRendering = !!viewport;//no viewport means smart rendering is disabled\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(smartRendering && !isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar capacity = templates.histogram_cell_capacity(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\t\tcapacityMatrix[day.start_date.valueOf()] = capacity || 0;\n\t\t\tvar sizes = timeline.getItemPosition(resource, day.start_date, day.end_date);\n\n\t\t\tvar el = renderHistogramCell(resource, sizes, maxCapacity, config, templates, day, timeline);\n\t\t\tif(el){\n\t\t\t\tcells.push(el);\n\t\t\t\trenderedHistogramCells[resource.id][columnIndex] = el;\n\t\t\t}\n\t\t}\n\n\t\tvar row = null;\n\t\tif (cells.length) {\n\t\t\trow = document.createElement(\"div\");\n\t\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\t\trow.appendChild(cells[i]);\n\t\t\t}\n\n\t\t\tvar capacityElement = renderCapacityElement(resource, sizes, capacityMatrix, config, timeline, maxCapacity, viewport);\n\t\t\tif(capacityElement){\n\t\t\t\trow.appendChild(capacityElement);\n\t\t\t\trenderedHistogramCapacity[resource.id] = capacityElement;\n\t\t\t}\n\t\t\trenderedHistogramRows[resource.id] = row;\n\t\t}\n\n\t\treturn row;\n\t}\n\n\tfunction updateResourceHistogram(resource, node, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, scale, timeline);\n\t\tvar maxCapacity = resource.capacity || timeline.$config.capacity || 24;\n\t\tvar capacityMatrix = {};\n\n\t\tvar smartRendering = !!viewport;//no viewport means smart rendering is disabled\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\n\t\tvar checkedColumns = {};\n\t\tif(renderedHistogramCells && renderedHistogramCells[resource.id]){\n\t\t\tfor(var i in renderedHistogramCells[resource.id]){\n\t\t\t\tcheckedColumns[i] = i;\n\t\t\t}\n\t\t}\n\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tcheckedColumns[columnIndex] = false;\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar capacity = templates.histogram_cell_capacity(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\t\tcapacityMatrix[day.start_date.valueOf()] = capacity || 0;\n\t\t\tvar sizes = timeline.getItemPosition(resource, day.start_date, day.end_date);\n\n\t\t\tif(smartRendering && !isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tdetachRenderedHistogramCell(resource.id, columnIndex);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar renderedCell = renderedHistogramCells[resource.id];\n\t\t\tif(!renderedCell || !renderedCell[columnIndex]){\n\t\t\t\tvar el = renderHistogramCell(resource, sizes, maxCapacity, config, templates, day, timeline);\n\t\t\t\tif(el){\n\t\t\t\t\tnode.appendChild(el);\n\t\t\t\t\trenderedHistogramCells[resource.id][columnIndex] = el;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(renderedCell && renderedCell[columnIndex] && !renderedCell[columnIndex].parentNode){\n\t\t\t\tnode.appendChild(renderedCell[columnIndex]);\n\t\t\t}\n\t\t}\n\n\t\tfor(var i in checkedColumns){\n\t\t\tif(checkedColumns[i] !== false){\n\t\t\t\tdetachRenderedHistogramCell(resource.id, i);\n\t\t\t}\n\t\t}\n\n\t\tvar capacityElement = renderCapacityElement(resource, sizes, capacityMatrix, config, timeline, maxCapacity, viewport);\n\t\tif(capacityElement){\n\t\t\tnode.appendChild(capacityElement);\n\t\t\trenderedHistogramCapacity[resource.id] = capacityElement;\n\t\t}\n\t}\n\n\treturn {\n\t\trender: renderResourceHistogram,\n\t\tupdate: updateResourceHistogram,\n\t\tgetRectangle: getRectangle,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default generateRenderResourceHistogram;","import isBarInViewport from \"./is_bar_in_viewport\";\nexport default function areDatesInViewPort(task, viewport, view, config, gantt, dateProperties ){\n\tconst bar = {\n\t\tid: task.id,\n\t\tparent: task.id\n\t};\n\n\tfunction checkTaskProperties(task){\n\t\tconst hasAllDates = task[dateProperties.start_date] && task[dateProperties.end_date];\n\t\tif (!hasAllDates) {\n\t\t\treturn false;\n\t\t}\n\t\n\t\tfor (let i = 0; i < dateProperties.length; i++) {\n\t\t\tif (!task[dateProperties[i]]){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tconst taskProperties = checkTaskProperties(task);\n\tlet childProperties = false;\n\n\tif (taskProperties){\n\t\tbar.start_date = task[dateProperties.start_date];\n\t\tbar.end_date = task[dateProperties.end_date];\t\n\t}\n\n\tif (task.render == \"split\"){\n\t\tgantt.eachTask(function(child){\n\t\t\tif (checkTaskProperties(child)){\n\t\t\t\tchildProperties = true;\n\t\t\t\tbar.start_date = bar.start_date || child[dateProperties.start_date];\n\t\t\t\tbar.end_date = bar.end_date || child[dateProperties.end_date];\n\n\t\t\t\tif (bar.start_date < child[dateProperties.start_date]){\n\t\t\t\t\tbar.start_date = child[dateProperties.start_date];\n\t\t\t\t}\n\t\t\t\tif (bar.end_date > child[dateProperties.end_date]){\n\t\t\t\t\tbar.end_date = child[dateProperties.end_date];\t\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tif (taskProperties || childProperties){\n\t\treturn isBarInViewport(bar, viewport, view, gantt);\n\t} else {\n\t\treturn false;\n\t}\n};","import getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport areDatesInViewPort from \"./viewport/are_dates_in_viewport\";\nimport { childrenHaveBaselines, getAdjustedPosition, isSplitParent } from \"./baseline_helper\";\n\nfunction isConstraintInViewPort (item, viewport, view, config, gantt){\n  if (gantt.config.auto_scheduling && gantt.config.auto_scheduling.show_constraints !== false){\n    const dateProperties = {\n      start_date: \"constraint_date\",\n      end_date: \"constraint_date\",\n      additional_properties: [\"constraint_type\"]\n    };\n    return areDatesInViewPort(item, viewport, view, config, gantt, dateProperties);\n  } else {\n    // don't process constraints when they shouldn't be displayed\n    return false;\n  }\n}\n\nfunction createTaskRenderer(gantt) {\n  // we need that for the use case when the constraints have different names\n  const constraintNames = {};\n  for (let prop in gantt.config.constraint_types) {\n    constraintNames[gantt.config.constraint_types[prop]] = prop;\n  }\n\n  function getConstraintName(task) {\n    const constraintValue = gantt.getConstraintType(task);\n    const commonName = constraintNames[constraintValue].toLowerCase();\n    return commonName;\n  }\n\n  function generateConstraintNode(task, timeline, childBaselines){\n    const constraintType = getConstraintName(task);\n    if (constraintType == \"asap\" || constraintType == \"alap\"){\n      return false;\n    }\n    const el = document.createElement(\"div\");\n    const sizes = gantt.getTaskPosition(task, task.constraint_date, task.constraint_date);\n\n    const heightLimit = 30;\n    let { height, marginTop } = getAdjustedPosition(gantt, timeline, sizes, heightLimit, task, childBaselines);\n\n    let width = height;\n\n    let marginLeft = 0;\n    switch (constraintType) {\n      case \"snet\":\n      case \"fnet\":\n      case \"mso\":\n        if (gantt.config.rtl){\n          marginLeft = 1;\n        }\n        else {\n          marginLeft = -width - 1;\n        }\n\n        break;\n      case \"snlt\":\n      case \"fnlt\":\n      case \"mfo\":\n        if (gantt.config.rtl){\n          marginLeft = -width - 1;\n        }\n        else {\n          marginLeft = 1;\n        }\n        break;\n\n    }\n\n    if (task.type === gantt.config.types.milestone){\n      marginTop -= 1;\n    }\n\n    el.style.height = height + \"px\";\n    el.style.width = width + \"px\";\n\n    el.style.left = sizes.left + \"px\";\n    el.style.top = sizes.top + \"px\";\n    \n    el.style.marginLeft = marginLeft + \"px\";\n    el.style.marginTop = marginTop + \"px\";\n\n    el.className = \"gantt_constraint_marker gantt_constraint_marker_\" + constraintType;\n    \n    switch (constraintType) {\n      case \"snet\":\n      case \"snlt\":\n      case \"fnet\":\n      case \"fnlt\":\n        el.innerHTML = `<svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<g id=\"Start No Later Than\">\n<line id=\"Line 3\" x1=\"30.5\" y1=\"6.92097e-08\" x2=\"30.5\" y2=\"32\" stroke=\"#555D63\" stroke-width=\"3\" stroke-dasharray=\"3 3\"/>\n<path id=\"Vector\" d=\"m 18.3979,23.5 v -6 H 3.05161 L 3,14.485 H 18.3979 V 8.5 L 27,16 Z\" fill=\"#555D63\"/>\n</g>\n</svg>\n`;\n      break;\n      case \"mfo\":\n      case \"mso\":\n        el.innerHTML = `<svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<g id=\"Must Start On \">\n<path id=\"Vector\" d=\"m 18.3979,23.5 v -6 H 3.05161 L 3,14.485 H 18.3979 V 8.5 L 27,16 Z\" fill=\"#555D63\"/>\n<line id=\"line\" x1=\"30.5\" y1=\"-6.55671e-08\" x2=\"30.5\" y2=\"32\" stroke=\"black\" stroke-opacity=\"0.7\" stroke-width=\"3\"/>\n</g>\n</svg>\n`;\n        break;\n    }\n    \n    \n    el.setAttribute(\"data-task-id\", task.id);\n\n    return el;\n  }\n\n  function renderConstraints(task, timeline, config, viewPort) {\n    if(gantt.config.auto_scheduling_compatibility){\n      return;\n    }\n    if (gantt.config.auto_scheduling && gantt.config.auto_scheduling.show_constraints !== false){\n      const constraintNodes = document.createElement(\"div\");\n      constraintNodes.className = \"gantt_constraint_nodes\";\n      constraintNodes.setAttribute(\"data-task-row-id\", task.id);\n  \n      if (task.constraint_date && task.constraint_type) {\n        const taskConstraint = generateConstraintNode(task, timeline);\n        if (taskConstraint){\n          constraintNodes.appendChild(taskConstraint);  \n        }\n      }\n\n      if (isSplitParent(task)){\n        const childBaselines = childrenHaveBaselines(gantt, task.id);\n        gantt.eachTask(function(child){\n          if (child.constraint_date && child.constraint_type) {\n            const childConstraint = generateConstraintNode(child, timeline, childBaselines);\n            if (childConstraint){\n              constraintNodes.appendChild(childConstraint);\n            }\n          }\n        }, task.id);\n      }\n  \n      if (constraintNodes.childNodes.length){\n        return constraintNodes;\n      }\n  \n    }\n  }\n  return {\n    render: renderConstraints,\n    isInViewPort: isConstraintInViewPort,\n    getVisibleRange: getVisibleRange\n  };\n}\n\nexport default createTaskRenderer;\n","import getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport areDatesInViewPort from \"./viewport/are_dates_in_viewport\";\nimport { childrenHaveBaselines, getAdjustedPosition, isSplitParent } from \"./baseline_helper\";\n\nfunction isDeadlineInViewPort (item, viewport, view, config, gantt){\n\tconst dateProperties = {\n\t\tstart_date: \"deadline\",\n\t\tend_date: \"deadline\"\n\t};\n\treturn areDatesInViewPort(item, viewport, view, config, gantt, dateProperties);\n}\n\nfunction createTaskRenderer(gantt) {\n\n  function generateDeadlineNode(task, timeline, childBaselines){\n    const el = document.createElement(\"div\");\n\n    const sizes = gantt.getTaskPosition(task, task.deadline, task.deadline);\n\n    const heightLimit = 20;\n    const { height, marginTop } = getAdjustedPosition(gantt, timeline, sizes, heightLimit, task, childBaselines);\n    \n    let width = height;\n\n    if (gantt.config.rtl){\n      sizes.left += width;\n    }\n\n    el.style.left = sizes.left - width + \"px\";\n    el.style.top = sizes.top + \"px\";\n    el.style.marginTop = marginTop + \"px\";\n\n    el.style.width = width + \"px\";\n    el.style.height = height + \"px\";\n\n    el.style.fontSize = height + \"px\";\n\n    el.className = \"gantt_task_deadline\";\n    el.setAttribute(\"data-task-id\", task.id);\n\n    return el;\n  }\n\n  function renderDeadline(task, timeline, config, viewPort) {\n    const deadlineNodes = document.createElement(\"div\");\n    deadlineNodes.className = \"gantt_deadline_nodes\";\n    deadlineNodes.setAttribute(\"data-task-row-id\", task.id);\n\n    if (task.deadline) {\n      const taskDeadline = generateDeadlineNode(task, timeline);\n      deadlineNodes.appendChild(taskDeadline);\n    }\n    if (isSplitParent(task)){\n      const childBaselines = childrenHaveBaselines(gantt, task.id);\n      gantt.eachTask(function(child){\n        if (child.deadline){\n          const childDeadline = generateDeadlineNode(child, timeline, childBaselines);\n          deadlineNodes.appendChild(childDeadline);\n        }\n      }, task.id);\n    }\n\n    if (deadlineNodes.childNodes.length){\n      return deadlineNodes;\n    }\n  }\n  return {\n    render: renderDeadline,\n    isInViewPort: isDeadlineInViewPort,\n    getVisibleRange: getVisibleRange\n  };\n}\n\nexport default createTaskRenderer;\n","import getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport areDatesInViewPort from \"./viewport/are_dates_in_viewport\";\nimport { getMaxParentHeight, getMilestoneHeight, getInvertedMilestoneHeight, isSplitParent } from \"./baseline_helper\";\n\nfunction isBaselineInViewPort (task, viewport, view, config, gantt){\n  let inViewport = false;\n  const dateProperties = {\n    start_date: \"start_date\",\n    end_date: \"end_date\"\n  };\n  if (task.type == gantt.config.types.milestone){\n    dateProperties.end_date = dateProperties.start_date;\n  }\n\n  if (task.baselines){\n    inViewport = iterateBaselines(task, viewport, view, config, gantt, dateProperties);\n  }\n  if (isSplitParent(task)){\n    gantt.eachTask(function(child){\n      if (inViewport){\n        return;\n      }\n      if (child.baselines && child.baselines.length) {\n        if (child.type == gantt.config.types.milestone){\n          dateProperties.end_date = dateProperties.start_date;\n        }      \n        if (iterateBaselines(child, viewport, view, config, gantt, dateProperties)){\n          inViewport = true;\n        }\n      }\n    }, task.id);\n  }\n\n  return inViewport;\n}\n\nfunction iterateBaselines(task, viewport, view, config, gantt, dateProperties){\n  for (var i = 0; i < task.baselines.length; i++) {\n    const baseline = {\n      id: task.id,\n      parent: task.parent,\n      start_date: task.baselines[i].start_date,\n      end_date: task.baselines[i].end_date\n    };\n    if (areDatesInViewPort(baseline, viewport, view, config, gantt, dateProperties)){\n      return true;\n    }\n  }\n}\n\nfunction createBaselineRenderer(gantt) {\n\n  function generateBaselineNode(task, baseline, index, timeline, splitChild){\n    const el = document.createElement(\"div\");\n    let baselineEnd = baseline.end_date;\n    let milestoneTask = task.type === gantt.config.types.milestone;\n    if (milestoneTask){\n      baselineEnd = baseline.start_date;\n    }\n    const sizes = gantt.getTaskPosition(task, baseline.start_date, baselineEnd);\n\n    let milestoneMarginTop = 0;\n    let milestoneWidth;\n    if (milestoneTask){\n      let milestoneHeight = timeline.getBarHeight(task.id, true);\n      milestoneWidth = getMilestoneHeight(milestoneHeight);\n      milestoneMarginTop = Math.floor((milestoneWidth - milestoneHeight) / 4);\n    }\n\n    let parentHeight = getMaxParentHeight(gantt, timeline, task, sizes.rowHeight);\n    let maxHeight = parentHeight.maxHeight;\n\n\n    let top = sizes.top + 1 + milestoneMarginTop;\n    let height = timeline.getBarHeight(task.id, task.type);\n    const baselineSubrowHeight = gantt.config.baselines.row_height;\n    const baselineBarHeight = gantt.config.baselines.bar_height;\n\n    // between task and first baseline\n    let siblingBaselinesSize;\n    let marginTop;\n\n    switch (gantt.config.baselines.render_mode) {\n      case \"separateRow\":\n        top += sizes.height + (baselineSubrowHeight - baselineBarHeight) / 2;\n        height = baselineBarHeight;\n        break;\n\n      case \"individualRow\":\n       // betweenBaselines = 3 * (index + 1);\n        siblingBaselinesSize = (baselineSubrowHeight) * index;\n        top += sizes.height + siblingBaselinesSize + (baselineSubrowHeight - baselineBarHeight) / 2;\n    \n        height = baselineBarHeight;\n        break;\n    \n      case \"taskRow\":\n      default:\n        // TODO: simplify positioning\n        marginTop = 1;\n        if (splitChild){\n          maxHeight = getMaxParentHeight(gantt, timeline, task).maxHeight;\n          if (milestoneMarginTop){\n            if (maxHeight >= milestoneWidth){\n              marginTop = (maxHeight - height) / 2 - 1 - milestoneMarginTop;\n            } else {\n              height = getInvertedMilestoneHeight(maxHeight);\n              top = sizes.top;\n              marginTop = Math.abs(height - maxHeight) / 2;\n              milestoneMarginTop = 0; // for maxBottom\n            }\n          } else {\n            if (maxHeight > height){\n              marginTop = (maxHeight - height) / 2 - 1;\n            } \n            marginTop -= milestoneMarginTop;  \n          }\n          if(!task.bar_height){\n            marginTop -= 1;\n          }else{\n           // marginTop += 1;\n          }\n        } else {\n          if (task.bar_height && sizes.rowHeight >= task.bar_height){\n            marginTop = (sizes.rowHeight - task.bar_height) / 2 - 1;\n          }\n          marginTop += milestoneMarginTop;\n\n          if(!task.bar_height){\n            marginTop += 2;\n          }\n          if (milestoneTask){\n            marginTop += 1;\n          }\n \n        }\n        break;\n    }\n\n    let maxBottom = sizes.top + maxHeight + 1 - milestoneMarginTop;\n\n\n    // don't exceed maximal task row height\n    if (top + height > maxBottom){\n      height -= top + height - maxBottom;\n      if (height <= 0) {\n        return false;\n      }\n    }\n\n\n    el.style.left = sizes.left + \"px\";\n    el.style.width = sizes.width + \"px\";\n    el.style.top = top + \"px\";\n    el.style.height = Math.floor(height) + \"px\";\n    if(marginTop){\n      el.style.marginTop = marginTop + \"px\";\n    }\n    el.className = `gantt_task_baseline gantt_task_baseline_${index} ${baseline.className || \"\"}`;\n\n    if (milestoneTask){\n      el.className += \"gantt_milestone_baseline\";\n      el.style.width = el.style.height = height + \"px\";\n      el.style.marginLeft = Math.floor(-height / 2) + \"px\";\n    } else {\n      el.innerHTML = gantt.templates.baseline_text(task, baseline, index);\n    }\n\n\n    el.setAttribute(\"data-task-id\", task.id);\n    el.setAttribute(\"data-baseline-id\", baseline.id);\n\n    return el;\n  }\n\n  function renderBaseline(task, timeline, config, viewPort) {\n    if (!gantt.config.baselines.render_mode){\n      return;\n    }\n\n    const baselineNodes = document.createElement(\"div\");\n    baselineNodes.className = \"gantt_baseline_nodes\";\n    baselineNodes.setAttribute(\"data-task-row-id\", task.id);\n\n    if (task.baselines && task.baselines.length) {\n      task.baselines.forEach(function(baseline, index){\n        const taskBaseline = generateBaselineNode(task, baseline, index, timeline);\n        if (taskBaseline){\n          baselineNodes.appendChild(taskBaseline);  \n        }\n      });\n    }\n    if (isSplitParent(task)){\n      gantt.eachTask(function(child){\n        if (child.baselines && child.baselines.length) {\n          child.baselines.forEach(function(baseline, index){\n            const childBaseline = generateBaselineNode(child, baseline, index, timeline, true);\n            if (childBaseline){\n              baselineNodes.appendChild(childBaseline);  \n            }\n          });\n        }\n      }, task.id);\n    }\n\n    if (baselineNodes.childNodes.length){\n      return baselineNodes;\n    }\n  }\n  return {\n    render: renderBaseline,\n    isInViewPort: isBaselineInViewPort,\n    getVisibleRange: getVisibleRange\n  };\n}\n\nexport default createBaselineRenderer;\n","import * as domHelpers from \"../utils/dom_helpers\";\nimport isPlaceholderTask from \"../../../utils/placeholder_task\";\n\nfunction _init_dnd(gantt, grid) {\n\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\tif(!grid.$config.bind || !gantt.getDatastore(grid.$config.bind)){\n\t\treturn;\n\t}\n\n\tfunction locate(e){\n\t\treturn domHelpers.locateAttribute(e, grid.$config.item_attribute);\n\t}\n\n\tfunction getStore(){\n\t\treturn gantt.getDatastore(grid.$config.bind);\n\t}\n\n\tfunction checkPlaceholderTask(id){\n\t\treturn isPlaceholderTask(id, gantt, getStore());\n\t}\n\n\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\n\tif (gantt.defined(grid.$getConfig().dnd_sensitivity))\n\t\tdnd.config.sensitivity = grid.$getConfig().dnd_sensitivity;\n\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\t\tif (!el) return false;\n\t\tif (gantt.hideQuickInfo) gantt.hideQuickInfo();\n\n\t\tif (domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\")){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar id = el.getAttribute(grid.$config.item_attribute);\n\t\tif (checkPlaceholderTask(id)) return false;\n\n\t\tvar datastore = getStore();\n\n\t\tvar task = datastore.getItem(id);\n\n\t\tif (gantt.isReadonly(task))\n\t\t\treturn false;\n\n\t\tdnd.config.initial_open_state = task.$open;\n\t\tif (!gantt.callEvent(\"onRowDragStart\", [id, e.target || e.srcElement, e])) {\n\t\t\treturn false;\n\t\t}\n\n\t}, gantt));\n\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\t\tdnd.config.marker.innerHTML = el.outerHTML;\n\t\tvar element = dnd.config.marker.firstChild;\n\t\tif(element){\n\t\t\telement.style.position = \"static\";\n\t\t}\n\n\t\tdnd.config.id = el.getAttribute(grid.$config.item_attribute);\n\n\t\tvar store = getStore();\n\n\t\tvar task = store.getItem(dnd.config.id);\n\t\tdnd.config.index = store.getBranchIndex(dnd.config.id);\n\t\tdnd.config.parent = task.parent;\n\t\ttask.$open = false;\n\t\ttask.$transparent = true;\n\t\tthis.refreshData();\n\t}, gantt));\n\n\tdnd.lastTaskOfLevel = function (level) {\n\t\tvar last_item = null;\n\t\tvar store = getStore();\n\t\tvar tasks = store.getItems();\n\t\tfor (var i = 0, len = tasks.length; i < len; i++) {\n\t\t\tif (tasks[i].$level == level) {\n\t\t\t\tlast_item = tasks[i];\n\t\t\t}\n\t\t}\n\t\treturn last_item ? last_item.id : null;\n\t};\n\tdnd._getGridPos = gantt.bind(function (e) {\n\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\n\t\t// row offset\n\t\tvar x = pos.x + grid.$grid.scrollLeft;\n\t\tvar y = e.pos.y - 10;\n\n\t\tvar rowHeight = grid.getItemHeight(dnd.config.id);\n\t\t// prevent moving row out of grid_data container\n\t\tif (y < pos.y) y = pos.y;\n\t\tvar gridHeight = grid.getTotalHeight();\n\t\tif (y > pos.y + gridHeight - rowHeight) y = pos.y + gridHeight - rowHeight;\n\t\tconst maxBottom = pos.y + pos.height;\n\t\tif (y > maxBottom - rowHeight) {\n\t\t\ty = maxBottom - rowHeight;\n\t\t}\n\n\t\tpos.x = x;\n\t\tpos.y = y;\n\t\treturn pos;\n\t}, gantt);\n\tdnd._getTargetY = gantt.bind(function (e) {\n\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\n\t\tvar scrollPos = grid.$state.scrollTop || 0;\n\t\tvar maxBottom = gantt.$grid_data.getBoundingClientRect().height + scrollPos;\n\n\t\tvar y = e.pageY - pos.y + scrollPos;\n\t\tif (y > maxBottom) {\n\t\t\ty = maxBottom;\n\t\t} else if (y < scrollPos) {\n\t\t\ty = scrollPos;\n\t\t}\n\t\treturn y;\n\t}, gantt);\n\tdnd._getTaskByY = gantt.bind(function (y, dropIndex) {\n\n\t\tvar store = getStore();\n\n\t\ty = y || 0;\n\n\t\tvar index = grid.getItemIndexByTopPosition(y);\n\t\tindex = dropIndex < index ? index - 1 : index;\n\n\t\tif (index > store.countVisible() - 1)\n\t\t\treturn null;\n\n\t\treturn store.getIdByIndex(index);\n\t}, gantt);\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function (obj, e) {\n\t\tvar gridDataSizes = gantt.$grid_data.getBoundingClientRect();\n\t\tvar maxBottom = gridDataSizes.height + gridDataSizes.y + (grid.$state.scrollTop || 0) + window.scrollY;\n\t\tvar dd = dnd.config;\n\t\tvar pos = dnd._getGridPos(e);\n\n\t\tgantt._waiAria.reorderMarkerAttr(dd.marker);\n\n\t\tvar config = grid.$getConfig(),\n\t\t\tstore = getStore();\n\n\t\t// setting position of row\n\t\tif (pos.y < maxBottom) {\n\t\t\tdd.marker.style.top = pos.y + \"px\";\n\t\t} else {\n\t\t\tdd.marker.style.top = maxBottom + \"px\";\n\t\t}\n\t\tdd.marker.style.left = pos.x + 10 + \"px\";\n\t\tconst containerSize = domHelpers.getNodePosition(gantt.$root);\n\t\tif (pos.width > containerSize.width){\n\t\t\tdd.marker.style.width = containerSize.width - 10 - 2 + \"px\";\n\t\t\tdd.marker.style.overflow = \"hidden\";\t\n\t\t}\n\n\t\t// highlight row when mouseover\n\t\tvar item = store.getItem(dnd.config.id);\n\t\tvar targetY = dnd._getTargetY(e);\n\t\tvar el = dnd._getTaskByY(targetY, store.getIndexById(item.id));\n\n\t\tif (!store.exists(el)) {\n\t\t\tel = dnd.lastTaskOfLevel(config.order_branch_free ? item.$level : 0);\n\t\t\tif (el == dnd.config.id) {\n\t\t\t\tel = null;\n\t\t\t}\n\t\t}\n\n\t\tfunction allowedLevel(next, item) {\n\t\t\treturn (!(store.isChildOf(over.id, item.id)) && (next.$level == item.$level || config.order_branch_free));\n\t\t}\n\n\t\tif (store.exists(el)) {\n\t\t\tvar over = store.getItem(el);\n\n\t\t\tvar itemTop = grid.getItemTop(over.id);\n\t\t\tvar itemHeight = grid.getItemHeight(over.id);\n\t\t\tif (itemTop + itemHeight / 2 < targetY) {\n\t\t\t\t//hovering over bottom part of item, check can be drop to bottom\n\t\t\t\tvar index = store.getIndexById(over.id);\n\t\t\t\tvar nextId = store.getNext(over.id);//adds +1 when hovering over placeholder\n\t\t\t\tvar next = store.getItem(nextId);\n\t\t\t\tif (checkPlaceholderTask(nextId)){\n\t\t\t\t\tvar prevId = store.getPrev(next.id);\n\t\t\t\t\tnext = store.getItem(prevId);\n\t\t\t\t}\n\t\t\t\tif (next) {\n\t\t\t\t\tif (next.id != item.id) {\n\t\t\t\t\t\tover = next; //there is a valid target\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (config.order_branch_free) {\n\t\t\t\t\t\t\tif (!(store.isChildOf(item.id, over.id) && store.getChildren(over.id).length == 1))\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tstore.move(item.id, store.getBranchIndex(over.id) + 1, store.getParent(over.id));\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//we at end of the list, check and drop at the end of list\n\t\t\t\t\tnextId = store.getIdByIndex(index);\n\t\t\t\t\tnext = store.getItem(nextId);\n\n\t\t\t\t\tif (checkPlaceholderTask(nextId)){\n\t\t\t\t\t\tvar prevId = store.getPrev(next.id);\n\t\t\t\t\t\tnext = store.getItem(prevId);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (allowedLevel(next, item) && next.id != item.id) {\n\t\t\t\t\t\tstore.move(item.id, -1, store.getParent(next.id));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (config.order_branch_free) {\n\t\t\t\tif (over.id != item.id && allowedLevel(over, item) && !checkPlaceholderTask(over.id)) {\n\t\t\t\t\tif (!store.hasChild(over.id)) {\n\t\t\t\t\t\tover.$open = true;\n\t\t\t\t\t\tstore.move(item.id, -1, over.id);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (store.getIndexById(over.id) || itemHeight / 3 < targetY) return;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//if item is on different level, check the one before it\n\t\t\tvar index = store.getIndexById(over.id),\n\t\t\t\tprevId = store.getIdByIndex(index - 1);\n\n\t\t\tvar prev = store.getItem(prevId);\n\n\t\t\tvar shift = 1;\n\t\t\twhile ((!prev || prev.id == over.id) && index - shift >= 0) {\n\n\t\t\t\tprevId = store.getIdByIndex(index - shift);\n\t\t\t\tprev = store.getItem(prevId);\n\t\t\t\tshift++;\n\t\t\t}\n\n\t\t\tif (item.id == over.id || checkPlaceholderTask(over.id)) return;\n\t\t\t//replacing item under cursor\n\t\t\tif (allowedLevel(over, item) && item.id != over.id) {\n\t\t\t\tstore.move(item.id, 0, 0, over.id);\n\n\t\t\t} else if (over.$level == item.$level - 1 && !store.getChildren(over.id).length) {\n\t\t\t\tstore.move(item.id, 0, over.id);\n\n\t\t\t} else if (prev && (allowedLevel(prev, item)) && (item.id != prev.id)) {\n\t\t\t\tstore.move(item.id, -1, store.getParent(prev.id));\n\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}, gantt));\n\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function () {\n\t\tvar store = getStore();\n\t\tvar task = store.getItem(dnd.config.id);\n\t\ttask.$transparent = false;\n\t\ttask.$open = dnd.config.initial_open_state;\n\n\t\tif (this.callEvent(\"onBeforeRowDragEnd\", [dnd.config.id, dnd.config.parent, dnd.config.index]) === false) {\n\t\t\tstore.move(dnd.config.id, dnd.config.index, dnd.config.parent);\n\t\t\ttask.$drop_target = null;\n\t\t} else {\n\t\t\tthis.callEvent(\"onRowDragEnd\", [dnd.config.id, task.$drop_target]);\n\t\t}\n\t\tgantt.render();\n\t\tthis.refreshData();\n\t}, gantt));\n}\n\nexport default {\n\tinit: _init_dnd\n};","/**\n * The state object for order branch drag and drop\n */\n\nimport * as utils from \"../../../../utils/utils\";\n\nexport default {\n\tcreateDropTargetObject: function createDropTargetObject(parent) {\n\t\tvar res = {\n\t\t\ttargetParent: null,\n\t\t\ttargetIndex: 0,\n\t\t\ttargetId: null,\n\t\t\tchild: false,\n\t\t\tnextSibling: false,\n\t\t\tprevSibling: false\n\t\t};\n\n\t\tif (parent) {\n\t\t\tutils.mixin(res, parent, true);\n\t\t}\n\t\treturn res;\n\t},\n\tnextSiblingTarget: function nextSiblingTarget(dndTaskId, targetTaskId, store) {\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = targetTaskId;\n\t\tresult.nextSibling = true;\n\t\tresult.targetParent = store.getParent(result.targetId);\n\t\tresult.targetIndex = store.getBranchIndex(result.targetId);\n\t\tif(store.getParent(dndTaskId) != result.targetParent || result.targetIndex < store.getBranchIndex(dndTaskId)){\n\t\t\tresult.targetIndex += 1;\n\t\t}\n\t\treturn result;\n\t},\n\tprevSiblingTarget: function prevSiblingTarget(dndTaskId, targetTaskId, store) {\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = targetTaskId;\n\t\tresult.prevSibling = true;\n\t\tresult.targetParent = store.getParent(result.targetId);\n\t\tresult.targetIndex = store.getBranchIndex(result.targetId);\n\t\tif(store.getParent(dndTaskId) == result.targetParent && result.targetIndex > store.getBranchIndex(dndTaskId)){\n\t\t\tresult.targetIndex -= 1;\n\t\t}\n\t\treturn result;\n\t},\n\tfirstChildTarget: function firstChildTarget(dndTaskId, targetTaskId, store) {\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = targetTaskId;\n\t\tresult.targetParent = result.targetId;\n\t\tresult.targetIndex = 0;\n\t\tresult.child = true;\n\t\treturn result;\n\t},\n\tlastChildTarget: function lastChildTarget(dndTaskId, targetTaskId, store) {\n\t\tvar children = store.getChildren(targetTaskId);\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = children[children.length - 1];\n\t\tresult.targetParent = targetTaskId;\n\t\tresult.targetIndex = children.length;\n\t\tresult.nextSibling = true;\n\t\treturn result;\n\t}\n};","/**\n * resolve dnd position of the task when gantt.config.order_branch_free = false\n */\n\nimport dropTarget from \"./drop_target\";\n\nfunction getLast(store){\n\tvar current = store.getNext();\n\twhile(store.exists(current)){\n\n\t\tvar next = store.getNext(current);\n\t\tif(!store.exists(next)){\n\t\t\treturn current;\n\t\t}else{\n\t\t\tcurrent = next;\n\t\t}\n\t}\n\treturn null;\n}\n\nfunction findClosesTarget(dndTaskId, taskId, allowedLevel, store, up){\n\tvar prev = taskId;\n\twhile(store.exists(prev)){\n\t\tvar targetLevel = store.calculateItemLevel(store.getItem(prev));\n\t\tif((targetLevel === allowedLevel || targetLevel === (allowedLevel - 1)) && store.getBranchIndex(prev) > -1){\n\t\t\tbreak;\n\t\t}else {\n\t\t\tprev = up ? store.getPrev(prev) : store.getNext(prev);\n\t\t}\n\t}\n\n\tif(store.exists(prev)){\n\t\tif(store.calculateItemLevel(store.getItem(prev)) === allowedLevel){\n\t\t\treturn up ? dropTarget.nextSiblingTarget(dndTaskId, prev, store) : dropTarget.prevSiblingTarget(dndTaskId, prev, store);\n\t\t}else{\n\t\t\treturn dropTarget.firstChildTarget(dndTaskId, prev, store);\n\t\t}\n\t}\n\treturn null;\n}\n\nfunction findTargetAbove(dndTaskId, taskId, allowedLevel, store){\n\treturn findClosesTarget(dndTaskId, taskId, allowedLevel, store, true);\n}\nfunction findTargetBelow(dndTaskId, taskId, allowedLevel, store){\n\treturn findClosesTarget(dndTaskId, taskId, allowedLevel, store, false);\n}\n\nexport default function getSameLevelDropPosition(dndTaskId, targetTaskId, relTargetPos, eventTop, store, level){\n\tvar result;\n\tif(targetTaskId !== store.$getRootId()){\n\t\tvar targetTask = store.getItem(targetTaskId);\n\t\tvar targetLevel = store.calculateItemLevel(targetTask);\n\t\tif(targetLevel === level){\n\t\t\tvar prevSibling = store.getPrevSibling(targetTaskId);\n\t\t\tif(relTargetPos < 0.5 && !prevSibling){\n\t\t\t\tresult = dropTarget.prevSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t\t}else{\n\t\t\t\tif(relTargetPos < 0.5){\n\t\t\t\t\ttargetTaskId = prevSibling;\n\t\t\t\t}\n\t\t\t\tresult = dropTarget.nextSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t\t}\n\t\t}else if(targetLevel > level){\n\t\t\tstore.eachParent(function(parent){\n\t\t\t\tif(store.calculateItemLevel(parent) === level){\n\t\t\t\t\ttargetTaskId = parent.id;\n\t\t\t\t}\n\t\t\t}, targetTask); \n\t\t\tresult = findTargetAbove(dndTaskId, targetTaskId, level, store);\n\t\t}else{\n\t\t\tvar targetAbove = findTargetAbove(dndTaskId, targetTaskId, level, store);\n\t\t\tvar targetBelow = findTargetBelow(dndTaskId, targetTaskId, level, store);\n\t\t\tresult = (relTargetPos < 0.5) ? targetAbove : targetBelow;\n\t\t}\n\t}else{\n\t\tvar rootId = store.$getRootId();\n\t\tvar rootLevel = store.getChildren(rootId);\n\t\tresult = dropTarget.createDropTargetObject();\n\t\tif(rootLevel.length && eventTop >= 0){\n\t\t\tresult = findTargetAbove(dndTaskId, getLast(store), level, store);\n\t\t}else{\n\t\t\tresult = findTargetBelow(dndTaskId, rootId, level, store);\n\t\t}\n\t}\n\n\treturn result;\n};\n","import * as domHelpers from \"../../utils/dom_helpers\";\n\n/**\n * methods for highlighting current drag and drop position\n */\n\nfunction highlightPosition(target, root, grid){\n\tvar markerPos = getTaskMarkerPosition(target, grid);\n\t// setting position of row\n\troot.marker.style.left = markerPos.x + 9 + \"px\";\n\troot.marker.style.width = markerPos.width + \"px\";\n\troot.marker.style.overflow = \"hidden\";\n\tvar markerLine = root.markerLine;\n\tif(!markerLine){\n\t\tmarkerLine = document.createElement(\"div\");\n\t\tmarkerLine.className = \"gantt_drag_marker gantt_grid_dnd_marker\";\n\t\tmarkerLine.innerHTML = \"<div class='gantt_grid_dnd_marker_line'></div>\";\n\t\tmarkerLine.style.pointerEvents = \"none\";\n\t}\n\n\tif(target.child){\n\t\thighlightFolder(target, markerLine, grid);\n\t}else{\n\t\thighlightRow(target, markerLine, grid);\n\t}\n\n\tif(!root.markerLine){\n\t\tdocument.body.appendChild(markerLine);\n\t\troot.markerLine = markerLine;\n\t}\n}\n\nfunction removeLineHighlight(root){\n\tif(root.markerLine && root.markerLine.parentNode){\n\t\troot.markerLine.parentNode.removeChild(root.markerLine);\n\t}\n\troot.markerLine = null;\n}\n\nfunction highlightRow(target, markerLine, grid){\n\tvar linePos = getLineMarkerPosition(target, grid);\n\tvar maxBottom = grid.$grid_data.getBoundingClientRect().bottom + window.scrollY;\n\n\tmarkerLine.innerHTML = \"<div class='gantt_grid_dnd_marker_line'></div>\";\n\tmarkerLine.style.left = linePos.x + \"px\";\n\tmarkerLine.style.height = \"4px\";\n\n\tvar markerLineTop = linePos.y - 2;\n\tmarkerLine.style.top = markerLineTop + \"px\";\n\tmarkerLine.style.width = linePos.width + \"px\";\n\n\tif (markerLineTop > maxBottom) {\n\t\tmarkerLine.style.top = maxBottom + 'px';\n\t}\n\n\treturn markerLine;\n}\nfunction highlightFolder(target, markerFolder, grid){\n\tvar id = target.targetParent;\n\tvar pos = gridToPageCoordinates({x: 0, y: grid.getItemTop(id)}, grid);\n\tvar maxBottom = grid.$grid_data.getBoundingClientRect().bottom + window.scrollY;\n\n\tlet folderHighlightWidth = setWidthWithinContainer(grid.$gantt, grid.$grid_data.offsetWidth);\t\n\n\tmarkerFolder.innerHTML = \"<div class='gantt_grid_dnd_marker_folder'></div>\";\n\tmarkerFolder.style.width = folderHighlightWidth + \"px\";\n\tmarkerFolder.style.top = pos.y + \"px\";\n\tmarkerFolder.style.left = pos.x  + \"px\";\n\tmarkerFolder.style.height = grid.getItemHeight(id) + \"px\";\n\tif (pos.y > maxBottom) {\n\t\tmarkerFolder.style.top = maxBottom + 'px';\n\t}\n\n\treturn markerFolder;\n}\n\nfunction getLineMarkerPosition(target, grid){\n\tvar store = grid.$config.rowStore;\n\tvar pos = {x:0, y:0};\n\tvar indentNode = grid.$grid_data.querySelector(\".gantt_tree_indent\");\n\tvar indent = 15;\n\tvar level = 0;\n\tif(indentNode){\n\t\tindent = indentNode.offsetWidth;\n\t}\n\tvar iconWidth = 40;\n\tif(target.targetId !== store.$getRootId()){\n\t\tvar itemTop = grid.getItemTop(target.targetId);\n\t\tvar itemHeight = grid.getItemHeight(target.targetId);\n\t\tlevel = store.exists(target.targetId) ? store.calculateItemLevel(store.getItem(target.targetId)) : 0;\n\n\t\tif(target.prevSibling){\n\t\t\tpos.y = itemTop;\n\t\t}else if(target.nextSibling){\n\t\t\tvar childCount = 0;\n\t\t\tstore.eachItem(function(child){\n\t\t\t\tif(store.getIndexById(child.id) !== -1)\n\t\t\t\t\tchildCount++;\n\t\t\t}, target.targetId);\n\n\t\t\tpos.y = itemTop + itemHeight + childCount*itemHeight;\n\t\t}else {\n\t\t\tpos.y = itemTop + itemHeight;\n\t\t\tlevel += 1;\n\t\t}\n\t}\n\tpos.x = iconWidth + level * indent;\n\tpos.width = setWidthWithinContainer(grid.$gantt, Math.max(grid.$grid_data.offsetWidth - pos.x, 0), pos.x);\n\treturn gridToPageCoordinates(pos, grid);\n}\n\nfunction gridToPageCoordinates(pos, grid){\n\tvar gridPos = domHelpers.getNodePosition(grid.$grid_data);\n\tpos.x += gridPos.x + grid.$grid.scrollLeft;\n\tpos.y += gridPos.y - grid.$grid_data.scrollTop;\n\treturn pos;\n}\n\nfunction getTaskMarkerPosition(e, grid) {\n\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\n\tvar ePos = domHelpers.getRelativeEventPosition(e, grid.$grid_data);\n\t// row offset\n\tvar x = pos.x + grid.$grid.scrollLeft;\n\tvar y = ePos.y - 10;\n\n\tvar rowHeight = grid.getItemHeight(e.targetId);\n\t// prevent moving row out of grid_data container\n\tif (y < pos.y) y = pos.y;\n\tvar gridHeight = grid.getTotalHeight();\n\tif (y > pos.y + gridHeight - rowHeight) y = pos.y + gridHeight - rowHeight;\n\n\tpos.x = x;\n\tpos.y = y;\n\tpos.width = setWidthWithinContainer(grid.$gantt, pos.width, 9);\n\treturn pos;\n}\n\nfunction setWidthWithinContainer(gantt, width, offset = 0){\n\tconst containerSize = domHelpers.getNodePosition(gantt.$root);\n\tif (width > containerSize.width){\n\t\twidth = containerSize.width - offset - 2;\n\t}\n\treturn width;\n}\n\nexport default {\n\tremoveLineHighlight: removeLineHighlight,\n\thighlightPosition: highlightPosition\n};\n","import * as domHelpers from \"../utils/dom_helpers\";\nimport dropTarget from \"./tasks_grid_dnd_marker_helpers/drop_target\";\nimport getLockedLevelTarget from \"./tasks_grid_dnd_marker_helpers/locked_level\";\nimport getMultiLevelTarget from \"./tasks_grid_dnd_marker_helpers/multi_level\";\nimport higlighter from \"./tasks_grid_dnd_marker_helpers/highlight\";\nimport isPlaceholderTask from \"../../../utils/placeholder_task\";\n\nfunction _init_dnd(gantt, grid) {\n\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\tif(!grid.$config.bind || !gantt.getDatastore(grid.$config.bind)){\n\t\treturn;\n\t}\n\n\tfunction locate(e){\n\t\treturn domHelpers.locateAttribute(e, grid.$config.item_attribute);\n\t}\n\n\tfunction getStore(){\n\t\treturn gantt.getDatastore(grid.$config.bind);\n\t}\n\n\tfunction checkPlaceholderTask(id){\n\t\treturn isPlaceholderTask(id, gantt, getStore());\n\t}\n\n\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\n\tif (gantt.defined(grid.$getConfig().dnd_sensitivity))\n\t\tdnd.config.sensitivity = grid.$getConfig().dnd_sensitivity;\n\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\t\tif (!el) return false;\n\t\tif (gantt.hideQuickInfo) gantt.hideQuickInfo();\n\t\tif (domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\")){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar id = el.getAttribute(grid.$config.item_attribute);\n\t\tvar datastore = grid.$config.rowStore;\n\t\tvar task = datastore.getItem(id);\n\n\t\tif (gantt.isReadonly(task) || checkPlaceholderTask(id))\n\t\t\treturn false;\n\n\t\tdnd.config.initial_open_state = task.$open;\n\t\tif (!gantt.callEvent(\"onRowDragStart\", [id, e.target || e.srcElement, e])) {\n\t\t\treturn false;\n\t\t}\n\n\t}, gantt));\n\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\n\t\tdnd.config.marker.innerHTML = el.outerHTML;\n\t\tvar element = dnd.config.marker.firstChild;\n\t\tif(element){\n\t\t\tdnd.config.marker.style.opacity = 0.4;\n\t\t\telement.style.position = \"static\";\n\t\t\telement.style.pointerEvents = \"none\";\n\t\t}\n\n\t\tdnd.config.id = el.getAttribute(grid.$config.item_attribute);\n\n\t\tvar store = grid.$config.rowStore;\n\n\t\tvar task = store.getItem(dnd.config.id);\n\t\tdnd.config.level = store.calculateItemLevel(task);\n\t\tdnd.config.drop_target = dropTarget.createDropTargetObject({\n\t\t\ttargetParent: store.getParent(task.id),\n\t\t\ttargetIndex: store.getBranchIndex(task.id),\n\t\t\ttargetId: task.id,\n\t\t\tnextSibling: true\n\t\t});\n\n\t\ttask.$open = false;\n\t\ttask.$transparent = true;\n\t\tthis.refreshData();\n\t}, gantt));\n\n\tfunction getTargetTaskId(e){\n\t\tvar y = domHelpers.getRelativeEventPosition(e, grid.$grid_data).y;\n\t\tvar store = grid.$config.rowStore;\n\n\t\tif (!document.doctype){\n\t\t\ty += window.scrollY;\n\t\t}\n\t\ty = y || 0;\n\n\t\t// limits for the marker according to the layout layer\n\t\tvar scrollPos = grid.$state.scrollTop || 0;\n\t\tvar maxBottom = gantt.$grid_data.getBoundingClientRect().height + scrollPos + window.scrollY;\n\t\tvar minTop = scrollPos;\n\n\t\tvar firstVisibleTaskIndex = grid.getItemIndexByTopPosition(grid.$state.scrollTop);\n\t\tif (!store.exists(firstVisibleTaskIndex)){\n\t\t\tfirstVisibleTaskIndex = store.countVisible() - 1;\n\t\t}\n\t\tif (firstVisibleTaskIndex < 0) {\n\t\t\treturn store.$getRootId();\n\t\t}\n\n\t\tvar firstVisibleTaskId = store.getIdByIndex(firstVisibleTaskIndex);\n\n\t\tvar firstVisibleTaskPos = grid.$state.scrollTop / grid.getItemHeight(firstVisibleTaskId);\n\t\tvar hiddenTaskPart = firstVisibleTaskPos - Math.floor(firstVisibleTaskPos);\n\t\tif (hiddenTaskPart > 0.1 && hiddenTaskPart < 0.9) {\n\t\t\tmaxBottom = maxBottom - grid.getItemHeight(firstVisibleTaskId) * hiddenTaskPart;\n\t\t\tminTop = minTop + grid.getItemHeight(firstVisibleTaskId) * (1 - hiddenTaskPart);\n\t\t}\n\n\t\t// GS-715. The placeholder task row shouldn't be draggable below the Gantt container\n\t\tconst gridPosition = domHelpers.getNodePosition(grid.$grid_data);\n\t\tconst gridBottom = gridPosition.y + gridPosition.height;\n\t\tconst placeholderRowHeight = dnd.config.marker.offsetHeight;\n\t\tif (y + placeholderRowHeight + window.scrollY >= maxBottom){\n\t\t\tdnd.config.marker.style.top = gridBottom - placeholderRowHeight\t+ \"px\";\n\t\t}\n\n\t\tif (y >= maxBottom) {\n\t\t\ty = maxBottom;\n\t\t} else if (y <= minTop) {\n\t\t\ty = minTop;\n\t\t\tdnd.config.marker.style.top = gridPosition.y + \"px\";\n\t\t}\n\n\t\tvar index = grid.getItemIndexByTopPosition(y);\n\n\t\tif (index > store.countVisible() - 1 || index < 0) {\n\t\t\treturn store.$getRootId();\n\t\t}\n\n\t\tvar targetId = store.getIdByIndex(index);\n\t\tif (checkPlaceholderTask(targetId)) {\n\t\t\treturn store.getPrevSibling(targetId);\n\t\t}\n\n\t\treturn store.getIdByIndex(index);\n\t}\n\n\tfunction getDropPosition(e){\n\t\tvar targetTaskId = getTargetTaskId(e);\n\t\tvar relTargetPos = null;\n\t\tvar store = grid.$config.rowStore;\n\t\tvar config = grid.$getConfig();\n\t\tvar lockLevel = !config.order_branch_free;\n\n\t\tvar eventTop = domHelpers.getRelativeEventPosition(e, grid.$grid_data).y;\n\t\tif (!document.doctype){\n\t\t\teventTop += window.scrollY;\n\t\t}\n\n\t\tif(targetTaskId !== store.$getRootId()) {\n\t\t\tvar rowTop = grid.getItemTop(targetTaskId);\n\t\t\tvar rowHeight = grid.getItemHeight(targetTaskId);\n\t\t\trelTargetPos = (eventTop - rowTop) / rowHeight;\n\t\t}\n\n\t\tvar result;\n\t\tif(!lockLevel){\n\t\t\tresult = getMultiLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store);\n\t\t}else{\n\t\t\tresult = getLockedLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store, dnd.config.level);\n\t\t\tif(result && result.targetParent && checkPlaceholderTask(result.targetParent)){\n\t\t\t\ttargetTaskId = store.getPrevSibling(result.targetParent);\n\t\t\t\tresult = getLockedLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store, dnd.config.level);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function (obj, e) {\n\t\tvar target = getDropPosition(e);\n\n\t\tif(!target ||\n\t\t\tgantt.callEvent(\"onBeforeRowDragMove\", [dnd.config.id, target.targetParent, target.targetIndex]) === false){\n\t\t\t\ttarget = dropTarget.createDropTargetObject(dnd.config.drop_target);\n\t\t\t}\n\n\t\thiglighter.highlightPosition(target, dnd.config, grid);\n\t\tdnd.config.drop_target = target;\n\t\tgantt._waiAria.reorderMarkerAttr(dnd.config.marker);\n\n\t\tthis.callEvent(\"onRowDragMove\", [dnd.config.id, target.targetParent, target.targetIndex]);\n\t\treturn true;\n\t}, gantt));\n\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function () {\n\t\tvar store = grid.$config.rowStore;\n\t\tvar task = store.getItem(dnd.config.id);\n\n\t\thiglighter.removeLineHighlight(dnd.config);\n\n\t\ttask.$transparent = false;\n\t\ttask.$open = dnd.config.initial_open_state;\n\t\tvar target = dnd.config.drop_target;\n\n\t\tif (this.callEvent(\"onBeforeRowDragEnd\", [dnd.config.id, target.targetParent, target.targetIndex]) === false) {\n\t\t\ttask.$drop_target = null;\n\t\t} else {\n\t\t\tstore.move(dnd.config.id, target.targetIndex, target.targetParent);\n\t\t\tgantt.render();\n\t\t\tthis.callEvent(\"onRowDragEnd\", [dnd.config.id, target.targetParent, target.targetIndex]);\n\t\t}\n\t\tstore.refresh(task.id);\n\t}, gantt));\n}\n\nexport default {\n\tinit: _init_dnd\n};","/**\n * resolve dnd position of the task when gantt.config.order_branch_free = true\n */\n\nimport dropTarget from \"./drop_target\";\n\nexport default function getMultiLevelDropPosition(dndTaskId, targetTaskId, relTargetPos, eventTop, store){\n\tvar result;\n\n\tif(targetTaskId !== store.$getRootId()){\n\t\tif(relTargetPos < 0.25){\n\t\t\tresult = dropTarget.prevSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t}else if(relTargetPos > 0.60 && !(store.hasChild(targetTaskId) && store.getItem(targetTaskId).$open)){\n\t\t\tresult = dropTarget.nextSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t}else {\n\t\t\tresult = dropTarget.firstChildTarget(dndTaskId, targetTaskId, store);\n\t\t}\n\t}else{\n\t\tvar rootId = store.$getRootId();\n\t\tif(store.hasChild(rootId) && eventTop >= 0){\n\t\t\tresult = dropTarget.lastChildTarget(dndTaskId, rootId, store);\n\t\t}else{\n\t\t\tresult = dropTarget.firstChildTarget(dndTaskId, rootId, store);\n\t\t}\n\t}\n\n\treturn result;\n};","import * as utils from \"../../../utils/utils\";\nimport rowDnd from \"./tasks_grid_dnd\";\nimport rowDndMarker from \"./tasks_grid_dnd_marker\";\nimport mouseEventContainer from \"../mouse_event_container\";\n\nvar initializer = (function(){\n\treturn function(gantt){\n\t\treturn {\n\t\t\tonCreated: function (grid) {\n\t\t\t\tgrid.$config = utils.mixin(grid.$config, {\n\t\t\t\t\tbind: \"task\"\n\t\t\t\t});\n\t\t\t\tif(grid.$config.id == \"grid\") {\n\t\t\t\t\tthis.extendGantt(grid);\n\t\t\t\t\tgantt.ext.inlineEditors = gantt.ext._inlineEditors.createEditors(grid);\n\t\t\t\t\tgantt.ext.inlineEditors.init();\n\t\t\t\t}\n\n\t\t\t\tthis._mouseDelegates = mouseEventContainer(gantt);\n\t\t\t},\n\t\t\tonInitialized: function (grid) {\n\t\t\t\tvar config = grid.$getConfig();\n\t\t\t\tif (config.order_branch) {\n\t\t\t\t\tif(config.order_branch == \"marker\"){\n\t\t\t\t\t\trowDndMarker.init(grid.$gantt, grid);\n\t\t\t\t\t}else{\n\t\t\t\t\t\trowDnd.init(grid.$gantt, grid);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.initEvents(grid, gantt);\n\t\t\t\tif(grid.$config.id == \"grid\") {\n\t\t\t\t\tthis.extendDom(grid);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonDestroyed: function (grid) {\n\t\t\t\tif(grid.$config.id == \"grid\") {\n\t\t\t\t\t// GS-1288. We need to only detach the store and its events without detaching the\n\t\t\t\t\t// inline editor's events. Otherwise, we won't be able to access them\n\t\t\t\t\tgantt.ext.inlineEditors.detachStore();\n\t\t\t\t}\n\t\t\t\tthis.clearEvents(grid, gantt);\n\t\t\t},\n\n\t\t\tinitEvents: function (grid, gantt) {\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_row\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tconst config = grid.$getConfig();\n\t\t\t\t\tif (id !== null) {\n\t\t\t\t\t\tconst task = this.getTask(id);\n\t\t\t\t\t\tif (config.scroll_on_click) {\n\t\t\t\t\t\t\tconst notOpenIcon = !gantt._is_icon_open_click(e);\n\t\t\t\t\t\t\tconst visibleTimeline = gantt.$ui.getView(\"timeline\");\n\t\t\t\t\t\t\t// don't need to scroll to the date when the timeline is not visible\n\t\t\t\t\t\t\t// or when we click on the open/close icon\n\t\t\t\t\t\t\tif (notOpenIcon && visibleTimeline){\n\t\t\t\t\t\t\t\tthis.showDate(task.start_date);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgantt.callEvent(\"onTaskRowClick\", [id, trg]);\n\t\t\t\t\t}\n\t\t\t\t}, gantt), grid.$grid);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_grid_head_cell\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar column = trg.getAttribute(\"data-column-id\");\n\n\t\t\t\t\tif (!gantt.callEvent(\"onGridHeaderClick\", [column, e]))\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tvar config = grid.$getConfig();\n\n\t\t\t\t\tif (column == \"add\") {\n\t\t\t\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\n\t\t\t\t\t\tmouseEvents.callHandler(\"click\", \"gantt_add\", grid.$grid, [e, config.root_id]);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (config.sort && column) { // GS-929: if there is no column name, we cannot sort the column\n\t\t\t\t\t\tvar sorting_method = column,\n\t\t\t\t\t\t\tconf;\n\n\t\t\t\t\t\tfor (var i = 0; i < config.columns.length; i++) {\n\t\t\t\t\t\t\tif (config.columns[i].name == column) {\n\t\t\t\t\t\t\t\tconf = config.columns[i];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (conf && conf.sort !== undefined && conf.sort !== true) {\n\t\t\t\t\t\t\tsorting_method = conf.sort;\n\n\t\t\t\t\t\t\tif (!sorting_method) { // column sort property 'false', no sorting\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar sort = (this._sort && this._sort.direction && this._sort.name == column) ? this._sort.direction : \"desc\";\n\t\t\t\t\t\t// invert sort direction\n\t\t\t\t\t\tsort = (sort == \"desc\") ? \"asc\" : \"desc\";\n\t\t\t\t\t\tthis._sort = {\n\t\t\t\t\t\t\tname: column,\n\t\t\t\t\t\t\tdirection: sort\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.sort(sorting_method, sort == \"desc\");\n\t\t\t\t\t}\n\t\t\t\t}, gantt), grid.$grid);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_add\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar config = grid.$getConfig();\n\t\t\t\t\tif (config.readonly) return;\n\n\t\t\t\t\tvar item = {};\n\t\t\t\t\tthis.createTask(item, id ? id : gantt.config.root_id);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}, gantt), grid.$grid);\n\n\t\t\t},\n\n\t\t\tclearEvents: function(grid, gantt){\n\t\t\t\tthis._mouseDelegates.destructor();\n\t\t\t\tthis._mouseDelegates = null;\n\t\t\t},\n\n\t\t\textendDom: function(grid){\n\t\t\t\tgantt.$grid = grid.$grid;\n\t\t\t\tgantt.$grid_scale = grid.$grid_scale;\n\t\t\t\tgantt.$grid_data = grid.$grid_data;\n\t\t\t},\n\t\t\textendGantt: function(grid){\n\t\t\t\tgantt.getGridColumns = gantt.bind(grid.getGridColumns, grid);\n\n\t\t\t\tgrid.attachEvent(\"onColumnResizeStart\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResizeStart\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onColumnResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResize\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onColumnResizeEnd\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResizeEnd\", arguments);\n\t\t\t\t});\n\n\t\t\t\tgrid.attachEvent(\"onColumnResizeComplete\", function(columns, totalWidth){\n\t\t\t\t\tgantt.config.grid_width = totalWidth;\n\t\t\t\t});\n\n\t\t\t\tgrid.attachEvent(\"onBeforeRowResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onBeforeRowResize\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onRowResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onRowResize\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onBeforeRowResizeEnd\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onBeforeRowResizeEnd\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onAfterRowResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onAfterRowResize\", arguments);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t};\n})();\n\nexport default initializer;","import * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport timeout from \"../../../utils/timeout\";\nimport * as helpers from \"../../../utils/helpers\";\n\nfunction createTaskDND(timeline, gantt) {\n\tvar services = gantt.$services;\n\treturn {\n\t\tdrag: null,\n\t\tdragMultiple: {},\n\t\t_events: {\n\t\t\tbefore_start: {},\n\t\t\tbefore_finish: {},\n\t\t\tafter_finish: {}\n\t\t},\n\t\t_handlers: {},\n\t\tinit: function() {\n\t\t\tthis._domEvents = gantt._createDomEventScope();\n\t\t\tthis.clear_drag_state();\n\t\t\tvar drag = gantt.config.drag_mode;\n\t\t\tthis.set_actions();\n\n\t\t\tvar stateService = services.getService(\"state\");\n\t\t\tstateService.registerProvider(\"tasksDnd\", utils.bind(function() {\n\t\t\t\treturn {\n\t\t\t\t\tdrag_id : this.drag ? this.drag.id : undefined,\n\t\t\t\t\tdrag_mode : this.drag ? this.drag.mode : undefined,\n\t\t\t\t\tdrag_from_start : this.drag ? this.drag.left : undefined\n\t\t\t\t};\n\t\t\t}, this));\n\n\t\t\tvar evs = {\n\t\t\t\t\"before_start\": \"onBeforeTaskDrag\",\n\t\t\t\t\"before_finish\": \"onBeforeTaskChanged\",\n\t\t\t\t\"after_finish\": \"onAfterTaskDrag\"\n\t\t\t};\n\t\t\t//for now, all drag operations will trigger the same events\n\t\t\tfor (var stage in this._events) {\n\t\t\t\tfor (var mode in drag) {\n\t\t\t\t\tthis._events[stage][mode] = evs[stage];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._handlers[drag.move] = this._move;\n\t\t\tthis._handlers[drag.resize] = this._resize;\n\t\t\tthis._handlers[drag.progress] = this._resize_progress;\n\t\t},\n\t\tset_actions: function() {\n\t\t\tvar data = timeline.$task_data;\n\t\t\tthis._domEvents.attach(data, \"mousemove\", gantt.bind(function(e) {\n\t\t\t\tthis.on_mouse_move(e);\n\t\t\t}, this));\n\t\t\tthis._domEvents.attach(data, \"mousedown\", gantt.bind(function(e) {\n\t\t\t\tthis.on_mouse_down(e);\n\t\t\t}, this));\n\t\t\tthis._domEvents.attach(document.body, \"mouseup\", gantt.bind(function(e) {\n\t\t\t\tthis.on_mouse_up(e);\n\t\t\t}, this));\n\t\t},\n\n\t\tclear_drag_state: function() {\n\t\t\tthis.drag = {\n\t\t\t\tid: null,\n\t\t\t\tmode: null,\n\t\t\t\tpos: null,\n\t\t\t\tstart_x: null,\n\t\t\t\tstart_y: null,\n\t\t\t\tobj: null,\n\t\t\t\tleft: null\n\t\t\t};\n\t\t\tthis.dragMultiple = {};\n\t\t},\n\t\t_resize: function(task, shift, drag) {\n\t\t\tvar cfg = timeline.$getConfig();\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\t\t\tif (drag.left) {\n\t\t\t\ttask.start_date = gantt.dateFromPos(coords_x.start + shift);\n\t\t\t\tif (!task.start_date) {\n\t\t\t\t\ttask.start_date = new Date(gantt.getState().min_date);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttask.end_date = gantt.dateFromPos(coords_x.end + shift);\n\t\t\t\tif (!task.end_date) {\n\t\t\t\t\ttask.end_date = new Date(gantt.getState().max_date);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar minDurationInUnits = this._calculateMinDuration(cfg.min_duration, cfg.duration_unit);\n\t\t\tif (task.end_date - task.start_date < cfg.min_duration) {\n\t\t\t\tif (drag.left)\n\t\t\t\t\ttask.start_date = gantt.calculateEndDate(task.end_date, -minDurationInUnits, cfg.duration_unit, task);\n\t\t\t\telse\n\t\t\t\t\ttask.end_date = gantt.calculateEndDate(task.start_date, minDurationInUnits, cfg.duration_unit, task);\n\t\t\t}\n\t\t\tgantt._init_task_timing(task);\n\t\t},\n\t\t_calculateMinDuration: function(duration, unit) {\n\t\t\tvar inMs = {\n\t\t\t\t\"minute\": 60000,\n\t\t\t\t\"hour\": 3600000,\n\t\t\t\t\"day\": 86400000,\n\t\t\t\t\"week\": 604800000,\n\t\t\t\t\"month\": 2419200000,\n\t\t\t\t\"year\": 31356000000\n\t\t\t};\n\t\t\treturn Math.ceil(duration / inMs[unit]);\n\t\t},\n\t\t_resize_progress: function(task, shift, drag) {\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar diffValue = !config.rtl ? (drag.pos.x - coords_x.start) : (coords_x.start - drag.pos.x);\n\n\t\t\tvar diff = Math.max(0, diffValue);\n\t\t\ttask.progress = Math.min(1, diff / Math.abs(coords_x.end - coords_x.start));\n\t\t},\n\t\t_find_max_shift: function(dragItems, shift) {\n\t\t\tvar correctShift;\n\t\t\tfor (var i in dragItems) {\n\t\t\t\tvar drag = dragItems[i];\n\t\t\t\tvar task = gantt.getTask(drag.id);\n\n\t\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\t\t\t\tvar minX = gantt.posFromDate(new Date(gantt.getState().min_date));\n\t\t\t\tvar maxX = gantt.posFromDate(new Date(gantt.getState().max_date));\n\n\t\t\t\tif (coords_x.end + shift > maxX) {\n\t\t\t\t\tvar maxShift = maxX - coords_x.end;\n\t\t\t\t\tif (maxShift < correctShift || correctShift === undefined) {\n\t\t\t\t\t\tcorrectShift = maxShift;\n\t\t\t\t\t}\n\t\t\t\t} else if (coords_x.start + shift < minX) {\n\t\t\t\t\tvar minShift = minX - coords_x.start;\n\t\t\t\t\tif (minShift > correctShift || correctShift === undefined) {\n\t\t\t\t\t\tcorrectShift = minShift;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn correctShift;\n\t\t},\n\t\t_move: function(task, shift, drag, multipleDragShift) {\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\t\t\tvar new_start = null,\n\t\t\tnew_end = null;\n\t\t\t// GS-454: If we drag multiple tasks, rely on the dates instead of timeline coordinates\n\t\t\tif (multipleDragShift){\n\t\t\t\tnew_start = new Date(+drag.obj.start_date + multipleDragShift),\n\t\t\t\tnew_end = new Date(+drag.obj.end_date + multipleDragShift);\n\t\t\t} else {\n\t\t\t\tnew_start = gantt.dateFromPos(coords_x.start + shift),\n\t\t\t\tnew_end = gantt.dateFromPos(coords_x.end + shift);\n\t\t\t}\n\t\t\tif (!new_start) {\n\t\t\t\ttask.start_date = new Date(gantt.getState().min_date);\n\t\t\t\ttask.end_date = gantt.dateFromPos(gantt.posFromDate(task.start_date) + (coords_x.end - coords_x.start));\n\t\t\t} else if (!new_end) {\n\t\t\t\ttask.end_date = new Date(gantt.getState().max_date);\n\t\t\t\ttask.start_date = gantt.dateFromPos(gantt.posFromDate(task.end_date) - (coords_x.end - coords_x.start));\n\t\t\t} else {\n\t\t\t\ttask.start_date = new_start;\n\t\t\t\ttask.end_date = new_end;\n\t\t\t}\n\t\t},\n\t\t_drag_task_coords: function(t, drag) {\n\t\t\tvar start = drag.obj_s_x = drag.obj_s_x || gantt.posFromDate(t.start_date);\n\t\t\tvar end = drag.obj_e_x = drag.obj_e_x || gantt.posFromDate(t.end_date);\n\t\t\treturn {\n\t\t\t\tstart: start,\n\t\t\t\tend: end\n\t\t\t};\n\t\t},\n\t\t_mouse_position_change: function(oldPos, newPos) {\n\t\t\tvar dx = oldPos.x - newPos.x,\n\t\t\t\tdy = oldPos.y - newPos.y;\n\t\t\treturn Math.sqrt(dx * dx + dy * dy);\n\t\t},\n\t\t_is_number: function(n) {\n\t\t\treturn !isNaN(parseFloat(n)) && isFinite(n);\n\t\t},\n\n\t\ton_mouse_move: function(e) {\n\t\t\tif (this.drag.start_drag) {\n\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\n\n\t\t\t\tvar sX = this.drag.start_drag.start_x,\n\t\t\t\t\tsY = this.drag.start_drag.start_y;\n\n\t\t\t\tif ((Date.now() - this.drag.timestamp > 50) ||\n\t\t\t\t\t(this._is_number(sX) && this._is_number(sY) && this._mouse_position_change({\n\t\t\t\t\t\tx: sX,\n\t\t\t\t\t\ty: sY\n\t\t\t\t\t}, pos) > 20)) {\n\t\t\t\t\tthis._start_dnd(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar drag = this.drag;\n\n\t\t\tif (drag.mode) {\n\t\t\t\tif (!timeout(this, 40))//limit update frequency\n\t\t\t\t\treturn;\n\n\t\t\t\tthis._update_on_move(e);\n\n\t\t\t}\n\t\t},\n\n\t\t_update_item_on_move: function(shift, id, mode, drag, e, multipleDragShift) {\n\t\t\tvar task = gantt.getTask(id);\n\t\t\tvar original = gantt.mixin({}, task);\n\t\t\tvar copy = gantt.mixin({}, task);\n\t\t\tthis._handlers[mode].apply(this, [copy, shift, drag, multipleDragShift]);\n\t\t\tgantt.mixin(task, copy, true);\n\t\t\t//gantt._update_parents(drag.id, true);\n\t\t\tgantt.callEvent(\"onTaskDrag\", [task.id, mode, copy, original, e]);\n\t\t\tgantt.mixin(task, copy, true);\n\t\t\tgantt.refreshTask(id);\n\t\t},\n\n\t\t_update_on_move: function(e) {\n\t\t\tvar drag = this.drag;\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tif (drag.mode) {\n\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, timeline.$task_data);\n\t\t\t\tif (drag.pos && drag.pos.x == pos.x)\n\t\t\t\t\treturn;\n\n\t\t\t\tdrag.pos = pos;\n\n\t\t\t\tvar curr_date = gantt.dateFromPos(pos.x);\n\t\t\t\tif (!curr_date || isNaN(curr_date.getTime()))\n\t\t\t\t\treturn;\n\n\n\t\t\t\tvar shift = pos.x - drag.start_x;\n\t\t\t\tvar task = gantt.getTask(drag.id);\n\t\t\t\tif (this._handlers[drag.mode]) {\n\t\t\t\t\tif (drag.mode === config.drag_mode.move) {\n\t\t\t\t\t\tvar dragHash = {};\n\n\t\t\t\t\t\tif (this._isMultiselect()) {\n\t\t\t\t\t\t\tvar selectedTasksIds = gantt.getSelectedTasks();\n\t\t\t\t\t\t\tif (selectedTasksIds.indexOf(drag.id) >= 0) {\n\t\t\t\t\t\t\t\tdragHash = this.dragMultiple;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar dragProject = false;\n\t\t\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project) {\n\t\t\t\t\t\t\tvar initialDrag = {};\n\t\t\t\t\t\t\tinitialDrag[drag.id] = utils.copy(drag);\n\t\t\t\t\t\t\tdragProject = true;\n\t\t\t\t\t\t\tdragHash = utils.mixin(initialDrag, this.dragMultiple);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar maxShift = this._find_max_shift(dragHash, shift);\n\t\t\t\t\t\tif (maxShift !== undefined) {\n\t\t\t\t\t\t\tshift = maxShift;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._update_item_on_move(shift, drag.id, drag.mode, drag, e);\n\n\t\t\t\t\t\tlet multipleDragShift;\n\t\t\t\t\t\tif (maxShift === undefined) {\n\t\t\t\t\t\t\t// GS-2593. If the timeline is repainted during the drag (infinite scale scenario)\n\t\t\t\t\t\t\t// we need to update the initial drag position to correctly update\n\t\t\t\t\t\t\t// the position of other dragged tasks\n\t\t\t\t\t\t\tconst newStartPos = gantt.posFromDate(drag.obj.start_date);\n\t\t\t\t\t\t\tconst newEndPos = gantt.posFromDate(drag.obj.end_date);\n\t\t\t\t\t\t\t// calculate the offset only when the drag started\n\t\t\t\t\t\t\tif (drag.handle_offset === undefined){\n\t\t\t\t\t\t\t\tconst width = newEndPos - newStartPos;\n\t\t\t\t\t\t\t\tconst dragPos = drag.start_x - newStartPos;\n\t\t\t\t\t\t\t\tdrag.handle_offset = dragPos / width;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst newWidth = Math.abs(newEndPos - newStartPos);\n\t\t\t\t\t\t\tlet dragX = newStartPos + newWidth * drag.handle_offset;\n\n\t\t\t\t\t\t\t// GS-454: Calculate the date shift in milliseconds instead of pixels\n\t\t\t\t\t\t\tconst shiftDate = gantt.dateFromPos(dragX);\n\t\t\t\t\t\t\tmultipleDragShift = curr_date - shiftDate;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfor (var i in dragHash) {\n\t\t\t\t\t\t\tvar childDrag = dragHash[i];\n\t\t\t\t\t\t\tif(dragProject && childDrag.id != drag.id){\n\t\t\t\t\t\t\t\tgantt._bulk_dnd = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis._update_item_on_move(shift, childDrag.id, childDrag.mode, childDrag, e, multipleDragShift);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgantt._bulk_dnd = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// for resize and progress\n\t\t\t\t\t\tthis._update_item_on_move(shift, drag.id, drag.mode, drag, e);\n\t\t\t\t\t}\n\t\t\t\t\tgantt._update_parents(drag.id);\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\n\t\ton_mouse_down: function(e, src) {\n\t\t\t// on Mac we do not get onmouseup event when clicking right mouse button leaving us in dnd state\n\t\t\t// let's ignore right mouse button then\n\t\t\tif (e.button == 2 && e.button !== undefined)\n\t\t\t\treturn;\n\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar id = gantt.locate(e);\n\t\t\tvar task = null;\n\t\t\tif (gantt.isTaskExists(id)) {\n\t\t\t\ttask = gantt.getTask(id);\n\t\t\t}\n\n\t\t\tif (gantt.isReadonly(task) || this.drag.mode) return;\n\n\t\t\tthis.clear_drag_state();\n\n\t\t\tsrc = src || (e.target || e.srcElement);\n\n\t\t\tvar className = domHelpers.getClassName(src);\n\t\t\tvar drag = this._get_drag_mode(className, src);\n\n\t\t\tif (!className || !drag) {\n\t\t\t\tif (src.parentNode)\n\t\t\t\t\treturn this.on_mouse_down(e, src.parentNode);\n\t\t\t\telse\n\t\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!drag) {\n\t\t\t\tif (gantt.checkEvent(\"onMouseDown\") && gantt.callEvent(\"onMouseDown\", [className.split(\" \")[0]])) {\n\t\t\t\t\tif (src.parentNode)\n\t\t\t\t\t\treturn this.on_mouse_down(e, src.parentNode);\n\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (drag.mode && drag.mode != config.drag_mode.ignore && config[\"drag_\" + drag.mode]) {\n\t\t\t\t\tid = gantt.locate(src);\n\t\t\t\t\ttask = gantt.copy(gantt.getTask(id) || {});\n\n\t\t\t\t\tif (gantt.isReadonly(task)) {\n\t\t\t\t\t\tthis.clear_drag_state();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ((gantt.isSummaryTask(task) && !(task.auto_scheduling === false) && !config.drag_project) && drag.mode != config.drag_mode.progress) {//only progress drag is allowed for tasks with flexible duration\n\t\t\t\t\t\tthis.clear_drag_state();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tdrag.id = id;\n\t\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\n\n\t\t\t\t\tdrag.start_x = pos.x;\n\t\t\t\t\tdrag.start_y = pos.y;\n\t\t\t\t\tdrag.obj = task;\n\t\t\t\t\tthis.drag.start_drag = drag;\n\t\t\t\t\tthis.drag.timestamp = Date.now();\n\n\t\t\t\t} else\n\t\t\t\t\tthis.clear_drag_state();\n\t\t\t}\n\t\t},\n\t\t_fix_dnd_scale_time: function(task, drag) {\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar unit = gantt.getScale().unit,\n\t\t\t\tstep = gantt.getScale().step;\n\t\t\tif (!config.round_dnd_dates) {\n\t\t\t\tunit = 'minute';\n\t\t\t\tstep = config.time_step;\n\t\t\t}\n\n\t\t\tfunction fixStart(task) {\n\t\t\t\tif (!gantt.config.correct_work_time)\n\t\t\t\t\treturn;\n\t\t\t\tvar config = timeline.$getConfig();\n\t\t\t\tif (!gantt.isWorkTime(task.start_date, undefined, task))\n\t\t\t\t\ttask.start_date = gantt.calculateEndDate({\n\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\tduration: -1,\n\t\t\t\t\t\tunit: config.duration_unit,\n\t\t\t\t\t\ttask: task\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction fixEnd(task) {\n\t\t\t\tif (!gantt.config.correct_work_time)\n\t\t\t\t\treturn;\n\t\t\t\tvar config = timeline.$getConfig();\n\t\t\t\tif (!gantt.isWorkTime(new Date(task.end_date - 1), undefined, task))\n\t\t\t\t\ttask.end_date = gantt.calculateEndDate({\n\t\t\t\t\t\tstart_date: task.end_date,\n\t\t\t\t\t\tduration: 1,\n\t\t\t\t\t\tunit: config.duration_unit,\n\t\t\t\t\t\ttask: task\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (drag.mode == config.drag_mode.resize) {\n\t\t\t\tif (drag.left) {\n\t\t\t\t\ttask.start_date = gantt.roundDate({date: task.start_date, unit: unit, step: step});\n\t\t\t\t\tfixStart(task);\n\t\t\t\t} else {\n\t\t\t\t\ttask.end_date = gantt.roundDate({date: task.end_date, unit: unit, step: step});\n\t\t\t\t\tfixEnd(task);\n\t\t\t\t}\n\t\t\t} else if (drag.mode == config.drag_mode.move) {\n\t\t\t\ttask.start_date = gantt.roundDate({date: task.start_date, unit: unit, step: step});\n\t\t\t\tfixStart(task);\n\t\t\t\ttask.end_date = gantt.calculateEndDate(task);\n\t\t\t}\n\t\t},\n\t\t_fix_working_times: function(task, drag) {\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar drag = drag || {mode: config.drag_mode.move};\n\n\t\t\tif (drag.mode == config.drag_mode.resize) {\n\t\t\t\tif (drag.left) {\n\t\t\t\t\ttask.start_date = gantt.getClosestWorkTime({date: task.start_date, dir: 'future', task: task});\n\t\t\t\t} else {\n\t\t\t\t\ttask.end_date = gantt.getClosestWorkTime({date: task.end_date, dir: 'past', task: task});\n\t\t\t\t}\n\t\t\t} else if (drag.mode == config.drag_mode.move) {\n\t\t\t\tgantt.correctTaskWorkTime(task);\n\t\t\t}\n\t\t},\n\n\t\t_finalize_mouse_up: function(taskId, config, drag, e) {\n\t\t\tvar task = gantt.getTask(taskId);\n\n\t\t\tif (config.work_time && config.correct_work_time) {\n\t\t\t\tthis._fix_working_times(task, drag);\n\t\t\t}\n\n\t\t\tthis._fix_dnd_scale_time(task, drag);\n\n\t\t\tif (!this._fireEvent(\"before_finish\", drag.mode, [taskId, drag.mode, gantt.copy(drag.obj), e])) {\n\t\t\t\t//drag.obj._dhx_changed = false;\n\t\t\t\tthis.clear_drag_state();\n\t\t\t\tif (taskId == drag.id) {\n\t\t\t\t\tdrag.obj._dhx_changed = false;\n\t\t\t\t\tgantt.mixin(task, drag.obj, true);\n\t\t\t\t}\n\n\n\t\t\t\tgantt.refreshTask(task.id);\n\t\t\t} else {\n\t\t\t\tvar drag_id = taskId;\n\n\t\t\t\tgantt._init_task_timing(task);\n\n\t\t\t\tthis.clear_drag_state();\n\t\t\t\tgantt.updateTask(task.id);\n\t\t\t\tthis._fireEvent(\"after_finish\", drag.mode, [drag_id, drag.mode, e]);\n\t\t\t}\n\n\t\t},\n\n\t\ton_mouse_up: function(e) {\n\n\t\t\tvar drag = this.drag;\n\t\t\tif (drag.mode && drag.id) {\n\t\t\t\tvar config = timeline.$getConfig();\n\t\t\t\t//drop\n\t\t\t\tvar task = gantt.getTask(drag.id);\n\t\t\t\tvar dragMultiple = this.dragMultiple;\n\n\t\t\t\tvar finalizingBulkMove = false;\n\t\t\t\tvar moveCount = 0;\n\t\t\t\tif (drag.mode === config.drag_mode.move) {\n\t\t\t\t\tif ((gantt.isSummaryTask(task) && config.drag_project) || (this._isMultiselect())) {\n\t\t\t\t\t\tfinalizingBulkMove = true;\n\t\t\t\t\t\tmoveCount = Object.keys(dragMultiple).length;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar doFinalize = function doFinalize(){\n\t\t\t\t\tif(finalizingBulkMove){\n\t\t\t\t\t\tfor (var i in dragMultiple) {\n\t\t\t\t\t\t\t// GS-1057: Don't call drag events for the dragged task as they will be called later\n\t\t\t\t\t\t\tif (dragMultiple[i].id != drag.id){\n\t\t\t\t\t\t\t\tthis._finalize_mouse_up(dragMultiple[i].id, config, dragMultiple[i], e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis._finalize_mouse_up(drag.id, config, drag, e);\n\n\t\t\t\t};\n\n\t\t\t\tif(finalizingBulkMove && moveCount > 10){// 10 - arbitrary threshold for bulk dnd at which we start doing complete repaint to refresh\n\t\t\t\t\tgantt.batchUpdate(function(){\n\t\t\t\t\t\tdoFinalize.call(this);\n\t\t\t\t\t}.bind(this));\n\t\t\t\t}else{\n\t\t\t\t\tdoFinalize.call(this);\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis.clear_drag_state();\n\t\t},\n\t\t_get_drag_mode: function(className, el) {\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar modes = config.drag_mode;\n\t\t\tvar classes = (className || \"\").split(\" \");\n\t\t\tvar classname = classes[0];\n\t\t\tvar drag = {mode: null, left: null};\n\t\t\tswitch (classname) {\n\t\t\t\tcase \"gantt_task_line\":\n\t\t\t\tcase \"gantt_task_content\":\n\t\t\t\t\tdrag.mode = modes.move;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gantt_task_drag\":\n\t\t\t\t\tdrag.mode = modes.resize;\n\n\t\t\t\t\tvar dragProperty = el.getAttribute(\"data-bind-property\");\n\n\t\t\t\t\tif (dragProperty == \"start_date\") {\n\t\t\t\t\t\tdrag.left = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdrag.left = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gantt_task_progress_drag\":\n\t\t\t\t\tdrag.mode = modes.progress;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gantt_link_control\":\n\t\t\t\tcase \"gantt_link_point\":\n\t\t\t\t\tdrag.mode = modes.ignore;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdrag = null;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn drag;\n\n\t\t},\n\n\t\t_start_dnd: function(e) {\n\t\t\tvar drag = this.drag = this.drag.start_drag;\n\t\t\tdelete drag.start_drag;\n\n\t\t\tvar cfg = timeline.$getConfig();\n\t\t\tvar id = drag.id;\n\n\t\t\tif (!cfg[\"drag_\" + drag.mode] || !gantt.callEvent(\"onBeforeDrag\", [id, drag.mode, e]) || !this._fireEvent(\"before_start\", drag.mode, [id, drag.mode, e])) {\n\t\t\t\tthis.clear_drag_state();\n\t\t\t} else {\n\t\t\t\tdelete drag.start_drag;\n\t\t\t\tvar task = gantt.getTask(id);\n\t\t\t\tif (gantt.isReadonly(task)){\n\t\t\t\t\tthis.clear_drag_state();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this._isMultiselect()) {\n\t\t\t\t\t// for don't move selected tasks when drag unselected task\n\t\t\t\t\tvar selectedTasksIds = gantt.getSelectedTasks();\n\t\t\t\t\tif (selectedTasksIds.indexOf(drag.id) >= 0) {\n\t\t\t\t\t\thelpers.forEach(selectedTasksIds, gantt.bind(function(taskId) {\n\t\t\t\t\t\t\tvar selectedTask = gantt.getTask(taskId);\n\t\t\t\t\t\t\tif (gantt.isSummaryTask(selectedTask) && gantt.config.drag_project && drag.mode == cfg.drag_mode.move) {\n\t\t\t\t\t\t\t\tthis._addSubtasksToDragMultiple(selectedTask.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.dragMultiple[taskId] = gantt.mixin({\n\t\t\t\t\t\t\t\tid: selectedTask.id,\n\t\t\t\t\t\t\t\tobj: gantt.copy(selectedTask)\n\t\t\t\t\t\t\t}, this.drag);\n\t\t\t\t\t\t}, this));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// for move unselected summary\n\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project && drag.mode == cfg.drag_mode.move) {\n\t\t\t\t\tthis._addSubtasksToDragMultiple(task.id);\n\t\t\t\t}\n\t\t\t\tgantt.callEvent(\"onTaskDragStart\", []);\n\t\t\t}\n\n\t\t},\n\t\t_fireEvent: function(stage, mode, params) {\n\t\t\tgantt.assert(this._events[stage], \"Invalid stage:{\" + stage + \"}\");\n\n\t\t\tvar trigger = this._events[stage][mode];\n\n\t\t\tgantt.assert(trigger, \"Unknown after drop mode:{\" + mode + \"}\");\n\t\t\tgantt.assert(params, \"Invalid event arguments\");\n\n\n\t\t\tif (!gantt.checkEvent(trigger))\n\t\t\t\treturn true;\n\n\t\t\treturn gantt.callEvent(trigger, params);\n\t\t},\n\n\t\tround_task_dates: function(task) {\n\t\t\tvar drag_state = this.drag;\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tif (!drag_state) {\n\t\t\t\tdrag_state = {mode: config.drag_mode.move};\n\t\t\t}\n\t\t\tthis._fix_dnd_scale_time(task, drag_state);\n\t\t},\n\t\tdestructor: function() {\n\t\t\tthis._domEvents.detachAll();\n\t\t},\n\t\t_isMultiselect: function() {\n\t\t\treturn gantt.config.drag_multiple && !!(gantt.getSelectedTasks && gantt.getSelectedTasks().length > 0);\n\t\t},\n\t\t_addSubtasksToDragMultiple: function(summaryId) {\n\t\t\tgantt.eachTask(function(child) {\n\t\t\t\tthis.dragMultiple[child.id] = gantt.mixin({\n\t\t\t\t\tid: child.id,\n\t\t\t\t\tobj: gantt.copy(child)\n\t\t\t\t}, this.drag);\n\t\t\t}, summaryId, this);\n\t\t}\n\t};\n}\n\nfunction initTaskDND() {\n\tvar _tasks_dnd;\n\treturn {\n\t\textend: function(timeline) {\n\t\t\ttimeline.roundTaskDates = function(task) {\n\t\t\t\t_tasks_dnd.round_task_dates(task);\n\t\t\t};\n\n\t\t},\n\t\tinit: function(timeline, gantt) {\n\t\t\t_tasks_dnd = createTaskDND(timeline, gantt);\n\t\t\t// TODO: entry point for touch handlers, move touch to timeline\n\t\t\ttimeline._tasks_dnd = _tasks_dnd;\n\t\t\treturn _tasks_dnd.init(gantt);\n\t\t},\n\t\tdestructor: function() {\n\t\t\tif (_tasks_dnd) {\n\t\t\t\t_tasks_dnd.destructor();\n\t\t\t\t_tasks_dnd = null;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default {\n\tcreateTaskDND: initTaskDND\n};","import * as domHelpers from \"../utils/dom_helpers\";\n\nvar initLinksDND = function(timeline, gantt) {\n\tvar _link_landing,\n\t\t_link_target_task,\n\t\t_link_target_task_start,\n\t\t_link_source_task,\n\t\t_link_source_task_start,\n\t\tmarkerDefaultOffset = 10,\n\t\tscrollDefaultSize = 18;\n\n\tfunction getDndState(){\n\t\treturn {\n\t\t\tlink_source_id : _link_source_task,\n\t\t\tlink_target_id : _link_target_task,\n\t\t\tlink_from_start : _link_source_task_start,\n\t\t\tlink_to_start : _link_target_task_start,\n\t\t\tlink_landing_area : _link_landing\n\t\t};\n\t}\n\n\tvar services = gantt.$services;\n\n\tvar state = services.getService(\"state\");\n\tvar DnD = services.getService(\"dnd\");\n\n\tstate.registerProvider(\"linksDnD\", getDndState);\n\n\tvar start_marker = \"task_start_date\",\n\t\tend_marker = \"task_end_date\",\n\t\tlink_edge_marker = \"gantt_link_point\",\n\t\tlink_landing_hover_area = \"gantt_link_control\";\n\n\tvar dnd = new DnD(timeline.$task_bars, {\n\t\tsensitivity : 0,\n\t\tupdates_per_second : 60,\n\t\tmousemoveContainer: gantt.$root,\n\t\tselector: \".\" + link_edge_marker,\n\t\tpreventDefault: true\n\t});\n\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function(obj,e) {\n\t\tvar target = (e.target||e.srcElement);\n\t\tresetDndState();\n\t\tif(gantt.getState(\"tasksDnd\").drag_id)\n\t\t\treturn false;\n\n\t\tif(domHelpers.locateClassName(target, link_edge_marker)){\n\t\t\tif(domHelpers.locateClassName(target, start_marker))\n\t\t\t\t_link_source_task_start = true;\n\n\t\t\tvar sid = gantt.locate(e);\n\t\t\t_link_source_task = sid;\n\n\t\t\tvar t = gantt.getTask(sid);\n\t\t\tif(gantt.isReadonly(t)){\n\t\t\t\tresetDndState();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis._dir_start = {\n\t\t\t\tx: dnd.config.original_element_sizes.x + dnd.config.original_element_sizes.width/2,\n\t\t\t\ty: dnd.config.original_element_sizes.y + dnd.config.original_element_sizes.height/2\n\t\t\t};\n\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\n\t}, this));\n\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function(obj,e) {\n\t\tif(gantt.config.touch) {\n\t\t\tgantt.refreshData();\n\t\t}\n\t\tupdateMarkedHtml(dnd.config.marker);\n\t}, this));\n\n\tfunction getVieportSize(){\n\t\tvar root = gantt.$root;\n\t\treturn { right: root.offsetWidth, bottom: root.offsetHeight };\n\t}\n\tfunction getMarkerSize (marker){\n\t\tvar width = 0, height = 0;\n\t\tif(marker){\n\t\t\twidth = marker.offsetWidth || 0;\n\t\t\theight = marker.offsetHeight || 0;\n\t\t}\n\t\treturn { width: width, height: height };\n\t}\n\n\tfunction getPosition(e, marker){\n\t\tvar oldPos = dnd.getPosition(e);\n\n\t\tvar markerSize = getMarkerSize(marker);\n\t\tvar viewportSize = getVieportSize();\n\n\t\tvar offsetX = gantt.config.tooltip_offset_x || markerDefaultOffset;\n\t\tvar offsetY = gantt.config.tooltip_offset_y || markerDefaultOffset;\n\n\t\tvar scrollSize = gantt.config.scroll_size || scrollDefaultSize;\n\n\t\t// GS-1315: Add offset if there are elements above Gantt\n\t\tvar ganttOffsetY = gantt.$container.getBoundingClientRect().y + window.scrollY;\n\n\t\tvar position = {\n\t\t\ty: oldPos.y + offsetY,\n\t\t\tx: oldPos.x + offsetX,\n\t\t\tbottom: oldPos.y + markerSize.height + offsetY + scrollSize,\n\t\t\tright: oldPos.x + markerSize.width + offsetX + scrollSize\n\t\t};\n\n\t\tif(position.bottom > viewportSize.bottom + ganttOffsetY){\n\t\t\tposition.y = viewportSize.bottom + ganttOffsetY - markerSize.height - offsetY;\n\t\t}\n\n\t\tif(position.right > viewportSize.right){\n\t\t\tposition.x = viewportSize.right - markerSize.width - offsetX;\n\t\t}\n\t\treturn position;\n\t}\n\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function(obj,e) {\n\t\tvar dd = dnd.config;\n\t\tvar pos = getPosition(e, dd.marker);\n\t\tadvanceMarker(dd.marker, pos);\n\t\tvar landing = !!domHelpers.locateClassName(e, link_landing_hover_area);\n\n\t\tvar prevTarget = _link_target_task;\n\t\tvar prevLanding = _link_landing;\n\t\tvar prevToStart = _link_target_task_start;\n\n\t\tvar targ = gantt.locate(e),\n\t\t\tto_start = true;\n\n\t\t// can drag and drop link to another gantt on the page, such links are not supported\n\t\tvar eventTarget = domHelpers.getTargetNode(e);\n\n\t\tvar sameGantt = domHelpers.isChildOf(eventTarget, gantt.$root);\n\t\tif(!sameGantt){\n\t\t\tlanding = false;\n\t\t\ttarg = null;\n\t\t}\n\n\t\tif(landing){\n\t\t\t//refreshTask\n\t\t\tto_start = !domHelpers.locateClassName(e, end_marker);\n\t\t\tlanding = !!targ;\n\t\t}\n\n\t\t_link_target_task = targ;\n\t\t_link_landing = landing;\n\t\t_link_target_task_start = to_start;\n\n\t\tif(landing){\n\n\t\t\tvar node = domHelpers.locateClassName(e, link_landing_hover_area);\n\t\t\n\t\t\tconst point = node.querySelector(`.${link_edge_marker}`);\n\t\t\tif(point){\n\t\t\t\tconst absCoords = domHelpers.getRelativeNodePosition(point, timeline.$task_bg);\n\t\t\t\tthis._dir_end = {\n\t\t\t\t\tx: absCoords.x + point.offsetWidth/2,\n\t\t\t\t\ty: absCoords.y + point.offsetHeight/2\n\t\t\t\t};\n\t\t\t}\n\n\t\t}else{\n\t\t\tthis._dir_end = domHelpers.getRelativeEventPosition(e, timeline.$task_data);\n\t\t\tif(gantt.env.isEdge){ // to fix margin collapsing\n\t\t\t\tthis._dir_end.y += window.scrollY;\n\t\t\t}\n\t\t}\n\n\t\tvar targetChanged = !(prevLanding == landing && prevTarget == targ && prevToStart == to_start);\n\t\tif(targetChanged){\n\t\t\tif(prevTarget)\n\t\t\t\tgantt.refreshTask(prevTarget, false);\n\t\t\tif(targ)\n\t\t\t\tgantt.refreshTask(targ, false);\n\t\t}\n\n\t\tif(targetChanged){\n\t\t\tupdateMarkedHtml(dd.marker);\n\t\t}\n\n\t\tshowDirectingLine(this._dir_start.x, this._dir_start.y, this._dir_end.x, this._dir_end.y);\n\n\t\treturn true;\n\t}, this));\n\n\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function() {\n\t\tvar drag = getDndState();\n\n\t\tif(drag.link_source_id && drag.link_target_id && drag.link_source_id != drag.link_target_id){\n\t\t\tvar type = gantt._get_link_type(drag.link_from_start, drag.link_to_start);\n\n\t\t\tvar link = {source : drag.link_source_id, target: drag.link_target_id, type:type};\n\t\t\tif(link.type && gantt.isLinkAllowed(link)) {\n\t\t\t\tif(gantt.callEvent(\"onLinkCreated\", [link])){\n\t\t\t\t\tgantt.addLink(link);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tresetDndState();\n\n\t\tif(gantt.config.touch) {\n\t\t\tgantt.refreshData();\n\t\t}\n\t\telse {\n\t\t\tif (drag.link_source_id)\n\t\t\t\tgantt.refreshTask(drag.link_source_id, false);\n\t\t\tif (drag.link_target_id)\n\t\t\t\tgantt.refreshTask(drag.link_target_id, false);\n\t\t}\n\t\tremoveDirectionLine();\n\t}, this));\n\n\tfunction updateMarkedHtml(marker){\n\t\tvar link = getDndState();\n\n\t\tvar css = [\"gantt_link_tooltip\"];\n\t\tif(link.link_source_id && link.link_target_id){\n\t\t\tif(gantt.isLinkAllowed(link.link_source_id, link.link_target_id, link.link_from_start, link.link_to_start)){\n\t\t\t\tcss.push(\"gantt_allowed_link\");\n\t\t\t}else{\n\t\t\t\tcss.push(\"gantt_invalid_link\");\n\t\t\t}\n\t\t}\n\n\t\tvar className = gantt.templates.drag_link_class(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start);\n\t\tif(className)\n\t\t\tcss.push(className);\n\n\t\tvar html = \"<div class='\"+className+ \"'>\" +\n\t\t\tgantt.templates.drag_link(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start) +\n\t\t\t\"</div>\";\n\t\tmarker.innerHTML = html;\n\t}\n\n\tfunction advanceMarker(marker, pos){\n\t\tmarker.style.left = pos.x + \"px\";\n\t\tmarker.style.top = pos.y + \"px\";\n\t}\n\n\tfunction resetDndState(){\n\t\t_link_source_task =\n\t\t\t_link_source_task_start =\n\t\t\t\t_link_target_task = null;\n\t\t_link_target_task_start = true;\n\t}\n\tfunction showDirectingLine(s_x, s_y, e_x, e_y){\n\t\tvar div = getDirectionLine();\n\n\t\tvar link = getDndState();\n\n\t\tvar css = [\"gantt_link_direction\"];\n\t\tif(gantt.templates.link_direction_class){\n\t\t\tcss.push(gantt.templates.link_direction_class(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start));\n\t\t}\n\n\t\tvar dist =Math.sqrt( (Math.pow(e_x - s_x, 2)) + (Math.pow(e_y - s_y, 2)) );\n\t\tdist = Math.max(0, dist - 3);\n\t\tif(!dist)\n\t\t\treturn;\n\n\t\tdiv.className = css.join(\" \");\n\t\tvar tan = (e_y - s_y)/(e_x - s_x),\n\t\t\tangle = Math.atan(tan);\n\n\t\tif(coordinateCircleQuarter(s_x, e_x, s_y, e_y) == 2){\n\t\t\tangle += Math.PI;\n\t\t}else if(coordinateCircleQuarter(s_x, e_x, s_y, e_y) == 3){\n\t\t\tangle -= Math.PI;\n\t\t}\n\n\n\n\t\tvar sin = Math.sin(angle),\n\t\t\tcos = Math.cos(angle),\n\t\t\ttop = Math.round(s_y),\n\t\t\tleft = Math.round(s_x);\n\n\n\t\tvar style = [\n\t\t\t\"-webkit-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"-moz-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"-ms-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"-o-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"width:\" + Math.round(dist) + \"px\"\n\t\t];\n\n\t\tif(window.navigator.userAgent.indexOf(\"MSIE 8.0\") != -1){\n\t\t\t//ms-filter breaks styles in ie9, so add it only for 8th\n\t\t\tstyle.push(\"-ms-filter: \\\"\" + ieTransform(sin, cos) + \"\\\"\");\n\n\t\t\tvar shiftLeft = Math.abs(Math.round(s_x - e_x)),\n\t\t\t\tshiftTop = Math.abs(Math.round(e_y - s_y));\n\t\t\t//fix rotation axis\n\t\t\tswitch(coordinateCircleQuarter(s_x, e_x, s_y, e_y)){\n\t\t\t\tcase 1:\n\t\t\t\t\ttop -= shiftTop;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tleft -= shiftLeft;\n\t\t\t\t\ttop -= shiftTop;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tleft -= shiftLeft;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tstyle.push(\"top:\" +  top + \"px\");\n\t\tstyle.push(\"left:\" +  left + \"px\");\n\n\t\tdiv.style.cssText = style.join(\";\");\n\t}\n\n\tfunction ieTransform(sin, cos){\n\t\treturn \"progid:DXImageTransform.Microsoft.Matrix(\"+\n\t\t\t\"M11 = \"+cos+\",\"+\n\t\t\t\"M12 = -\"+sin+\",\"+\n\t\t\t\"M21 = \"+sin+\",\"+\n\t\t\t\"M22 = \"+cos+\",\"+\n\t\t\t\"SizingMethod = 'auto expand'\"+\n\t\t\")\";\n\t}\n\tfunction coordinateCircleQuarter(sX, eX, sY, eY){\n\t\tif(eX >= sX){\n\t\t\tif(eY <= sY){\n\t\t\t\treturn 1;\n\t\t\t}else{\n\t\t\t\treturn 4;\n\t\t\t}\n\t\t}else{\n\t\t\tif(eY <= sY){\n\t\t\t\treturn 2;\n\t\t\t}else{\n\t\t\t\treturn 3;\n\t\t\t}\n\t\t}\n\n\t}\n\tfunction getDirectionLine(){\n\t\tif(!dnd._direction || !dnd._direction.parentNode){\n\t\t\tdnd._direction = document.createElement(\"div\");\n\t\t\ttimeline.$task_links.appendChild(dnd._direction);\n\t\t}\n\t\treturn dnd._direction;\n\t}\n\tfunction removeDirectionLine(){\n\t\tif(dnd._direction){\n\t\t\tif (dnd._direction.parentNode)\t//the event line can be detached because of data refresh\n\t\t\t\tdnd._direction.parentNode.removeChild(dnd._direction);\n\n\t\t\tdnd._direction = null;\n\t\t}\n\t}\n\tgantt.attachEvent(\"onGanttRender\", gantt.bind(function() {\n\t\tif(dnd._direction){\n\t\t\tshowDirectingLine(this._dir_start.x, this._dir_start.y, this._dir_end.x, this._dir_end.y);\n\t\t}\n\t}, this));\n};\n\nexport default {\n\tcreateLinkDND: function(){\n\t\treturn {\n\t\t\tinit: initLinksDND\n\t\t};\n\t}\n};","import * as utils from \"../../../utils/utils\";\nimport taskDnD from \"./tasks_dnd\";\nimport linkDnD from \"./links_dnd\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport MouseDelegates from \"../mouse_event_container\";\n\nvar initializer = (function(){\n\treturn function(gantt){\n\t\tvar services = gantt.$services;\n\t\treturn {\n\t\t\tonCreated: function (timeline) {\n\t\t\t\tvar config = timeline.$config;\n\t\t\t\tconfig.bind = utils.defined(config.bind) ? config.bind : \"task\";\n\t\t\t\tconfig.bindLinks = utils.defined(config.bindLinks) ? config.bindLinks : \"link\";\n\n\t\t\t\ttimeline._linksDnD = linkDnD.createLinkDND();\n\t\t\t\ttimeline._tasksDnD = taskDnD.createTaskDND();\n\t\t\t\ttimeline._tasksDnD.extend(timeline);\n\n\t\t\t\tthis._mouseDelegates = MouseDelegates(gantt);\n\t\t\t},\n\t\t\tonInitialized: function (timeline) {\n\t\t\t\tthis._attachDomEvents(gantt);\n\n\t\t\t\tthis._attachStateProvider(gantt, timeline);\n\n\t\t\t\ttimeline._tasksDnD.init(timeline, gantt);\n\t\t\t\ttimeline._linksDnD.init(timeline, gantt);\n\n\t\t\t\tif(timeline.$config.id == \"timeline\"){\n\t\t\t\t\tthis.extendDom(timeline);\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tonDestroyed: function (timeline) {\n\t\t\t\tthis._clearDomEvents(gantt);\n\t\t\t\tthis._clearStateProvider(gantt);\n\t\t\t\tif (timeline._tasksDnD) {\n\t\t\t\t\ttimeline._tasksDnD.destructor();\n\t\t\t\t}\n\t\t\t},\n\t\t\textendDom: function(timeline){\n\t\t\t\tgantt.$task = timeline.$task;\n\t\t\t\tgantt.$task_scale = timeline.$task_scale;\n\t\t\t\tgantt.$task_data = timeline.$task_data;\n\t\t\t\tgantt.$task_bg = timeline.$task_bg;\n\t\t\t\tgantt.$task_links = timeline.$task_links;\n\t\t\t\tgantt.$task_bars = timeline.$task_bars;\n\t\t\t},\n\n\t\t\t_clearDomEvents: function(){\n\t\t\t\tthis._mouseDelegates.destructor();\n\t\t\t\tthis._mouseDelegates = null;\n\t\t\t},\n\n\t\t\t_attachDomEvents: function(gantt){\n\t\t\t\tfunction _delete_link_handler(id, e) {\n\t\t\t\t\tif (id && this.callEvent(\"onLinkDblClick\", [id, e])) {\n\n\t\t\t\t\t\tvar link = this.getLink(id);\n\t\t\t\t\t\tif (this.isReadonly(link)) return;\n\n\t\t\t\t\t\tvar title = \"\";\n\t\t\t\t\t\tvar question = this.locale.labels.link + \" \" + this.templates.link_description(this.getLink(id)) + \" \" + this.locale.labels.confirm_link_deleting;\n\n\t\t\t\t\t\twindow.setTimeout(function () {\n\t\t\t\t\t\t\tgantt._simple_confirm(question, title, function () {\n\t\t\t\t\t\t\t\tgantt.deleteLink(id);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}, (this.config.touch ? 300 : 1));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_task_link\", gantt.bind(function (e, trg) {\n\t\t\t\t\tvar id = this.locate(e, this.config.link_attribute);\n\t\t\t\t\tif (id) {\n\t\t\t\t\t\tthis.callEvent(\"onLinkClick\", [id, e]);\n\t\t\t\t\t}\n\t\t\t\t}, gantt), this.$task);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_scale_cell\", gantt.bind(function (e, trg) {\n\t\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\n\t\t\t\t\tvar date = gantt.dateFromPos(pos.x);\n\t\t\t\t\tvar coll = Math.floor(gantt.columnIndexByDate(date));\n\n\t\t\t\t\tvar coll_date = gantt.getScale().trace_x[coll];\n\n\t\t\t\t\tgantt.callEvent(\"onScaleClick\", [e, coll_date]);\n\t\t\t\t}, gantt), this.$task);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"doubleclick\", \"gantt_task_link\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar id = this.locate(e, gantt.config.link_attribute);\n\t\t\t\t\t_delete_link_handler.call(this, id, e);\n\t\t\t\t}, gantt), this.$task);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"doubleclick\", \"gantt_link_point\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar id = this.locate(e),\n\t\t\t\t\t\ttask = this.getTask(id);\n\n\t\t\t\t\tvar link = null;\n\t\t\t\t\tif (trg.parentNode && domHelpers.getClassName(trg.parentNode)) {\n\t\t\t\t\t\tif (domHelpers.getClassName(trg.parentNode).indexOf(\"_left\") > -1) {\n\t\t\t\t\t\t\tlink = task.$target[0];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlink = task.$source[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (link)\n\t\t\t\t\t\t_delete_link_handler.call(this, link, e);\n\t\t\t\t\treturn false;\n\t\t\t\t}, gantt), this.$task);\n\t\t\t},\n\n\t\t\t_attachStateProvider: function(gantt, timeline){\n\t\t\t\tvar self = timeline;\n\t\t\t\tvar state = services.getService(\"state\");\n\t\t\t\tstate.registerProvider(\"tasksTimeline\", function(){\n\t\t\t\t\treturn {\n\t\t\t\t\t\tscale_unit: self._tasks ? self._tasks.unit : undefined,\n\t\t\t\t\t\tscale_step:  self._tasks ? self._tasks.step  : undefined\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t_clearStateProvider: function(){\n\t\t\t\tvar state = services.getService(\"state\");\n\t\t\t\tstate.unregisterProvider(\"tasksTimeline\");\n\t\t\t}\n\t\t};\n\t};\n\n})();\n\nexport default initializer;","import * as domHelpers from \"./utils/dom_helpers\";\n\nvar initializer = (function() {\n\treturn function (gantt) {\n\t\treturn {\n\n\t\t\tgetVerticalScrollbar: function(){\n\t\t\t\treturn gantt.$ui.getView(\"scrollVer\");\n\t\t\t},\n\t\t\tgetHorizontalScrollbar: function(){\n\t\t\t\treturn gantt.$ui.getView(\"scrollHor\");\n\t\t\t},\n\n\t\t\t_legacyGridResizerClass: function(layout){\n\t\t\t\tvar resizers = layout.getCellsByType(\"resizer\");\n\t\t\t\tfor(var i = 0; i < resizers.length; i++){\n\t\t\t\t\tvar r = resizers[i];\n\t\t\t\t\tvar gridResizer = false;\n\n\t\t\t\t\tvar prev = r.$parent.getPrevSibling(r.$id);\n\t\t\t\t\tif(prev && prev.$config && prev.$config.id === \"grid\"){\n\t\t\t\t\t\tgridResizer= true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar next = r.$parent.getNextSibling(r.$id);\n\t\t\t\t\t\tif(next && next.$config && next.$config.id === \"grid\"){\n\t\t\t\t\t\t\tgridResizer= true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif(gridResizer){\n\t\t\t\t\t\tr.$config.css = (r.$config.css ? r.$config.css + \" \" : \"\") + \"gantt_grid_resize_wrap\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonCreated: function(layout) {\n\t\t\t\tvar first = true;\n\n\t\t\t\tthis._legacyGridResizerClass(layout);\n\n\t\t\t\tlayout.attachEvent(\"onBeforeResize\", function() {\n\t\t\t\t\tvar mainTimeline = gantt.$ui.getView(\"timeline\");\n\t\t\t\t\tif (mainTimeline)\n\t\t\t\t\t\tmainTimeline.$config.hidden = mainTimeline.$parent.$config.hidden = !gantt.config.show_chart;\n\n\t\t\t\t\tvar mainGrid = gantt.$ui.getView(\"grid\");\n\n\t\t\t\t\tif(!mainGrid)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tvar colsWidth = mainGrid._getColsTotalWidth();\n\t\t\t\t\tvar hideGrid = !gantt.config.show_grid || !gantt.config.grid_width || colsWidth === 0;\n\t\t\t\t\tif (first && !hideGrid && colsWidth !== false){\n\t\t\t\t\t\t\tgantt.config.grid_width = colsWidth;\n\t\t\t\t\t}\n\t\t\t\t\tmainGrid.$config.hidden = mainGrid.$parent.$config.hidden = hideGrid;\n\n\t\t\t\t\tif (!mainGrid.$config.hidden) {\n\t\t\t\t\t\t/* restrict grid width due to min_width, max_width, min_grid_column_width */\n\t\t\t\t\t\tvar grid_limits = mainGrid._getGridWidthLimits();\n\t\t\t\t\t\tif (grid_limits[0] && gantt.config.grid_width < grid_limits[0])\n\t\t\t\t\t\t\tgantt.config.grid_width = grid_limits[0];\n\t\t\t\t\t\tif (grid_limits[1] && gantt.config.grid_width > grid_limits[1])\n\t\t\t\t\t\t\tgantt.config.grid_width = grid_limits[1];\n\t\t\t\t\t\tif (mainTimeline && gantt.config.show_chart){\n\n\t\t\t\t\t\t\tmainGrid.$config.width = gantt.config.grid_width - 1;\n\n\t\t\t\t\t\t\t// GS-1314: Don't let the non-scrollable grid to be larger than the container with the correct width\n\t\t\t\t\t\t\tif (!mainGrid.$config.scrollable && mainGrid.$config.scrollY && gantt.$root.offsetWidth){\n\t\t\t\t\t\t\t\tvar ganttContainerWidth = mainGrid.$gantt.$layout.$container.offsetWidth;\n\t\t\t\t\t\t\t\tvar verticalScrollbar = gantt.$ui.getView(mainGrid.$config.scrollY);\n\t\t\t\t\t\t\t\tvar verticalScrollbarWidth = verticalScrollbar.$config.width;\n\n\t\t\t\t\t\t\t\t// GS-2488: to prevent grid from occupying the whole gantt container(timeline will be disabled) \n\t\t\t\t\t\t\t\t// need to leave min width for timeline\n\t\t\t\t\t\t\t\tvar gridOverflow = ganttContainerWidth - (mainGrid.$config.width + verticalScrollbarWidth) - 4;\n\t\t\t\t\t\t\t\tif (gridOverflow < 0){\n\t\t\t\t\t\t\t\t\tmainGrid.$config.width += gridOverflow;\n\t\t\t\t\t\t\t\t\tgantt.config.grid_width += gridOverflow;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\t\tif (mainTimeline && !domHelpers.isChildOf(mainTimeline.$task, layout.$view)) {\n\t\t\t\t\t\t\t\t\t// timeline is being displayed after being not visible, reset grid with from full screen\n\t\t\t\t\t\t\t\t\tif (!mainGrid.$config.original_grid_width) {\n\t\t\t\t\t\t\t\t\t\tvar skinSettings = gantt.skins[gantt.skin];\n\t\t\t\t\t\t\t\t\t\tif(skinSettings && skinSettings.config && skinSettings.config.grid_width){\n\t\t\t\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width =  skinSettings.config.grid_width;\n\t\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width = 0;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tgantt.config.grid_width = mainGrid.$config.original_grid_width;\n\t\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = gantt.config.grid_width;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmainGrid.$parent._setContentSize(mainGrid.$config.width, null);\n\t\t\t\t\t\t\t\t\tgantt.$layout._syncCellSizes(mainGrid.$parent.$config.group, {value: gantt.config.grid_width, isGravity: false});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = gantt.config.grid_width;\n\t\t\t\t\t\t\t\tif (mainGrid.$parent.$config.group) {\n\t\t\t\t\t\t\t\t\tgantt.$layout._syncCellSizes(mainGrid.$parent.$config.group, {value: mainGrid.$parent.$config.width, isGravity: false});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (mainTimeline && domHelpers.isChildOf(mainTimeline.$task, layout.$view)) {\n\t\t\t\t\t\t\t\t// hiding timeline, remember grid with to restore it when timeline is displayed again\n\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width = gantt.config.grid_width;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfirst = false;\n\t\t\t\t});\n\t\t\t\tthis._initScrollStateEvents(layout);\n\t\t\t},\n\n\t\t\t_initScrollStateEvents: function(layout) {\n\t\t\t\tgantt._getVerticalScrollbar = this.getVerticalScrollbar;\n\t\t\t\tgantt._getHorizontalScrollbar = this.getHorizontalScrollbar;\n\n\t\t\t\tvar vertical = this.getVerticalScrollbar();\n\t\t\t\tvar horizontal = this.getHorizontalScrollbar();\n\t\t\t\tif (vertical) {\n\t\t\t\t\tvertical.attachEvent(\"onScroll\", function(oldPos, newPos, dir){\n\t\t\t\t\t\tvar scrollState = gantt.getScrollState();\n\t\t\t\t\t\tgantt.callEvent(\"onGanttScroll\", [scrollState.x, oldPos, scrollState.x, newPos]);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (horizontal) {\n\t\t\t\t\thorizontal.attachEvent(\"onScroll\", function(oldPos, newPos, dir){\n\t\t\t\t\t\tvar scrollState = gantt.getScrollState();\n\t\t\t\t\t\tgantt.callEvent(\"onGanttScroll\", [oldPos, scrollState.y, newPos, scrollState.y]);\n\n\t\t\t\t\t\t// if the grid doesn't fit the width, scroll the row container\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tif (grid && grid.$grid_data && !grid.$config.scrollable){\n\t\t\t\t\t\t\tgrid.$grid_data.style.left = grid.$grid.scrollLeft + \"px\";\n\t\t\t\t\t\t\tgrid.$grid_data.scrollLeft = grid.$grid.scrollLeft;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tlayout.attachEvent(\"onResize\", function(){\n\t\t\t\t\tif (vertical && !gantt.$scroll_ver){\n\t\t\t\t\t\tgantt.$scroll_ver = vertical.$scroll_ver;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (horizontal && !gantt.$scroll_hor){\n\t\t\t\t\t\tgantt.$scroll_hor = horizontal.$scroll_hor;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t_findGridResizer: function(layout, grid){\n\t\t\t\tvar resizers = layout.getCellsByType(\"resizer\");\n\n\t\t\t\tvar gridFirst = true;\n\t\t\t\tvar gridResizer;\n\t\t\t\tfor(var i = 0; i < resizers.length; i++){\n\t\t\t\t\tvar res = resizers[i];\n\t\t\t\t\tres._getSiblings();\n\t\t\t\t\tvar prev = res._behind;\n\t\t\t\t\tvar next = res._front;\n\t\t\t\t\tif(prev && prev.$content === grid || (prev.isChild && prev.isChild(grid))){\n\t\t\t\t\t\tgridResizer = res;\n\t\t\t\t\t\tgridFirst = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else if(next && next.$content === grid || (next.isChild && next.isChild(grid))){\n\t\t\t\t\t\tgridResizer = res;\n\t\t\t\t\t\tgridFirst = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tresizer: gridResizer,\n\t\t\t\t\tgridFirst: gridFirst\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tonInitialized: function (layout) {\n\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\n\t\t\t\tvar resizeInfo = this._findGridResizer(layout, grid);\n\n\t\t\t\t// expose grid resize events\n\t\t\t\tif(resizeInfo.resizer){\n\t\t\t\t\tvar gridFirst = resizeInfo.gridFirst,\n\t\t\t\t\t\tnext = resizeInfo.resizer;\n\t\t\t\t\t\t\n\t\t\t\t\tif(next.$config.mode !== \"x\"){\n\t\t\t\t\t\treturn;// track only horizontal resize\n\t\t\t\t\t}\n\n\t\t\t\t\tvar initialWidth;\n\t\t\t\t\tnext.attachEvent(\"onResizeStart\", function(prevCellWidth, nextCellWidth){\n\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tvar viewCell = grid ? grid.$parent : null;\n\t\t\t\t\t\tif(viewCell){\n\t\t\t\t\t\t\tvar limits = grid._getGridWidthLimits();\n\n\t\t\t\t\t\t\t// min grid width is defined by min widths of its columns, unless grid has horizontal scroll\n\t\t\t\t\t\t\tif(!grid.$config.scrollable)\n\t\t\t\t\t\t\t\tviewCell.$config.minWidth = limits[0];\n\n\t\t\t\t\t\t\tviewCell.$config.maxWidth = limits[1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinitialWidth = gridFirst ? prevCellWidth : nextCellWidth;\n\t\t\t\t\t\treturn gantt.callEvent(\"onGridResizeStart\", [initialWidth]);\n\t\t\t\t\t});\n\t\t\t\t\tnext.attachEvent(\"onResize\", function(newBehindSize, newFrontSize){\n\t\t\t\t\t\tvar newSize = gridFirst ? newBehindSize : newFrontSize;\n\t\t\t\t\t\treturn gantt.callEvent(\"onGridResize\", [initialWidth, newSize]);\n\t\t\t\t\t});\n\t\t\t\t\tnext.attachEvent(\"onResizeEnd\", function(oldBackSize, oldFrontSize, newBackSize, newFrontSize){\n\n\t\t\t\t\t\tvar oldSize = gridFirst ? oldBackSize : oldFrontSize;\n\t\t\t\t\t\tvar newSize = gridFirst ? newBackSize : newFrontSize;\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tvar viewCell = grid ? grid.$parent : null;\n\t\t\t\t\t\tif(viewCell){\n\t\t\t\t\t\t\tviewCell.$config.minWidth = undefined;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar res = gantt.callEvent(\"onGridResizeEnd\", [oldSize, newSize]);\n\t\t\t\t\t\tif(res && newSize !== 0){// new size may be numeric zero when cell size is defined by 'gravity', actual size will be calculated by layout later\n\t\t\t\t\t\t\tgantt.config.grid_width = newSize;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn res;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tonDestroyed: function (timeline) {\n\n\t\t\t}\n\t\t};\n\n\t};\n})();\n\nexport default initializer;","import uiFactory from \"./ui_factory\";\nimport mouseEvents from \"./mouse\";\nimport createLayers from \"./gantt_layers\";\nimport Cell from \"./layout/cell\";\nimport Layout from \"./layout/layout\";\nimport ViewLayout from \"./layout/view_layout\";\nimport ViewCell from \"./layout/view_cell\";\nimport Resizer from \"./layout/resizer_cell\";\nimport Scrollbar from \"./layout/scrollbar_cell\";\nimport Timeline from \"./timeline/timeline\";\nimport Grid from \"./grid/grid\";\nimport ResourceGrid from \"./grid/resource_grid\";\nimport ResourceTimeline from \"./timeline/resource_timeline\";\nimport ResourceHistogram from \"./timeline/resource_histogram\";\n\n\nimport gridEditorsFactory from \"./grid/editors/controller\";\n\nimport renderTaskBar from \"./render/task_bar_smart_render\";\nimport renderTimedProjectBar from \"./render/task_project_smart_render\";\nimport renderSplitTaskBar from \"./render/task_split_render\";\nimport renderRollupTaskBar from \"./render/task_rollup_render\";\nimport renderTaskBg from \"./render/task_bg_render\";\nimport renderLink from \"./render/link_render\";\nimport gridRenderer from \"./render/task_grid_line_render\";\nimport resourceMatrixRenderer from \"./render/resource_matrix_render\";\nimport resourceHistogramRenderer from \"./render/resource_histogram_render\";\nimport gridTaskRowResizerRenderer from \"./render/task_grid_row_resize_render\";\nimport renderConstraints from \"./render/task_constraints_render\";\nimport renderDeadline from \"./render/task_deadline_render\";\nimport renderBaselines from \"./render/task_baselines_render\";\nimport mainGridInitializer from \"./grid/main_grid_initializer\";\nimport mainTimelineInitializer from \"./timeline/main_timeline_initializer\";\nimport mainLayoutInitializer from \"./main_layout_initializer\";\n\nfunction initUI(gantt){\n\tfunction attachInitializer(view, initializer){\n\t\tvar ext = initializer(gantt);\n\t\tif(ext.onCreated)\n\t\t\text.onCreated(view);\n\t\tview.attachEvent(\"onReady\", function(){\n\t\t\tif(ext.onInitialized)\n\t\t\t\text.onInitialized(view);\n\t\t});\n\t\tview.attachEvent(\"onDestroy\", function(){\n\t\t\tif(ext.onDestroyed)\n\t\t\t\text.onDestroyed(view);\n\t\t});\n\t}\n\n\tvar factory = uiFactory.createFactory(gantt);\n\tfactory.registerView(\"cell\", Cell);\n\tfactory.registerView(\"resizer\", Resizer);\n\tfactory.registerView(\"scrollbar\", Scrollbar);\n\tfactory.registerView(\"layout\", Layout, function(view){\n\t\tvar id = view.$config ? view.$config.id : null;\n\t\tif(id === \"main\"){\n\t\t\tattachInitializer(view, mainLayoutInitializer);\n\t\t}\n\t});\n\tfactory.registerView(\"viewcell\", ViewCell);\n\tfactory.registerView(\"multiview\", ViewLayout);\n\tfactory.registerView(\"timeline\", Timeline, function(view){\n\t\tvar id = view.$config ? view.$config.id : null;\n\t\tif(id === \"timeline\" || view.$config.bind == \"task\"){\n\t\t\tattachInitializer(view, mainTimelineInitializer);\n\t\t}\n\t});\n\tfactory.registerView(\"grid\", Grid, function(view){\n\t\tvar id = view.$config ? view.$config.id : null;\n\t\tif(id === \"grid\" || view.$config.bind == \"task\"){\n\t\t\tattachInitializer(view, mainGridInitializer);\n\t\t}\n\t});\n\n\tfactory.registerView(\"resourceGrid\", ResourceGrid);\n\tfactory.registerView(\"resourceTimeline\", ResourceTimeline);\n\tfactory.registerView(\"resourceHistogram\", ResourceHistogram);\n\n\tvar layersEngine = createLayers(gantt);\n\n\tvar inlineEditors = gridEditorsFactory(gantt);\n\n\tgantt.ext.inlineEditors = inlineEditors;\n\tgantt.ext._inlineEditors = inlineEditors;\n\tinlineEditors.init(gantt);\n\n\treturn {\n\t\tfactory:factory,\n\t\tmouseEvents: mouseEvents.init(gantt),\n\t\tlayersApi: layersEngine.init(),\n\t\trender:{\n\t\t\tgridLine: function(){\n\t\t\t\treturn gridRenderer(gantt);\n\t\t\t},\n\t\t\ttaskBg: function(){\n\t\t\t\treturn renderTaskBg(gantt);\n\t\t\t},\n\t\t\ttaskBar: function(){\n\t\t\t\treturn renderTaskBar(gantt);\n\t\t\t},\n\t\t\ttimedProjectBar: function(){\n\t\t\t\treturn renderTimedProjectBar(gantt);\n\t\t\t},\n\t\t\ttaskRollupBar: function() {\n\t\t\t\treturn renderRollupTaskBar(gantt);\n\t\t\t},\n\t\t\ttaskSplitBar: function(){\n\t\t\t\treturn renderSplitTaskBar(gantt);\n\t\t\t},\n\t\t\ttaskConstraints: function(){\n\t\t\t\treturn renderConstraints(gantt);\n\t\t\t},\n\t\t\ttaskDeadline: function(){\n\t\t\t\treturn renderDeadline(gantt);\n\t\t\t},\n\t\t\ttaskBaselines: function(){\n\t\t\t\treturn renderBaselines(gantt);\n\t\t\t},\n\t\t\tlink: function(){\n\t\t\t\treturn renderLink(gantt);\n\t\t\t},\n\t\t\tresourceRow: function(){\n\t\t\t\treturn resourceMatrixRenderer(gantt);\n\t\t\t},\n\t\t\tresourceHistogram: function(){\n\t\t\t\treturn resourceHistogramRenderer(gantt);\n\t\t\t},\n\t\t\tgridTaskRowResizer: function(){\n\t\t\t\treturn gridTaskRowResizerRenderer(gantt);\n\t\t\t}\n\t\t},\n\t\tlayersService: {\n\t\t\tgetDataRender: function(name){\n\t\t\t\treturn layersEngine.getDataRender(name, gantt);\n\t\t\t},\n\t\t\tcreateDataRender: function(config){\n\t\t\t\treturn layersEngine.createDataRender(config, gantt);\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default {\n\tinit: initUI\n};","import * as helpers from \"../../../utils/helpers\";\nimport getRowRectangle from \"./viewport/get_grid_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport isInViewPort from \"./viewport/is_grid_row_in_viewport\";\n\nfunction createGridLineRender(gantt){\n\n\tfunction _render_grid_item(item, view, config, viewport) {\n\t\tvar columns = view.getGridColumns();\n\t\tvar templates = view.$getTemplates();\n\n\t\tvar store = view.$config.rowStore;\n\n\t\tvar cells = [];\n\t\tvar has_child;\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar last = i == columns.length - 1;\n\t\t\tvar col = columns[i];\n\t\t\tvar cell;\n\n\t\t\tvar value;\n\t\t\tvar textValue;\n\t\t\tif (col.name == \"add\") {\n\t\t\t\tvar aria = gantt._waiAria.gridAddButtonAttrString(col);\n\n\t\t\t\tvalue = \"<div \" + aria + \" class='gantt_add'></div>\";\n\t\t\t\ttextValue = \"\";\n\t\t\t} else {\n\t\t\t\tif (col.template)\n\t\t\t\t\tvalue = col.template(item);\n\t\t\t\telse\n\t\t\t\t\tvalue = item[col.name];\n\n\t\t\t\tif (helpers.isDate(value)){\n\t\t\t\t\tvalue = templates.date_grid(value, item, col.name);\n\t\t\t\t}\n\n\t\t\t\tif (value === null || value === undefined) {\n\t\t\t\t\tvalue = \"\";\n\t\t\t\t}\n\n\t\t\t\ttextValue = value;\n\t\t\t\tvalue = \"<div class='gantt_tree_content'>\" + value + \"</div>\";\n\t\t\t}\n\t\t\tvar css = \"gantt_cell\" + (last ? \" gantt_last_cell\" : \"\");\n\n\t\t\tvar tree = [];\n\t\t\tif (col.tree) {\n\t\t\t\tcss += \" gantt_cell_tree\";\n\t\t\t\tfor (var j = 0; j < item.$level; j++)\n\t\t\t\t\ttree.push(templates.grid_indent(item));\n\n\t\t\t\thas_child = store.hasChild(item.id) && !(gantt.isSplitTask(item) && !gantt.config.open_split_tasks);\n\t\t\t\tif (has_child) {\n\t\t\t\t\ttree.push(templates.grid_open(item));\n\t\t\t\t\ttree.push(templates.grid_folder(item));\n\t\t\t\t} else {\n\t\t\t\t\ttree.push(templates.grid_blank(item));\n\t\t\t\t\ttree.push(templates.grid_file(item));\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar style = \"width:\" + (col.width - (last ? 1 : 0)) + \"px;\";\n\t\t\tif (this.defined(col.align)){\n\t\t\t\tvar flexAlign = {\n\t\t\t\t\tright: \"flex-end\",\n\t\t\t\t\tleft: \"flex-start\",\n\t\t\t\t\tcenter: \"center\"\n\t\t\t\t};\n\t\t\t\tvar justifyContent = flexAlign[col.align];\n\n\t\t\t\tstyle += \"text-align:\" + col.align + \";justify-content:\"  + justifyContent + \";\";\n\t\t\t}\n\n\t\t\tvar aria = gantt._waiAria.gridCellAttrString(col, textValue, item);\n\n\t\t\ttree.push(value);\n\t\t\tcell = \"<div class='\" + css + \"' data-column-index='\"+i+\"' data-column-name='\"+col.name+\"' style='\" + style + \"' \" + aria + \">\" + tree.join(\"\") + \"</div>\";\n\t\t\tcells.push(cell);\n\t\t}\n\t\t// GS-291. The odd class should be assigned correctly\n\t\tcss = \"\";\n\t\tconst storeName = store.$config.name;\n\t\tswitch (storeName) {\n\t\t\tcase \"task\":\n\t\t\t\tcss = gantt.getGlobalTaskIndex(item.id) % 2 === 0 ? \"\" : \" odd\";\n\t\t\t\tbreak;\n\t\t\tcase \"resource\":\n\t\t\t\tcss = store.visibleOrder.indexOf(item.id) % 2 === 0 ? \"\" : \" odd\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\tcss += (item.$transparent) ? \" gantt_transparent\" : \"\";\n\n\t\tcss += (item.$dataprocessor_class ? \" \" + item.$dataprocessor_class : \"\");\n\n\t\tif (templates.grid_row_class) {\n\t\t\tvar css_template = templates.grid_row_class.call(gantt, item.start_date, item.end_date, item);\n\t\t\tif (css_template)\n\t\t\t\tcss += \" \" + css_template;\n\t\t}\n\n\t\tif(store.isSelected(item.id)) {\n\t\t\tcss += \" gantt_selected\";\n\t\t}\n\n\t\tvar el = document.createElement(\"div\");\n\t\tel.className = \"gantt_row\" + css + \" gantt_row_\" + gantt.getTaskType(item.type);\n\t\tvar height = view.getItemHeight(item.id);\n\t\tel.style.height = height + \"px\";\n\t\tel.style.lineHeight = height + \"px\";\n\n\t\tif(config.smart_rendering){\n\t\t\tel.style.position = \"absolute\";\n\t\t\tel.style.left = \"0px\";\n\t\t\tel.style.top = view.getItemTop(item.id) + \"px\";\n\t\t}\n\n\t\tif(view.$config.item_attribute){\n\t\t\tel.setAttribute(view.$config.item_attribute, item.id);\n\t\t\tel.setAttribute(view.$config.bind + \"_id\", item.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\tgantt._waiAria.taskRowAttr(item, el);\n\n\t\tel.innerHTML = cells.join(\"\");\n\t\treturn el;\n\t}\n\n\tfunction onrender(item, rowNode, view){\n\t\tvar columns = view.getGridColumns();\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar column = columns[i];\n\t\t\tif (column.onrender){\n\n\t\t\t\t// find cell node for current column\n\t\t\t\tvar cellNode = rowNode.querySelector(\"[data-column-name=\" + column.name + \"]\");\n\t\t\t\tif (cellNode) {\n\t\t\t\t\tvar content = column.onrender(item, cellNode);\n\t\t\t\t\tif (content && typeof content === \"string\") {\n\t\t\t\t\t\tcellNode.innerHTML = content;\n\t\t\t\t\t} else if (content && typeof content === \"object\") {\n\t\t\t\t\t\t// render object to node using additional functionality\n\t\t\t\t\t\tif (gantt.config.external_render){\n\t\t\t\t\t\t\tvar adapter = gantt.config.external_render;\n\t\t\t\t\t\t\tif (adapter.isElement(content)){\n\t\t\t\t\t\t\t\tadapter.renderElement(content, cellNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\trender: _render_grid_item,\n\t\tupdate: null,\n\t\tgetRectangle: getRowRectangle,\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange,\n\t\tonrender: onrender\n\t};\n}\n\nexport default createGridLineRender;","import getRowRectangle from \"./viewport/get_bg_row_rectangle\";\nimport isLegacyRender from \"./is_legacy_smart_render\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\nimport isColumnVisible from \"./viewport/is_column_visible\";\nimport bgPlaceholder from \"./prerender/task_bg_placeholder\";\n\nfunction createTaskBgRender(gantt){\n\tvar renderedCells = {};\n\tvar visibleCells = {};\n\n\tfunction isRendered(item, columnIndex){\n\t\tif(renderedCells[item.id][columnIndex] && renderedCells[item.id][columnIndex].parentNode){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tfunction detachRenderedCell(itemId, columnIndex){\n\t\tif(renderedCells[itemId] && renderedCells[itemId][columnIndex] &&\n\t\t\trenderedCells[itemId][columnIndex].parentNode\n\t\t\t){\n\t\t\t\trenderedCells[itemId][columnIndex].parentNode.removeChild(renderedCells[itemId][columnIndex]);\n\t\t\t}\n\t}\n\n\tfunction getCellClassTemplate(view){\n\t\tvar templates = view.$getTemplates();\n\t\tvar cssTemplate;\n\t\tif (typeof templates.task_cell_class !== \"undefined\") {\n\t\t\tcssTemplate = templates.task_cell_class;\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tvar log = console.warn || console.log;\n\t\t\tlog('gantt.templates.task_cell_class template is deprecated and will be removed soon. Please use gantt.templates.timeline_cell_class instead.');\n\t\t} else {\n\t\t\tcssTemplate = templates.timeline_cell_class;\n\t\t}\n\t\treturn cssTemplate;\n\t}\n\tfunction getCellContentTemplate(view){\n\t\tvar templates = view.$getTemplates();\n\t\tvar contentTemplate = templates.timeline_cell_content;\n\t\treturn contentTemplate;\n\t}\n\n\tfunction renderCells(item, node, view, config, viewPort){\n\t\tvar cfg = view.getScale();\n\t\tvar count = cfg.count;\n\t\tvar cssTemplate = getCellClassTemplate(view);\n\t\tvar contentTemplate = getCellContentTemplate(view);\n\n\t\tif (config.show_task_cells) {\n\t\t\tif(!renderedCells[item.id]){\n\t\t\t\trenderedCells[item.id] = {};\n\t\t\t}\n\t\t\tif(!visibleCells[item.id]){\n\t\t\t\tvisibleCells[item.id] = {};\n\t\t\t}\n\n\t\t\tvar range = getVisibleCellsRange(cfg, viewPort);\n\n\t\t\tfor(var i in visibleCells[item.id]){\n\t\t\t\tvar index = visibleCells[item.id][i];\n\n\t\t\t\tif(Number(index) < range.start || Number(index) > range.end){\n\t\t\t\t\tdetachRenderedCell(item.id, index);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvisibleCells[item.id] = {};\n\t\t\t// TODO: do not iterate all cell, only ones in the viewport and once that are already rendered\n\t\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\t\tvar cell = renderOneCell(cfg, columnIndex, item, viewPort, count, cssTemplate, contentTemplate, config);\n\t\t\t\tif(!cell && isRendered(item, columnIndex)){\n\t\t\t\t\tdetachRenderedCell(item.id, columnIndex);\n\t\t\t\t}else if (cell && !cell.parentNode){\n\t\t\t\t\tnode.appendChild(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction renderOneCell(scale, columnIndex, item, viewPort, count, cssTemplate, contentTemplate, config){\n\t\tvar width = scale.width[columnIndex],\n\t\t\tcssclass = \"\";\n\n\t\tif (isColumnVisible(columnIndex, scale, viewPort, gantt)) {//do not render skipped columns\n\n\t\t\tvar cssTemplateContent = cssTemplate(item, scale.trace_x[columnIndex]);\n\t\t\tvar htmlTemplateContent = \"\";\n\t\t\tif (contentTemplate) {// for backward compatibility, contentTemplate was added in 7.2.0+, will be undefined if someone used copy of old config/template object\n\t\t\t\thtmlTemplateContent = contentTemplate(item, scale.trace_x[columnIndex]);\n\t\t\t}\n\n\t\t\tif(config.static_background){\n\t\t\t\t// if cell render in static background is not allowed, or if it's a blank cell\n\t\t\t\tvar customCell = !!(cssTemplateContent || htmlTemplateContent);\n\t\t\t\tif(!(config.static_background_cells && customCell)){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(renderedCells[item.id][columnIndex]){\n\t\t\t\tvisibleCells[item.id][columnIndex] = columnIndex;\n\t\t\t\treturn renderedCells[item.id][columnIndex];\n\t\t\t}\n\t\t\tvar cell = document.createElement(\"div\");\n\t\t\tcell.style.width = (width) + \"px\";\n\n\t\t\tcssclass = \"gantt_task_cell\" + (columnIndex == count - 1 ? \" gantt_last_cell\" : \"\");\n\t\t\tif (cssTemplateContent) {\n\t\t\t\tcssclass += \" \" + cssTemplateContent;\n\t\t\t}\n\t\t\tcell.className = cssclass;\n\n\t\t\tif (htmlTemplateContent) {\n\t\t\t\tcell.innerHTML = htmlTemplateContent;\n\t\t\t}\n\n\t\t\tcell.style.position = \"absolute\";\n\t\t\tcell.style.left = scale.left[columnIndex] + \"px\";\n\t\t\trenderedCells[item.id][columnIndex] = cell;\n\t\t\tvisibleCells[item.id][columnIndex] = columnIndex;\n\n\t\t\treturn cell;\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction _render_bg_line(item, view, config, viewPort) {\n\t\tvar templates = view.$getTemplates();\n\t\tvar cfg = view.getScale();\n\t\tvar count = cfg.count;\n\n\t\tif(config.static_background && !config.static_background_cells){\n\t\t\treturn null;\n\t\t}\n\n\t\tvar row = document.createElement(\"div\");\n\n\t\tvar cellCssTemplate = getCellClassTemplate(view);\n\t\tvar cellHtmlTemplate = getCellContentTemplate(view);\n\n\t\tvar range;\n\n\t\tif(!viewPort || !config.smart_rendering || isLegacyRender(gantt)){\n\t\t\trange = {\n\t\t\t\tstart: 0,\n\t\t\t\tend: count - 1\n\t\t\t};\n\t\t} else {\n\t\t\trange = getVisibleCellsRange(cfg, viewPort.x);\n\t\t}\n\t\tif (config.show_task_cells) {\n\t\t\trenderedCells[item.id] = {};\n\t\t\tvisibleCells[item.id] = {};\n\t\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\t\tvar cell = renderOneCell(cfg, columnIndex, item, viewPort, count, cellCssTemplate, cellHtmlTemplate, config);\n\t\t\t\tif(cell){\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// GS-291. The odd class should be assigned correctly\n\t\tconst store = view.$config.rowStore;\n\t\tconst odd = store.getIndexById(item.id) % 2 !== 0;\n\n\t\tvar cssTemplate = templates.task_row_class(item.start_date, item.end_date, item);\n\t\tvar css = \"gantt_task_row\" + (odd ? \" odd\" : \"\") + (cssTemplate ? ' ' + cssTemplate : '');\n\n\t\tif(store.isSelected(item.id)) {\n\t\t\tcss += \" gantt_selected\";\n\t\t}\n\n\t\trow.className = css;\n\n\t\tif (config.smart_rendering) {\n\t\t\trow.style.position = \"absolute\";\n\t\t\trow.style.top = view.getItemTop(item.id) + \"px\";\n\t\t\trow.style.width = \"100%\";\n\t\t}else{\n\t\t\trow.style.position = \"relative\";\n\t\t}\n\t\trow.style.height = (view.getItemHeight(item.id)) + \"px\";\n\n\t\tif (item.id == \"timeline_placeholder_task\"){\n\t\t\tvar placeholderTop = 0;\n\t\t\tif (item.lastTaskId){\n\t\t\t\tvar lastTaskTop = view.getItemTop(item.lastTaskId);\n\t\t\t\tvar lastTaskHeight = view.getItemHeight(item.lastTaskId);\n\t\t\t\tplaceholderTop = lastTaskTop + lastTaskHeight;\t\n\t\t\t}\n\n\t\t\tvar maxHeight = item.row_height || view.$task_data.offsetHeight;\n\n\t\t\tvar placeholderHeight = maxHeight - placeholderTop;\n\t\t\t// So that it won't exceed the placeholder timeline height\n\t\t\tif (placeholderHeight < 0){\n\t\t\t\tplaceholderHeight = 0;\n\t\t\t}\n\n\t\t\tif (config.smart_rendering) {\n\t\t\t\trow.style.top = placeholderTop + \"px\";\t\n\t\t\t}\n\t\t\trow.style.height = placeholderHeight + \"px\";\n\t\t}\n\n\n\t\tif(view.$config.item_attribute){\n\t\t\trow.setAttribute(view.$config.item_attribute, item.id);\n\t\t\trow.setAttribute(view.$config.bind + \"_id\", item.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\treturn row;\n\t}\n\n\treturn {\n\t\trender: _render_bg_line,\n\t\tupdate: renderCells,\n\t\tgetRectangle: getRowRectangle,\n\t\tgetVisibleRange: getVisibleRange,\n\t\tprepareData: bgPlaceholder\n\t};\n}\n\nexport default createTaskBgRender;\n","import isInViewPort from \"./viewport/is_bar_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport createBaseBarRender from \"./task_bar_render\";\n\nexport default function createTaskRenderer(gantt){\n\tvar defaultRender = createBaseBarRender(gantt);\n\treturn {\n\t\trender: defaultRender,\n\t\tupdate: null,\n\t\t//getRectangle: getBarRectangle\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n};","import isInViewPort from \"./viewport/is_project_bar_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport createBaseBarRender from \"./task_project_render\";\n\nexport default function createTaskRenderer(gantt){\n\tvar defaultRender = createBaseBarRender(gantt);\n\treturn {\n\t\trender: defaultRender,\n\t\tupdate: null,\n\t\t//getRectangle: getBarRectangle\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n};","import createBaseBarRender from \"./task_bar_render\";\nimport isInViewPort from \"./viewport/is_bar_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\n\nfunction createTaskRenderer(gantt){\n\tconst defaultRender = createBaseBarRender(gantt);\n\n\tconst renderedNodes = {};\n\n\tfunction checkVisibility(child, viewPort, timeline, config, gantt){\n\t\tlet isVisible = true;\n\t\t// GS-2123. Don't render rollup tasks that are outside the viewport\n\t\tif (config.smart_rendering){\n\t\t\tisVisible = isInViewPort(child, viewPort, timeline, config, gantt);\n\t\t}\n\t\treturn isVisible;\n\t}\n\n\tfunction generateChildElement(task, child, timeline, sizes){\n\t\tconst childCopy = gantt.copy(gantt.getTask(child.id));\n\t\tchildCopy.$rendered_at = task.id;\n\t\t// a way to filter rollup tasks:\n\t\tconst displayRollup = gantt.callEvent(\"onBeforeRollupTaskDisplay\", [childCopy.id, childCopy, task.id]);\n\t\tif (displayRollup === false){\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = defaultRender(childCopy, timeline);\n\t\tif(!element){\n\t\t\treturn;\n\t\t}\n\n\t\tconst height = timeline.getBarHeight(task.id, child.type == gantt.config.types.milestone);\n\t\tconst padding = Math.floor((timeline.getItemHeight(task.id) - height) / 2);\n\n\t\telement.style.top = (sizes.top + padding) + \"px\";\n\t\telement.classList.add(\"gantt_rollup_child\");\n\t\telement.setAttribute(\"data-rollup-parent-id\", task.id);\n\n\t\treturn element;\n\t}\n\n\tfunction getKey(childId, renderParentId){\n\t\treturn childId + \"_\" + renderParentId;\n\t}\n\n\n\tfunction renderRollupTask(task, timeline, config, viewPort) {\n\t\tif (task.rollup !== false && task.$rollup && task.$rollup.length) {\n\t\t\tconst el = document.createElement('div'),\n\t\t\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t\t// vertical position is not important for the rollup tasks as long as the parent is rendered\n\t\t\tif (viewPort){\n\t\t\t\tviewPort.y = 0;\n\t\t\t\tviewPort.y_end = gantt.$task_bg.scrollHeight;\n\t\t\t}\n\n\t\t\ttask.$rollup.forEach(function(itemId){\n\t\t\t\tif (!gantt.isTaskExists(itemId)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst child = gantt.getTask(itemId);\n\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\tif (!isVisible){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes);\n\t\t\t\tif (element) {\n\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = element;\n\t\t\t\t\tel.appendChild(element);\n\t\t\t\t} else{\n\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = false;\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\treturn el;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction repaintRollupTask(task, itemNode, timeline, config, viewPort) {\n\t\tconst el = document.createElement(\"div\"),\n\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t// vertical position is not important for the rollup tasks as long as the parent is rendered\n\t\tviewPort.y = 0;\n\t\tviewPort.y_end = gantt.$task_bg.scrollHeight;\n\n\t\ttask.$rollup.forEach(function(itemId){\n\t\t\tconst child = gantt.getTask(itemId);\n\t\t\tconst rollupKey = getKey(child.id, task.id);\n\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\tif (isVisible !== !!renderedNodes[rollupKey]) {\n\n\t\t\t\tif (isVisible) {\n\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes);\n\t\t\t\t\trenderedNodes[rollupKey] = element || false;\n\t\t\t\t} else {\n\t\t\t\t\trenderedNodes[rollupKey] = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!!renderedNodes[rollupKey]) {\n\t\t\t\tel.appendChild(renderedNodes[rollupKey]);\n\t\t\t}\n\t\t\titemNode.innerHTML = \"\";\n\t\t\titemNode.appendChild(el);\n\t\t});\n\t}\n\n\n\n\treturn {\n\t\trender: renderRollupTask,\n\t\tupdate: repaintRollupTask,\n\t\t//getRectangle: getBarRectangle\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default createTaskRenderer;","\nimport createBaseBarRender from \"./task_bar_render\";\n//import isInViewPort from \"./viewport/is_split_task_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\n\nimport isInViewPortParent from \"./viewport/is_split_task_in_viewport\";\nimport isInViewPortChild from \"./viewport/is_bar_in_viewport\";\nimport { childrenHaveBaselines, getMilestoneHeight, getInvertedMilestoneHeight } from \"./baseline_helper\";\n\n\n\nfunction createTaskRenderer(gantt){\n\tconst defaultRender = createBaseBarRender(gantt);\n\n\tconst renderedNodes = {};\n\n\tfunction checkVisibility(child, viewPort, timeline, config, gantt){\n\t\tlet isVisible = !child.hide_bar;\n\t\t// GS-1195. Don't render split tasks that are outside the viewport\n\t\tif (config.smart_rendering && isVisible){\n\t\t\tisVisible = isInViewPortChild(child, viewPort, timeline, config, gantt);\n\t\t}\n\t\treturn isVisible;\n\t}\n\n\tfunction generateChildElement(task, child, timeline, sizes, childBaselines){\n\t\tif(child.hide_bar){\n\t\t\treturn;\n\t\t}\n\n\t\tconst isProject = gantt.isSummaryTask(child);\n\t\tif(isProject){\n\t\t\tgantt.resetProjectDates(child);\n\t\t}\n\n\t\tconst childCopy = gantt.copy(gantt.getTask(child.id));\n\t\tchildCopy.$rendered_at = task.id;\n\t\t// a way to filter split tasks:\n\t\tconst showSplitTask = gantt.callEvent(\"onBeforeSplitTaskDisplay\", [childCopy.id, childCopy, task.id]);\n\t\tif (showSplitTask === false){\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = defaultRender(childCopy, timeline);\n\t\tif(!element)\n\t\t\treturn;\n\n\t\tconst milestoneChild = child.type === gantt.config.types.milestone;\n\t\tlet milestoneWidth;\n\n\t\tconst parentHeight = sizes.rowHeight;\n\t\tconst childHeight = timeline.getBarHeight(childCopy.id, milestoneChild);\n\t\tlet padding = Math.floor((timeline.getItemHeight(task.id) - childHeight) / 2);\n\n\t\tif (milestoneChild){\n\t\t\tmilestoneWidth = getMilestoneHeight(childHeight);\n\t\t}\n\n\t\tif (childBaselines/*|| (child.bar_height !== \"full\" && child.bar_height < child.row_height)*/){\n\t\t\tif (milestoneChild){\n\t\t\t\tpadding = Math.floor((milestoneWidth - childHeight) / 2) + 2;\n\t\t\t} else {\n\t\t\t\tpadding = 2;\n\t\t\t}\t\n\t\t}\n\t\t// GS-2270: Split children shouldn't exceed the parent row height\n\t\tconst linkDragLeft = element.querySelector(\".gantt_link_control.task_start_date\");\n\t\tconst linkDragRight = element.querySelector(\".gantt_link_control.task_end_date\");\n\t\tif (milestoneChild){\n\t\t\tif (milestoneWidth > parentHeight){\n\t\t\t\tpadding = 2;\n\t\t\t\telement.style.height = parentHeight - padding + \"px\";\n\t\t\t\tconst offsetHeight = getInvertedMilestoneHeight(parentHeight);\n\t\t\t\tconst offsetMargin = (offsetHeight - parentHeight) / 2;\n\t\t\t\tconst taskContent = element.querySelector(\".gantt_task_content\");\n\t\t\t\tpadding = Math.abs(offsetMargin);\n\n\t\t\t\tlinkDragLeft.style.marginLeft = offsetMargin + \"px\";\n\t\t\t\tlinkDragRight.style.marginRight = offsetMargin + \"px\";\n\t\t\t\tlinkDragLeft.style.height = linkDragRight.style.height = offsetHeight + \"px\";\n\n\t\t\t\telement.style.width = \n\t\t\t\ttaskContent.style.height = \n\t\t\t\ttaskContent.style.width = offsetHeight + \"px\";\n\t\t\t\telement.style.left = timeline.getItemPosition(childCopy).left - offsetHeight / 2 + \"px\";\n\t\t\t}\n\t\t} else if (childHeight + padding > parentHeight){\n\t\t\tpadding = 0;\n\t\t\telement.style.height = \n\t\t\telement.style.lineHeight = \n\t\t\tlinkDragLeft.style.height = \n\t\t\tlinkDragRight.style.height = parentHeight + \"px\";\n\t\t}\n\n\t\telement.style.top = (sizes.top + padding) + \"px\";\n\t\telement.classList.add(\"gantt_split_child\");\n\t\tif(isProject){\n\t\t\telement.classList.add(\"gantt_split_subproject\");\n\t\t}\n\n\t\treturn element;\n\t}\n\n\tfunction getKey(childId, renderParentId){\n\t\treturn childId + \"_\" + renderParentId;\n\t}\n\n\tfunction shouldUseSplitRendering(task, config){\n\t\treturn (gantt.isSplitTask(task) && ((config.open_split_tasks && !task.$open) || !config.open_split_tasks) && gantt.hasChild(task.id));\n\t}\n\n\tfunction renderSplitTask(task, timeline, config, viewPort) {\n\t\tif (shouldUseSplitRendering(task, config)) {\n\t\t\tconst el = document.createElement('div'),\n\t\t\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t\tconst childBaselines = childrenHaveBaselines(gantt, task.id);\n\n\t\t\tif(gantt.hasChild(task.id)){\n\n\t\t\t\tgantt.eachTask(function(child){\n\t\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\t\tif (!isVisible){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes, childBaselines);\n\t\t\t\t\tif (element) {\n\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = element;\n\t\t\t\t\t\tel.appendChild(element);\n\t\t\t\t\t}else{\n\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = false;\n\t\t\t\t\t}\n\n\t\t\t\t}, task.id);\n\t\t\t}\n\t\t\treturn el;\n\t\t}\n\t\treturn false;\n\t}\n\tfunction repaintSplitTask(task, itemNode, timeline, config, viewPort) {\n\t\tif (shouldUseSplitRendering(task, config)) {\n\t\t\tconst el = document.createElement(\"div\"),\n\t\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t\tconst childBaselines = childrenHaveBaselines(gantt, task.id);\n\t\t\tgantt.eachTask(function (child) {\n\t\t\t\tconst splitKey = getKey(child.id, task.id);\n\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\tif (isVisible !== !!renderedNodes[splitKey]) {\n\n\t\t\t\t\tif (isVisible) {\n\t\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes, childBaselines);\n\t\t\t\t\t\trenderedNodes[splitKey] = element || false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\trenderedNodes[splitKey] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!!renderedNodes[splitKey]) {\n\t\t\t\t\tel.appendChild(renderedNodes[splitKey]);\n\t\t\t\t}\n\t\t\t\titemNode.innerHTML = \"\";\n\t\t\t\titemNode.appendChild(el);\n\t\t\t}, task.id);\n\t\t}\n\t}\n\treturn {\n\t\trender: renderSplitTask,\n\t\tupdate: repaintSplitTask,\n\t\tisInViewPort: isInViewPortParent,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default createTaskRenderer;","import getRectangle from \"./viewport/get_bg_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\nimport isColumnVisible from \"./viewport/is_column_visible\";\nimport resourceTimetable from \"../../resource_timetable_builder\";\n\nfunction generateRenderResourceLine(gantt){\n\tvar getResourceLoad = resourceTimetable(gantt);\n\tvar renderedResourceLines = {};\n\n\tfunction renderResourceLineCell(resource, day, templates, config, timeline){\n\t\tvar css = templates.resource_cell_class(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar content = templates.resource_cell_value(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar height = timeline.getItemHeight(resource.id) - 1;\n\n\t\tif (css || content){\n\t\t\tvar sizes = timeline.getItemPosition(resource, day.start_date, day.end_date);\n\t\t\tvar el = document.createElement('div');\n\t\t\tel.setAttribute(timeline.$config.item_attribute, resource.id);\n\t\t\tel.className = [\"gantt_resource_marker\", css].join(\" \");\n\n\t\t\tel.style.cssText = [\n\t\t\t\t'left:' + sizes.left + 'px',\n\t\t\t\t'width:' + sizes.width + 'px',\n\t\t\t\t'height:' + (height) + 'px',\n\t\t\t\t'line-height:' + (height) + 'px',\n\t\t\t\t'top:' + sizes.top + 'px'\n\t\t\t].join(\";\");\n\n\t\t\tif(content)\n\t\t\t\tel.innerHTML = content;\n\n\t\t\treturn el;\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction detachRenderedResourceLine(id, index){\n\t\tif(renderedResourceLines[id] && renderedResourceLines[id][index] &&\n\t\t\trenderedResourceLines[id][index].parentNode\n\t\t\t){\n\t\t\t\trenderedResourceLines[id][index].parentNode.removeChild(renderedResourceLines[id][index]);\n\t\t\t}\n\t}\n\n\tfunction renderResourceLine(resource, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, timeline.getScale(), timeline);\n\t\tvar smartRendering = !!viewport;//no viewport means smart rendering is disabled\n\t\tvar cells = [];\n\t\trenderedResourceLines[resource.id] = {};\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(smartRendering && !isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar cell = renderResourceLineCell(resource, day, templates, config, timeline);\n\t\t\tif(cell){\n\t\t\t\tcells.push(cell);\n\t\t\t\trenderedResourceLines[resource.id][columnIndex] = cell;\n\t\t\t}\n\t\t}\n\n\t\tvar row = null;\n\t\tif(cells.length){\n\t\t\trow = document.createElement(\"div\");\n\t\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\t\trow.appendChild(cells[i]);\n\t\t\t}\n\t\t}\n\t\treturn row;\n\t}\n\n\tfunction updateResourceLine(resource, node, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, timeline.getScale(), timeline);\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\n\t\tvar checkedColumns = {};\n\t\tif(renderedResourceLines && renderedResourceLines[resource.id]){\n\t\t\tfor(var i in renderedResourceLines[resource.id]){\n\t\t\t\tcheckedColumns[i] = i;\n\t\t\t}\n\t\t}\n\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tcheckedColumns[columnIndex] = false;\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(!isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tdetachRenderedResourceLine(resource.id, columnIndex);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(!renderedResourceLines[resource.id] || !renderedResourceLines[resource.id][columnIndex]){\n\t\t\t\tvar cell = renderResourceLineCell(resource, day, templates, config, timeline);\n\t\t\t\tif(cell){\n\t\t\t\t\tnode.appendChild(cell);\n\t\t\t\t\trenderedResourceLines[resource.id][columnIndex] = cell;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(renderedResourceLines[resource.id] && renderedResourceLines[resource.id][columnIndex] && !renderedResourceLines[resource.id][columnIndex].parentNode){\n\t\t\t\tnode.appendChild(renderedResourceLines[resource.id][columnIndex]);\n\t\t\t}\n\t\t}\n\n\t\tfor(var i in checkedColumns){\n\t\t\tif(checkedColumns[i] !== false){\n\t\t\t\tdetachRenderedResourceLine(resource.id, i);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\trender: renderResourceLine,\n\t\tupdate: updateResourceLine,\n\t\tgetRectangle: getRectangle,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default generateRenderResourceLine;","import getRowRectangle from \"./viewport/get_grid_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\n\nfunction createGridTaskRowResizerRender(gantt){\n\n\tfunction _render_grid_item(item, view, viewport) {\n\n\t\tvar config = view.$getConfig();\n\t\tvar resize_el = document.createElement(\"div\");\n\t\tresize_el.className = \"gantt_task_grid_row_resize_wrap\";\n\n\t\tresize_el.style.top = (view.getItemTop(item.id) + view.getItemHeight(item.id)) + \"px\";\n\n\t\tresize_el.innerHTML = \"<div class='gantt_task_grid_row_resize' role='cell'></div>\";\n\t\tresize_el.setAttribute(config.task_grid_row_resizer_attribute, item.id);\n\n\t\tgantt._waiAria.rowResizerAttr(resize_el);\n\t\treturn resize_el;\n\t}\n\n\treturn {\n\t\trender: _render_grid_item,\n\t\tupdate: null,\n\t\tgetRectangle: getRowRectangle,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default createGridTaskRowResizerRender;","function _configure(col, data, force) {\n\tfor (var key in data)\n\t\tif (typeof col[key] == \"undefined\" || force)\n\t\t\tcol[key] = data[key];\n}\n\nfunction _get_skin(force, gantt) {\n\n\tconst styles = getComputedStyle(gantt.$root);\n\tconst themeVar = styles.getPropertyValue(\"--dhx-gantt-theme\");\n\tlet isCssVarTheme = !!themeVar;\n\tlet themeName;\n\n\t\n\tif(isCssVarTheme){\n\t\tthemeName = themeVar;\n\t}else{\n\t\tvar skin = gantt.skin;\n\t\tthemeName = skin;\n\t\tif (!skin || force) {\n\t\t\tvar links = document.getElementsByTagName(\"link\");\n\t\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\t\tvar res = links[i].href.match(\"dhtmlxgantt_([a-z_]+).css\");\n\t\t\t\tif (res) {\n\t\t\t\t\tif (gantt.skins[res[1]] || !skin) {\n\t\t\t\t\t\tthemeName = res[1];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tgantt._theme_info = {\n\t\ttheme: themeName,\n\t\tcssVarTheme: isCssVarTheme\n\t};\n\n\n\n\tgantt.skin = themeName || \"terrace\";\n\tvar skinset = gantt.skins[gantt.skin] || gantt.skins[\"terrace\"];\n\n\t//apply skin related settings\n\t_configure(gantt.config, skinset.config, force);\n\n\tif(!isCssVarTheme){\n\t\tgantt.config.link_radius = 1;\n\t}\n\n\tvar config = gantt.getGridColumns();\n\tif (config[1] && !gantt.defined(config[1].width))\n\t\tconfig[1].width = skinset._second_column_width;\n\tif (config[2] && !gantt.defined(config[2].width))\n\t\tconfig[2].width = skinset._third_column_width;\n\t\n\tfor (var i=0; i<config.length; i++) {\n\t\tvar column = config[i];\n\t\tif (column.name == \"add\") {\n\t\t\tif(!column.width){\n\t\t\t\tcolumn.width = 44;\n\t\t\t}\n\t\t\tif (!(gantt.defined(column.min_width) && gantt.defined(column.max_width))) {\n\t\t\t\tcolumn.min_width = column.min_width || column.width;\n\t\t\t\tcolumn.max_width = column.max_width || column.width;\n\t\t\t}\n\t\t\tif (column.min_width)\n\t\t\t\tcolumn.min_width = +column.min_width;\n\t\t\tif (column.max_width)\n\t\t\t\tcolumn.max_width = +column.max_width;\n\t\t\tif (column.width) {\n\t\t\t\tcolumn.width = +column.width;\n\t\t\t\tcolumn.width = (column.min_width && column.min_width > column.width) ? column.min_width : column.width;\n\t\t\t\tcolumn.width = (column.max_width && column.max_width < column.width) ? column.max_width : column.width;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (skinset.config.task_height){\n\t\tgantt.config.task_height = skinset.config.task_height || \"full\";\n\t}\n\tif (skinset.config.bar_height){\n\t\tgantt.config.bar_height = skinset.config.bar_height || \"full\";\n\t}\n\n\tif (skinset._lightbox_template)\n\t\tgantt._lightbox_template = skinset._lightbox_template;\n\n\tif (skinset._redefine_lightbox_buttons) {\n\t\tgantt.config.buttons_right = skinset._redefine_lightbox_buttons[\"buttons_right\"];\n\t\tgantt.config.buttons_left = skinset._redefine_lightbox_buttons[\"buttons_left\"];\n\t}\n\n\n\tgantt.resetLightbox();\n}\n\n\n\nexport default function(gantt) {\n\t\n\tif(!gantt.resetSkin){\n\t\tgantt.resetSkin = function () {\n\t\t\tthis.skin = \"\";\n\t\t\t_get_skin(true, this);\n\t\t};\n\t\tgantt.skins = {};\n\n\t\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\t\t_get_skin(false, this);\n\t\t\tmonitorThemeChange();\n\t\t});\n\t}\n\n\tgantt._addThemeClass = function(){\n\t\tdocument.documentElement.setAttribute(\"data-gantt-theme\", gantt.skin);\n\t};\n\n\tgantt.setSkin = function(value){\n\t\tthis.skin = value;\n\t\tgantt._addThemeClass();\n\t\tmonitorThemeChange();\n\t\tif(gantt.$root){\n\t\t\t_get_skin(true, gantt);\n\t\t\tthis.render();\n\t\t}\n\t\t\n\t\t//\n\t};\n\n\n\tlet monitorIntervalId = null;\n\tfunction monitorThemeChange(){\n\t\tconst container = gantt.$root;\n\t\t\n\t\tif(monitorIntervalId){\n\t\t\tclearInterval(monitorIntervalId);\n\t\t}\n\t\t\n\t\tif(container){\n\t\t\tmonitorIntervalId = setInterval(() => {\n\t\t\t\tconst csstheme = getComputedStyle(container).getPropertyValue('--dhx-gantt-theme');\n\t\t\t\tif(csstheme && csstheme !== gantt.skin){\n\t\t\t\t\tgantt.setSkin(csstheme);\n\t\t\t\t}\n\n\t\t\t}, 100);\n\t\t}\n\t}\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\tclearInterval(monitorIntervalId);\n\t});\n};","import * as domHelpers from \"../utils/dom_helpers\";\nimport isHeadless from \"../../../utils/is_headless\";\n\nexport default function(gantt){\n\n\tvar scrollRange = 50,\n\t\tscrollStep = 30,\n\t\tscrollDelay = 10,\n\t\tscrollSpeed = 50;\n\n\tvar interval = null,\n\t\tisMove = false,\n\t\tdelayTimeout = null,\n\t\tstartPos = {\n\t\t\tstarted: false\n\t\t},\n\t\teventPos = {};\n\n\n\tfunction isDisplayed(element){\n\t\treturn element &&\n\t\t\tdomHelpers.isChildOf(element, gantt.$root) &&\n\t\t\telement.offsetHeight;\n\t}\n\n\tfunction getAutoscrollContainer(){\n\t\tvar element;\n\t\tif(isDisplayed(gantt.$task)){\n\t\t\telement = gantt.$task;\n\t\t}else if(isDisplayed(gantt.$grid)){\n\t\t\telement = gantt.$grid;\n\t\t}else{\n\t\t\telement = gantt.$root;\n\t\t}\n\n\t\treturn element;\n\t}\n\n\tfunction isScrollState() {\n\t\tvar dragMarker = !!document.querySelector(\".gantt_drag_marker\");\n\t\tvar isResize = !!document.querySelector(\".gantt_drag_marker.gantt_grid_resize_area\")\n\t\t\t|| !!document.querySelector(\".gantt_drag_marker.gantt_row_grid_resize_area\") ;\n\t\tvar isLink = !!document.querySelector(\".gantt_link_direction\");\n\t\tvar state = gantt.getState();\n\t\tvar isClickDrag = state.autoscroll;\n\t\tisMove = dragMarker && !isResize && !isLink;\n\n\t\treturn !((!state.drag_mode && !dragMarker) || isResize) || isClickDrag;\n\t}\n\n\tfunction defineDelayTimeout(state) {\n\t\tif (delayTimeout) {\n\t\t\tclearTimeout(delayTimeout);\n\t\t\tdelayTimeout = null;\n\t\t}\n\t\tif (state) {\n\t\t\tvar speed = gantt.config.autoscroll_speed;\n\t\t\tif (speed && speed < 10) // limit speed value to 10\n\t\t\t\tspeed = 10;\n\n\t\t\tdelayTimeout = setTimeout(function() {\n\t\t\t\tinterval = setInterval(tick, speed || scrollSpeed);\n\t\t\t}, gantt.config.autoscroll_delay || scrollDelay);\n\t\t}\n\t}\n\n\tfunction defineScrollInterval(state) {\n\t\tif (state) {\n\t\t\tdefineDelayTimeout(true);\n\t\t\tif (!startPos.started) {\n\t\t\t\tstartPos.x = eventPos.x;\n\t\t\t\tstartPos.y = eventPos.y;\n\t\t\t\tstartPos.started = true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (interval) {\n\t\t\t\tclearInterval(interval);\n\t\t\t\tinterval = null;\n\t\t\t}\n\t\t\tdefineDelayTimeout(false);\n\t\t\tstartPos.started = false;\n\t\t}\n\t}\n\n\tfunction autoscrollInterval(event) {\n\t\tvar isScroll = isScrollState();\n\n\t\tif ((interval || delayTimeout) && !isScroll) {\n\t\t\tdefineScrollInterval(false);\n\t\t}\n\n\t\tif (!gantt.config.autoscroll || !isScroll) {\n\t\t\treturn false;\n\t\t}\n\n\t\teventPos = {\n\t\t\tx: event.clientX,\n\t\t\ty: event.clientY\n\t\t};\n\n\t\t// if it is a mobile device, we need to detect the touch event coords\n\t\tif (event.type == \"touchmove\"){\n\t\t\teventPos.x = event.targetTouches[0].clientX;\n\t\t\teventPos.y = event.targetTouches[0].clientY;\n\t\t}\n\n\t\tif (!interval && isScroll) {\n\t\t\tdefineScrollInterval(true);\n\t\t}\n\t}\n\n\tfunction tick() {\n\n\t\tif (!isScrollState()) {\n\t\t\tdefineScrollInterval(false);\n\t\t\treturn false;\n\t\t}\n\n\t\tvar container = getAutoscrollContainer();\n\t\tif(!container){\n\t\t\treturn;\n\t\t}\n\t\t// GS-1150: if we reorder or resize something in the grid, we should obtain the grid container\n\t\tvar gridDrag = false;\n\t\tvar gridMarkers = [\n\t\t\t\".gantt_drag_marker.gantt_grid_resize_area\",\n\t\t\t\".gantt_drag_marker .gantt_row.gantt_row_task\",\n\t\t\t\".gantt_drag_marker.gantt_grid_dnd_marker\"\n\t\t];\n\t\tgridMarkers.forEach(function (selector) {\n\t\t\tgridDrag = gridDrag || !!document.querySelector(selector);\n\t\t});\n\t\tif (gridDrag){\n\t\t\tcontainer = gantt.$grid;\n\t\t}\n\n\t\tvar box = domHelpers.getNodePosition(container);\n\n\t\tvar posX = eventPos.x - box.x;\n\t\tvar posY = eventPos.y - box.y + window.scrollY; // GS-1315: window.scrollY here and below for the elements above Gantt\n\n\t\tvar scrollLeft = isMove ? 0 : need_scroll(posX, box.width, startPos.x - box.x);\n\t\tvar scrollTop = need_scroll(posY, box.height, startPos.y - box.y + window.scrollY);\n\n\t\tvar scrollState = gantt.getScrollState();\n\n\t\tvar currentScrollTop = scrollState.y,\n\t\t\tscrollOuterHeight = scrollState.inner_height,\n\t\t\tscrollInnerHeight = scrollState.height,\n\t\t\tcurrentScrollLeft = scrollState.x,\n\t\t\tscrollOuterWidth = scrollState.inner_width,\n\t\t\tscrollInnerWidth = scrollState.width;\n\n\t\t// do scrolling only if we have scrollable area to do so\n\t\tif (scrollTop && !scrollOuterHeight) {\n\t\t\tscrollTop = 0;\n\t\t} else if (scrollTop < 0 && !currentScrollTop) {\n\t\t\tscrollTop = 0;\n\t\t} else if (scrollTop > 0 && currentScrollTop + scrollOuterHeight >= scrollInnerHeight + 2) {\n\t\t\tscrollTop = 0;\n\t\t}\n\n\t\tif (scrollLeft && !scrollOuterWidth) {\n\t\t\tscrollLeft = 0;\n\t\t} else if (scrollLeft < 0 && !currentScrollLeft) {\n\t\t\tscrollLeft = 0;\n\t\t} else if (scrollLeft > 0 && currentScrollLeft + scrollOuterWidth >= scrollInnerWidth) {\n\t\t\tscrollLeft = 0;\n\t\t}\n\n\t\tvar step = gantt.config.autoscroll_step;\n\n\t\tif (step && step < 2) // limit step value to 2\n\t\t\tstep = 2;\n\n\t\tscrollLeft = scrollLeft * (step || scrollStep);\n\t\tscrollTop = scrollTop * (step || scrollStep);\n\n\t\tif (scrollLeft || scrollTop) {\n\t\t\tscroll(scrollLeft, scrollTop);\n\t\t}\n\t}\n\n\tfunction need_scroll(pos, boxSize, startCoord) {\n\t\tif ((pos - scrollRange < 0) && (pos < startCoord))\n\t\t\treturn -1;\n\t\telse if ((pos > boxSize - scrollRange) && (pos > startCoord))\n\t\t\treturn 1;\n\t\treturn 0;\n\t}\n\n\tfunction scroll(left, top) {\n\t\tvar scrollState = gantt.getScrollState();\n\n\t\tvar scrollLeft = null,\n\t\t\tscrollTop = null;\n\n\t\tif (left) {\n\t\t\tscrollLeft = scrollState.x + left;\n\t\t\tscrollLeft = Math.min(scrollState.width, scrollLeft);\n\t\t\tscrollLeft = Math.max(0, scrollLeft);\n\t\t}\n\n\t\tif (top) {\n\t\t\tscrollTop = scrollState.y + top;\n\t\t\tscrollTop = Math.min(scrollState.height, scrollTop);\n\t\t\tscrollTop = Math.max(0, scrollTop);\n\t\t}\n\n\t\tgantt.scrollTo(scrollLeft, scrollTop);\n\t}\n\n\tgantt.attachEvent(\"onGanttReady\", function() {\n\t\tif(!isHeadless(gantt)){\n\t\t\tvar eventElement = domHelpers.getRootNode(gantt.$root) || document.body;\n\t\t\tgantt.eventRemove(eventElement, \"mousemove\", autoscrollInterval);\n\t\t\tgantt.event(eventElement, \"mousemove\", autoscrollInterval);\n\n\t\t\tgantt.eventRemove(eventElement, \"touchmove\", autoscrollInterval);\n\t\t\tgantt.event(eventElement, \"touchmove\", autoscrollInterval);\n\n\t\t\tgantt.eventRemove(eventElement, \"pointermove\", autoscrollInterval);\n\t\t\tgantt.event(eventElement, \"pointermove\", autoscrollInterval);\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\tdefineScrollInterval(false);\n\t});\n\n};","if (window.jQuery){\n\n\t(function( $ ){\n\n\t\tvar methods = [];\n\t\t$.fn.dhx_gantt = function(config){\n\t\t\tconfig = config || {};\n\t\t\tif (typeof(config) === 'string') {\n\t\t\t\tif (methods[config] ) {\n\t\t\t\t\treturn methods[config].apply(this, []);\n\t\t\t\t}else {\n\t\t\t\t\t$.error('Method ' +  config + ' does not exist on jQuery.dhx_gantt');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar views = [];\n\t\t\t\tthis.each(function() {\n\t\t\t\t\tif (this && this.getAttribute){\n\t\t\t\t\t\tif (!this.gantt && !(window.gantt.$root == this)){\n\n\t\t\t\t\t\t\tvar newgantt = (window.gantt.$container && window.Gantt) ? window.Gantt.getGanttInstance():window.gantt;\n\t\t\t\t\t\t\tfor (var key in config)\n\t\t\t\t\t\t\t\tif (key!=\"data\")\n\t\t\t\t\t\t\t\t\tnewgantt.config[key] = config[key];\n\n\t\t\t\t\t\t\tnewgantt.init(this);\n\t\t\t\t\t\t\tif (config.data)\n\t\t\t\t\t\t\t\tnewgantt.parse(config.data);\n\n\t\t\t\t\t\t\tviews.push(newgantt);\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\tviews.push(typeof this.gantt == \"object\" ? this.gantt : window.gantt);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\n\t\t\t\tif (views.length === 1) return views[0];\n\t\t\t\treturn views;\n\t\t\t}\n\t\t};\n\n\t})(window.jQuery);\n\n}\n\n\nexport default null;","if (window.dhtmlx){\n\n\tif (!window.dhtmlx.attaches)\n\twindow.dhtmlx.attaches = {};\n\n\twindow.dhtmlx.attaches.attachGantt=function(start, end, gantt){\n\t\tvar obj = document.createElement(\"DIV\");\n\n\t\tgantt = gantt || window.gantt;\n\n\t\tobj.id = \"gantt_\"+ gantt.uid();\n\t\tobj.style.width = \"100%\";\n\t\tobj.style.height = \"100%\";\n\t\tobj.cmp = \"grid\";\n\n\t\tdocument.body.appendChild(obj);\n\t\tthis.attachObject(obj.id);\n\t\tthis.dataType = \"gantt\";\n\t\tthis.dataObj = gantt;\n\n\t\tvar that = this.vs[this.av];\n\t\tthat.grid = gantt;\n\n\t\tgantt.init(obj.id, start, end);\n\t\tobj.firstChild.style.border = \"none\";\n\n\t\tthat.gridId = obj.id;\n\t\tthat.gridObj = obj;\n\n\t\tvar method_name=\"_viewRestore\";\n\t\treturn this.vs[this[method_name]()].grid;\n\t};\n\n}\nif (typeof(window.dhtmlXCellObject) != \"undefined\") {\n\n\twindow.dhtmlXCellObject.prototype.attachGantt=function(start, end, gantt){\n\t\tgantt = gantt || window.gantt;\n\n\t\tvar obj = document.createElement(\"DIV\");\n\t\tobj.id = \"gantt_\"+gantt.uid();\n\t\tobj.style.width = \"100%\";\n\t\tobj.style.height = \"100%\";\n\t\tobj.cmp = \"grid\";\n\n\t\tdocument.body.appendChild(obj);\n\t\tthis.attachObject(obj.id);\n\n\t\tthis.dataType = \"gantt\";\n\t\tthis.dataObj = gantt;\n\n\t\tgantt.init(obj.id, start, end);\n\t\tobj.firstChild.style.border = \"none\";\n\n\t\tobj = null;\n\t\tthis.callEvent(\"_onContentAttach\",[]);\n\n\t\treturn this.dataObj;\n\t};\n}\n\nexport default null;","import env from \"../../../utils/env\";\nimport eventable from \"../../../utils/eventable\";\nimport { IScale, TModifierKeys } from \"../../common/config\";\n\ninterface ITimelineZoomConfig {\n\thandler?: (e: Event) => {};\n\tstartDate?: Date;\n\tendDate?: Date;\n\tlevels: IZoomLevel[];\n\tactiveLevelIndex?: number;\n\twidthStep?: number;\n\tminColumnWidth?: number;\n\tmaxColumnWidth?: number;\n\tuseKey?: \"ctrlKey\" | \"altKey\" | \"shiftKey\";\n\ttrigger?: \"wheel\" | null | undefined;\n\telement?: Element | (() => Element);\n}\n\nconst USE_KEY = [\"ctrlKey\", \"altKey\", \"shiftKey\", \"metaKey\"];\n\ninterface IZoomLevel {\n\tname?: string;\n\tscale_height?: number;\n\tmin_column_width: number;\n\tscales: IScale[];\n}\n\nconst _defaultScales = [\n\t[\n\t\t{\n\t\t\tunit: \"month\",\n\t\t\tdate: \"%M\",\n\t\t\tstep: 1\n\t\t},\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d\",\n\t\t\tstep: 1\n\t\t}\n\t],\n\t[\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d %M\",\n\t\t\tstep: 1\n\t\t}\n\t],\n\t[\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d %M\",\n\t\t\tstep: 1\n\t\t},\n\t\t{\n\t\t\tunit: \"hour\",\n\t\t\tdate: \"%H:00\",\n\t\t\tstep: 8\n\t\t}\n\t],\n\t[\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d %M\",\n\t\t\tstep: 1\n\t\t},\n\t\t{\n\t\t\tunit: \"hour\",\n\t\t\tdate: \"%H:00\",\n\t\t\tstep: 1\n\t\t}\n\t]\n];\n\nexport default class TimelineZoom {\n\tpublic attachEvent: (eventName: string, handler: () => void) => string;\n\tpublic callEvent: (eventName: string, args: any[]) => any;\n\tpublic detachEvent: (eventName: string) => any;\n\tprotected _initialStartDate: Date;\n\tprotected _initialEndDate: Date;\n\tprotected _activeLevelIndex: number;\n\tprotected _levels: IZoomLevel[];\n\tprotected _handler: (e: any) => void;\n\tprotected $gantt;\n\tprotected _widthStep: number;\n\tprotected _minColumnWidth: number;\n\tprotected _maxColumnWidth: number;\n\tprotected _useKey: TModifierKeys;\n\tprotected _visibleDate: Date;\n\tprotected _initialized: boolean;\n\tprotected _domEvents: any;\n\n\tconstructor(gantt) {\n\t\tthis.$gantt = gantt;\n\t\tthis._domEvents = this.$gantt._createDomEventScope();\n\t}\n\n\tpublic init(config: ITimelineZoomConfig) {\n\t\t// GS-1354 and GS-1318. If we check the headless mode using the function,\n\t\t// it will return false when Gantt is not initialized, but we may want to do it later\n\t\tif(this.$gantt.env.isNode){\n\t\t\treturn;\n\t\t}\n\t\tthis._initialStartDate = config.startDate;\n\t\tthis._initialEndDate = config.endDate;\n\t\tthis._activeLevelIndex = config.activeLevelIndex ? config.activeLevelIndex : 0;\n\t\tthis._levels = this._mapScales(config.levels || _defaultScales);\n\t\tthis._handler = config.handler || this._defaultHandler;\n\t\tthis._minColumnWidth = config.minColumnWidth || 60;\n\t\tthis._maxColumnWidth = config.maxColumnWidth || 240;\n\t\tthis._widthStep = config.widthStep || 3/8 * config.minColumnWidth;\n\t\tthis._useKey = config.useKey;\n\n\t\tif(!this._initialized){\n\t\t\teventable(this);\n\t\t\tthis.$gantt.attachEvent(\"onGanttScroll\", () => {\n\t\t\t\tthis._getVisibleDate();\n\t\t\t});\n\t\t}\n\n\t\tthis._domEvents.detachAll();\n\n\t\tif(config.trigger === \"wheel\"){\n\t\t\tif(this.$gantt.$root){\n\t\t\t\tthis._attachWheelEvent(config);\n\t\t\t}else{\n\t\t\t\tthis.$gantt.attachEvent(\"onGanttReady\", () => {\n\t\t\t\t\tthis._attachWheelEvent(config);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis._initialized = true;\n\t\tthis.setLevel(this._activeLevelIndex);\n\t}\n\n\tpublic zoomIn = () => {\n\t\tconst index = this.getCurrentLevel() - 1;\n\t\tif(index < 0){\n\t\t\treturn;\n\t\t}\n\t\tthis.setLevel(index);\n\t};\n\n\tpublic zoomOut = () => {\n\t\tconst index = this.getCurrentLevel() + 1;\n\t\tif(index > this._levels.length - 1){\n\t\t\treturn;\n\t\t}\n\t\tthis.setLevel(index);\n\t};\n\n\tpublic getCurrentLevel = () => {\n\t\treturn this._activeLevelIndex;\n\t};\n\n\tpublic getLevels = () => {\n\t\treturn this._levels;\n\t};\n\n\tpublic setLevel = (level: number|string) => {\n\t\tconst zoomLevel = this._getZoomIndexByName(level);\n\n\t\tif(zoomLevel === -1){\n\t\t\tthis.$gantt.assert(zoomLevel !== -1, \"Invalid zoom level for gantt.ext.zoom.setLevel. \" + level + \" is not an expected value.\");\n\t\t}\n\t\tthis._setLevel(zoomLevel, 0);\n\t};\n\n\tprotected _getZoomIndexByName = (levelName: number|string) => {\n\t\tlet zoomLevel:number = -1;\n\t\tif(typeof levelName === \"string\"){\n\t\t\tif(!isNaN(Number(levelName)) &&  this._levels[Number(levelName)]){\n\t\t\t\tzoomLevel = Number(levelName);\n\t\t\t}else{\n\t\t\t\tfor(let i = 0; i < this._levels.length; i++){\n\t\t\t\t\tif(this._levels[i].name === levelName){\n\t\t\t\t\t\tzoomLevel = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}else{\n\t\t\tzoomLevel = levelName;\n\t\t}\n\t\treturn zoomLevel;\n\t};\n\n\tprotected _mapScales(levels: IScale[][] | any): IZoomLevel[]{\n\t\treturn levels.map((l) => {\n\t\t\tif(Array.isArray(l)){\n\t\t\t\treturn {\n\t\t\t\t\tscales: l\n\t\t\t\t};\n\t\t\t}else{\n\t\t\t\treturn l;\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected _getVisibleDate = () => {\n\t\t// GS-1450. Don't try to get the visible date if there is no timeline\n\t\tif (!this.$gantt.$task){\n\t\t\treturn null;\n\t\t}\n\t\tconst scrollPos = this.$gantt.getScrollState().x;\n\t\tconst viewPort = this.$gantt.$task.offsetWidth;\n\t\tthis._visibleDate = this.$gantt.dateFromPos(scrollPos + viewPort/2);\n\t};\n\n\tprotected _setLevel = (level: number, cursorOffset: number) => {\n\t\tthis._activeLevelIndex = level;\n\n\t\tconst gantt = this.$gantt;\n\t\tconst nextConfig = gantt.copy(this._levels[this._activeLevelIndex]);\n\t\tconst chartConfig = gantt.copy(nextConfig);\n\t\tdelete chartConfig.name;\n\n\t\tgantt.mixin(gantt.config, chartConfig, true);\n\n\t\t// GS-1148: Change scales for the resource views\n\t\tconst resourceViews = [\n\t\t\t\"resourceTimeline\",\n\t\t\t\"resourceHistogram\"\n\t\t];\n\n\t\tresourceViews.forEach(function(name){\n\t\t\tconst resourceView = gantt.$ui.getView(name);\n\t\t\tif (resourceView){\n\t\t\t\tconst resourceConfig = resourceView.$getConfig();\n\t\t\t\tif (!resourceConfig.fixed_scales){\n\t\t\t\t\tgantt.mixin(resourceConfig, chartConfig, true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst isRendered = !!gantt.$root && !!gantt.$task;\n\n\t\tif(isRendered){\n\t\t\tif(cursorOffset){\n\t\t\t\tconst cursorDate = this.$gantt.dateFromPos(cursorOffset + this.$gantt.getScrollState().x);\n\t\t\t\tthis.$gantt.render();\n\t\t\t\tconst newPosition = this.$gantt.posFromDate(cursorDate);\n\t\t\t\tthis.$gantt.scrollTo(newPosition - cursorOffset);\n\t\t\t}else{\n\t\t\t\tconst viewPort = this.$gantt.$task.offsetWidth;\n\t\t\t\tif(!this._visibleDate){\n\t\t\t\t\tthis._getVisibleDate();\n\t\t\t\t}\n\t\t\t\tconst middleDate = this._visibleDate;\n\t\t\t\tthis.$gantt.render();\n\t\t\t\tconst newPosition = this.$gantt.posFromDate(middleDate);\n\t\t\t\tthis.$gantt.scrollTo(newPosition - viewPort/2);\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onAfterZoom\", [this._activeLevelIndex, nextConfig]);\n\t\t}\n\t};\n\n\tprivate _attachWheelEvent = (config) => {\n\t\tconst event = env.isFF ? \"wheel\" : \"mousewheel\";\n\t\tlet el: Element;\n\t\tif(typeof config.element === \"function\"){\n\t\t\tel = config.element();\n\t\t}else{\n\t\t\tel = config.element as Element;\n\t\t}\n\t\tif (!el){\n\t\t\treturn;\n\t\t}\n\n\t\tthis._domEvents.attach(el, event, this.$gantt.bind(function(e) {\n\t\t\tif (this._useKey) {\n\t\t\t\tif (USE_KEY.indexOf(this._useKey) < 0) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (!e[this._useKey]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof this._handler === \"function\") {\n\t\t\t\tthis._handler.apply(this, [e]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}, this), {passive: false});\n\t};\n\n\tprivate _defaultHandler = (e: any):void => {\n\t\tconst timelineOffset = this.$gantt.$task.getBoundingClientRect().x;\n\t\tconst cursorOffset = e.clientX - timelineOffset;\n\t\tconst wheelY = this.$gantt.env.isFF ? (e.deltaY*-40) : e.wheelDelta;\n\t\tlet wheelUp = false;\n\t\tif (wheelY > 0) {\n\t\t\twheelUp = true;\n\t\t}\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis._setScaleSettings(wheelUp, cursorOffset);\n\t};\n\n\tprivate _setScaleSettings(wheelUp: boolean, cursorOffset: number) {\n\t\tif (wheelUp) {\n\t\t\tthis._stepUp(cursorOffset);\n\t\t} else {\n\t\t\tthis._stepDown(cursorOffset);\n\t\t}\n\t}\n\n\tprivate _setScaleDates = () => {\n\t\tif(this._initialStartDate && this._initialEndDate){\n\t\t\tthis.$gantt.config.start_date = this._initialStartDate;\n\t\t\tthis.$gantt.config.end_date = this._initialEndDate;\n\t\t}\n\t};\n\n\tprivate _stepUp(cursorOffset) {\n\t\tif (this._activeLevelIndex >= this._levels.length - 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet nextLevel = this._activeLevelIndex;\n\t\tthis._setScaleDates();\n\n\t\tif(this._widthStep){\n\t\t\tlet newColumnWidth = this.$gantt.config.min_column_width + this._widthStep;\n\t\t\tif (newColumnWidth > this._maxColumnWidth) {\n\t\t\t\tnewColumnWidth = this._minColumnWidth;\n\t\t\t\tnextLevel++;\n\t\t\t}\n\n\t\t\tthis.$gantt.config.min_column_width = newColumnWidth;\n\t\t}else{\n\t\t\tnextLevel++;\n\t\t}\n\t\tthis._setLevel(nextLevel, cursorOffset);\n\t}\n\tprivate _stepDown(cursorOffset) {\n\t\tif (this._activeLevelIndex < 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet nextLevel = this._activeLevelIndex;\n\t\tthis._setScaleDates();\n\n\t\tif(this._widthStep){\n\t\t\tlet newColumnWidth = this.$gantt.config.min_column_width - this._widthStep;\n\t\t\tif (newColumnWidth < this._minColumnWidth) {\n\t\t\t\tnewColumnWidth = this._maxColumnWidth;\n\t\t\t\tnextLevel--;\n\t\t\t}\n\t\t\tthis.$gantt.config.min_column_width = newColumnWidth;\n\t\t}else{\n\t\t\tnextLevel--;\n\t\t}\n\t\tthis._setLevel(nextLevel, cursorOffset);\n\t}\n}","export default function(gantt) {\n\n\tgantt.config.touch_drag = 75; //nearly immediate dnd\n\tgantt.config.touch = true;\n\tgantt.config.touch_feedback = true;\n\tgantt.config.touch_feedback_duration = 1;\n\tgantt._prevent_touch_scroll = false;\n\n\n\tgantt._touch_feedback = function () {\n\t\tif (gantt.config.touch_feedback) {\n\t\t\tif (navigator.vibrate)\n\t\t\t\tnavigator.vibrate(gantt.config.touch_feedback_duration);\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif (gantt.$container)\t{\n\t\t\taddTouchEvents();\n\t\t}\n\t});\n\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\tif (gantt.$container)\t{\n\t\t\t\tgantt.attachEvent(\"onGanttRender\", addTouchEvents, {once: true});\n\t\t}\n\t});\n\n\tfunction addTouchEvents(){\n\t\tif (gantt.config.touch != \"force\")\n\t\t\tgantt.config.touch = gantt.config.touch &&\n\t\t\t\t((navigator.userAgent.indexOf(\"Mobile\") != -1) ||\n\t\t\t\t\t(navigator.userAgent.indexOf(\"iPad\") != -1) ||\n\t\t\t\t\t(navigator.userAgent.indexOf(\"Android\") != -1) ||\n\t\t\t\t\t(navigator.userAgent.indexOf(\"Touch\") != -1)) ||\n\t\t\t\t\t((navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1));\n\n\t\tif (gantt.config.touch) {\n\n\t\t\tvar touchEventsSupported = true;\n\t\t\ttry {\n\t\t\t\tdocument.createEvent(\"TouchEvent\");\n\t\t\t} catch (e) {\n\t\t\t\ttouchEventsSupported = false;\n\t\t\t}\n\n\t\t\tif (touchEventsSupported) {\n\t\t\t\tgantt._touch_events([\"touchmove\", \"touchstart\", \"touchend\"], function (ev) {\n\t\t\t\t\tif (ev.touches && ev.touches.length > 1) return null;\n\t\t\t\t\tif (ev.touches[0])\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttarget: ev.target,\n\t\t\t\t\t\t\tpageX: ev.touches[0].pageX,\n\t\t\t\t\t\t\tpageY: ev.touches[0].pageY,\n\t\t\t\t\t\t\tclientX: ev.touches[0].clientX,\n\t\t\t\t\t\t\tclientY: ev.touches[0].clientY\n\t\t\t\t\t\t};\n\t\t\t\t\telse\n\t\t\t\t\t\treturn ev;\n\t\t\t\t}, function () {\n\t\t\t\t\treturn false;\n\t\t\t\t});\n\t\t\t} else if (window.navigator.pointerEnabled) {\n\t\t\t\tgantt._touch_events([\"pointermove\", \"pointerdown\", \"pointerup\"], function (ev) {\n\t\t\t\t\tif (ev.pointerType == \"mouse\") return null;\n\t\t\t\t\treturn ev;\n\t\t\t\t}, function (ev) {\n\t\t\t\t\treturn (!ev || (ev.pointerType == \"mouse\" ));\n\t\t\t\t});\n\t\t\t} else if (window.navigator.msPointerEnabled) {\n\t\t\t\tgantt._touch_events([\"MSPointerMove\", \"MSPointerDown\", \"MSPointerUp\"], function (ev) {\n\t\t\t\t\tif (ev.pointerType == ev.MSPOINTER_TYPE_MOUSE) return null;\n\t\t\t\t\treturn ev;\n\t\t\t\t}, function (ev) {\n\t\t\t\t\treturn (!ev || ev.pointerType == ev.MSPOINTER_TYPE_MOUSE);\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\t}\n\n\n\tfunction findTargetView(event){\n\t\tvar allViews = gantt.$layout.getCellsByType(\"viewCell\");\n\n\t\tfor(var i = 0; i < allViews.length; i++){\n\t\t\tvar box = allViews[i].$view.getBoundingClientRect();\n\t\t\tif(event.clientX >= box.left && event.clientX <= box.right &&\n\t\t\t\tevent.clientY <= box.bottom && event.clientY >= box.top){\n\t\t\t\t\treturn allViews[i];\n\t\t\t\t}\n\t\t}\n\t}\n\n\tfunction getScrollState(view){\n\t\tvar scrollX = view.$config.scrollX ? gantt.$ui.getView(view.$config.scrollX) : null;\n\t\tvar scrollY = view.$config.scrollY ? gantt.$ui.getView(view.$config.scrollY) : null;\n\n\t\tvar scrollState = {x: null, y: null};\n\t\tif(scrollX){\n\t\t\tvar state = scrollX.getScrollState();\n\t\t\tif(state.visible){\n\t\t\t\tscrollState.x = scrollX.$view.scrollLeft;\n\t\t\t}\n\t\t}\n\t\tif(scrollY){\n\t\t\tvar state = scrollY.getScrollState();\n\t\t\tif(state.visible){\n\t\t\t\tscrollState.y = scrollY.$view.scrollTop;\n\t\t\t}\n\t\t}\n\t\treturn scrollState;\n\t}\n\n\tfunction scrollView(view, left, top){\n\t\tvar scrollX = view.$config.scrollX ? gantt.$ui.getView(view.$config.scrollX) : null;\n\t\tvar scrollY = view.$config.scrollY ? gantt.$ui.getView(view.$config.scrollY) : null;\n\n\t\tif(scrollX){\n\t\t\tscrollX.scrollTo(left, null);\n\t\t}\n\t\tif(scrollY){\n\t\t\tscrollY.scrollTo(null, top);\n\t\t}\n\t}\n\n\tfunction getTaskDND(){\n\t\tvar tasksDnD;\n\t\tif(gantt.$ui.getView(\"timeline\")){\n\t\t\ttasksDnD = gantt.$ui.getView(\"timeline\")._tasks_dnd;\n\t\t}\n\t\treturn tasksDnD;\n\t}\n\n\tvar touchHandlers = [];\n\n//we can't use native scrolling, as we need to sync momentum between different parts\n//so we will block native scroll and use the custom one\n//in future we can add custom momentum\n\tgantt._touch_events = function (names, accessor, ignore) {\n\t\t//webkit on android need to be handled separately\n\t\tvar dblclicktime = 0;\n\t\tvar actionMode = false;\n\t\tvar scrollMode = false;\n\t\tvar actionStart = null;\n\t\tvar scrollState;\n\t\tvar longTapTimer = null;\n\t\tvar currentDndId = null;\n\t\tvar dndNodes = [];\n\t\tvar targetView = null;\n\t\tlet multiTouchEvents = {};\n\n\t\tfor(var i = 0; i < touchHandlers.length; i++){\n\t\t\tgantt.eventRemove(touchHandlers[i][0], touchHandlers[i][1], touchHandlers[i][2]);\n\t\t}\n\t\ttouchHandlers = [];\n\n\t\t//touch move\n\t\ttouchHandlers.push([gantt.$container, names[0], function (e) {\n\t\t\tvar tasksDnD = getTaskDND();\n\n\t\t\t\tif (ignore(e)) return;\n\n\t\t\t\t//ignore common and scrolling moves\n\t\t\t\tif (!actionMode) return;\n\n\t\t\t\tif (longTapTimer) clearTimeout(longTapTimer);\n\n\t\t\t\tvar source = accessor(e);\n\t\t\t\tif (tasksDnD && (tasksDnD.drag.id || tasksDnD.drag.start_drag)) {\n\t\t\t\t\ttasksDnD.on_mouse_move(source);\n\t\t\t\t\tif (e.preventDefault)\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.cancelBubble = true;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (!gantt._prevent_touch_scroll) {\n\t\t\t\t\tif (source && actionStart) {\n\t\t\t\t\t\tvar dx = actionStart.pageX - source.pageX;\n\t\t\t\t\t\tvar dy = actionStart.pageY - source.pageY;\n\t\t\t\t\t\tif (!scrollMode && (Math.abs(dx) > 5 || Math.abs(dy) > 5)) {\n\t\t\t\t\t\t\tscrollMode = true;\n\t\t\t\t\t\t\t//gantt._touch_scroll_active = scroll_mode = true;\n\t\t\t\t\t\t\tdblclicktime = 0;\n\n\t\t\t\t\t\t\tif(targetView){\n\t\t\t\t\t\t\t\tscrollState = getScrollState(targetView);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tscrollState = gantt.getScrollState();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (scrollMode) {\n\n\t\t\t\t\t\t\tvar newScrollState;\n\t\t\t\t\t\t\tvar scrollX = scrollState.x + dx;\n\t\t\t\t\t\t\tvar scrollY = scrollState.y + dy;\n\t\t\t\t\t\t\tif(targetView){\n\t\t\t\t\t\t\t\tscrollView(targetView, scrollX, scrollY);\n\t\t\t\t\t\t\t\tnewScrollState = getScrollState(targetView);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tgantt.scrollTo(scrollX, scrollY);\n\t\t\t\t\t\t\t\tnewScrollState = gantt.getScrollState();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ((scrollState.x != newScrollState.x && dy > 2 * dx) ||\n\t\t\t\t\t\t\t\t(scrollState.y != newScrollState.y && dx > 2 * dy )) {\n\t\t\t\t\t\t\t\treturn block_action(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn block_action(e);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}]);\n\n\t\t// prevent page drag on touch move\n\t\ttry{\n\t\t\tdocument.addEventListener('touchmove', function(e) {\n\t\t\t\tif (gantt._touch_drag) {\n\t\t\t\t\tblock_action(e);\n\t\t\t\t}\n\t\t\t}, { passive: false });\n\t\t}\n\t\tcatch(e){\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(\"Cannot prevent touch event for the page drag\");\n\t\t}\n\n\t\t//block touch context menu in IE10\n\t\ttouchHandlers.push([this.$container, \"contextmenu\", function (e) {\n\t\t\tif (actionMode)\n\t\t\t\treturn block_action(e);\n\t\t}]);\n\n\t\t//touch start\n\t\ttouchHandlers.push([this.$container, names[1], function (e) {\n\t\t\tmultiTouchEvents = e.touches.length;\n\t\t\t// block pull-to-refresh\n\t\t\tif(document && document.body){\n\t\t\t\tdocument.body.classList.add(\"gantt_touch_active\");\n\t\t\t}\n\n\t\t\tif (ignore(e)) return;\n\t\t\tif (e.touches && e.touches.length > 1) {\n\t\t\t\tactionMode = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tactionStart = accessor(e);\n\t\t\ttargetView = findTargetView(actionStart);\n\t\t\tif (!gantt._locate_css(actionStart, \"gantt_hor_scroll\") && !gantt._locate_css(actionStart, \"gantt_ver_scroll\")) {\n\t\t\t\tactionMode = true;\n\t\t\t}\n\t\t\tvar tasksDnD = getTaskDND();\n\n\t\t\t//long tap\n\t\t\tlongTapTimer = setTimeout(function () {\n\t\t\t\tvar taskId = gantt.locate(actionStart);\n\t\t\t\tif (tasksDnD && (taskId && !gantt._locate_css(actionStart, \"gantt_link_control\") && !gantt._locate_css(actionStart, \"gantt_grid_data\"))) {\n\t\t\t\t\ttasksDnD.on_mouse_down(actionStart);\n\n\t\t\t\t\tif (tasksDnD.drag && tasksDnD.drag.start_drag) {\n\t\t\t\t\t\t// we need that as touch events break if the target node is removed from the DOM\n\t\t\t\t\t\tcloneTaskRendered(taskId);\n\t\t\t\t\t\ttasksDnD._start_dnd(actionStart);\n\t\t\t\t\t\tgantt._touch_drag = true;\n\n\t\t\t\t\t\tgantt.refreshTask(taskId);\n\n\t\t\t\t\t\tgantt._touch_feedback();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tlongTapTimer = null;\n\t\t\t}, gantt.config.touch_drag);\n\t\t}]);\n\n\t\t//touch end\n\t\ttouchHandlers.push([this.$container, names[2], function (e) {\n\t\t\tif(document && document.body){\n\t\t\t\tdocument.body.classList.remove(\"gantt_touch_active\");\n\t\t\t}\n\t\t\tif (ignore(e)) return;\n\t\t\tif (longTapTimer) clearTimeout(longTapTimer);\n\t\t\tgantt._touch_drag = false;\n\t\t\tactionMode = false;\n\t\t\tvar source = accessor(e);\n\n\t\t\tvar tasksDnD = getTaskDND();\n\n\t\t\tif(tasksDnD)\n\t\t\t\ttasksDnD.on_mouse_up(source);\n\n\t\t\tif (currentDndId && gantt.isTaskExists(currentDndId)) {\n\t\t\t\tgantt.refreshTask(currentDndId);\n\t\t\t\tif(dndNodes.length){\n\t\t\t\t\tdndNodes.forEach(function(node){\n\t\t\t\t\t\tif(node.parentNode){\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tgantt._touch_feedback();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//gantt._touch_scroll_active = action_mode = scroll_mode = false;\n\t\t\tactionMode = scrollMode = false;\n\t\t\tdndNodes = [];\n\t\t\tcurrentDndId = null;\n\n\t\t\t//dbl-tap handling\n\t\t\tif (actionStart && dblclicktime) {\n\t\t\t\tvar now = new Date();\n\t\t\t\t// doubletap shouldn't happen with multitouch\n\t\t\t\tif ((now - dblclicktime) < 500 && multiTouchEvents <= 1) {\n\n\t\t\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\n\t\t\t\t\tmouseEvents.onDoubleClick(actionStart);\n\t\t\t\t\tblock_action(e);\n\t\t\t\t} else\n\t\t\t\t\tdblclicktime = now;\n\t\t\t} else {\n\t\t\t\tdblclicktime = new Date();\n\t\t\t}\n\t\t}]);\n\n\t\tfor(var i = 0; i < touchHandlers.length; i++){\n\t\t\tgantt.event(touchHandlers[i][0], touchHandlers[i][1], touchHandlers[i][2]);\n\t\t}\n\n\t\t//common helper, prevents event\n\t\tfunction block_action(e) {\n\t\t\tif (e && e.preventDefault && e.cancelable){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\te.cancelBubble = true;\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction cloneTaskRendered(taskId) {\n\t\t\tconst renders = gantt._getTaskLayers();\n\t\t\tlet task = gantt.getTask(taskId);\n\t\t\tif (task) {\n\t\t\t\tlet visible = gantt.isTaskVisible(taskId);\n\t\t\t\tif (visible){\n\t\t\t\t\tcurrentDndId = taskId;\n\t\t\t\t\tfor (let i = 0; i < renders.length; i++) {\n\t\t\t\t\t\ttask = renders[i].rendered[taskId];\n\t\t\t\t\t\tif (task && task.getAttribute(gantt.config.task_attribute) && task.getAttribute(gantt.config.task_attribute) == taskId) {\n\t\t\t\t\t\t\tconst copy = task.cloneNode(true);\n\t\t\t\t\t\t\tdndNodes.push(task);\n\t\t\t\t\t\t\trenders[i].rendered[taskId] = copy;\n\t\t\t\t\t\t\ttask.style.display = \"none\";\n\t\t\t\t\t\t\tcopy.className += \" gantt_drag_move \";\n\t\t\t\t\t\t\ttask.parentNode.appendChild(copy);\n\t\t\t\t\t\t\t//return copy;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (task.$split_subtask){\n\t\t\t\t\tlet renderedParent = task.$rendered_parent;\n\t\t\t\t\tvisible = gantt.isTaskVisible(renderedParent);\n\t\t\t\t\tif (!visible){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentDndId = taskId;\n\t\t\t\t\tfor (let i = 0; i < renders.length; i++) {\n\t\t\t\t\t\tconst parent = renders[i].rendered[renderedParent];\n\t\t\t\t\t\tlet taskNode;\n\t\t\t\t\t\tif (parent && parent.childNodes){\n\t\t\t\t\t\t\ttaskNode = parent.querySelector(`[${gantt.config.task_attribute}=\"${task.id}\"]`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (taskNode) {\n\t\t\t\t\t\t\t// move the child node to a different parent as the task bar will be repainted\n\t\t\t\t\t\t\t// and the initial node will be lost\n\t\t\t\t\t\t\tconst copy = taskNode.cloneNode(true);\n\t\t\t\t\t\t\ttaskNode.parentNode.appendChild(copy);\n\n\t\t\t\t\t\t\tgantt.$task_bars.appendChild(taskNode);\n\t\t\t\t\t\t\ttaskNode.style.display = \"none\";\n\n\t\t\t\t\t\t\t// don't add the node as rendered otherwise it will be lost:\n\t\t\t\t\t\t\t// renders[i].rendered[taskId] = taskNode;\n\t\t\t\t\t\t\t// instead, add it to dndNodes as its elements will be removed after drag\n\t\t\t\t\t\t\tdndNodes.push(taskNode);\n\n\t\t\t\t\t\t\ttaskNode = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n};","function dummy() {\n\t// eslint-disable-next-line\n\tconsole.log(\"Method is not implemented.\"); \n}\nfunction BaseControl() {\n}\n\n// base methods will be runned in gantt context\nBaseControl.prototype.render = dummy; // arguments: sns\nBaseControl.prototype.set_value = dummy; // arguments: node, value, ev, sns(config)\nBaseControl.prototype.get_value = dummy; // arguments node, ev, sns(config)\nBaseControl.prototype.focus = dummy; // arguments: node\n\nexport default function(gantt) { // we could send current instance of gantt to module\n\treturn BaseControl;\n};","import * as helpers from \"../../../utils/helpers\";\n\nvar htmlHelpers = {\n\tgetHtmlSelect: function(options, attributes, value) {\n\t\tvar innerHTML = \"\";\n\t\tvar _this = this;\n\n\t\toptions = options || [];\n\t\t\n\t\thelpers.forEach(options, function(entry) {\n\t\t\tvar _attributes = [{ key: \"value\", value: entry.key }];\n\n\t\t\tif (value == entry.key) {\n\t\t\t\t_attributes[_attributes.length] = { key: \"selected\", value: \"selected\" };\n\t\t\t}\n\t\t\tif (entry.attributes) {\n\t\t\t\t_attributes = _attributes.concat(entry.attributes);\n\t\t\t}\n\t\t\tinnerHTML += _this.getHtmlOption({ innerHTML: entry.label }, _attributes);\n\t\t});\n\n\t\treturn _getHtmlContainer(\"select\", { innerHTML: innerHTML }, attributes);\n\t},\n\tgetHtmlOption: function(options, attributes) { return _getHtmlContainer(\"option\", options, attributes); },\n\tgetHtmlButton: function(options, attributes) { return _getHtmlContainer(\"button\", options, attributes); },\n\tgetHtmlDiv: function(options, attributes) { return _getHtmlContainer(\"div\", options, attributes); },\n\tgetHtmlLabel: function(options, attributes) { return _getHtmlContainer(\"label\", options, attributes); },\n\tgetHtmlInput: function(attributes) {\n\t\treturn \"<input\" + _getHtmlAttributes(attributes || []) + \">\";\n\t}\n};\n\nfunction _getHtmlContainer(tag, options, attributes) {\n\tvar html;\n\n\toptions = options || [];\n\t\n\thtml = \"<\" + tag + _getHtmlAttributes(attributes || []) + \">\" + (options.innerHTML || \"\") + \"</\" + tag +\">\";\n\treturn html;\n\n}\n\nfunction _getHtmlAttributes(attributes) {\n\tvar html = \"\";\n\n\thelpers.forEach(attributes, function(entry) {\n\t\thtml += \" \" + entry.key + \"='\" + entry.value + \"'\";\n\t});\n\treturn html;\n}\n\nexport default htmlHelpers;","import __extends from \"../../../../utils/extends\";\nimport htmlHelpers from \"../../utils/html_helpers\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction SelectControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\n\t\treturn self; \n\t}\n\t\n\t__extends(SelectControl, _super);\n\t\n\tSelectControl.prototype.render = function(sns) {\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\n\n\t\thtml += htmlHelpers.getHtmlSelect(sns.options, [{ key: \"style\", value: \"width:100%;\" }, { key: \"title\", value: sns.name }]);\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tSelectControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar select = node.firstChild;\n\t\tif (!select._dhx_onchange && sns.onchange) {\n\t\t\tselect.onchange = sns.onchange;\n\t\t\tselect._dhx_onchange = true;\n\t\t}\n\t\tif (typeof value === \"undefined\")\n\t\t\tvalue = (select.options[0] || {}).value;\n\t\tselect.value = value || \"\";\n\t};\n\t\n\tSelectControl.prototype.get_value = function(node) {\n\t\treturn node.firstChild.value;\n\t};\n\t\n\tSelectControl.prototype.focus = function(node) {\n\t\tvar a = node.firstChild;\n\t\tgantt._focus(a, true);\n\t};\n\t\n\treturn SelectControl;\n};","export default class DurationFormatterNumeric implements IDurationFormatter {\n\tstatic create = (settings: IDurationFormatterConfig = null): IDurationFormatter => {\n\t\treturn new DurationFormatterNumeric();\n\t};\n\tcanParse = (value: string) : boolean => {\n\t\treturn !isNaN(this.parse(value));\n\t};\n\tformat = (value: number) : string => {\n\t\treturn String(value);\n\t};\n\tparse = (value: string) : number => {\n\t\treturn parseInt(value, 10);\n\t};\n}","import __extends from \"../../../../utils/extends\";\nimport SelectControl from \"./select_control\";\nexport default function(gantt) {\n\tvar _super = SelectControl(gantt);\n\n\tfunction ParentControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\n\t\treturn self; \n\t}\n\n\t__extends(ParentControl, _super);\n\n\n\tParentControl.prototype.render = function(sns) {\n\t\treturn _display(sns, false);\n\t};\n\n\tParentControl.prototype.set_value = function(node, value, ev, config) {\n\t\t// GS-1051. If the value is `0`, the set_value function in the select control won't select \n\t\t// the first child because (0 || '') = '';\n\t\tif (value === 0) value = \"0\";\n\n\t\tvar tmpDom = document.createElement(\"div\");\n\t\ttmpDom.innerHTML = _display(config, ev.id);\n\t\tvar newOptions = tmpDom.removeChild(tmpDom.firstChild);\n\t\tnode.onselect = null;\n\t\tnode.parentNode.replaceChild(newOptions, node);\n\n\t\treturn gantt.form_blocks.select.set_value.apply(gantt, [newOptions, value, ev, config]);\n\t};\n\n\tfunction _display(config, item_id) {\n\t\tvar tasks = [],\n\t\t\toptions = [];\n\t\tif (item_id) {\n\t\t\ttasks = gantt.getTaskByTime();\n\t\t\tif (config.allow_root) {\n\t\t\t\ttasks.unshift({id: gantt.config.root_id, text: config.root_label || \"\"});\n\t\t\t}\n\t\t\ttasks = _filter(tasks, config, item_id);\n\t\t\tif (config.sort) {\n\t\t\t\ttasks.sort(config.sort);\n\t\t\t}\n\t\t}\n\t\tvar text = config.template || gantt.templates.task_text;\n\t\tfor (var i = 0; i < tasks.length; i++) {\n\t\t\tvar label = text.apply(gantt, [tasks[i].start_date, tasks[i].end_date, tasks[i]]);\n\t\t\tif (label === undefined) {\n\t\t\t\tlabel = \"\";\n\t\t\t}\n\t\t\toptions.push({\n\t\t\t\tkey: tasks[i].id,\n\t\t\t\tlabel: label\n\t\t\t});\n\t\t}\n\t\tconfig.options = options;\n\t\tconfig.map_to = config.map_to || \"parent\";\n\t\treturn gantt.form_blocks.select.render.apply(this, arguments);\n\t}\n\n\tfunction _filter(options, config, item_id) {\n\t\tvar filter = config.filter || function() {\n\t\t\treturn true;\n\t\t};\n\n\t\toptions = options.slice(0);\n\n\t\tfor (var i = 0; i < options.length; i++) {\n\t\t\tvar task = options[i];\n\t\t\tif (task.id == item_id || gantt.isChildOf(task.id, item_id) || filter(task.id, task) === false) {\n\t\t\t\toptions.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\treturn options;\n\t}\n\treturn ParentControl;\n};","import * as helpers from \"../../../../utils/helpers\";\nimport * as domHelpers from \"../../utils/dom_helpers\";\nimport htmlHelpers from \"../../utils/html_helpers\";\nimport __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\tvar localCache = {\n\t\tresources: {},\n\t\tresourcesValues: {},\n\t\tfilter: {},\n\t\teventsInitialized: {}\n\t};\n\n\tgantt.attachEvent(\"onAfterLightbox\", _clearCached);\n\n\tfunction ResourcesControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(ResourcesControl, _super);\n\n\tResourcesControl.prototype.render = function(sns) {\n\t\tif(!sns.options){\n\t\t\tsns.options = gantt.serverList(\"resourceOptions\");\n\t\t}\n\t\t\n\t\tif(!sns.map_to || sns.map_to == \"auto\"){\n\t\t\tsns.map_to = gantt.config.resource_property;\n\t\t}\n\t\tvar html;\n\t\tvar resourceFilterPlaceholder = gantt.locale.labels.resources_filter_placeholder || sns.filter_placeholder || \"type to filter\";\n\t\tvar resourceFilterLabel = gantt.locale.labels.resources_filter_label || \"hide empty\";\n\t\t// if set fixed height for this element, then resize of lightbox will be calculated improperly\n\t\thtml = \"<div\" + (!isNaN(sns.height) ? \" style='height: \" + sns.height + \"px;'\" : \"\") + \" class='gantt_section_\" + sns.name + \"'>\";\n\t\thtml += \"<div class='gantt_cal_ltext gantt_resources_filter'><input type='text' class='gantt_resources_filter_input' placeholder='\" + resourceFilterPlaceholder + \"'> <label><input class='switch_unsetted' type='checkbox'><span class='matherial_checkbox_icon'></span>\" + resourceFilterLabel + \"</label></div>\";\n\t\thtml += \"<div class='gantt_cal_ltext gantt_resources' data-name='\" + sns.name + \"'></div>\";\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tResourcesControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar resourcesElement = _setResourcesElement(node, sns);\n\t\tvar htmlResourceRow = \"\";\n\t\tvar data;\n\n\t\t_setFilterCache(node, sns);\n\t\t_initEvents(node, ev, sns, this);\n\t\thelpers.forEach(sns.options, function(entry, index) {\n\t\t\tif (sns.unassigned_value == entry.key) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdata = _getDisplayValues(sns, value, entry);\n\n\t\t\thtmlResourceRow += [\n\t\t\t\t\"<label class='gantt_resource_row' data-item-id='\" + entry.key + \"' data-checked=\"+(data.value ? 'true' : 'false')+\">\",\n\t\t\t\t\"<input class='gantt_resource_toggle' type='checkbox'\", data.value ? \" checked='checked'\" : \"\", \"><div class='gantt_resource_cell gantt_resource_cell_checkbox'><span class='matherial_checkbox_icon'></span></div>\",\n\t\t\t\t\"<div class='gantt_resource_cell gantt_resource_cell_label'>\", entry.label, \"</div>\",\n\t\t\t\t\"<div class='gantt_resource_cell gantt_resource_cell_value'>\", _getAmountInput(entry, data.value, !data.value, data.id),\"</div>\",\n\t\t\t\t\"<div class='gantt_resource_cell gantt_resource_cell_unit'>\", entry.unit,\"</div>\",\n\t\t\t\t\"</label>\"\n\t\t\t].join(\"\");\n\t\t});\n\t\tresourcesElement.innerHTML = htmlResourceRow;\n\t\t// weird element sizes in ie11 when display empty resource list, use zoom to force repaint\n\t\tresourcesElement.style.zoom = \"1\";\n\t\tresourcesElement._offsetSizes = resourcesElement.offsetHeight;\n\t\tresourcesElement.style.zoom = \"\";\n\n\t\tgantt._center_lightbox(gantt.getLightbox());\n\t};\n\n\tResourcesControl.prototype.get_value = function(node, ev, sns) {\n\n\t\tvar amountElement = _getResourcesElement(sns);\n\t\tvar result = [];\n\t\tvar selectorAdd = _getInputElementSelector(true);\n\t\tvar selectorSub = _getInputElementSelector(false);\n\t\tvar filterCache = _getFilterCache(sns);\n\t\tvar settedValuesHash = gantt.copy(localCache.resourcesValues[sns.id]) || {};\n\n\t\tvar itemsAdd = amountElement.querySelectorAll(selectorAdd);\n\t\tvar itemsSub = amountElement.querySelectorAll(selectorSub);\n\n\t\tfor (var i = 0; i < itemsSub.length; i++) {\n\t\t\tdelete settedValuesHash[itemsSub[i].getAttribute(\"data-item-id\")];\n\t\t}\n\n\t\tfor (var i = 0; i < itemsAdd.length; i++) {\n\t\t\tvar originalId = itemsAdd[i].getAttribute(\"data-assignment-id\");\n\t\t\tvar resourceId = itemsAdd[i].getAttribute(\"data-item-id\");\n\t\t\tvar amount = itemsAdd[i].value.trim();\n\n\t\t\tif (amount !== \"\" && amount !== \"0\") {\n\t\t\t\tdelete settedValuesHash[resourceId];\n\t\t\t\tresult[result.length] = { resource_id: resourceId, value: amount };\n\t\t\t\tif (originalId){\n\t\t\t\t\tresult[result.length - 1] = { ...result[result.length - 1], id: originalId };\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (filterCache.filterApplied) {\n\t\t\tfor (var item in settedValuesHash) {\n\t\t\t\tresult[result.length] = { resource_id: item, value: settedValuesHash[item].value, id: settedValuesHash[item].id };\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tResourcesControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.querySelector(\".gantt_resources\"));\n\t};\n\n\tfunction _getAmountInput(item, value, disabled, assignmentId) {\n\t\tvar _attributes;\n\t\tvar innerHTML = \"\";\n\n\t\tif (!item) return;\n\n\t\t_attributes = [{ key: \"data-item-id\", value: item.key }, { key: \"data-assignment-id\", value: assignmentId || \"\"}, { key: \"class\", value: \"gantt_resource_amount_input\"}];\n\t\tif (disabled) {\n\t\t\t_attributes.push({ key: \"disabled\", value: \"disabled\" });\n\t\t}\n\n\t\tif (item.options) {\n\t\t\tinnerHTML += htmlHelpers.getHtmlSelect(item.options, _attributes, value);\n\t\t} else {\n\t\t\t_attributes[_attributes.length] = { key: \"value\", value: value || \"\" };\n\t\t\tinnerHTML += htmlHelpers.getHtmlInput(_attributes);\n\t\t}\n\t\treturn innerHTML;\n\t}\n\n\tfunction _getValue(el) {\n\t\treturn el.value.trim();\n\t}\n\n\tfunction _initEvents(node, ev, sns, context) {\n\t\tif (localCache.eventsInitialized[sns.id]) return;\n\n\t\tvar _applyFilter = function(e) {\n\t\t\t_saveValues(sns, node);\n\t\t\tvar resultSns;\n\t\t\tvar query;\n\t\t\tvar hideUnsetted;\n\t\t\tvar input;\n\t\t\tvar checkbox;\n\t\t\tvar filterCache = _getFilterCache(sns);\n\n\t\t\tcheckbox = filterCache.checkbox;\n\t\t\tinput = filterCache.input;\n\n\t\t\thideUnsetted = checkbox.checked;\n\t\t\tquery = _getValue(input);\n\t\t\tfilterCache.filterApplied = !!query;\n\t\t\tif (gantt.getState().lightbox) {\n\t\t\t\tev = gantt.getLightboxValues();\n\t\t\t}\n\t\t\tresultSns = _getSnsToHideUnsetted(sns, ev, query, hideUnsetted);\n\t\t\tvar value = ev[sns.map_to];\n\t\t\tcontext.form_blocks.resources.set_value(node, value, ev, resultSns);\n\t\t};\n\n\t\tfunction _resourceChangeListener(e) {\n\t\t\tvar target = e.target;\n\t\t\tvar parent;\n\t\t\tvar input;\n\n\t\t\tif (e.target.type === \"checkbox\") {\n\t\t\t\tparent = target.parentNode;\n\t\t\t\tinput = parent.querySelector(_getInputElementSelector());\n\t\t\t\tinput.disabled = !target.checked;\n\t\t\t\tvar itemId = input.getAttribute(\"data-item-id\");\n\t\t\t\tvar row = domHelpers.locateClassName(e, \"gantt_resource_row\");\n\t\t\t\tvar valueInput = row.querySelector(\".gantt_resource_amount_input\");\n\t\t\t\trow.setAttribute(\"data-checked\", target.checked);\n\t\t\t\tif (target.checked) {\n\t\t\t\t\tif (input.nodeName.toLowerCase() === \"select\") {\n\t\t\t\t\t\tgantt.callEvent(\"onResourcesSelectActivated\", [{ target: input }]);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar resId = itemId;\n\t\t\t\t\tvar defaultValue = sns.default_value;\n\t\t\t\t\tsns.options.forEach(function(option){\n\t\t\t\t\t\tif(option.key == resId && option.default_value){\n\t\t\t\t\t\t\tdefaultValue = option.default_value;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif(valueInput && !valueInput.value && defaultValue !== undefined){\n\t\t\t\t\t\tvalueInput.value = defaultValue;\n\t\t\t\t\t\t_saveValues(sns, this);\n\t\t\t\t\t}\n\n\t\t\t\t\tif(valueInput.select) {\n\t\t\t\t\t\tvalueInput.select();\n\t\t\t\t\t}else if(valueInput.focus){\n\t\t\t\t\t\tvalueInput.focus();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\n\t\t\t\t\tif (localCache.resourcesValues[sns.id]) {\n\t\t\t\t\t\tdelete localCache.resourcesValues[sns.id][itemId];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (e.target.type === \"text\" || e.target.nodeName.toLowerCase() === \"select\") {\n\t\t\t\tparent = target.parentNode.parentNode;\n\n\t\t\t\tinput = e.target;\n\t\t\t\t_saveValues(sns, this);\n\t\t\t}\n\t\t}\n\t\t\n\n\t\tfunction _saveValues(sns, domElement) {\n\t\t\tvar selector = _getInputElementSelector();\n\t\t\tvar inputs = domElement.querySelectorAll(selector);\n\n\t\t\tlocalCache.resourcesValues[sns.id] = localCache.resourcesValues[sns.id] || {};\n\n\t\t\tfor (var i = 0; i < inputs.length; i++) {\n\t\t\t\tvar key = inputs[i].getAttribute(\"data-item-id\");\n\t\t\t\tvar originalAssignmentId = inputs[i].getAttribute(\"data-assignment-id\");\n\t\t\t\tif (!inputs[i].disabled) {\n\t\t\t\t\tlocalCache.resourcesValues[sns.id][key] = {value: inputs[i].value, id: originalAssignmentId};\n\t\t\t\t} else {\n\t\t\t\t\tdelete localCache.resourcesValues[sns.id][key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t_applyFilter = helpers.throttle(_applyFilter, 100);\n\n\t\t_getFilterCache(sns).container.addEventListener(\"keyup\", _applyFilter);\n\t\t_getFilterCache(sns).container.addEventListener(\"input\", _applyFilter, true);\n\t\t_getFilterCache(sns).container.addEventListener(\"change\", _applyFilter, true);\n\t\t_getResourcesElement(sns).addEventListener(\"input\", _resourceChangeListener);\n\t\t_getResourcesElement(sns).addEventListener(\"change\", _resourceChangeListener);\n\t\tgantt.attachEvent(\"onResourcesSelectActivated\", gantt.bind(_resourceChangeListener, _getResourcesElement(sns)));\n\t\tlocalCache.eventsInitialized[sns.id] = true;\n\t}\n\n\tfunction _getSnsToHideUnsetted(controlConfig, task, query, hideUnsetted) {\n\t\tvar comparison;\n\t\tvar resultConfig;\n\n\t\tif (!hideUnsetted) {\n\t\t\tif (query === \"\") {// show all\n\t\t\t\treturn controlConfig;\n\t\t\t}\n\n\t\t\tcomparison = function(entry) {// show matching labels only\n\t\t\t\tif (entry.label.toLowerCase().indexOf(query.toLowerCase()) >= 0) {\n\t\t\t\t\treturn entry;\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\tvar collection = task[controlConfig.map_to] || [];\n\n\t\t\tif (!helpers.isArray(collection)) {\n\t\t\t\tcollection = [collection];\n\t\t\t}\n\n\t\t\t// copy section array in order not to modify ev[sns.map_to]\n\t\t\tcollection = collection.slice();\n\n\t\t\tif (collection.length === 0) {//nothing setted\n\t\t\t\tcollection = [];\n\t\t\t\tresultConfig = gantt.copy(controlConfig);\n\t\t\t\tresultConfig.options = [];\n\t\t\t\tfor (var key in localCache.resourcesValues[controlConfig.id]) {\n\t\t\t\t\tvar cachedValue = localCache.resourcesValues[controlConfig.id][key];\n\t\t\t\t\tif (cachedValue.value !== \"\") {\n\t\t\t\t\t\tcollection.push({resource_id: key, value: cachedValue.value, id: cachedValue.id});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (collection.length === 0) {\n\t\t\t\t\treturn resultConfig;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (var key in localCache.resourcesValues[controlConfig.id]) {\n\t\t\t\t\tvar cachedValue = localCache.resourcesValues[controlConfig.id][key];\n\t\t\t\t\tif (cachedValue.value !== \"\") {\n\t\t\t\t\t\tvar searchResult = helpers.arrayFind(collection, function(entry) {\n\t\t\t\t\t\t\treturn entry.id == key;\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\tif (!searchResult) {\n\t\t\t\t\t\t\tcollection.push({resource_id: key, value: cachedValue.value, id: cachedValue.id});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar itemIds = {};\n\n\t\t\tfor (var i=0; i < collection.length; i++) {\n\t\t\t\titemIds[collection[i].resource_id] = true;\n\t\t\t}\n\t\t\tcomparison = function(entry) {//show setted and filtered if field is filled\n\t\t\t\tif (itemIds[String(entry.key)] && (query === \"\" || entry.label.toLowerCase().indexOf(query.toLowerCase()) >= 0)) {\n\t\t\t\t\treturn entry;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tresultConfig = gantt.copy(controlConfig);\n\t\tresultConfig.options = helpers.arrayFilter(resultConfig.options, comparison);\n\t\treturn resultConfig;\n\t}\n\n\tfunction _getInputElementSelector(isChecked) {\n\t\tif(isChecked === undefined){\n\t\t\treturn \".gantt_resource_amount_input\";\n\t\t}else{\n\t\t\treturn \"[data-checked='\"+(isChecked ? \"true\" : \"false\") + \"'] .gantt_resource_amount_input\";\n\t\t}\n\t}\n\n\tfunction _setResourcesElement(node, sns) {\n\t\tif (!localCache.resources[sns.id]) {\n\t\t\tlocalCache.resources[sns.id] = node.querySelector(\".gantt_resources\");\n\t\t}\n\t\treturn localCache.resources[sns.id];\n\t}\n\n\tfunction _getResourcesElement(sns) {\n\t\treturn localCache.resources[sns.id];\n\t}\n\n\tfunction _setFilterCache(node, sns) {\n\t\tif (!localCache.filter[sns.id]) {\n\t\t\tvar container = node.querySelector(\".gantt_resources_filter\");\n\t\t\tvar input = container.querySelector(\".gantt_resources_filter_input\");\n\t\t\tvar checkbox = container.querySelector(\".switch_unsetted\");\n\n\t\t\tlocalCache.filter[sns.id] = {\n\t\t\t\tcontainer: container,\n\t\t\t\tinput: input,\n\t\t\t\tcheckbox: checkbox,\n\t\t\t\tfilterApplied: false\n\t\t\t};\n\t\t}\n\t\treturn localCache.filter[sns.id];\n\t}\n\n\tfunction _getFilterCache(sns) {\n\t\treturn localCache.filter[sns.id];\n\t}\n\n\tfunction _clearCached() {\n\t\tfor (var key in localCache.filter) {\n\t\t\tlocalCache.filter[key].checkbox.checked = false;\n\t\t\tlocalCache.filter[key].input.value = \"\";\n\t\t\tlocalCache.filter[key].filterApplied = false;\n\t\t}\n\t\tlocalCache.resourcesValues = {};\n\t}\n\n\tfunction _getDisplayValues(sns, value, option) {\n\t\tvar data = {};\n\n\t\tif (value) {\n\t\t\tvar searchResult;\n\n\t\t\tif (helpers.isArray(value)) {\n\t\t\t\tsearchResult = helpers.arrayFind(value, function(val) {\n\t\t\t\t\treturn (val.resource_id == option.key);\n\t\t\t\t});\n\t\t\t} else if (value.resource_id == option.key) {\n\t\t\t\tsearchResult = value;\n\t\t\t}\n\n\t\t\tif (searchResult) {\n\t\t\t\tdata.value = searchResult.value;\n\t\t\t\tdata.id = searchResult.id;\n\t\t\t}\n\t\t}\n\t\tif (localCache.resourcesValues[sns.id] && localCache.resourcesValues[sns.id][option.key]) {\n\t\t\tdata.value = localCache.resourcesValues[sns.id][option.key].value;\n\t\t\tdata.id = localCache.resourcesValues[sns.id][option.key].id;\n\t\t}\n\t\treturn data;\n\t}\n\n\treturn ResourcesControl;\n};","import TemplateControlConstructor from \"./controls/template_control\";\nimport TextareaControlConstructor from \"./controls/textarea_control\";\nimport TimeControlConstructor from \"./controls/time_control\";\nimport SelectControlConstructor from \"./controls/select_control\";\nimport CheckboxControlConstructor from \"./controls/checkbox_control\";\nimport RadioControlConstructor from \"./controls/radio_control\";\nimport DurationControlConstructor from \"./controls/duration_control\";\nimport ParentControlConstructor from \"./controls/parent_control\";\nimport ResourcesControlConstructor from \"./controls/resources_control\";\nimport ConstraintControlConstructor from \"./controls/constraint_control\";\nimport TypeselectControlConstructor from \"./controls/typeselect_control\";\nimport BaselineControlConstructor from \"./controls/baseline_control\";\n\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport * as helpers from \"../../../utils/helpers\";\n\t\n\nexport default function (gantt) {\n\n\n\tvar TemplateControl = TemplateControlConstructor(gantt);\n\tvar TextareaControl = TextareaControlConstructor(gantt);\n\tvar TimeControl = TimeControlConstructor(gantt);\n\tvar SelectControl = SelectControlConstructor(gantt);\n\tvar CheckboxControl = CheckboxControlConstructor(gantt);\n\tvar RadioControl = RadioControlConstructor(gantt);\n\tvar DurationControl = DurationControlConstructor(gantt);\n\tvar ParentControl = ParentControlConstructor(gantt);\n\tvar ResourcesControl = ResourcesControlConstructor(gantt);\n\tvar ConstraintControl = ConstraintControlConstructor(gantt);\n\tvar TypeselectControl = TypeselectControlConstructor(gantt);\n\tvar BaselineControl = BaselineControlConstructor(gantt);\n\n\tgantt._lightbox_methods = {};\n\tgantt._lightbox_template = \"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span></div><div class='gantt_cal_larea'></div>\";\n\tgantt._lightbox_template = `<div class='gantt_cal_ltitle'><div class=\"dhx_cal_ltitle_descr\"><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='dhx_title'></span>\n</div>\n<div class=\"gantt_cal_ltitle_controls\">\n\t<a class=\"gantt_cal_ltitle_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\n\n</div></div><div class='gantt_cal_larea'></div>`;\n\n\t// GS-1952. Attaching the lightbox to the BODY element is not considered secure.\n\t// Attach it to Gantt container for Salesforce and other secure environments\n\tgantt._lightbox_root = gantt.$root;\n\tfunction setParentNode() {\n\t\tconst cspEnvironment = gantt.config.csp === true;\n\t\tconst salesforceEnvironment = !!window[\"Sfdc\"] || !!window[\"$A\"] || window[\"Aura\"] || ('$shadowResolver$' in document.body);\n\t\tif (cspEnvironment || salesforceEnvironment) {\n\t\t\tgantt._lightbox_root = gantt.$root;\n\t\t} else {\n\t\t\tgantt._lightbox_root = document.body;\n\t\t}\n\t}\n\n\t//TODO: gantt._lightbox_id is changed from data.js and accessed from autoscheduling, check if it can be removed from gantt object\n\tvar state = gantt.$services.getService(\"state\");\n\tstate.registerProvider(\"lightbox\", function () {\n\t\treturn {\n\t\t\tlightbox: gantt._lightbox_id\n\t\t};\n\t});\n\n\tgantt.showLightbox = function (id) {\n\t\tvar task = this.getTask(id);\n\t\tif (!this.callEvent(\"onBeforeLightbox\", [id])) {\n\t\t\tif(gantt.isTaskExists(id) && gantt.getTask(id).$new){\n\t\t\t\t//GS-2340 if 'onBeforeLightbox' returns 'false' need update the order in datastore\n\t\t\t\tthis.$data.tasksStore._updateOrder();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tvar box = this.getLightbox(this.getTaskType(task.type));\n\n\t\tthis.showCover(box);\n\t\tthis._fill_lightbox(id, box);\n\t\tthis._setLbPosition(box);\n\t\tthis._waiAria.lightboxVisibleAttr(box);\n\n\t\tthis.callEvent(\"onLightbox\", [id]);\n\t};\n\n\tfunction _is_chart_visible(gantt) {\n\t\tvar timeline = gantt.$ui.getView(\"timeline\");\n\t\tif (timeline && timeline.isVisible()) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tgantt._get_timepicker_step = function () {\n\t\tif (this.config.round_dnd_dates) {\n\t\t\tvar step;\n\t\t\tif (_is_chart_visible(this)) {\n\t\t\t\tvar scale = gantt.getScale();\n\t\t\t\tstep = (helpers.getSecondsInUnit(scale.unit) * scale.step) / 60;//timepicker step is measured in minutes\n\t\t\t}\n\n\t\t\tif (!step || step >= 60 * 24) {\n\t\t\t\tstep = this.config.time_step;\n\t\t\t}\n\t\t\treturn step;\n\t\t}\n\t\treturn this.config.time_step;\n\t};\n\tgantt.getLabel = function (property, key) {\n\t\tvar sections = this._get_typed_lightbox_config();\n\t\tfor (var i = 0; i < sections.length; i++) {\n\t\t\tif (sections[i].map_to == property) {\n\t\t\t\tvar options = sections[i].options;\n\t\t\t\tfor (var j = 0; j < options.length; j++) {\n\t\t\t\t\tif (options[j].key == key) {\n\t\t\t\t\t\treturn options[j].label;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t};\n\n\tgantt.updateCollection = function (list_name, collection) {\n\t\tcollection = collection.slice(0);\n\t\tvar list = gantt.serverList(list_name);\n\t\tif (!list) return false;\n\t\tlist.splice(0, list.length);\n\t\tlist.push.apply(list, collection || []);\n\t\tgantt.resetLightbox();\n\t};\n\tgantt.getLightboxType = function () {\n\t\treturn this.getTaskType(this._lightbox_type);\n\t};\n\tgantt.getLightbox = function (type) {\n\t\tvar lightboxDiv;\n\t\tvar fullWidth;\n\t\tvar html;\n\t\tvar sns;\n\t\tvar ds;\n\t\tvar classNames = \"\";\n\t\tsetParentNode();\n\n\t\tif (type === undefined)\n\t\t\ttype = this.getLightboxType();\n\n\t\tif (!this._lightbox || this.getLightboxType() != this.getTaskType(type)) {\n\t\t\tthis._lightbox_type = this.getTaskType(type);\n\t\t\tlightboxDiv = document.createElement(\"div\");\n\t\t\tclassNames = \"gantt_cal_light\";\n\t\t\tfullWidth = this._is_lightbox_timepicker();\n\n\t\t\tif (gantt.config.wide_form)\n\t\t\t\tclassNames += \" gantt_cal_light_wide\";\n\n\t\t\tif (fullWidth) {\n\t\t\t\tclassNames += \" gantt_cal_light_full\";\n\t\t\t}\n\n\t\t\tlightboxDiv.className = classNames;\n\n\t\t\tlightboxDiv.style.visibility = \"hidden\";\n\t\t\thtml = this._lightbox_template;\n\t\t\thtml += \"<div class='gantt_cal_lcontrols'>\";\n\t\t\thtml += getHtmlButtons(this.config.buttons_left);\n\t\t\thtml += \"<div class='gantt_cal_lcontrols_push_right'></div>\";\n\t\t\thtml += getHtmlButtons(this.config.buttons_right, true);\n\t\t\thtml += \"</div>\";\n\n\t\t\tlightboxDiv.innerHTML = html;\n\n\t\t\tgantt._waiAria.lightboxAttr(lightboxDiv);\n\n\t\t\tif (gantt.config.drag_lightbox) {\n\t\t\t\tlightboxDiv.firstChild.onmousedown = gantt._ready_to_dnd;\n\t\t\t\tlightboxDiv.firstChild.ontouchstart = function (e){\n\t\t\t\t\tgantt._ready_to_dnd(e.touches[0]);\n\t\t\t\t};\n\t\t\t\tlightboxDiv.firstChild.onselectstart = function () {\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\t\t\t\tlightboxDiv.firstChild.style.cursor = \"pointer\";\n\t\t\t\tgantt._init_dnd_events();\n\t\t\t}\n\n\t\t\t// GS-1428: If there is lightbox node, we need to remove it from the DOM\n\t\t\tif (this._lightbox){\n\t\t\t\tthis.resetLightbox();\n\t\t\t}\n\t\t\tshow_cover();\n\t\t\tthis._cover.insertBefore(lightboxDiv, this._cover.firstChild);\n\t\t\tthis._lightbox = lightboxDiv;\n\n\t\t\tsns = this._get_typed_lightbox_config(type);\n\t\t\thtml = this._render_sections(sns);\n\n\t\t\tds = lightboxDiv.querySelector(\"div.gantt_cal_larea\");\n\t\t\t\n\t\t\t//GS-1131. If gantt_cal_larea is displayed, Firefox renders buttons incorrectly;\n\t\t\tvar backup_overflow = ds.style.overflow;\n\t\t\tds.style.overflow = 'hidden';\n\n\t\t\tds.innerHTML = html;\n\n\t\t\t\n\n\t\t\tbindLabelsToInputs(sns);\n\n\t\t\tds.style.overflow = backup_overflow;\n\n\t\t\tthis._init_lightbox_events(this);\n\t\t\tlightboxDiv.style.display = \"none\";\n\t\t\tlightboxDiv.style.visibility = \"visible\";\n\t\t}\n\t\treturn this._lightbox;\n\t};\n\n\tgantt._render_sections = function (sns) {\n\t\tvar html = \"\";\n\t\tfor (var i = 0; i < sns.length; i++) {\n\t\t\tvar block = this.form_blocks[sns[i].type];\n\t\t\tif (!block) continue; //ignore incorrect blocks\n\t\t\tsns[i].id = \"area_\" + this.uid();\n\n\t\t\tvar display = sns[i].hidden ? \" style='display:none'\" : \"\";\n\t\t\tvar button = \"\";\n\t\t\tif (sns[i].button) {\n\t\t\t\tbutton = \"<div class='gantt_custom_button' data-index='\" + i + \"'><div class='gantt_custom_button_\" + sns[i].button + \"'></div><div class='gantt_custom_button_label'>\" + this.locale.labels[\"button_\" + sns[i].button] + \"</div></div>\";\n\t\t\t}\n\t\t\tif (sns[i].type == \"baselines\") {\n\t\t\t\tbutton = \"<div class='gantt_custom_button gantt_remove_baselines' data-index='\" + i + \"'><div class='gantt_custom_button_delete_baselines'></div><div class='gantt_custom_button_label'>\" + this.locale.labels.baselines_remove_all_button + \"</div></div>\" +\n\t\t\t\t\"<div class='gantt_custom_button gantt_add_baselines' data-index='\" + i + \"'><div class='gantt_custom_button_add_baseline'></div><div class='gantt_custom_button_label'>\" + this.locale.labels.baselines_add_button + \"</div></div>\";\n\t\t\t}\n\t\t\tif (this.config.wide_form) {\n\t\t\t\thtml += \"<div class='gantt_wrap_section' \" + display + \">\";\n\t\t\t}\n\t\t\thtml += \"<div id='\" + sns[i].id + \"' class='gantt_cal_lsection'><label>\" + button + this.locale.labels[\"section_\" + sns[i].name] + \"</label></div>\" + block.render.call(this, sns[i]);\n\t\t\thtml += \"</div>\";\n\t\t}\n\t\treturn html;\n\t};\n\n\tgantt._center_lightbox = function(box){\n\t\tgantt._setLbPosition(box);\n\t};\n\tgantt._setLbPosition = function(box) {\n\t\tif(!box){\n\t\t\treturn;\n\t\t}\n\t\tconst rootElement = gantt._lightbox_root || gantt.$root;\n\t\tbox.style.top = Math.max(rootElement.offsetHeight / 2 - box.offsetHeight/2, 0) + \"px\";\n\t\tbox.style.left = Math.max(rootElement.offsetWidth / 2 - box.offsetWidth/2, 0) + \"px\";\n\t};\n\n\tgantt.showCover = function (box) {\n\t\tif (box){\n\t\t\tbox.style.display=\"block\";\n\t\n\t\t\tthis._setLbPosition(box);\n\t\t}\n\t\tshow_cover();\n\t\tthis._cover.style.display = \"\";\n\t};\n\tconst show_cover=function(){\n\t\tif(gantt._cover) {\n\t\t\treturn;\n\t\t}\n\t\n\t\tgantt._cover=document.createElement(\"div\");\n\t\tgantt._cover.className=\"gantt_cal_cover\";\n\t\tgantt._cover.style.display = \"none\";\n\t\n\t\tgantt.event(gantt._cover, \"mousemove\", gantt._move_while_dnd);\n\t\tgantt.event(gantt._cover, \"mouseup\", gantt._finish_dnd);\n\t\n\t\tconst rootElement = gantt._lightbox_root || gantt.$root;\n\t\trootElement.appendChild(gantt._cover);\n\t};\n\n\tgantt._init_lightbox_events = function () {\n\t\tgantt.lightbox_events = {};\n\n\n\t\tgantt.lightbox_events.gantt_save_btn = function () {\n\t\t\tgantt._save_lightbox();\n\t\t};\n\n\n\t\tgantt.lightbox_events.gantt_delete_btn = function () {\n\t\t\tgantt._lightbox_current_type = null;\n\t\t\tif (!gantt.callEvent(\"onLightboxDelete\", [gantt._lightbox_id]))\n\t\t\t\treturn;\n\n\t\t\tif (gantt.isTaskExists(gantt._lightbox_id)) {\n\t\t\t\tgantt.$click.buttons[\"delete\"](gantt._lightbox_id);\n\t\t\t} else {\n\t\t\t\tgantt.hideLightbox();\n\t\t\t}\n\n\t\t};\n\n\n\t\tgantt.lightbox_events.gantt_cancel_btn = function () {\n\t\t\tgantt._cancel_lightbox();\n\t\t};\n\n\n\t\tgantt.lightbox_events[\"default\"] = function (e, src) {\n\t\t\tif (src.getAttribute(\"data-dhx-button\")) {\n\t\t\t\tgantt.callEvent(\"onLightboxButton\", [src.className, src, e]);\n\t\t\t} else {\n\t\t\t\tvar index, block, sec;\n\n\t\t\t\tvar className = domHelpers.getClassName(src);\n\t\t\t\tif (className.indexOf(\"gantt_custom_button\") != -1) {\n\t\t\t\t\tif (className.indexOf(\"gantt_custom_button_\") != -1) {\n\t\t\t\t\t\tindex = src.parentNode.getAttribute(\"data-index\");\n\t\t\t\t\t\tsec = src;\n\t\t\t\t\t\twhile (sec && domHelpers.getClassName(sec).indexOf(\"gantt_cal_lsection\") == -1) {\n\t\t\t\t\t\t\tsec = sec.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tindex = src.getAttribute(\"data-index\");\n\t\t\t\t\t\tsec = src.closest(\".gantt_cal_lsection\");\n\t\t\t\t\t\tsrc = src.firstChild;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar sections = gantt._get_typed_lightbox_config();\n\n\t\t\t\tif (index) {\n\t\t\t\t\tindex = index * 1;\n\t\t\t\t\tblock = gantt.form_blocks[sections[index * 1].type];\n\t\t\t\t\tblock.button_click(index, src, sec, sec.nextSibling);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tthis.event(gantt.getLightbox(), \"click\", function (e) {\n\t\t\tif(e.target.closest(\".gantt_cal_ltitle_close_btn\")){\n\t\t\t\tgantt._cancel_lightbox();\n\t\t\t}\n\t\t\tvar src = domHelpers.getTargetNode(e);\n\n\t\t\tvar className = domHelpers.getClassName(src);\n\t\t\tif (!className) {\n\t\t\t\tsrc = src.previousSibling;\n\t\t\t\tclassName = domHelpers.getClassName(src);\n\t\t\t}\n\t\t\tif (src && className && className.indexOf(\"gantt_btn_set\") === 0) {\n\t\t\t\tsrc = src.firstChild;\n\t\t\t\tclassName = domHelpers.getClassName(src);\n\t\t\t}\n\t\t\tif (src && className) {\n\t\t\t\tvar func = gantt.defined(gantt.lightbox_events[src.className]) ? gantt.lightbox_events[src.className] : gantt.lightbox_events[\"default\"];\n\t\t\t\treturn func(e, src);\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\tgantt.getLightbox().onkeydown = function (e) {\n\t\t\tvar event = e || window.event;\n\t\t\tvar target = e.target || e.srcElement;\n\t\t\tvar buttonTarget = domHelpers.getClassName(target).indexOf(\"gantt_btn_set\") > -1;\n\n\t\t\tswitch ((e || event).keyCode) {\n\t\t\t\tcase gantt.constants.KEY_CODES.SPACE: {\n\t\t\t\t\tif ((e || event).shiftKey) return;\n\t\t\t\t\tif (buttonTarget && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase gantt.keys.edit_save:\n\t\t\t\t\tif ((e || event).shiftKey) return;\n\t\t\t\t\tif (buttonTarget && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgantt._save_lightbox();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase gantt.keys.edit_cancel:\n\t\t\t\t\tgantt._cancel_lightbox();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t};\n\t};\n\n\tgantt._cancel_lightbox = function () {\n\t\tvar task = this.getLightboxValues();\n\t\tgantt._lightbox_current_type = null;\n\t\tthis.callEvent(\"onLightboxCancel\", [this._lightbox_id, task.$new]);\n\t\tif (gantt.isTaskExists(task.id) && task.$new) {\n\t\t\tthis.silent(function () {\n\t\t\t\tgantt.$data.tasksStore.removeItem(task.id);\n\t\t\t\tgantt._update_flags(task.id, null);\n\t\t\t});\n\t\t\tthis.refreshData();\n\t\t}\n\n\t\tthis.hideLightbox();\n\t};\n\n\tgantt._save_lightbox = function () {\n\t\tvar task = this.getLightboxValues();\n\t\tgantt._lightbox_current_type = null;\n\t\tif (!this.callEvent(\"onLightboxSave\", [this._lightbox_id, task, !!task.$new]))\n\t\t\treturn;\n\n\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks\n\t\t// as they will be recalculated in the `refreshData`\n\t\tgantt.$data.tasksStore._skipTaskRecalculation = \"lightbox\";\n\t\tif (task.$new) {\n\t\t\tdelete task.$new;\n\t\t\tthis.addTask(task, task.parent, this.getTaskIndex(task.id));\n\t\t} else if (this.isTaskExists(task.id)) {\n\t\t\tthis.mixin(this.getTask(task.id), task, true);\n\t\t\tthis.refreshTask(task.id);\n\t\t\tthis.updateTask(task.id);\n\t\t}\n\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\n\t\tthis.refreshData();\n\n\t\t// TODO: do we need any blockable events here to prevent closing lightbox?\n\t\tthis.hideLightbox();\n\t};\n\n\tgantt._resolve_default_mapping = function (section) {\n\t\tvar mapping = section.map_to;\n\t\tvar time_controls = { \"time\": true, \"time_optional\": true, \"duration\": true, \"duration_optional\": true };\n\t\tif (time_controls[section.type]) {\n\t\t\tif (section.map_to == \"auto\") {\n\t\t\t\tmapping = { start_date: \"start_date\", end_date: \"end_date\", duration: \"duration\" };\n\t\t\t} else if (typeof (section.map_to) === \"string\") {\n\t\t\t\tmapping = { start_date: section.map_to };\n\t\t\t}\n\t\t} else if (section.type === \"constraint\") {\n\t\t\tif (!section.map_to || typeof (section.map_to) === \"string\") {\n\t\t\t\tmapping = { constraint_type: \"constraint_type\", constraint_date: \"constraint_date\" };\n\t\t\t}\n\t\t}\n\n\t\treturn mapping;\n\t};\n\n\tgantt.getLightboxValues = function () {\n\t\tvar task = {};\n\n\t\tif (gantt.isTaskExists(this._lightbox_id)) {\n\t\t\ttask = this.mixin({}, this.getTask(this._lightbox_id));\n\t\t}\n\n\t\tvar sns = this._get_typed_lightbox_config();\n\t\tfor (var i = 0; i < sns.length; i++) {\n\t\t\tvar node = gantt._lightbox_root.querySelector(\"#\" + sns[i].id);\n\t\t\tnode = (node ? node.nextSibling : node);\n\t\t\tvar block = this.form_blocks[sns[i].type];\n\t\t\tif (!block) continue;\n\t\t\tvar res = block.get_value.call(this, node, task, sns[i]);\n\t\t\tvar map_to = gantt._resolve_default_mapping(sns[i]);\n\t\t\tif (typeof map_to == \"string\" && map_to != \"auto\") {\n\t\t\t\ttask[map_to] = res;\n\t\t\t} else if (typeof map_to == \"object\") {\n\t\t\t\tfor (var property in map_to) {\n\t\t\t\t\tif (map_to[property])\n\t\t\t\t\t\ttask[map_to[property]] = res[property];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// GS-1282 We need to preserve the task type even if the lightbox doesn't have the typeselect section\n\t\t// GS-2460 set the current type from selector\n\t\tif (gantt._lightbox_current_type) {\n\t\t\ttask.type = gantt._lightbox_current_type;\n\t\t}\n\n\t\treturn task;\n\t};\n\n\n\tgantt.hideLightbox = function () {\n\t\tvar box = this.getLightbox();\n\t\tif (box) box.style.display = \"none\";\n\n\t\tthis._waiAria.lightboxHiddenAttr(box);\n\t\tthis._lightbox_id = null;\n\n\t\tthis.hideCover(box);\n\t\tthis.resetLightbox();\n\t\tthis.callEvent(\"onAfterLightbox\", []);\n\t};\n\tgantt.hideCover = function (box) {\n\t\tif(box){\n\t\t\tbox.style.display = \"none\";\n\t\t}\n\t\tif (this._cover)\n\t\t\tthis._cover.parentNode.removeChild(this._cover);\n\t\tthis._cover = null;\n\t};\n\n\tgantt.resetLightbox = function () {\n\t\tif (gantt._lightbox && !gantt._custom_lightbox)\n\t\t\tgantt._lightbox.remove();\n\t\tgantt._lightbox = null;\n\t};\n\tgantt._set_lightbox_values = function (data, box) {\n\t\tvar task = data;\n\t\tvar s = box.getElementsByTagName(\"span\");\n\t\tvar lightboxHeader = [];\n\t\tif (gantt.templates.lightbox_header) {\n\t\t\tlightboxHeader.push(\"\");\n\t\t\tlightboxHeader.push(gantt.templates.lightbox_header(task.start_date, task.end_date, task));\n\t\t\ts[1].innerHTML = \"\";\n\t\t\ts[2].innerHTML = gantt.templates.lightbox_header(task.start_date, task.end_date, task);\n\t\t} else {\n\t\t\tlightboxHeader.push(this.templates.task_time(task.start_date, task.end_date, task));\n\t\t\tlightboxHeader.push(String(this.templates.task_text(task.start_date, task.end_date, task) || \"\").substr(0, 70)); //IE6 fix\n\t\t\ts[1].innerHTML = this.templates.task_time(task.start_date, task.end_date, task);\n\t\t\ts[2].innerHTML = String(this.templates.task_text(task.start_date, task.end_date, task) || \"\").substr(0, 70); //IE6 fix\n\t\t}\n\t\ts[1].innerHTML = lightboxHeader[0];\n\t\ts[2].innerHTML = lightboxHeader[1];\n\n\t\tgantt._waiAria.lightboxHeader(box, lightboxHeader.join(\" \"));\n\n\t\tvar sns = this._get_typed_lightbox_config(this.getLightboxType());\n\t\tfor (var i = 0; i < sns.length; i++) {\n\t\t\tvar section = sns[i];\n\n\t\t\tif (!this.form_blocks[section.type]) {\n\t\t\t\tcontinue;//skip incorrect sections, same check is done during rendering\n\t\t\t}\n\n\n\t\t\tvar node = gantt._lightbox_root.querySelector(\"#\" + section.id).nextSibling;\n\t\t\tvar block = this.form_blocks[section.type];\n\t\t\tvar map_to = gantt._resolve_default_mapping(sns[i]);\n\t\t\tvar value = this.defined(task[map_to]) ? task[map_to] : section.default_value;\n\t\t\tblock.set_value.call(gantt, node, value, task, section);\n\n\t\t\tif (section.focus)\n\t\t\t\tblock.focus.call(gantt, node);\n\t\t}\n\t\tif (gantt.isTaskExists(data.id)){\n\t\t\tgantt._lightbox_id = data.id;\n\t\t}\n\t};\n\tgantt._fill_lightbox = function (id, box) {\n\t\tvar task = this.getTask(id);\n\t\tthis._set_lightbox_values(task, box);\n\t};\n\n\n\tgantt.getLightboxSection = function (name) {\n\t\tvar config = this._get_typed_lightbox_config();\n\t\tvar i = 0;\n\t\tfor (i; i < config.length; i++)\n\t\t\tif (config[i].name == name)\n\t\t\t\tbreak;\n\t\tvar section = config[i];\n\t\tif (!section)\n\t\t\treturn null;\n\n\t\tif (!this._lightbox)\n\t\t\tthis.getLightbox();\n\t\tvar header = gantt._lightbox_root.querySelector(\"#\" + section.id);\n\t\tvar node = header.nextSibling;\n\n\t\tvar result = {\n\t\t\tsection: section,\n\t\t\theader: header,\n\t\t\tnode: node,\n\t\t\tgetValue: function (ev) {\n\t\t\t\treturn gantt.form_blocks[section.type].get_value.call(gantt, node, (ev || {}), section);\n\t\t\t},\n\t\t\tsetValue: function (value, ev) {\n\t\t\t\treturn gantt.form_blocks[section.type].set_value.call(gantt, node, value, (ev || {}), section);\n\t\t\t}\n\t\t};\n\n\t\tvar handler = this._lightbox_methods[\"get_\" + section.type + \"_control\"];\n\t\treturn handler ? handler(result) : result;\n\t};\n\n\tgantt._lightbox_methods.get_template_control = function (result) {\n\t\tresult.control = result.node;\n\t\treturn result;\n\t};\n\tgantt._lightbox_methods.get_select_control = function (result) {\n\t\tresult.control = result.node.getElementsByTagName(\"select\")[0];\n\t\treturn result;\n\t};\n\tgantt._lightbox_methods.get_textarea_control = function (result) {\n\t\tresult.control = result.node.getElementsByTagName(\"textarea\")[0];\n\t\treturn result;\n\t};\n\tgantt._lightbox_methods.get_time_control = function (result) {\n\t\tresult.control = result.node.getElementsByTagName(\"select\"); // array\n\t\treturn result;\n\t};\n\n\n\tgantt._init_dnd_events = function () {\n\t\tvar eventElement = gantt._lightbox_root;\n\t\tthis.event(eventElement, \"mousemove\", gantt._move_while_dnd);\n\t\tthis.event(eventElement, \"mouseup\", gantt._finish_dnd);\n\t\tthis.event(eventElement, \"touchmove\", function (e){\n\t\t\tgantt._move_while_dnd(e.touches[0]);\n\t\t});\n\t\tthis.event(eventElement, \"touchend\", function (e){\n\t\t\tgantt._finish_dnd(e.touches[0]);\n\t\t});\n\t\t// GS-1952: In Salesforce environment, the lightbox is attached to the Gantt container. \n\t\t// So when Gantt is reinitialized, the events are no longer attached to the Gantt container.\n\t\t// gantt._init_dnd_events = function () {\n\t\t// };\n\t};\n\tgantt._move_while_dnd = function (event) {\n\t\tif (gantt._dnd_start_lb) {\n\t\t\tif (!document.gantt_unselectable) {\n\t\t\t\tgantt._lightbox_root.className += \" gantt_unselectable\";\n\t\t\t\tdocument.gantt_unselectable = true;\n\t\t\t}\n\t\t\tvar lb = gantt.getLightbox();\n\t\t\tvar now = [event.pageX, event.pageY];\n\t\t\tlb.style.top = gantt._lb_start[1] + now[1] - gantt._dnd_start_lb[1] + \"px\";\n\t\t\tlb.style.left = gantt._lb_start[0] + now[0] - gantt._dnd_start_lb[0] + \"px\";\n\t\t}\n\t};\n\tgantt._ready_to_dnd = function (event) {\n\t\tvar lb = gantt.getLightbox();\n\t\tgantt._lb_start = [lb.offsetLeft, lb.offsetTop];\n\t\tgantt._dnd_start_lb = [event.pageX, event.pageY];\n\t};\n\tgantt._finish_dnd = function () {\n\t\tif (gantt._lb_start) {\n\t\t\tgantt._lb_start = gantt._dnd_start_lb = false;\n\t\t\tgantt._lightbox_root.className = gantt._lightbox_root.className.replace(\" gantt_unselectable\", \"\");\n\t\t\tdocument.gantt_unselectable = false;\n\t\t}\n\t};\n\n\n\tgantt._focus = function (node, select) {\n\t\tif (node && node.focus) {\n\t\t\tif (gantt.config.touch) {\n\t\t\t\t//do not focus editor, to prevent auto-zoom\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\tif (select && node.select) node.select();\n\t\t\t\t\tnode.focus();\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// silent errors\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\n\tgantt.form_blocks = {\n\t\tgetTimePicker: function (sns, hidden) {\n\t\t\tvar html = \"\";\n\t\t\tvar cfg = this.config;\n\t\t\tvar i;\n\t\t\tvar options;\n\t\t\tvar ariaAttrs;\n\t\t\tvar readonly;\n\t\t\tvar display;\n\t\t\tvar settings = {\n\t\t\t\tfirst: 0,\n\t\t\t\tlast: 24 * 60,\n\t\t\t\tdate: this.date.date_part(new Date(gantt._min_date.valueOf())),\n\t\t\t\ttimeFormat: getTimeFormat(sns)\n\t\t\t};\n\n\t\t\t// map: default order => real one\n\t\t\tsns._time_format_order = { size: 0 };\n\n\t\t\tif (gantt.config.limit_time_select) {\n\t\t\t\tsettings.first = 60 * cfg.first_hour;\n\t\t\t\tsettings.last = 60 * cfg.last_hour + 1;\n\t\t\t\tsettings.date.setHours(cfg.first_hour);\n\t\t\t}\n\n\t\t\tfor (i = 0; i < settings.timeFormat.length; i++) {\n\t\t\t\t// adding spaces between selects\n\t\t\t\tif (i > 0) {\n\t\t\t\t\thtml += \" \";\n\t\t\t\t}\n\n\t\t\t\toptions = getHtmlTimePickerOptions(sns, i, settings);\n\n\t\t\t\tif (options) {\n\t\t\t\t\tariaAttrs = gantt._waiAria.lightboxSelectAttrString(settings.timeFormat[i]);\n\t\t\t\t\treadonly = sns.readonly ? \"disabled='disabled'\" : \"\";\n\t\t\t\t\tdisplay = hidden ? \" style='display:none' \" : \"\";\n\t\t\t\t\thtml += \"<select \" + readonly + display + ariaAttrs + \">\" + options + \"</select>\";\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn html;\n\t\t},\n\t\tgetTimePickerValue: function (selects, config, offset) {\n\t\t\tvar map = config._time_format_order;\n\t\t\tvar needSetTime = gantt.defined(map[3]);\n\n\t\t\tvar time;\n\t\t\tvar hours = 0;\n\t\t\tvar minutes = 0;\n\n\t\t\tvar mapOffset = offset || 0;\n\n\t\t\tif (needSetTime) {\n\t\t\t\ttime = parseInt(selects[map[3] + mapOffset].value, 10);\n\t\t\t\thours = Math.floor(time / 60);\n\t\t\t\tminutes = time % 60;\n\t\t\t}\n\t\t\treturn new Date(selects[map[2] + mapOffset].value, selects[map[1] + mapOffset].value, selects[map[0] + mapOffset].value, hours, minutes);\n\t\t},\n\n\t\t_fill_lightbox_select: function (s, i, d, map) {\n\t\t\ts[i + map[0]].value = d.getDate();\n\t\t\ts[i + map[1]].value = d.getMonth();\n\t\t\ts[i + map[2]].value = d.getFullYear();\n\t\t\tif (gantt.defined(map[3])) {\n\t\t\t\tvar v = d.getHours() * 60 + d.getMinutes();\n\t\t\t\tv = Math.round(v / gantt._get_timepicker_step()) * gantt._get_timepicker_step();\n\t\t\t\tvar input = s[i + map[3]];\n\t\t\t\tinput.value = v;\n\t\t\t\t//in case option not shown\n\t\t\t\tinput.setAttribute(\"data-value\", v);\n\t\t\t}\n\t\t},\n\t\ttemplate: new TemplateControl(),\n\t\ttextarea: new TextareaControl(),\n\t\tselect: new SelectControl(),\n\t\ttime: new TimeControl(),\n\t\tduration: new DurationControl(),\n\t\tparent: new ParentControl(),\n\t\tradio: new RadioControl(),\n\t\tcheckbox: new CheckboxControl(),\n\t\tresources: new ResourcesControl(),\n\t\tconstraint: new ConstraintControl(),\n\t\tbaselines: new BaselineControl(),\n\t\ttypeselect: new TypeselectControl()\n\t};\n\n\tgantt._is_lightbox_timepicker = function () {\n\t\tvar s = this._get_typed_lightbox_config();\n\t\tfor (var i = 0; i < s.length; i++)\n\t\t\tif (s[i].name == \"time\" && s[i].type == \"time\")\n\t\t\t\treturn true;\n\t\treturn false;\n\t};\n\n\tgantt._simple_confirm = function (message, title, callback, ok) {\n\t\tif (!message)\n\t\t\treturn callback();\n\t\tvar opts = { text: message };\n\t\tif (title)\n\t\t\topts.title = title;\n\t\tif (ok) {\n\t\t\topts.ok = ok;\n\t\t}\n\t\tif (callback) {\n\t\t\topts.callback = function (result) {\n\t\t\t\tif (result)\n\t\t\t\t\tcallback();\n\t\t\t};\n\t\t}\n\t\tgantt.confirm(opts);\n\t};\n\n\tfunction _get_type_name(type_value) {\n\t\tfor (var i in this.config.types) {\n\t\t\tif (this.config.types[i] == type_value) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn \"task\";\n\t}\n\n\tgantt._get_typed_lightbox_config = function (type) {\n\t\tif (type === undefined) {\n\t\t\ttype = this.getLightboxType();\n\t\t}\n\n\t\tvar field = _get_type_name.call(this, type);\n\n\t\tif (gantt.config.lightbox[field + \"_sections\"]) {\n\t\t\treturn gantt.config.lightbox[field + \"_sections\"];\n\t\t} else {\n\t\t\treturn gantt.config.lightbox.sections;\n\t\t}\n\t};\n\n\tgantt._silent_redraw_lightbox = function (type) {\n\t\tvar oldType = this.getLightboxType();\n\n\t\tif (this.getState().lightbox) {\n\t\t\tvar taskId = this.getState().lightbox;\n\t\t\tvar formData = this.getLightboxValues(),\n\t\t\t\ttask = this.copy(this.getTask(taskId));\n\n\t\t\tthis.resetLightbox();\n\n\t\t\tvar updTask = this.mixin(task, formData, true);\n\t\t\tvar box = this.getLightbox(type ? type : undefined);\n\t\t\tthis._set_lightbox_values(updTask, box);\n\t\t\tthis.showCover(box);\n\t\t} else {\n\t\t\tthis.resetLightbox();\n\t\t\tthis.getLightbox(type ? type : undefined);\n\t\t}\n\t\tthis.callEvent(\"onLightboxChange\", [oldType, this.getLightboxType()]);\n\t};\n\n\tfunction bindLabelsToInputs(sns) {\n\t\tvar section;\n\t\tvar label;\n\t\tvar labelBlock;\n\t\tvar inputBlock;\n\t\tvar input;\n\t\tvar i;\n\n\t\tfor (i = 0; i < sns.length; i++) {\n\t\t\tsection = sns[i];\n\t\t\tlabelBlock = gantt._lightbox_root.querySelector(\"#\" + section.id);\n\n\t\t\tif (!section.id || !labelBlock) continue;\n\n\t\t\tlabel = labelBlock.querySelector(\"label\");\n\t\t\tinputBlock = labelBlock.nextSibling;\n\n\t\t\tif (!inputBlock) continue;\n\n\t\t\tinput = inputBlock.querySelector(\"input, select, textarea\");\n\t\t\tif (input) {\n\t\t\t\tinput.id = input.id || \"input_\" + gantt.uid();\n\t\t\t\tsection.inputId = input.id;\n\t\t\t\tlabel.setAttribute(\"for\", section.inputId);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getHtmlButtons(buttons, floatRight) {\n\t\tvar button;\n\t\tvar ariaAttr;\n\t\tvar html = \"\";\n\t\tvar i;\n\n\t\tfor (i = 0; i < buttons.length; i++) {\n\t\t\t// needed to migrate from 'dhx_something' to 'gantt_something' naming in a lightbox\n\t\t\tbutton = gantt.config._migrate_buttons[buttons[i]] ? gantt.config._migrate_buttons[buttons[i]] : buttons[i];\n\n\t\t\tariaAttr = gantt._waiAria.lightboxButtonAttrString(button);\n\t\t\thtml += \"<div \" + ariaAttr + \" class='gantt_btn_set gantt_left_btn_set \" + button + \"_set'\" + \"><div dhx_button='1' data-dhx-button='1' class='\" + button + \"'></div><div>\" + gantt.locale.labels[button] + \"</div></div>\";\n\t\t}\n\t\treturn html;\n\t}\n\n\tfunction getTimeFormat(sns) {\n\t\tvar scale;\n\t\tvar unit;\n\t\tvar result;\n\n\t\tif (sns.time_format) return sns.time_format;\n\n\t\t// default order\n\t\tresult = [\"%d\", \"%m\", \"%Y\"];\n\t\tscale = gantt.getScale();\n\t\tunit = scale ? scale.unit : gantt.config.duration_unit;\n\t\tif (helpers.getSecondsInUnit(unit) < helpers.getSecondsInUnit(\"day\")) {\n\t\t\tresult.push(\"%H:%i\");\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction getHtmlTimePickerOptions(sns, index, settings) {\n\t\tvar range;\n\t\tvar offset;\n\t\tvar start_year;\n\t\tvar end_year;\n\t\tvar i;\n\t\tvar time;\n\t\tvar diff;\n\t\tvar tdate;\n\t\tvar html = \"\";\n\n\t\tswitch (settings.timeFormat[index]) {\n\t\t\tcase \"%Y\":\n\t\t\t\tsns._time_format_order[2] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//year\n\n\t\t\t\tif (sns.year_range) {\n\t\t\t\t\tif (!isNaN(sns.year_range)) {\n\t\t\t\t\t\trange = sns.year_range;\n\t\t\t\t\t} else if (sns.year_range.push) {\n\t\t\t\t\t\t// if\n\t\t\t\t\t\tstart_year = sns.year_range[0];\n\t\t\t\t\t\tend_year = sns.year_range[1];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trange = range || 10;\n\t\t\t\toffset = offset || Math.floor(range / 2);\n\t\t\t\tstart_year = start_year || settings.date.getFullYear() - offset;\n\t\t\t\tend_year = end_year || gantt.getState().max_date.getFullYear() + offset;\n\n\t\t\t\tfor (i = start_year; i <= end_year; i++)\n\t\t\t\t\thtml += \"<option value='\" + (i) + \"'>\" + (i) + \"</option>\";\n\t\t\t\tbreak;\n\t\t\tcase \"%m\":\n\t\t\t\tsns._time_format_order[1] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//month\n\t\t\t\tfor (i = 0; i < 12; i++)\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + gantt.locale.date.month_full[i] + \"</option>\";\n\t\t\t\tbreak;\n\t\t\tcase \"%d\":\n\t\t\t\tsns._time_format_order[0] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//days\n\t\t\t\tfor (i = 1; i < 32; i++)\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + i + \"</option>\";\n\t\t\t\tbreak;\n\t\t\tcase \"%H:%i\":\n\t\t\t\t//  var last = 24*60, first = 0;\n\t\t\t\tsns._time_format_order[3] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//hours\n\t\t\t\ti = settings.first;\n\t\t\t\ttdate = settings.date.getDate();\n\t\t\t\tsns._time_values = [];\n\n\t\t\t\twhile (i < settings.last) {\n\t\t\t\t\ttime = gantt.templates.time_picker(settings.date);\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + time + \"</option>\";\n\t\t\t\t\tsns._time_values.push(i);\n\t\t\t\t\tsettings.date.setTime(settings.date.valueOf() + gantt._get_timepicker_step() * 60 * 1000);\n\t\t\t\t\tdiff = (settings.date.getDate() != tdate) ? 1 : 0; // moved or not to the next day\n\t\t\t\t\ti = diff * 24 * 60 + settings.date.getHours() * 60 + settings.date.getMinutes();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn html;\n\t}\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TemplateControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\t\treturn self; \n\t}\n\n\t__extends(TemplateControl, _super);\n\n\n\tTemplateControl.prototype.render = function(sns) {\n\t\tlet height = sns.height ? `${sns.height}px` : '';\n\t\treturn `<div class='gantt_cal_ltext gantt_cal_template gantt_section_${sns.name}' ${height ? `style='height:${height};'` : ''}></div>`;\n\t};\n\n\tTemplateControl.prototype.set_value = function(node, value) {\n\t\tnode.innerHTML = value || \"\";\n\t};\n\n\tTemplateControl.prototype.get_value = function(node) {\n\t\treturn node.innerHTML || \"\";\n\t};\n\n\tTemplateControl.prototype.focus = function() {};\n\n\treturn TemplateControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TextareaControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self; \n\t}\n\n\t__extends(TextareaControl, _super);\n\n\tTextareaControl.prototype.render = function(sns) {\n\t\tconst height = (sns.height || \"130\") + \"px\";\n\t\tconst placeholder = sns.placeholder ? `placeholder='${sns.placeholder}'` : \"\";\n\t\treturn `<div class='gantt_cal_ltext gantt_section_${sns.name}' style='height:${height};' ${placeholder}><textarea></textarea></div>`;\n\t};\n\n\tTextareaControl.prototype.set_value = function(node, value) {\n\t\tgantt.form_blocks.textarea._get_input(node).value = value || \"\";\n\t};\n\n\tTextareaControl.prototype.get_value = function(node) {\n\t\treturn gantt.form_blocks.textarea._get_input(node).value;\n\t};\n\n\tTextareaControl.prototype.focus = function(node) {\n\t\tvar a = gantt.form_blocks.textarea._get_input(node);\n\t\tgantt._focus(a, true);\n\t};\n\n\tTextareaControl.prototype._get_input = function(node) {\n\t\treturn node.querySelector(\"textarea\");\n\t};\n\n\treturn TextareaControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TimeControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(TimeControl, _super);\n\n\tTimeControl.prototype.render = function (sns) {\n\t\tvar time = gantt.form_blocks.getTimePicker.call(this, sns);\n\t\tlet sectionClassName = \"gantt_section_time\";\n\t\tif (sns.name !== \"time\"){\n\t\t\tsectionClassName += \" gantt_section_\" + sns.name;\n\t\t}\n\t\tvar html = \"<div style='padding-top:0px;font-size:inherit;text-align:center;' class='\" + sectionClassName + \"'>\";\n\t\thtml += time;\n\n\t\tif (sns.single_date) {\n\t\t\ttime = gantt.form_blocks.getTimePicker.call(this, sns, true);\n\t\t\thtml += \"<span></span>\";\n\t\t} else {\n\t\t\thtml += \"<span class='gantt_section_time_spacer'> &nbsp;&ndash;&nbsp; </span>\";\n\t\t}\n\n\t\thtml += time;\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tTimeControl.prototype.set_value = function (node, value, ev, config) {\n\t\tvar cfg = config;\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar map = config._time_format_order;\n\n\t\tif (cfg.auto_end_date) {\n\t\t\tvar _update_lightbox_select = function () {\n\t\t\t\tstart_date = new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, 0, 0);\n\t\t\t\tend_date = gantt.calculateEndDate({ start_date: start_date, duration: 1, task: ev });\n\t\t\t\tgantt.form_blocks._fill_lightbox_select(s, map.size, end_date, map, cfg);\n\t\t\t};\n\t\t\tfor (var i = 0; i < 4; i++) {\n\t\t\t\ts[i].onchange = _update_lightbox_select;\n\t\t\t}\n\t\t}\n\n\t\tvar mapping = gantt._resolve_default_mapping(config);\n\n\t\tif (typeof (mapping) === \"string\") mapping = { start_date: mapping };\n\n\t\tvar start_date = ev[mapping.start_date] || new Date();\n\t\tvar end_date = ev[mapping.end_date] || gantt.calculateEndDate({\n\t\t\tstart_date: start_date,\n\t\t\tduration: 1,\n\t\t\ttask: ev\n\t\t});\n\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, cfg);\n\t\tgantt.form_blocks._fill_lightbox_select(s, map.size, end_date, map, cfg);\n\t};\n\n\tTimeControl.prototype.get_value = function (node, ev, config) {\n\t\tvar selects = node.getElementsByTagName(\"select\");\n\t\tvar startDate;\n\t\tvar map = config._time_format_order;\n\t\tfunction _getEndDate(selects, map, startDate) {\n\t\t\tvar endDate = gantt.form_blocks.getTimePickerValue(selects, config, map.size);\n\t\t\t// GS-1010: We need to add a way to obtain exact end_date for validation\n\t\t\tif (endDate <= startDate) {  // when end date seems wrong\n\t\t\t\tif (config.autofix_end !== false || config.single_date) { // auto correct it in two cases - when the auto correction is not disabled, or when we have 'single date' control and the user don't have the UI to specify the end date\n\t\t\t\t\treturn gantt.date.add(startDate, gantt._get_timepicker_step(), \"minute\");\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn endDate;\n\t\t}\n\n\t\tstartDate = gantt.form_blocks.getTimePickerValue(selects, config);\n\n\t\tif (typeof gantt._resolve_default_mapping(config) === \"string\") {\n\t\t\treturn startDate;\n\t\t}\n\n\t\treturn {\n\t\t\tstart_date: startDate,\n\t\t\tend_date: _getEndDate(selects, map, startDate)\n\t\t};\n\t};\n\n\tTimeControl.prototype.focus = function (node) {\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\n\t};\n\n\treturn TimeControl;\n};","import * as helpers from \"../../../../utils/helpers\";\nimport __extends from \"../../../../utils/extends\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction CheckboxControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self; \n\t}\n\n\t__extends(CheckboxControl, _super);\n\n\tCheckboxControl.prototype.render = function(sns) {\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_cal_lcheckbox gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\n\n\t\tif (sns.options && sns.options.length) {\n\t\t\tfor (var i = 0; i < sns.options.length; i++) {\n\t\t\t\thtml += \"<label><input type='checkbox' value='\" + sns.options[i].key + \"' name='\" + sns.name + \"'>\" + sns.options[i].label + \"</label>\";\n\t\t\t}\n\t\t}else{\n\t\t\tsns.single_value = true;\n\t\t\thtml += \"<label><input type='checkbox' name='\" + sns.name + \"'></label>\";\n\t\t}\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tCheckboxControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar checkboxes = Array.prototype.slice.call(node.querySelectorAll(\"input[type=checkbox]\"));\n\n\t\tif (!node._dhx_onchange && sns.onchange) {\n\t\t\tnode.onchange = sns.onchange;\n\t\t\tnode._dhx_onchange = true;\n\t\t}\n\n\t\tif(sns.single_value){\n\t\t\tvar box = checkboxes[0];\n\t\t\tbox.checked = !!value;\n\t\t}else{\n\t\t\thelpers.forEach(checkboxes, function(entry) {\n\t\t\t\tentry.checked = value ? value.indexOf(entry.value) >= 0 : false;\n\t\t\t});\n\t\t}\n\t};\n\n\tCheckboxControl.prototype.get_value = function(node, task, sns) {\n\t\tif(sns.single_value){\n\t\t\tvar box = node.querySelector(\"input[type=checkbox]\");\n\t\t\treturn box.checked;\n\t\t}else{\n\t\t\treturn helpers.arrayMap(Array.prototype.slice.call(node.querySelectorAll(\"input[type=checkbox]:checked\")), function(entry) {\n\t\t\t\treturn entry.value;\n\t\t\t});\n\t\t}\n\t};\n\n\tCheckboxControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.querySelector(\"input[type=checkbox]\"));\n\t};\n\n\treturn CheckboxControl;\n};","import __extends from \"../../../../utils/extends\";\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction RadioControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self; \n\t}\n\n\t__extends(RadioControl, _super);\n\n\tRadioControl.prototype.render = function(sns) {\n\t\tconst height = sns.height ? `${sns.height}px` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_cal_lradio gantt_section_${sns.name}' ${height ? `style='height:${height};'` : ''}>`;\n\n\t\tif (sns.options && sns.options.length) {\n\t\t\tfor (var i = 0; i < sns.options.length; i++) {\n\t\t\t\thtml += \"<label><input type='radio' value='\" + sns.options[i].key + \"' name='\" + sns.name + \"'>\" + sns.options[i].label + \"</label>\";\n\t\t\t}\n\t\t}\n\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tRadioControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar radio;\n\n\t\tif (!sns.options || !sns.options.length) return;\n\n\t\tradio = node.querySelector(\"input[type=radio][value='\" + value + \"']\") ||\n\t\t\t\tnode.querySelector(\"input[type=radio][value='\" + sns.default_value + \"']\");\n\n\t\tif (!radio) return;\n\n\t\tif (!node._dhx_onchange && sns.onchange) {\n\t\t\tnode.onchange = sns.onchange;\n\t\t\tnode._dhx_onchange = true;\n\t\t}\n\n\t\tradio.checked = true;\n\t};\n\n\tRadioControl.prototype.get_value = function(node, ev) {\n\t\tvar result = node.querySelector(\"input[type=radio]:checked\");\n\n\t\treturn result ? result.value : \"\";\n\t};\n\n\tRadioControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.querySelector(\"input[type=radio]\"));\n\t};\n\n\treturn RadioControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport DurationFormatterNumeric from  \"../../../common/duration_formatter_numeric\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction DurationControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\n\t\treturn self; \n\t}\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || new DurationFormatterNumeric();\n\t}\n\n\t__extends(DurationControl, _super);\n\n\tDurationControl.prototype.render = function(sns) {\n\t\tvar time = \"<div class='gantt_time_selects'>\" + gantt.form_blocks.getTimePicker.call(this, sns) + \"</div>\";\n\t\tvar label = \" \"+ gantt.locale.labels[gantt.config.duration_unit + \"s\"] +\" \";\n\t\tvar singleDate = sns.single_date ? \" style='display:none'\" : \"\";\n\t\tvar readonly = sns.readonly ? \" disabled='disabled'\" : \"\";\n\t\tvar ariaAttr = gantt._waiAria.lightboxDurationInputAttrString(sns);\n\n\t\tvar durationInputClass = \"gantt_duration_value\";\n\t\tif(sns.formatter) {\n\t\t\tlabel = \"\";\n\t\t\tdurationInputClass += \" gantt_duration_value_formatted\" ;\n\t\t}\n\n\t\tvar duration = \"<div class='gantt_duration' \" + singleDate + \">\" +\n\t\t\"<div class='gantt_duration_inputs'>\" +\n\t\t\t\"<input type='button' class='gantt_duration_dec' value='−'\" + readonly + \">\" +\n\t\t\t\"<input type='text' value='5days' class='\"+durationInputClass+\"'\" + readonly + \" \" + ariaAttr + \">\" +\n\t\t\t\"<input type='button' class='gantt_duration_inc' value='+'\" + readonly + \">\"+\n\t\t\t\"</div>\" +\n\t\t\t\"<div class='gantt_duration_end_date'>\"+label+\"<span></span></div>\" +\n\t\t\t\"</div>\" +\n\t\t\t\"</div>\";\n\t\tlet sectionClassName = \"gantt_section_time gantt_section_duration\";\n\t\tif (sns.name !== \"time\"){\n\t\t\tsectionClassName += \" gantt_section_\" + sns.name;\n\t\t}\t\n\t\tvar html = \"<div style='padding-top:0px;font-size:inherit;' class='\" + sectionClassName + \"'>\" + time + \" \" + duration + \"</div>\";\n\t\treturn html;\n\t};\n\n\tDurationControl.prototype.set_value = function(node, value, ev, config) {\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar inps = node.getElementsByTagName(\"input\");\n\t\tvar duration = inps[1];\n\t\tvar btns = [inps[0], inps[2]];\n\t\tvar endspan = node.getElementsByTagName(\"span\")[0];\n\t\tvar map = config._time_format_order;\n\t\tvar mapping;\n\t\tvar start_date;\n\t\tvar end_date;\n\t\tvar duration_val;\n\n\t\tfunction _calc_date() {\n\t\t\tvar start_date = _getStartDate.call(gantt, node, config);\n\t\t\tvar duration = _getDuration.call(gantt, node, config);\n\t\t\tvar end_date = gantt.calculateEndDate({start_date: start_date, duration: duration, task: ev});\n\n\t\t\tvar template = gantt.templates.task_end_date || gantt.templates.task_date;\n\t\t\tendspan.innerHTML = template(end_date);\n\t\t}\n\n\t\tfunction _change_duration(step) {\n\t\t\tvar value = duration.value;\n\n\t\t\tvalue = getFormatter(config).parse(value);\n\t\t\tif (window.isNaN(value))\n\t\t\t\tvalue = 0;\n\t\t\tvalue += step;\n\t\t\tif (value < 1) value = 1;\n\t\t\tduration.value = getFormatter(config).format(value);\n\t\t\t_calc_date();\n\t\t}\n\n\t\tbtns[0].onclick = gantt.bind(function() {\n\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t}, this);\n\t\tbtns[1].onclick = gantt.bind(function() {\n\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t}, this);\n\t\ts[0].onchange = _calc_date;\n\t\ts[1].onchange = _calc_date;\n\t\ts[2].onchange = _calc_date;\n\t\tif (s[3]) s[3].onchange = _calc_date;\n\n\t\tduration.onkeydown = gantt.bind(function(e) {\n\t\t\tvar code; \n\n\t\t\te = e || window.event;\n\t\t\tcode = (e.charCode || e.keyCode || e.which);\n\t\t\t\n\t\t\tif (code == gantt.constants.KEY_CODES.DOWN) {\n\t\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (code == gantt.constants.KEY_CODES.UP) {\n\t\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\twindow.setTimeout(_calc_date, 1);\n\t\t}, this);\n\n\t\tduration.onchange = gantt.bind(_calc_date, this);\n\n\t\tmapping = gantt._resolve_default_mapping(config);\n\t\tif (typeof(mapping) === \"string\") mapping = {start_date: mapping};\n\n\t\tstart_date = ev[mapping.start_date] || new Date();\n\t\tend_date = ev[mapping.end_date] || gantt.calculateEndDate({\n\t\t\tstart_date: start_date,\n\t\t\tduration: 1,\n\t\t\ttask: ev\n\t\t});\n\t\tduration_val = Math.round(ev[mapping.duration]) || gantt.calculateDuration({\n\t\t\tstart_date: start_date,\n\t\t\tend_date: end_date,\n\t\t\ttask: ev\n\t\t});\n\t\tduration_val = getFormatter(config).format(duration_val);\n\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, config);\n\t\tduration.value = duration_val;\n\t\t_calc_date();\n\t};\n\n\tDurationControl.prototype.get_value = function(node, ev, config) {\n\t\tvar startDate = _getStartDate(node, config);\n\t\tvar duration = _getDuration(node, config);\n\t\tvar endDate = gantt.calculateEndDate({start_date: startDate, duration: duration, task: ev});\n\n\t\tif (typeof gantt._resolve_default_mapping(config) == \"string\") {\n\t\t\treturn startDate;\n\t\t}\n\n\t\treturn {\n\t\t\tstart_date: startDate,\n\t\t\tend_date: endDate,\n\t\t\tduration: duration\n\t\t};\n\t};\n\n\tDurationControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\n\t};\n\n\n\tfunction _getStartDate(node, config) {\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar map = config._time_format_order;\n\t\tvar hours = 0;\n\t\tvar minutes = 0;\n\n\t\tif (gantt.defined(map[3])) {\n\t\t\tvar input = s[map[3]];\n\t\t\tvar time = parseInt(input.value, 10);\n\t\t\tif (isNaN(time) && input.hasAttribute(\"data-value\")) {\n\t\t\t\ttime = parseInt(input.getAttribute(\"data-value\"), 10);\n\t\t\t}\n\n\t\t\thours = Math.floor(time / 60);\n\t\t\tminutes = time % 60;\n\t\t}\n\t\treturn new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, hours, minutes);\n\t}\n\n\tfunction _getDuration(node, config) {\n\t\tvar duration = node.getElementsByTagName(\"input\")[1];\n\n\t\tduration = getFormatter(config).parse(duration.value);\n\t\tif (!duration || window.isNaN(duration)) duration = 1;\n\t\tif (duration < 0) duration *= -1;\n\t\treturn duration;\n\t}\n\n\treturn DurationControl; \n};","import __extends from \"../../../../utils/extends\";\nimport htmlHelpers from \"../../utils/html_helpers\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction ConstraintControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(ConstraintControl, _super);\n\n\tfunction isNonTimedConstraint(value) {\n\t\tif (!value || value === gantt.config.constraint_types.ASAP || value === gantt.config.constraint_types.ALAP) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tfunction toggleTimeSelect(timeSelects, typeValue) {\n\t\tvar isNonTimed = isNonTimedConstraint(typeValue);\n\t\tfor (var i = 0; i < timeSelects.length; i++) {\n\t\t\ttimeSelects[i].disabled = isNonTimed;\n\t\t}\n\t}\n\n\tConstraintControl.prototype.render = function (sns) {\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\n\n\t\tvar options = [];\n\t\tfor (var i in gantt.config.constraint_types) {\n\t\t\toptions.push({ key: gantt.config.constraint_types[i], label: gantt.locale.labels[gantt.config.constraint_types[i]] });\n\t\t}\n\n\t\tsns.options = sns.options || options;\n\n\t\thtml += \"<span data-constraint-type-select>\" + htmlHelpers.getHtmlSelect(sns.options, [{ key: \"data-type\", value: \"constraint-type\" }]) + \"</span>\";\n\n\t\tvar timeLabel = gantt.locale.labels[\"constraint_date\"] || \"Constraint date\";\n\t\thtml += \"<label data-constraint-time-select>\" + timeLabel + \": \" + gantt.form_blocks.getTimePicker.call(this, sns) + \"</label>\";\n\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tConstraintControl.prototype.set_value = function (node, value, task, config) {\n\t\tvar typeSelect = node.querySelector(\"[data-constraint-type-select] select\");\n\t\tvar timeSelects = node.querySelectorAll(\"[data-constraint-time-select] select\");\n\t\tvar map = config._time_format_order;\n\n\t\tvar mapping = gantt._resolve_default_mapping(config);\n\n\t\tif (!typeSelect._eventsInitialized) {\n\t\t\ttypeSelect.addEventListener(\"change\", function (e) {\n\t\t\t\ttoggleTimeSelect(timeSelects, e.target.value);\n\t\t\t});\n\t\t\ttypeSelect._eventsInitialized = true;\n\t\t}\n\n\t\tvar constraintDate = task[mapping.constraint_date] || new Date();\n\t\tgantt.form_blocks._fill_lightbox_select(timeSelects, 0, constraintDate, map, config);\n\n\t\tvar constraintType = task[mapping.constraint_type] || gantt.getConstraintType(task);\n\t\ttypeSelect.value = constraintType;\n\t\ttoggleTimeSelect(timeSelects, constraintType);\n\t};\n\n\tConstraintControl.prototype.get_value = function (node, task, config) {\n\t\tvar typeSelect = node.querySelector(\"[data-constraint-type-select] select\");\n\t\tvar timeSelects = node.querySelectorAll(\"[data-constraint-time-select] select\");\n\n\t\tvar constraintType = typeSelect.value;\n\t\tvar constraintDate = null;\n\t\tif (!isNonTimedConstraint(constraintType)) {\n\t\t\tconstraintDate = gantt.form_blocks.getTimePickerValue(timeSelects, config);\n\t\t}\n\n\t\treturn {\n\t\t\tconstraint_type: constraintType,\n\t\t\tconstraint_date: constraintDate\n\t\t};\n\t};\n\n\tConstraintControl.prototype.focus = function (node) {\n\t\tgantt._focus(node.querySelector(\"select\"));\n\t};\n\n\treturn ConstraintControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./select_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TypeselectControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(TypeselectControl, _super);\n\n\tTypeselectControl.prototype.render = function(sns) {\n\t\tvar types = gantt.config.types,\n\t\t\tlocale = gantt.locale.labels,\n\t\t\toptions = [];\n\n\t\tvar filter = sns.filter || function (typeKey, typeValue) {\n\t\t\tif (!types.placeholder || typeValue !== types.placeholder) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tfor (var i in types) {\n\t\t\tif (!filter(i, types[i]) === false) {\n\t\t\t\toptions.push({ key: types[i], label: locale[\"type_\" + i] });\n\t\t\t}\n\t\t}\n\t\tsns.options = options;\n\n\t\tvar oldOnChange = sns.onchange;\n\t\tsns.onchange = function () {\n\t\t\tgantt._lightbox_current_type = this.value;\n\t\t\tgantt.changeLightboxType(this.value);\n\t\t\tif (typeof oldOnChange == 'function') {\n\t\t\t\toldOnChange.apply(this, arguments);\n\t\t\t}\n\t\t};\n\n\t\treturn _super.prototype.render.apply(this, arguments);\n\t};\n\n\treturn TypeselectControl;\n};\n","\nimport __extends from \"../../../../utils/extends\";\nimport DurationFormatterNumeric from \"../../../common/duration_formatter_numeric\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction DurationControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\n\t\treturn self; \n\t}\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || new DurationFormatterNumeric();\n\t}\n\n\tfunction _generateBaselineRow (node, baseline, task, config){\n\t\tconst time = \"<div class='gantt_time_selects'>\" + gantt.form_blocks.getTimePicker.call(gantt, config) + \"</div>\";\n\t\tlet durationLabel = \" \"+ gantt.locale.labels[gantt.config.duration_unit + \"s\"] +\" \";\n\t\tconst singleDate = config.single_date ? \" style='display:none'\" : \"\";\n\t\tconst readonly = config.readonly ? \" disabled='disabled'\" : \"\";\n\t\tconst ariaAttr = gantt._waiAria.lightboxDurationInputAttrString(config);\n\t\tconst deleteLabel = gantt.locale.labels.baselines_remove_button;\n\n\t\tlet durationInputClass = \"gantt_duration_value\";\n\t\tif(config.formatter) {\n\t\t\tdurationLabel = \"\";\n\t\t\tdurationInputClass += \" gantt_duration_value_formatted\";\n\t\t}\n\n\t\tconst durationEl = \"<div class='gantt_duration' \" + singleDate + \">\" +\n\t\t\"<div class='gantt_duration_inputs'>\" +\n\t\t\t\"<input type='button' class='gantt_duration_dec' value='−'\" + readonly + \">\" +\n\t\t\t\"<input type='text' value='5days' class='\"+durationInputClass+\"'\" + readonly + \" \" + ariaAttr + \">\" +\n\t\t\t\"<input type='button' class='gantt_duration_inc' value='+'\" + readonly + \">\"+\n\t\t\t\"</div>\" +\n\t\t\t\"<div class='gantt_duration_end_date'>\"+durationLabel+\"<span></span></div>\" +\n\t\t\t\"</div>\" +\n\t\t\t\"</div>\";\n\n\t\tconst deleteButton = `<div><div class='baseline_delete_button gantt_custom_button'>${deleteLabel}</div></div>`;\n\n\t\tconst baselineRow = document.createElement(\"div\");\n\t\tbaselineRow.className = \"gantt_section_time gantt_section_duration\";\n\t\tbaselineRow.setAttribute(\"data-baseline-id\", baseline.id);\n\t\tbaselineRow.innerHTML = time + durationEl + deleteButton + \"<br>\";\n\t\tnode.appendChild(baselineRow);\n\n\t\tvar s = baselineRow.getElementsByTagName(\"select\");\n\t\tvar inps = baselineRow.getElementsByTagName(\"input\");\n\t\tvar duration = inps[1];\n\t\tvar btns = [inps[0], inps[2]];\n\t\tvar endspan = baselineRow.getElementsByTagName(\"span\")[0];\n\t\tvar map = config._time_format_order;\n\t\tvar mapping;\n\t\tvar start_date;\n\t\tvar end_date;\n\t\tvar duration_val;\n\n\t\tconst deleteEl = baselineRow.querySelector(\".baseline_delete_button\");\n\t\tdeleteEl.onclick = function(e){\n\t\t\tconst section = baselineRow.parentNode;\n\t\t\tbaselineRow.innerHTML = \"\";\n\t\t\tbaselineRow.remove();\n\t\t\tif (section.innerHTML === \"\"){\n\t\t\t\tsection.innerHTML = gantt.locale.labels.baselines_section_placeholder;\n\t\t\t}\n\t\t};\n\t\t\n\n\t\tfunction _calc_date() {\n\t\t\tvar start_date = _getStartDate.call(gantt, baselineRow, config);\n\t\t\tvar duration = _getDuration.call(gantt, baselineRow, config);\n\t\t\tvar end_date = gantt.calculateEndDate({start_date: start_date, duration: duration, task: task});\n\n\t\t\tvar template = gantt.templates.task_end_date || gantt.templates.task_date;\n\t\t\tendspan.innerHTML = template(end_date);\n\t\t}\n\n\t\tfunction _change_duration(step) {\n\t\t\tvar value = duration.value;\n\n\t\t\tvalue = getFormatter(config).parse(value);\n\t\t\tif (window.isNaN(value))\n\t\t\t\tvalue = 0;\n\t\t\tvalue += step;\n\t\t\tif (value < 1) value = 1;\n\t\t\tduration.value = getFormatter(config).format(value);\n\t\t\t_calc_date();\n\t\t}\n\n\t\tbtns[0].onclick = gantt.bind(function() {\n\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t}, gantt);\n\t\tbtns[1].onclick = gantt.bind(function() {\n\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t}, gantt);\n\t\ts[0].onchange = _calc_date;\n\t\ts[1].onchange = _calc_date;\n\t\ts[2].onchange = _calc_date;\n\t\tif (s[3]) s[3].onchange = _calc_date;\n\n\t\tduration.onkeydown = gantt.bind(function(e) {\n\t\t\tvar code; \n\n\t\t\te = e || window.event;\n\t\t\tcode = (e.charCode || e.keyCode || e.which);\n\t\t\t\n\t\t\tif (code == gantt.constants.KEY_CODES.DOWN) {\n\t\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (code == gantt.constants.KEY_CODES.UP) {\n\t\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\twindow.setTimeout(_calc_date, 1);\n\t\t}, gantt);\n\n\t\tduration.onchange = gantt.bind(_calc_date, gantt);\n\n\t\tmapping = gantt._resolve_default_mapping(config);\n\t\tif (typeof(mapping) === \"string\") mapping = {start_date: mapping};\n\n\t\tstart_date = baseline.start_date || new Date();\n\t\tend_date = baseline.end_date || gantt.calculateEndDate({\n\t\t\tstart_date: start_date,\n\t\t\tduration: 1,\n\t\t\ttask\n\t\t});\n\t\tduration_val = gantt.calculateDuration({\n\t\t\tstart_date: start_date,\n\t\t\tend_date: end_date,\n\t\t\ttask\n\t\t});\n\t\tduration_val = getFormatter(config).format(duration_val);\n\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, config);\n\t\tduration.value = duration_val;\n\t\t_calc_date();\n\t}\n\n\t__extends(DurationControl, _super);\n\n\tDurationControl.prototype.render = function(sns) {\n\t\tconst baselineSection = `<div style='height: ${sns.height || 100}px; padding-top:0px; font-size:inherit;' class='gantt_section_baselines'></div>`;\n\t\treturn baselineSection;\n\t};\n\n\tDurationControl.prototype.set_value = function(node, value, task, config) {\n\t\tif (task.baselines){\n\t\t\tnode.innerHTML = \"\";\n\n\t\t\ttask.baselines.forEach((baseline)=>{\n\t\t\t\t_generateBaselineRow(node, baseline, task, config);\n\t\t\t});\n\t\t} else {\n\t\t\tnode.innerHTML = gantt.locale.labels.baselines_section_placeholder;\n\t\t}\t\t\n\n\t};\n\n\tDurationControl.prototype.get_value = function(node, task, config) {\n\t\tconst baselines = [];\n\t\tconst baselineRows = node.querySelectorAll(`[data-baseline-id]`);\n\t\tbaselineRows.forEach((baselineNode)=>{\n\t\t\tconst baselineId = baselineNode.dataset.baselineId;\n\t\t\tconst baselineStore = gantt.getDatastore(\"baselines\");\n\t\t\tlet baseline = baselineStore.getItem(baselineId);\n\t\t\tlet updatedBaseline;\n\t\t\tif (baseline){\n\t\t\t\tupdatedBaseline = gantt.copy(baseline);\n\t\t\t} else {\n\t\t\t\tupdatedBaseline = {\n\t\t\t\t\tid: gantt.uid(),\n\t\t\t\t\ttask_id: task.id,\n\t\t\t\t\ttext: \"Baseline 1\"\n\t\t\t\t};\n\t\t\t}\n\t\t\tupdatedBaseline.start_date = _getStartDate(baselineNode, config);\n\t\t\tupdatedBaseline.duration = _getDuration(baselineNode, config);\n\t\t\tupdatedBaseline.end_date = gantt.calculateEndDate({start_date: updatedBaseline.start_date, duration: updatedBaseline.duration, task});\n\n\t\t\tbaselines.push(updatedBaseline);\n\t\t});\n\n\t\treturn baselines;\n\t};\n\n\tDurationControl.prototype.button_click = function (index, el, section, container) {\n\t\tif (gantt.callEvent(\"onSectionButton\", [gantt._lightbox_id, section]) === false) {\n\t\t\treturn;\n\t\t}\n\t\tif (el.closest(\".gantt_custom_button.gantt_remove_baselines\")){\n\t\t\tcontainer.innerHTML = gantt.locale.labels.baselines_section_placeholder;\n\t\t}\n\t\tif (el.closest(\".gantt_custom_button.gantt_add_baselines\")){\n\t\t\tif (container.innerHTML == gantt.locale.labels.baselines_section_placeholder){\n\t\t\t\tcontainer.innerHTML = \"\";\n\t\t\t}\n\t\t\tconst task = gantt.getTask(gantt._lightbox_id);\n\t\t\tconst baseline = {\n\t\t\t\tid: gantt.uid(),\n\t\t\t\ttask_id: task.id,\n\t\t\t\ttext: \"Baseline 1\",\n\t\t\t\tstart_date: task.start_date,\n\t\t\t\tend_date: task.end_date\n\t\t\t};\n\t\t\tconst config = gantt._get_typed_lightbox_config()[index];\n\t\t\t_generateBaselineRow(container, baseline, task, config);\n\t\t}\n\t};\n\n\tDurationControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\n\t};\n\n\n\tfunction _getStartDate(node, config) {\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar map = config._time_format_order;\n\t\tvar hours = 0;\n\t\tvar minutes = 0;\n\n\t\tif (gantt.defined(map[3])) {\n\t\t\tvar input = s[map[3]];\n\t\t\tvar time = parseInt(input.value, 10);\n\t\t\tif (isNaN(time) && input.hasAttribute(\"data-value\")) {\n\t\t\t\ttime = parseInt(input.getAttribute(\"data-value\"), 10);\n\t\t\t}\n\n\t\t\thours = Math.floor(time / 60);\n\t\t\tminutes = time % 60;\n\t\t}\n\t\treturn new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, hours, minutes);\n\t}\n\n\tfunction _getDuration(node, config) {\n\t\tvar duration = node.getElementsByTagName(\"input\")[1];\n\n\t\tduration = getFormatter(config).parse(duration.value);\n\t\tif (!duration || window.isNaN(duration)) duration = 1;\n\t\tif (duration < 0) duration *= -1;\n\t\treturn duration;\n\t}\n\n\treturn DurationControl; \n};","import * as utils from \"../utils/utils\";\nimport env from \"../utils/env\";\nimport isHeadless from \"../utils/is_headless\";\nimport * as domHelpers from \"./ui/utils/dom_helpers\";\nimport * as codeHelpers from \"../utils/helpers\";\nimport domEventScope from \"./ui/utils/dom_event_scope\";\nimport messages from \"./ui/message\";\nimport ui from \"./ui/index\";\nimport createLayoutFacade from \"./facades/layout\";\nimport taskLayers from \"./data_task_layers\";\n\nimport skin from \"./ui/skin\";\nimport skyblue from \"../css/skins/skyblue\";\nimport meadow from \"../css/skins/meadow\";\nimport terrace from \"../css/skins/terrace\";\nimport broadway from \"../css/skins/broadway\";\nimport material from \"../css/skins/material\";\nimport dark from \"../css/skins/dark\";\nimport contrast_black from \"../css/skins/contrast_black\";\nimport contrast_white from \"../css/skins/contrast_white\";\nimport plugins from \"./ui/plugins\";\nimport touch from \"./ui/touch\";\nimport lightbox from \"./ui/lightbox\";\nimport lightbox_optional_time from \"./ui/lightbox/lightbox_optional_time\";\nimport wai_aria from \"./ui/wai_aria\";\n\n\nexport default function(gantt) {\n\n\tif(!env.isNode){\n\n\t\tgantt.utils = {\n\t\t\tarrayFind: codeHelpers.arrayFind,\n\t\t\tdom: domHelpers\n\t\t};\n\n\t\tvar domEvents = domEventScope();\n\t\tgantt.event = domEvents.attach;\n\t\tgantt.eventRemove = domEvents.detach;\n\t\tgantt._eventRemoveAll = domEvents.detachAll;\n\t\tgantt._createDomEventScope = domEvents.extend;\n\n\t\tutils.mixin(gantt, messages(gantt));\n\t\tvar uiApi = ui.init(gantt);\n\t\tgantt.$ui = uiApi.factory;\n\t\tgantt.$ui.layers = uiApi.render;\n\t\tgantt.$mouseEvents = uiApi.mouseEvents;\n\t\tgantt.$services.setService(\"mouseEvents\", function () {\n\t\t\treturn gantt.$mouseEvents;\n\t\t});\n\t\tgantt.mixin(gantt, uiApi.layersApi);\n\n\t\ttaskLayers(gantt);\n\n\t\tgantt.$services.setService(\"layers\", function () {\n\t\t\treturn uiApi.layersService;\n\t\t});\n\n\t\tgantt.mixin(gantt, createLayoutFacade());\n\t\tskin(gantt);\n\t\tskyblue(gantt);\n\t\tdark(gantt);\n\t\tmeadow(gantt);\n\t\tterrace(gantt);\n\t\tbroadway(gantt);\n\t\tmaterial(gantt);\n\t\tcontrast_black(gantt);\n\t\tcontrast_white(gantt);\n\t\tplugins(gantt);\n\t\ttouch(gantt);\n\t\tlightbox(gantt);\n\t\tlightbox_optional_time(gantt);\n\t\twai_aria(gantt);\n\n\t\tgantt.locate = function(e) {\n\t\t\tvar trg = domHelpers.getTargetNode(e);\n\n\t\t\t// ignore empty rows/cells of the timeline\n\t\t\tif(domHelpers.closest(trg, \".gantt_task_row\")){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar targetAttribute = arguments[1] || this.config.task_attribute;\n\n\t\t\tvar node = domHelpers.locateAttribute(trg, targetAttribute);\n\t\t\tif(node){\n\t\t\t\treturn node.getAttribute(targetAttribute);\n\t\t\t}else{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t};\n\n\t\tgantt._locate_css = function(e, classname, strict){\n\t\t\treturn domHelpers.locateClassName(e, classname, strict);\n\t\t};\n\n\t\tgantt._locateHTML = function(e, attribute) {\n\t\t\treturn domHelpers.locateAttribute(e, attribute || this.config.task_attribute);\n\t\t};\n\t}\n\n\tgantt.attachEvent(\"onParse\", function(){\n\t\tif(!isHeadless(gantt)){\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\n\t\t\t\tif(gantt.config.initial_scroll){\n\t\t\t\t\tvar firstTask = gantt.getTaskByIndex(0);\n\t\t\t\t\tvar id = firstTask ? firstTask.id : gantt.config.root_id;\n\t\t\t\t\t// GS-1450. Don't scroll to the task if there is no timeline\n\t\t\t\t\tif(gantt.isTaskExists(id) && gantt.$task && gantt.utils.dom.isChildOf(gantt.$task, gantt.$container)){\n\t\t\t\t\t\tgantt.showTask(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, {once: true});\n\t\t}\n\n\t});\n\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tif (!this.config.scroll_size)\n\t\t\tthis.config.scroll_size = domHelpers.getScrollSize() || 15;\n\n\t\tif(!isHeadless(gantt)){\n\t\t\t// detach listeners before clearing old DOM, possible IE errors when accessing detached nodes\n\t\t\tthis._eventRemoveAll();\n\t\t\tthis.$mouseEvents.reset();\n\n\t\t\tthis.resetLightbox();\n\t\t}\n\n\t});\n\n\t// GS-1261: scroll the views to the right side when RTL is enabled\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(!isHeadless(gantt) && gantt.config.rtl){\n\t\t\tgantt.$layout.getCellsByType(\"viewCell\").forEach(function(cell){ \n\t\t\t\tvar attachedScrollbar = cell.$config.scrollX;\n\t\t\t\tif (!attachedScrollbar) return;\n\n\t\t\t\tvar scrollbar = gantt.$ui.getView(attachedScrollbar);\n\t\t\t\tif (scrollbar) scrollbar.scrollTo(scrollbar.$config.scrollSize,0);\n\n\t\t\t});\n\t\t}\n\t});\n\n\t// GS-1649: check if extensions are connected via files\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(!isHeadless(gantt)){\n\n\t\t\tvar activePlugins = gantt.plugins();\n\n\t\t\tvar availablePlugins = {\n\t\t\t\tauto_scheduling: gantt.autoSchedule,\n\t\t\t\tclick_drag: gantt.ext.clickDrag,\n\t\t\t\tcritical_path: gantt.isCriticalTask,\n\t\t\t\tdrag_timeline: gantt.ext.dragTimeline,\n\t\t\t\texport_api: gantt.exportToPDF,\n\t\t\t\tfullscreen: gantt.ext.fullscreen,\n\t\t\t\tgrouping: gantt.groupBy,\n\t\t\t\tkeyboard_navigation: gantt.ext.keyboardNavigation,\n\t\t\t\tmarker: gantt.addMarker,\n\t\t\t\tmultiselect: gantt.eachSelectedTask,\n\t\t\t\toverlay: gantt.ext.overlay,\n\t\t\t\tquick_info: gantt.templates.quick_info_content,\n\t\t\t\ttooltip: gantt.ext.tooltips,\n\t\t\t\tundo: gantt.undo\n\t\t\t};\n\n\t\t\tfor (let plugin in availablePlugins){\n\t\t\t\tif (availablePlugins[plugin] && !activePlugins[plugin]){\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.warn(`You connected the '${plugin}' extension via an obsolete file. \nTo fix it, you need to remove the obsolete file and connect the extension via the plugins method: https://docs.dhtmlx.com/gantt/api__gantt_plugins.html`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n};","function createLayoutFacade(){\n\n\tfunction getTimeline(gantt){\n\t\treturn gantt.$ui.getView(\"timeline\");\n\t}\n\n\tfunction getGrid(gantt){\n\t\treturn gantt.$ui.getView(\"grid\");\n\t}\n\n\tfunction getBaseCell(gantt){\n\t\tvar timeline = getTimeline(gantt);\n\t\tif (timeline && !timeline.$config.hidden){\n\t\t\treturn timeline;\n\t\t} else{\n\t\t\tvar grid = getGrid(gantt);\n\t\t\tif (grid && !grid.$config.hidden){\n\t\t\t\treturn grid;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getVerticalScrollbar(gantt){\n\t\tvar baseCell = null;\n\t\t// GS-1150: if we reorder or resize something in the grid, we should obtain the grid container\n\t\tvar gridDrag = false;\n\t\tvar gridMarkers = [\n\t\t\t\".gantt_drag_marker.gantt_grid_resize_area\",\n\t\t\t\".gantt_drag_marker .gantt_row.gantt_row_task\",\n\t\t\t\".gantt_drag_marker.gantt_grid_dnd_marker\"\n\t\t];\n\t\tgridMarkers.forEach(function (selector) {\n\t\t\tgridDrag = gridDrag || !!document.querySelector(selector);\n\t\t});\n\t\tif (gridDrag){\n\t\t\tbaseCell = getGrid(gantt);\n\t\t} else{\n\t\t\tbaseCell = getBaseCell(gantt);\n\t\t}\n\n\t\t// GS-1827. If there is no grid and timeline, there is no scrollbar for them\n\t\tif (!baseCell){\n\t\t\treturn null;\n\t\t}\n\n\t\tvar verticalScrollbar = getAttachedScrollbar(gantt, baseCell, \"scrollY\");\n\t\treturn verticalScrollbar;\n\t}\n\n\tfunction getHorizontalScrollbar(gantt){\n\t\tvar baseCell = getBaseCell(gantt);\n\t\tif (!baseCell || baseCell.id == \"grid\"){\n\t\t\treturn null; // if the timeline is not displayed, do not return the scrollbar\n\t\t}\n\t\tvar horizontalScrollbar = getAttachedScrollbar(gantt, baseCell, \"scrollX\");\n\t\treturn horizontalScrollbar;\n\t}\n\n\tfunction getAttachedScrollbar(gantt, cell, type){\n\t\tvar attachedScrollbar = cell.$config[type];\n\t\tvar scrollbarView = gantt.$ui.getView(attachedScrollbar);\n\t\treturn scrollbarView;\n\t}\n\n\tvar DEFAULT_VALUE = \"DEFAULT_VALUE\";\n\n\tfunction tryCall(getView, method, args, fallback){\n\t\tvar view = getView(this);\n\t\tif (!(view && view.isVisible())) {\n\t\t\tif(fallback){\n\t\t\t\treturn fallback();\n\t\t\t}else{\n\t\t\t\treturn DEFAULT_VALUE;\n\t\t\t}\n\t\t} else {\n\t\t\treturn view[method].apply(view, args);\n\t\t}\n\t}\n\n\treturn {\n\n\t\tgetColumnIndex: function(name) {\n\t\t\tvar res = tryCall.call(this, getGrid, \"getColumnIndex\", [name]);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tdateFromPos: function(x) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"dateFromPos\", Array.prototype.slice.call(arguments));\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn this.getState().min_date;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tposFromDate: function(date) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"posFromDate\", [date]);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetRowTop: function(index) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getRowTop\", [index],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getRowTop\", [index]);}\n\t\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskTop: function(id) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getItemTop\", [id],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemTop\", [id]);}\n\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\n\t\tgetTaskPosition: function(task, start_date, end_date) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"getItemPosition\", [task, start_date, end_date]);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\tvar top = this.getTaskTop(task.id);\n\t\t\t\tvar height = this.getTaskBarHeight(task.id);\n\n\t\t\t\treturn {\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: top,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: 0\n\t\t\t\t};\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskBarHeight: function(taskId, isMilestoneRender) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getBarHeight\", [taskId, isMilestoneRender],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemHeight\", [taskId]);}\n\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskHeight: function(taskId) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getItemHeight\", [taskId],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemHeight\", [taskId]);}\n\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\n\t\tcolumnIndexByDate: function(date) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"columnIndexByDate\", [date]);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\troundTaskDates: function() {\n\t\t\ttryCall.call(this, getTimeline, \"roundTaskDates\", []);\n\t\t},\n\n\t\tgetScale: function() {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"getScale\", []);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn null;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskNode: function(id) {\n\t\t\tvar timeline = getTimeline(this);\n\t\t\tif (!timeline || !timeline.isVisible()) {\n\t\t\t\treturn null;\n\t\t\t} else {\n\t\t\t\tvar node = timeline._taskRenderer.rendered[id];\n\t\t\t\tif(!node){\n\t\t\t\t\tvar domAttr = timeline.$config.item_attribute;\n\t\t\t\t\tnode = timeline.$task_bars.querySelector(\"[\" +domAttr+ \"='\"+id+\"']\");\n\t\t\t\t}\n\n\t\t\t\treturn node || null;\n\t\t\t}\n\t\t},\n\n\n\t\tgetLinkNode: function(id) {\n\t\t\tvar timeline = getTimeline(this);\n\t\t\tif (!timeline.isVisible()) {\n\t\t\t\treturn null;\n\t\t\t} else {\n\t\t\t\treturn timeline._linkRenderer.rendered[id];\n\t\t\t}\n\t\t},\n\n\t\tscrollTo: function(left, top){\n\t\t\tvar vertical = getVerticalScrollbar(this);\n\t\t\tvar horizontal = getHorizontalScrollbar(this);\n\n\t\t\tvar oldH = {position: 0},\n\t\t\t\toldV = {position: 0};\n\n\t\t\tif(vertical){\n\t\t\t\toldV = vertical.getScrollState();\n\t\t\t}\n\t\t\tif(horizontal){\n\t\t\t\toldH = horizontal.getScrollState();\n\t\t\t}\n\n\t\t\tvar scrollHorizontal = (horizontal && left*1 == left);\n\t\t\tvar scrollVertical = (vertical && top*1 == top);\n\t\t\tvar scrollBoth = scrollHorizontal && scrollVertical;\n\n\t\t\tif(scrollBoth){\n\t\t\t\t// some views will be scrolled both horizontally and vertically and smart rendering can be called twice\n\t\t\t\t// set flag in order not to invoke smart rendering at the horizontal scroll stage\n\t\t\t\t// so it will repaint only once when the scroll is completed\n\t\t\t\tvar verticalViews = vertical._getLinkedViews();\n\t\t\t\tvar horizontalViews = horizontal._getLinkedViews();\n\n\t\t\t\tvar commonViews = [];\n\t\t\t\tfor(var i = 0; i < verticalViews.length; i++){\n\t\t\t\t\tfor(var j = 0; j < horizontalViews.length; j++){\n\n\t\t\t\t\t\tif(verticalViews[i].$config.id && horizontalViews[j].$config.id && verticalViews[i].$config.id === horizontalViews[j].$config.id){\n\t\t\t\t\t\t\tcommonViews.push(verticalViews[i].$config.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (scrollHorizontal){\n\t\t\t\tif(commonViews){\n\t\t\t\t\tcommonViews.forEach((function(viewId){\n\t\t\t\t\t\tthis.$ui.getView(viewId).$config.$skipSmartRenderOnScroll = true;\n\t\t\t\t\t}).bind(this));\n\t\t\t\t}\n\n\t\t\t\thorizontal.scroll(left);\n\t\t\t\tif(commonViews){\n\t\t\t\t\tcommonViews.forEach((function(viewId){\n\t\t\t\t\t\tthis.$ui.getView(viewId).$config.$skipSmartRenderOnScroll = false;\n\t\t\t\t\t}).bind(this));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(scrollVertical){\n\t\t\t\tvertical.scroll(top);\n\t\t\t}\n\n\t\t\tvar newV = {position: 0},\n\t\t\t\tnewH = {position: 0};\n\t\t\tif(vertical){\n\t\t\t\tnewV = vertical.getScrollState();\n\t\t\t}\n\t\t\tif(horizontal){\n\t\t\t\tnewH = horizontal.getScrollState();\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onGanttScroll\", [oldH.position, oldV.position, newH.position, newV.position]);\n\t\t},\n\n\t\tshowDate: function(date){\n\t\t\tvar date_x = this.posFromDate(date);\n\t\t\tvar scroll_to = Math.max(date_x - this.config.task_scroll_offset, 0);\n\t\t\tthis.scrollTo(scroll_to);\n\t\t},\n\t\tshowTask: function(id) {\n\t\t\tvar pos = this.getTaskPosition(this.getTask(id));\n\n\t\t\t// GS-1261: we need to show the start_date even in the RTL mode\n\t\t\tvar leftPos = pos.left;\n\t\t\tif (this.config.rtl) leftPos = pos.left + pos.width;\n\n\t\t\tvar left = Math.max(leftPos - this.config.task_scroll_offset, 0);\n\n\t\t\tvar dataHeight = this._scroll_state().y;\n\t\t\tvar top;\n\t\t\tif(!dataHeight){\n\t\t\t\ttop = pos.top;\n\t\t\t}else{\n\t\t\t\ttop = pos.top - (dataHeight - this.getTaskBarHeight(id))/2;\n\t\t\t}\n\n\t\t\tthis.scrollTo(left, top);\n\t\t\t// GS-1150: if the grid and timeline have different scrollbars, we need to scroll thegrid to show the task\n\t\t\tvar gridCell = getGrid(this);\n\t\t\tvar timelineCell = getTimeline(this);\n\t\t\tif (gridCell && timelineCell && gridCell.$config.scrollY != timelineCell.$config.scrollY){\n\t\t\t\tvar gridScrollbar = getAttachedScrollbar(this, gridCell, \"scrollY\");\n\t\t\t\tgridScrollbar.scrollTo(null, top);\n\t\t\t}\n\t\t},\n\t\t_scroll_state: function(){\n\t\t\tvar result = {\n\t\t\t\tx: false,\n\t\t\t\ty: false,\n\t\t\t\tx_pos: 0,\n\t\t\t\ty_pos: 0,\n\t\t\t\tscroll_size: this.config.scroll_size + 1,//1px for inner content\n\t\t\t\tx_inner: 0,\n\t\t\t\ty_inner: 0\n\t\t\t};\n\n\t\t\tvar scrollVer = getVerticalScrollbar(this),\n\t\t\t\tscrollHor = getHorizontalScrollbar(this);\n\t\t\tif(scrollHor){\n\t\t\t\tvar horState = scrollHor.getScrollState();\n\t\t\t\tif(horState.visible){\n\t\t\t\t\tresult.x = horState.size;\n\t\t\t\t\tresult.x_inner = horState.scrollSize;\n\t\t\t\t}\n\t\t\t\tresult.x_pos = horState.position || 0;\n\t\t\t}\n\n\t\t\tif(scrollVer){\n\t\t\t\tvar verState = scrollVer.getScrollState();\n\t\t\t\tif(verState.visible){\n\t\t\t\t\tresult.y = verState.size;\n\n\t\t\t\t\tresult.y_inner = verState.scrollSize;\n\t\t\t\t}\n\t\t\t\tresult.y_pos = verState.position || 0;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tgetScrollState: function(){\n\t\t\tvar state = this._scroll_state();\n\t\t\treturn { x:state.x_pos, y:state.y_pos, inner_width:state.x, inner_height:state.y, width: state.x_inner, height: state.y_inner };\n\t\t},\n\n\t\tgetLayoutView: function(cellName){\n\t\t\treturn this.$ui.getView(cellName);\n\t\t},\n\n\t\tscrollLayoutCell: function(cellName, left, top){\n\t\t\tconst cell = this.$ui.getView(cellName);\n\t\t\tif (!cell){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (left !== null){\n\t\t\t\tconst horizontalScroll = this.$ui.getView(cell.$config.scrollX);\n\t\t\t\tif (horizontalScroll){\n\t\t\t\t\thorizontalScroll.scrollTo(left, null);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (top !== null){\n\t\t\t\tconst verticalScroll = this.$ui.getView(cell.$config.scrollY);\n\t\t\t\tif (verticalScroll){\n\t\t\t\t\tverticalScroll.scrollTo(null, top);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t};\n\n}\n\nexport default createLayoutFacade;","export default function(gantt) {\ngantt.skins.skyblue = {\n\tconfig:{\n\t\tgrid_width:370,\n\t\trow_height: 27,\n\t\tbar_height_padding:4,\n\t\tscale_height: 27,\n\t\tlink_line_width:1,\n\t\tlink_arrow_size:8,\n\t\tlink_radius:2,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:95,\n\t_third_column_width:80\n};\n\n};","export default function(gantt) {\ngantt.skins.dark = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 36,\n\t\tscale_height: 36,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tbar_height_padding:9,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:70\t\t\n};\n\n};","export default function(gantt) {\ngantt.skins.meadow = {\n\tconfig:{\n\t\tgrid_width:380,\n\t\trow_height: 27,\n\t\tscale_height: 30,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:10,\n\t\tbar_height_padding:4,\n\t\tlightbox_additional_height:72\n\t},\n\t_second_column_width:95,\n\t_third_column_width:80\n};\n\n};","export default function(gantt) {\ngantt.skins.terrace = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 36,\n\t\tscale_height: 36,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tbar_height_padding:9,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:70\t\t\n};\n\n};","export default function(gantt) {\n\tgantt.skins.broadway = {\n\t\tconfig: {\n\t\t\tgrid_width: 390,\n\t\t\trow_height: 35,\n\t\t\tscale_height: 35,\n\t\t\tlink_line_width: 1,\n\t\t\tlink_arrow_size: 9,\n\t\t\tbar_height_padding:4,\n\t\t\tlightbox_additional_height: 86\n\t\t},\n\t\t_second_column_width: 100,\n\t\t_third_column_width: 80,\n\n\t\t_lightbox_template: \"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span><div class='gantt_cancel_btn'></div></div><div class='gantt_cal_larea'></div>\",\n\t\t_config_buttons_left: {},\n\t\t_config_buttons_right: {\n\t\t\t\"gantt_delete_btn\": \"icon_delete\",\n\t\t\t\"gantt_save_btn\": \"icon_save\"\n\t\t}\n\t};\n};","export default function(gantt) {\n\tgantt.skins.material = {\n\t\tconfig: {\n\t\t\tgrid_width: 411,\n\t\t\trow_height: 34,\n\t\t\tscale_height: 36,\n\t\t\tlink_line_width: 2,\n\t\t\tlink_arrow_size: 12,\n\t\t\tbar_height_padding:9,\n\t\t\tlightbox_additional_height: 80\n\t\t},\n\t\t_second_column_width: 110,\n\t\t_third_column_width: 75,\n\t\t_redefine_lightbox_buttons: {\n\t\t\t\"buttons_left\": [\"dhx_delete_btn\"],\n\t\t\t\"buttons_right\": [\"dhx_cancel_btn\", \"dhx_save_btn\"]\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onAfterTaskDrag\", function (id) {\n\t\tvar t = gantt.getTaskNode(id);\n\t\tif (t) {\n\t\t\tt.className += \" gantt_drag_animation\";\n\t\t\tsetTimeout(function () {\n\t\t\t\tvar indx = t.className.indexOf(\" gantt_drag_animation\");\n\t\t\t\tif (indx > -1) {\n\t\t\t\t\tt.className = t.className.slice(0, indx);\n\t\t\t\t}\n\t\t\t}, 200);\n\t\t}\n\t});\n\n};","export default function(gantt) {\ngantt.skins[\"contrast_black\"] = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 35,\n\t\tscale_height: 35,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:80\n};\n\n};","export default function(gantt) {\ngantt.skins[\"contrast_white\"] = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 35,\n\t\tscale_height: 35,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:80\n};\n\n};","import autoscroll from \"./autoscroll\";\nimport jquery_hooks from \"./jquery_hooks\";\nimport dhtmlx_hooks from \"./dhtmlx_hooks\";\nimport TimelineZoom from \"./timeline_zoom\";\n\n\nexport default function(gantt){\n\tif(!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tvar modules = [\n\t\tautoscroll,\n\t\tjquery_hooks,\n\t\tdhtmlx_hooks\n\t];\n\n\tfor(var i = 0; i < modules.length; i++){\n\t\tif(modules[i])\n\t\t\tmodules[i](gantt);\n\t}\n\n\tgantt.ext.zoom = new TimelineZoom(gantt);\n};","export default function(gantt) {\n\n\tgantt._extend_to_optional = function (lightbox_block) {\n\n\t\tvar duration = lightbox_block;\n\t\tvar optional_time = {\n\t\t\trender: duration.render,\n\t\t\tfocus: duration.focus,\n\t\t\tset_value: function (node, value, task, section) {\n\t\t\t\tvar mapping = gantt._resolve_default_mapping(section);\n\t\t\t\tif (!task[mapping.start_date] || (mapping.start_date == \"start_date\" && this._isAllowedUnscheduledTask(task))) {\n\t\t\t\t\toptional_time.disable(node, section);\n\t\t\t\t\tvar val = {};\n\n\t\t\t\t\tfor (var i in mapping) {\n\t\t\t\t\t\t//take default values from the time control from task start/end dates\n\t\t\t\t\t\tval[mapping[i]] = task[i];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn duration.set_value.call(gantt, node, value, val, section);//set default value\n\t\t\t\t} else {\n\t\t\t\t\toptional_time.enable(node, section);\n\t\t\t\t\treturn duration.set_value.call(gantt, node, value, task, section);\n\t\t\t\t}\n\t\t\t},\n\t\t\tget_value: function (node, task, section) {\n\t\t\t\tif (section.disabled) {\n\t\t\t\t\treturn {start_date: null};\n\t\t\t\t} else {\n\t\t\t\t\treturn duration.get_value.call(gantt, node, task, section);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate_block: function (node, section) {\n\t\t\t\tgantt.callEvent(\"onSectionToggle\", [gantt._lightbox_id, section]);\n\t\t\t\tnode.style.display = section.disabled ? \"none\" : \"\";\n\n\t\t\t\tif (section.button) {\n\t\t\t\t\tvar button = node.previousSibling.querySelector(\".gantt_custom_button_label\"),\n\t\t\t\t\t\tlabels = gantt.locale.labels;\n\n\t\t\t\t\tvar button_text = section.disabled ? labels[section.name + \"_enable_button\"] : labels[section.name + \"_disable_button\"];\n\n\t\t\t\t\tbutton.innerHTML = button_text;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdisable: function (node, section) {\n\t\t\t\tsection.disabled = true;\n\t\t\t\toptional_time.update_block(node, section);\n\n\t\t\t},\n\t\t\tenable: function (node, section) {\n\t\t\t\tsection.disabled = false;\n\t\t\t\toptional_time.update_block(node, section);\n\t\t\t},\n\t\t\tbutton_click: function (index, el, section, container) {\n\t\t\t\tif (gantt.callEvent(\"onSectionButton\", [gantt._lightbox_id, section]) === false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar config = gantt._get_typed_lightbox_config()[index];\n\t\t\t\tif (config.disabled) {\n\t\t\t\t\toptional_time.enable(container, config);\n\t\t\t\t} else {\n\t\t\t\t\toptional_time.disable(container, config);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn optional_time;\n\t};\n\n\tgantt.form_blocks.duration_optional = gantt._extend_to_optional(gantt.form_blocks.duration);\n\tgantt.form_blocks.time_optional = gantt._extend_to_optional(gantt.form_blocks.time);\n\n};","export default function(gantt){\n\tvar htmlTags = new RegExp(\"<(?:.|\\n)*?>\", \"gm\");\n\tvar extraSpaces = new RegExp(\" +\", \"gm\");\n\n\tfunction stripHTMLLite(htmlText){\n\t\treturn (htmlText + \"\")\n\t\t\t.replace(htmlTags, \" \").\n\t\t\treplace(extraSpaces, \" \");\n\t}\n\n\tvar singleQuotes = new RegExp(\"'\", \"gm\");\n\tfunction escapeQuotes(text){\n\t\treturn (text + \"\").replace(singleQuotes, \"&#39;\");\n\t}\n\n\tgantt._waiAria = {\n\t\tgetAttributeString: function(attr){\n\t\t\tvar attributes = [\" \"];\n\t\t\tfor(var i in attr){\n\t\t\t\tvar text = escapeQuotes(stripHTMLLite(attr[i]));\n\t\t\t\tattributes.push(i + \"='\" + text + \"'\");\n\t\t\t}\n\t\t\tattributes.push(\" \");\n\t\t\treturn attributes.join(\" \");\n\n\t\t},\n\n\t\tgetTimelineCellAttr:function(dateString){\n\n\t\t\treturn gantt._waiAria.getAttributeString({\"aria-label\": dateString});\n\t\t},\n\n\t\t_taskCommonAttr: function(task, div){\n\n\t\t\tif(!(task.start_date && task.end_date))\n\t\t\t\treturn;\n\n\t\t\tdiv.setAttribute(\"aria-label\", stripHTMLLite(gantt.templates.tooltip_text(task.start_date, task.end_date, task)));\n\n\t\t\tif(task.$dataprocessor_class){\n\t\t\t\tdiv.setAttribute(\"aria-busy\", true);\n\t\t\t}\n\n\t\t},\n\n\t\tsetTaskBarAttr: function(task, div){\n\t\t\tthis._taskCommonAttr(task, div);\n\n\t\t\t// task bars are complex elements that should be treated as a single element\n\t\t\tdiv.setAttribute(\"role\", \"img\");\n\n\t\t\tif(!gantt.isReadonly(task) && gantt.config.drag_move){\n\t\t\t\tif(task.id != gantt.getState(\"tasksDnd\").drag_id){\n\t\t\t\t\tdiv.setAttribute(\"aria-grabbed\", false);\n\t\t\t\t}else{\n\t\t\t\t\tdiv.setAttribute(\"aria-grabbed\", true);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\ttaskRowAttr: function(task, div){\n\n\t\t\tthis._taskCommonAttr(task, div);\n\n\t\t\tif(!gantt.isReadonly(task) && gantt.config.order_branch){\n\t\t\t\tdiv.setAttribute(\"aria-grabbed\", false);\n\t\t\t}\n\n\t\t\tdiv.setAttribute(\"role\", \"row\");\n\t\t\t// selected attribute should be added only to the grid  because\n\t\t\t// other parts don't have the keyboard navigation\n\t\t\tdiv.setAttribute(\"aria-selected\", gantt.isSelectedTask(task.id) ? \"true\" : \"false\");\n\n\t\t\t// allowed values start from 1, set 1 for non-tree datastores\n\t\t\tdiv.setAttribute(\"aria-level\", task.$level + 1 || 1);\n\n\t\t\tif(gantt.hasChild(task.id)){\n\t\t\t\tdiv.setAttribute(\"aria-expanded\", task.$open ? \"true\" : \"false\");\n\t\t\t}\n\t\t},\n\n\t\tlinkAttr: function(link, div){\n\n\t\t\tvar linkTypes = gantt.config.links;\n\n\t\t\tvar toStart = link.type == linkTypes.finish_to_start || link.type == linkTypes.start_to_start;\n\t\t\tvar fromStart = link.type == linkTypes.start_to_start || link.type == linkTypes.start_to_finish;\n\n\t\t\tvar content = gantt.locale.labels.link + \" \" +  gantt.templates.drag_link(link.source, fromStart, link.target, toStart);\n\n\t\t\t// links are complex elements that should be treated as a single element\n\t\t\tdiv.setAttribute(\"role\", \"img\");\n\n\t\t\tdiv.setAttribute(\"aria-label\", stripHTMLLite(content));\n\t\t\tif(gantt.isReadonly(link)){\n\t\t\t\tdiv.setAttribute(\"aria-readonly\", true);\n\t\t\t}\n\t\t},\n\n\t\tgridSeparatorAttr: function(div){\n\t\t\t// the only valid role for the grid header\n\t\t\tdiv.setAttribute(\"role\", \"columnheader\");\n\t\t},\n\t\trowResizerAttr: function(div){\n\t\t\t// the only valid role for the grid header\n\t\t\tdiv.setAttribute(\"role\", \"row\");\n\t\t},\n\n\t\tlightboxHiddenAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t},\n\n\t\tlightboxVisibleAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"false\");\n\t\t},\n\n\t\tlightboxAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t\tdiv.firstChild.setAttribute(\"role\", \"heading\");\n\t\t\tdiv.firstChild.setAttribute(\"aria-level\", \"1\");\n\t\t},\n\n\t\tlightboxButtonAttrString:function(buttonName){\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\":gantt.locale.labels[buttonName], \"tabindex\":\"0\"});\n\t\t},\n\n\t\tlightboxHeader: function(div, headerText){\n\t\t\tdiv.setAttribute(\"aria-label\", headerText);\n\t\t},\n\n\t\tlightboxSelectAttrString: function(time_option){\n\t\t\tvar label = \"\";\n\n\t\t\tswitch (time_option) {\n\t\t\t\tcase \"%Y\":\n\t\t\t\t\tlabel = gantt.locale.labels.years;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%m\":\n\t\t\t\t\tlabel = gantt.locale.labels.months;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%d\":\n\t\t\t\t\tlabel = gantt.locale.labels.days;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%H:%i\":\n\t\t\t\t\tlabel = gantt.locale.labels.hours + gantt.locale.labels.minutes;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn gantt._waiAria.getAttributeString({\"aria-label\": label});\n\t\t},\n\n\t\tlightboxDurationInputAttrString: function(section){\n\t\t\treturn this.getAttributeString({\n\t\t\t\t\"aria-label\": gantt.locale.labels.column_duration,\n\t\t\t\t\"aria-valuemin\": \"0\",\n\t\t\t\t\"role\": \"spinbutton\"\n\t\t\t});\n\t\t},\n\n\t\tinlineEditorAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"row\");\n\t\t},\n\n\t\tgridAttrString: function(){\n\t\t\treturn [\" role='treegrid'\", gantt.config.multiselect ? \"aria-multiselectable='true'\" : \"aria-multiselectable='false'\", \" \"].join(\" \");\n\t\t},\n\n\n\t\tgridScaleRowAttrString: function(){\n\t\t\treturn \"role='row'\";\n\t\t},\n\n\t\tgridScaleCellAttrString: function(column, label){\n\t\t\tvar attrs = \"\";\n\t\t\tif(column.name == \"add\"){\n\t\t\t\t// a more precise role is button, but it is not valid for the grid header\n\t\t\t\tattrs = this.getAttributeString({\"role\":\"columnheader\", \"aria-label\": gantt.locale.labels.new_task});\n\t\t\t}else{\n\n\t\t\t\tvar attributes = {\n\t\t\t\t\t\"role\":\"columnheader\",\n\t\t\t\t\t\"aria-label\": label\n\t\t\t\t};\n\n\t\t\t\tif(gantt._sort && gantt._sort.name == column.name){\n\t\t\t\t\tif(gantt._sort.direction == \"asc\"){\n\t\t\t\t\t\tattributes[\"aria-sort\"] = \"ascending\";\n\t\t\t\t\t}else{\n\t\t\t\t\t\tattributes[\"aria-sort\"] = \"descending\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tattrs = this.getAttributeString(attributes);\n\t\t\t}\n\t\t\treturn attrs;\n\t\t},\n\n\t\tgridDataAttrString: function(){\n\t\t\treturn \"role='rowgroup'\";\n\t\t},\n\n\t\treorderMarkerAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"grid\");\n\t\t\tdiv.firstChild.removeAttribute(\"aria-level\");\n\t\t\tdiv.firstChild.setAttribute(\"aria-grabbed\", \"true\");\n\t\t},\n\n\t\tgridCellAttrString: function(column, textValue, task){\n\t\t\tvar attributes = {\"role\":\"gridcell\", \"aria-label\": textValue};\n\t\t\tif(!column.editor || gantt.isReadonly(task)){\n\t\t\t\tattributes[\"aria-readonly\"] = true;\n\t\t\t}\n\n\t\t\treturn this.getAttributeString(attributes);\n\t\t},\n\n\t\tgridAddButtonAttrString: function(column){\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\": gantt.locale.labels.new_task});\n\t\t},\n\n\t\tmessageButtonAttrString: function(buttonLabel){\n\t\t\treturn \"tabindex='0' role='button' aria-label='\"+buttonLabel+\"'\";\n\t\t},\n\n\t\tmessageInfoAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"alert\");\n\t\t\t//div.setAttribute(\"tabindex\", \"-1\");\n\t\t},\n\n\t\tmessageModalAttr: function(div, uid){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t\tif(uid){\n\t\t\t\tdiv.setAttribute(\"aria-labelledby\", uid);\n\t\t\t}\n\n\t\t//\tdiv.setAttribute(\"tabindex\", \"-1\");\n\t\t},\n\n\t\tquickInfoAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t},\n\n\t\tquickInfoHeaderAttrString: function(){\n\t\t\treturn \" role='heading' aria-level='1' \";\n\t\t},\n\n\t\tquickInfoHeader: function(div, header){\n\t\t\tdiv.setAttribute(\"aria-label\", header);\n\t\t},\n\n\t\tquickInfoButtonAttrString: function(label){\n\t\t\treturn gantt._waiAria.getAttributeString({\"role\":\"button\", \"aria-label\":label, \"tabindex\":\"0\"});\n\t\t},\n\n\t\ttooltipAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"tooltip\");\n\t\t},\n\n\t\ttooltipVisibleAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"false\");\n\t\t},\n\n\t\ttooltipHiddenAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t}\n\t};\n\n\tfunction isDisabled(){\n\t\treturn !gantt.config.wai_aria_attributes;\n\t}\n\n\tfor(var i in gantt._waiAria){\n\t\tgantt._waiAria[i] = (function(payload){\n\t\t\treturn function(){\n\t\t\t\tif(isDisabled()){\n\t\t\t\t\treturn \"\";\n\t\t\t\t}\n\t\t\t\treturn payload.apply(this, arguments);\n\t\t\t};\n\t\t})(gantt._waiAria[i]);\n\t}\n\n\n};","import TreeDataStore from \"../datastore/treedatastore\";\n\nexport default function(gantt) {\n\n\tvar loadedBranches = {};\n\tgantt.attachEvent(\"onClearAll\", function(){\n\t\tloadedBranches = {};\n\t});\n\n\tvar oldHasChildren = TreeDataStore.prototype.hasChild;\n\tgantt.$data.tasksStore.hasChild = function (id) {\n\t\tif(!gantt.config.branch_loading){\n\t\t\treturn oldHasChildren.call(this, id);\n\t\t}else{\n\t\t\tif (oldHasChildren.call(this, id))\n\t\t\t\treturn true;\n\t\t\tif (this.exists(id)) {\n\t\t\t\treturn this.getItem(id)[gantt.config.branch_loading_property];\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tfunction needLoading(id) {\n\t\tif (gantt.config.branch_loading && gantt._load_url) {\n\t\t\tvar alreadyLoaded = !!loadedBranches[id];\n\t\t\t// call ajax only if branch has children\n\t\t\tif (!alreadyLoaded && (!gantt.getChildren(id).length && gantt.hasChild(id))) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tgantt.attachEvent(\"onTaskOpened\", function (id) {\n\t\tif (gantt.config.branch_loading && gantt._load_url) {\n\t\t\t// call ajax only if branch has children\n\t\t\tif (needLoading(id)) {\n\t\t\t\tvar url = gantt._load_url;\n\t\t\t\turl = url.replace(/(\\?|&)?parent_id=.+&?/, \"\");\n\t\t\t\tvar param = url.indexOf(\"?\") >= 0 ? \"&\" : \"?\";\n\t\t\t\tvar y = gantt.getScrollState().y || 0;\n\n\t\t\t\tvar requestData = {\n\t\t\t\t\ttaskId: id,\n\t\t\t\t\turl: url + param + \"parent_id=\" + encodeURIComponent(id)\n\t\t\t\t};\n\n\t\t\t\tif(gantt.callEvent(\"onBeforeBranchLoading\", [requestData]) === false){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tgantt.load(requestData.url, this._load_type, function () {\n\t\t\t\t\tif (y) {\n\t\t\t\t\t\tgantt.scrollTo(null, y);\n\t\t\t\t\t}\n\t\t\t\t\tgantt.callEvent(\"onAfterBranchLoading\", [requestData]);\n\t\t\t\t});\n\t\t\t\tloadedBranches[id] = true;\n\t\t\t}\n\t\t}\n\t});\n\n};","import extensions from \"./ext/extensions_all\";\nimport factoryMethod from \"./factory/make_instance_web\";\nimport scope from \"./utils/global\";\n\nconst gantt = (scope as any).gantt = factoryMethod(extensions);\n\nexport { gantt };","import \"../css/dhtmlxgantt.less\";\n\nimport factory from \"./make_instance_common\";\nimport ui from \"../core/ui_core\";\nimport ajaxLoading from \"../core/loading/ajax_loading\";\nimport dynamicLoading from \"../core/loading/dynamic_loading\";\n\nexport default function(supportedExtensions) {\n\tvar gantt = factory(supportedExtensions);\n\n\tif(!gantt.env.isNode){\n\t\tui(gantt);\n\t\tajaxLoading(gantt);\n\t\tdynamicLoading(gantt);\n\t}\n\n\treturn gantt;\n};","export default function(gantt) {\n\tgantt.load = function (url, type, callback) {\n\t\tthis._load_url = url;\n\t\tthis.assert(arguments.length, \"Invalid load arguments\");\n\n\t\tvar tp = 'json', cl = null;\n\t\tif (arguments.length >= 3) {\n\t\t\ttp = type;\n\t\t\tcl = callback;\n\t\t} else {\n\t\t\tif (typeof arguments[1] == \"string\")\n\t\t\t\ttp = arguments[1];\n\t\t\telse if (typeof arguments[1] == \"function\")\n\t\t\t\tcl = arguments[1];\n\t\t}\n\n\t\tthis._load_type = tp;\n\n\t\tthis.callEvent(\"onLoadStart\", [url, tp]);\n\n\t\treturn this.ajax.get(url, gantt.bind(function (l) {\n\t\t\tthis.on_load(l, tp);\n\t\t\tthis.callEvent(\"onLoadEnd\", [url, tp]);\n\t\t\tif (typeof cl == \"function\")\n\t\t\t\tcl.call(this);\n\t\t}, this));\n\t};\n};","import {gantt} from \"./dhtmlxgantt.web.single\";\n\nimport scope from \"./utils/global\";\n\n(scope as any).gantt = gantt;\n\nexport default gantt;\n\nexport { gantt };"],"names":["auto_scheduling_configs","gantt","config","auto_scheduling_use_progress","auto_scheduling_project_constraint","links_common","_get_linked_task","link","getTarget","task","taskId","target","source","isTaskExists","getTask","_get_link_target","_get_link_source","caching","formattedLinksStash","inheritedSuccessorsStash","inheritedPredecessorsStash","getPredecessorsCache","isManuallyScheduledSummary","isSummaryTask","auto_scheduling","_isLinksCacheEnabled","_startLinksCache","_endLinksCache","_formatLink","sourceDates","targetDates","id","relations","this","isChildOf","backwardsScheduling","schedule_from_end","project_end","respectTargetOffset","auto_scheduling_move_projects","auto_scheduling_compatibility","auto_scheduling_strict","getSubtaskDates","start_date","end_date","from","_getImplicitLinks","c","$source","length","getState","drag_id","calculateDuration","eachTask","child","type","types","project","$target","to","actualTarget","i","fromLength","fromTask","j","toLength","toTask","lag","subtaskLink","_linkedTasks","push","_convertToFinishToStartLink","taskParent","_isAutoSchedulable","unscheduled","unscheduledChildren","parent","selectOffset","selectSourceLinks","skipChild","children","linksCollection","l","links","start_to_start","start_to_finish","siblingLink","getLink","siblingId","siblingTask","linkLag","Math","abs","finish_to_start","additionalLag","insignificantTargetLag","duration","insignificantSourceLag","calculateLag","predecessorId","offsetLag","_getDirectDependencies","selectSuccessors","successors","linksIds","progress","concat","_getInheritedDependencies","cacheCollection","stop","inheritedRelations","eachParent","parentDependencies","_getDirectSuccessors","_getInheritedSuccessors","_getDirectPredecessors","_getInheritedPredecessors","_getSuccessors","skipInherited","_getPredecessors","result","key","String","predecessors","sourceTask","targetTask","sourceParent","targetParent","res","sourceLag","targetLag","trueLag","preferredStart","hashSum","finish_to_finish","units","second","minute","hour","day","week","month","quarter","year","getSecondsInUnit","unit","forEach","arr","callback","workArray","slice","arrayFind","find","arrayIncludes","item","includes","isArray","obj","Array","undefined","pop","isDate","getFullYear","getMonth","getDate","isValidDate","isNaN","getTime","delay","timeout","timer","$cancelTimeout","$pending","args","prototype","call","arguments","setTimeout","apply","clearTimeout","$execute","replaceValidZeroId","rootId","checkZeroId","findBinary","array","prev","low","high","floor","GraphHelper","getVertices","rel","ids","len","vertices","topologicalSort","edges","hash","$incoming","successor","S","filter","v","L","n","node","m","groupAdjacentEdges","edge","tarjanStronglyConnectedComponents","verticesHash","stack","edgesFromTasks","recurse","connectedComponents","root","getVertex","visited","workStack","index","lowLink","onStack","e","w","min","com","tasks","linkKeys","findLoops","cycles","helpers.forEach","component","LinksBuilder","getVirtualRoot","mixin","root_id","$virtual","getLinkedTasks","includePredecessors","startIds","clearCache","_getLinkedTasks","_collectRelations","rootObj","isChild","visitedLinks","linkKey","rootTask","visitedTasks","output","tasksStack","current","includeRelation","isSameParent","hasChild","getChildren","_slave","ConstraintTypes","TaskPlan","Create","plan","constructor","latestStart","earliestStart","earliestEnd","latestEnd","latestSchedulingStart","earliestSchedulingStart","latestSchedulingEnd","earliestSchedulingEnd","kind","conflict","ConstraintsHelper","isAsapTask","constraintType","getConstraintType","_gantt","ASAP","ALAP","isAlapTask","constraint","_getTaskConstraint","constraint_type","_getOwnConstraint","group_mode","defaultConstraintType","_getParentConstraint","constraint_date","hasConstraint","processConstraint","helpers.isValidDate","constraintDate","newPlan","SNET","Date","calculateEndDate","SNLT","FNET","FNLT","MSO","MFO","getConstraints","store","placeholder","DateComparator","dateA","dateB","_hasDuration","small","big","valueOf","isEqual","smallDate","bigDate","isFirstSmaller","AlapStrategy","instance","_comparator","adjacentLinks","plansHash","maxEnd","linkId","maxStart","defaultStart","maxRelationDate","masterPlan","relation","getLatestEndDate","constraintStartDate","isGreaterOrDefault","callEvent","getClosestWorkTime","date","dir","o","currentPlan","successorStart","getSuccessorStartDate","predecessor","predecessorEnd","AsapStrategy","minStart","autoScheduledDates","minRelationDate","getEarliestStartDate","isSmallerOrDefault","project_start","milestoneWorktimeDirection","linkProps","onlyFFLink","noRelevantLinks","linkType","getPredecessorEndDate","taskCalendar","ffLink","AutoSchedulingPlanner","graphHelper","constraintsHelper","_secondIteration","_constraintsHelper","_graphHelper","_asapStrategy","_alapStrategy","_secondIterationRequired","constraints","alapStrategy","asapStrategy","orderedIds","reversedIds","relationsMap","buildWorkCollections","processConstraints","iterateTasks","projectPlan","reason","updateTasks","newDate","mainSequence","secondarySequence","isMainSequence","mainSequenceStrategy","secondarySequenceStrategy","currentId","resolveRelationDate","limitPlanDates","processResolvedDate","summaryLagChanged","projectUpdates","linksToUpdate","getProjectUpdates","shouldReschedule","projectId","updatedProject","max","initialDuration","newDuration","updatedSource","updatedTarget","updatedRelation","idMatch","targetMatch","sourceMatch","relationProp","projectForUpdate","childTask","isLinkExists","effectiveStart","reverse","unshift","breadthFirstSearch","queue","groupTasks","groupLinksInternal","groupLinksPublic","currentVertex","shift","splice","linksArray","linksObjects","processedLinks","ConnectedGroupsHelper","linksBuilder","getConnectedGroupRelations","_linksBuilder","getConnectedGroup","group","groups","map","LoopsFinder","isCircularLink","getLoopContainingLink","allRelations","findCycles","attachUIHandlers","loopsFinder","connectedGroupsHelper","_attachAutoSchedulingHandlers","movedTask","_scheduleAfterBatchUpdate","_autoScheduleAfterLinkChange","_autoscheduling_in_progress","batch_update","autoSchedule","_preventCircularLink","slackConfigValue","_preventDescendantLink","auto_scheduling_descendant_links","_datesNotEqual","taskA","taskB","_notEqualTaskDates","task1","task2","milestone","getRelations","resetToStartLinksLags","relationsArray","skipped","originalLink","presentLinks","updatedLinks","shouldKeepConstraints","oldTask","updateTaskConstraints","constraintTypes","constraint_types","backwardConstraints","forwardConstraints","indexOf","finalizeTaskConstraints","attachEvent","auto_scheduling_initial","mode","drag_mode","_processConstraints","newTask","changedConstraint","modifiedTaskId","ext","inlineEditors","autoscheduleColumns","state","columnName","durationColumn","startDateColumn","endDateColumn","linkedColumnEdit","inline_editors_date_processing","constraintDateColumn","$keep_constraints","draggedTask","progressScheduling","shouldResetSSandSFLinkLags","_autoSchedule","editorConfig","getEditorConfig","map_to","once","getNodePosition","elem","top","left","right","bottom","getBoundingClientRect","box","body","document","docElem","documentElement","parentNode","scrollTop","window","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","offsetWidth","offsetHeight","parseInt","offsetTop","offsetLeft","offsetParent","y","round","x","width","height","isVisible","display","visibility","getComputedStyle","style","currentStyle","hasNonNegativeTabIndex","getAttribute","hasHref","a","area","nodeName","loLowerCase","isEnabled","input","select","textarea","button","object","toLowerCase","hasAttribute","getFocusableNodes","nodes","querySelectorAll","join","nodesArray","$position","sort","b","tabIndex","getScrollSize","div","createElement","cssText","appendChild","clientWidth","removeChild","getClassName","className","baseVal","_trimString","addClassName","removeClassName","name","split","regEx","RegExp","replace","toNode","getElementById","querySelector","insertNode","newone","innerHTML","firstChild","removeNode","getChildNodes","css","ch","childNodes","out","getTargetNode","trg","tagName","event","srcElement","shadowRoot","composedPath","locateAttribute","attribute","str","trim","locateClassName","classname","strict","ind","charAt","getRelativeEventPosition","ev","d","clientX","clientY","getRelativeNodePosition","childPos","parentPos","closest","element","selector","matches","msMatchesSelector","webkitMatchesSelector","el","contains","parentElement","nodeType","console","error","getClosestSizedElement","isShadowDomSupported","head","createShadowRoot","attachShadow","getActiveElement","activeElement","getSelection","focusNode","getRootNode","ShadowRoot","host","classList","test","scope","global","EventsManager$1","_mouseDown","_domEvents","_createDomEventScope","selectedRegion","useKey","ignore","_target","getViewPort","_originPosition","_restoreOriginPosition","position","$services","getService","registerProvider","autoscroll","scheduledDndCoordinates","startDragAndDrop","setStart","copy","setPosition","setEnd","attach","filterTargets","utils","dom","_getCoordinates","eventElement","domHelpers.getRootNode","$root","coordinates","dragEnd","dragTimeline","clickDrag","dragTimelineUseKey","drag_timeline","relative","render","detach","detachAll","unregisterProvider","viewPort","viewPortBounds","absolute","EventHost","_silent_mode","listeners","_silentStart","_silentEnd","createEventStorage","handlers","eventStorage","combinedResult","handlerResult","addEvent","handler","settings","t","handlerId","originalHandler","removeEvent","clear","makeEventable","eventHost","eventName","thisObject","bind","attachAll","eventArguments","handlerName","checkEvent","detachEvent","list","eventId","detachAllEvents","SelectedRegion","view","_el","defaultRender","start","end","_singleRow","pos","_getTaskPositionByTop","_startPoint","_view","_viewPort","add","_callback","_endPoint","draw","eventable","singleRow","_useRequestAnimationFrame","useRequestAnimationFrame","requestAnimationFrame","getElement","startPoint","_startDate","dateFromPos","endPoint","_endDate","_positionPoint","positionPoint","max_date","tasksByTime","getTaskByTime","tasksByIndex","_getTasksByTop","startValue","endValue","startIndex","endIndex","getTaskByIndex","getItemIndexByTopPosition","getItemHeight","getItemTop","dataHeight","getTotalHeight","row_height","getTaskCount","_dragInProgress","EventsManager","_calculateDirectionVector","_trace","dots","vectors","resultVector","vector","magnitude","sqrt","angleDegrees","atan2","PI","_applyDndReadyStyles","_timeline","$task","_clearDndReadyStyles","remove","_getScrollPosition","timeline","$ui","getView","$config","scrollX","getScrollState","scrollY","_countNewScrollPosition","coords","shiftX","shiftY","_scrollState","_setScrollPosition","scrollLayoutCell","$id","_stopDrag","_originalReadonly","readonly","_originAutoscroll","_startDrag","create","enabled","clickDragUseKey","click_drag","scrollPosition","modals","modalsStack","isModal","afterPopup","$destroyed","focus","startModal","eventRemove","trapFocus","endModal","currentTarget","$keyboardNavigation","traceLightbox","getLightbox","focusElement","QuickInfo","show","_showForTask","_showAtCoordinates","hide","forced","qi","_quickInfoBox","_quickInfoBoxId","_quickInfoTask","quick_info_detached","getNode","setContainer","container","_container","setContent","content","defaultContent","header","title","buttons","quickinfo_buttons","_createQuickInfoElement","titleBox","titleContent","titleDate","main","controls","_waiAria","quickInfoHeader","html","ariaAttr","quickInfoButtonAttrString","locale","labels","_qiButtonClickHandler","_qiKeyPressHandler","_qi_button_click","code","which","_appendAtCoordinates","show_quick_info","_getContainer","_get_event_counter_part","xViewport","yViewport","_init_quick_info","_prepare_quick_info_classname","_fill_quick_data","_show_quick_info","offset","domEv","getTaskNode","getTaskRowNode","scroll","dx","dy","quickInfoAttr","quickInfoHeaderAttrString","_quickInfoReadonly","isReadonly","getTaskType","template","templates","quick_info_class","allowedButtons","isEditor","icon_delete","icon_edit","quick_info_title","quick_info_date","quick_info_content","popupHeight","scrolls","screenWidth","relativePopupBottom","mask","$click","$task_data","$grid_data","$grid","$layout","seed","plainObjectConstructor","toString","helpers.isDate","helpers.isArray","Object","hasOwnProperty","force","f","defined","uid","functor","capture","addEventListener","removeEventListener","createScope","utils.event","utils.eventRemove","eventScope","staticArray","extend","Tooltip","_tooltipNode","tooltipAttr","_root","domHelpers.isChildOf","_isLikeMouseEvent","_calculateTooltipPosition","tooltipVisibleAttr","tooltipHiddenAttr","viewport","_getViewPortSize","tooltipNode","tooltip","offsetX","tooltip_offset_x","offsetY","tooltip_offset_y","mouse","domHelpers.getRelativeEventPosition","containerPos","domHelpers.getNodePosition","_getViewPort","TooltipManager","_listeners","domEventsScope","_initDelayedFunctions","destructor","delayHide","watchableTarget","eventTarget","domHelpers.getTargetNode","targetNode","domHelpers.closest","doOnMouseEnter","onmouseenter","onmousemove","onmouseleave","listener","cloneDomEvent","clone","createEvent","delayShow","helpers.delay","tooltip_timeout","tooltip_hide_timeout","noTrack","onBeforeUndo","onBeforeRedo","batchActions","Monitor","undo","_batchAction","_batchMode","_ignore","_ignoreMoveEvents","_initialTasks","_initialLinks","_nestedTasks","_nestedLinks","_undo","_attachEvents","overwrite","undo_types","_storeTask","_storeLink","isMoveEventsIgnored","newValue","startIgnore","_timeout","stopBatchAction","action","logAction","_storeTaskCommand","command","update","$local_index","getTaskIndex","_storeEntityCommand","getInitialTask","move","entity","childrenLinks","_storeLinkCommand","taskIds","linkIds","_getLinks","setInitialTask","uniqueLinks","setInitialLink","$index","getGlobalTaskIndex","setInitialTaskObject","deleteCacheCooldown","saveInitialAll","clearInitialTasks","clearInitialLinks","getLinks","getMoveObjectByTaskId","stopIgnore","startBatchAction","clearUndoStack","clearRedoStack","onTaskAdded","onTaskUpdated","onTaskDeleted","onLinkAdded","onLinkUpdated","onLinkDeleted","onTaskMoved","toggleIgnoreMoveEvents","nested","setNestedTasks","datastore","getDatastore","tindex","dragId","projectDrag","drag_project","plugins","multiselect","selectedIds","getSelectedTasks","onBeforeEditStartId","onEditStart","updateConfigs","undoEnabled","commands","old","actionType","entityType","_storeCommand","getInitialLink","Undo","maxSteps","redoEnabled","invert","revert","value","oldValue","inverseCommands","assert","_undoStack","_redoStack","getRedoStack","undo_steps","undo_actions","redo","_pop","_reorderCommands","_applyAction","_push","weights","any","actionWeights","weightA","entities","actions","methods","get","isExists","batchUpdate","method","getMethod","check","prop","copyProperty","startsWith","extensions","graph_helper","planner","connectedGroups","getConstraintLimitations","afterRenderBeforeFirstRepaint","updatedTasks","startTask","generatePlan","updateTask","applyProjectPlan","inclusive","parseDate","defaultConfig","setClickDrag","$container","critical_path","_private","_freeSlack","_totalSlack","_slackNeedCalculate","_linkedTasksById","_successorsByTaskId","_projectEnd","_calculateSlacks","linkedTasks","loops","loopLinks","loop","reversedOrder","successorsByTaskId","entry","linked","distCalculator","_cache","getDist","dist","_calculateFreeSlack","_calculateTotalSlack","_isCompletedTask","orderedFromEnd","successorsMap","freeSlack","tasksToDo","processedTasks","ownSlack","totalSlackByTaskId","successorLinks","totalSlack","successorLink","successorSlack","getFreeSlack","_resetTotalSlackCache","_shouldCalculateTotalSlack","getTotalSlack","minSlack","childSlack","dropCachedFreeSlack","init","slackHandler","criticalPath","_isProjectEnd","_getProjectEnd","_slackHelper","reset","_calculateCriticalPath","isCriticalTask","hasCritical","slackHelper","resetCache","handleTaskIdChange","oldId","newId","criticalPathHandler","highlight_critical_path","refreshTask","isCriticalLink","getSlack","common","newSlack","_getSlack","next_task","_isDragInProgress","fullscreen","isExpanded","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","isFullscreenAvailable","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled","backupBodyPadding","overflow","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","backupElementSizes","zIndex","modified","backupPositioning","updateSizes","expandGantt","onFullScreenChange","getFullscreenElement","positions","originalPositioning","record","restoreSizes","cantFullscreen","warning","log","requestArguments","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","requestExitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","exitFullscreen","toggle","collapse","expand","keyboard_navigation","keyboard_navigation_cells","_compose","parts","p","shortcuts","createCommand","modifiers","alt","ctrl","meta","keyCode","parse","shortcut","expr","getExpressions","words","getWords","commandKeys","specialKeys","charCodeAt","getCommandFromEvent","domEvent","shiftKey","altKey","ctrlKey","metaKey","printableKey","fromCharCode","getHashFromEvent","getHash","junctionChar","term","combinationChar","backspace","tab","enter","esc","space","up","down","home","pageup","pagedown","delete","insert","plus","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","EventHandler","_handlers","findHandler","doAction","facade","preventDefault","returnValue","unbind","bindAll","initKeys","keys","domHelpers.getFocusableNodes","focusable","currentFocus","domHelpers.getActiveElement","currentIndex","lastItem","firstItem","GanttNode","blur","scrollHorizontal","scale","getScale","step","scrollTo","posFromDate","scrollVertical","KeyNavNode","isValid","fallback","moveTo","dispatcher","setActiveNode","compareTo","canStringifyThis","canStringifyThat","eventFacade","setAttribute","$eventAttached","HeaderCell","show_grid","getVisibleTaskCount","getGridColumns","TaskRow","visibleColumns","fromDomElement","cellElement","domHelpers.locateClassName","previousSibling","$grid_scale","columns","taskRow","rootLevel","TaskCell","click","createTask","globalIndex","splitItem","$split_subtask","parentId","getParent","nextIndex","locate","isTaskVisible","task_attribute","replaceAll","keptFocus","getTaskPosition","getTaskHeight","viewWidth","viewHeight","inner_width","inner_height","visibleTimeline","show_chart","scroll_on_click","task_scroll_offset","grid","scrollPositionX","scrollPositionY","attachedScrollbarHorizontal","scrollable","scrollbarHorizontal","attachedScrollbarVertical","scrollbarVertical","nextElement","prevTask","getPrev","nextTask","getNext","$open","open","close","prevId","getPrevSibling","moveTask","isSelectedTask","unselectTask","selectTask","showLightbox","columnIndex","domHelpers.locateAttribute","show_tasks_outside_timescale","row","isActive","activeNode","globalNode","enable","getActiveNode","disable","getDefaultNode","setDefaultNode","inputs","focusGlobalNode","blurNode","focusChanged","keyDownHandler","defaultPrevented","ganttNode","awaitsFocus","clearDelay","isTaskFocused","isInlineEditorCell","isNoKeyboardNavigationElement","focusHandler","$preventDefault","reFocusActiveNode","outsideGantt","localName","domElement","mousedownHandler","locateTask","taskBar","gridLeft","gridRight","nodePosition","rightPosition","positionX","column","removeAttribute","onReady","$data","tasksStore","currentNode","gridDataTopScroll","gridDataBottomScroll","_smart_render","updateRender","_redrawTasks","renderers","items","focusedItemVisible","createdTaskId","keepFocusOnNewTask","nodeConstructor","placeholder_task","focusOnCreate","interval","setInterval","getScope","scopes","headerCell","taskCell","findVisibleColumnIndex","clearInterval","keyNavFacade","addShortcut","scopeObject","getShortcutHandler","getCommandHandler","removeShortcut","keyboardNavigation","quick_info","quickInfo","text","substr","details","task_time","events","hidingFunction","clearQuickInfo","hideQuickInfo","showQuickInfo","tooltipManager","tooltips","tooltipFor","touch","touch_tooltip","targetTaskId","tooltip_text","hideTooltip","link_source_id","monitor","isEqualIds","first","updTask","changeTaskCommandId","updLink","oldTaskId","newTaskId","changeLinkCommandId","updateTasksIds","updateLinksIds","getUndoStack","setUndoStack","setRedoStack","saveState","getInitialState","grouping","setRelationValueForAssignmentsArray","newGroupValues","oldRelationProperty","resources","resource_id","newRelationProperty","Set","new_value","reduce","resourceAssignmentIndexes","resourceId","assignmentIndex","setRelationValueForPrimitivesArray","_getResourcesIds","_getEntryId","_getGroupId","relationProperty","_initBeforeDataRender","_this","_listenerToDrop","delayedFunction","_groups","dynamicGroups","regroup","scrollState","is_active","relation_property","relation_id_property","group_id","group_text","loading","loaded","set_relation_value","_searchCache","self","originalGetParent","invalidParent","noRelationValueFunction","Function","save_tree_structure","oldParentTask","newParentTask","cyclicTree","parentTask","order_branch","$initial_parent","renderedParent","$rendered_parent","initialParent","restoreParent","get_parent","originalSetParent","setParent","new_pid","groupIds","groupId","_buildCache","virtualParentId","_setParentInner","_clearCache","getItems","parent_group_id","_groups_pull","parent_id","generate_sections","groups_type","clear_temp_tasks","generate_data","$calculate_duration","categories","data","update_settings","group_tasks","groups_array","selectedTasks","_clear_data","schedulingOnParse","groupBy","relationInfo","resourceAssignments","arrays","haveArrays","haveResourceAssignments","default_group_label","default_group","groupOpenCloseState","restoreOpenCloseState","resultObj","itemsByKey","property","delimiter","hasDefaultGroup","defaultGroupId","default","label","taskGroupValue","marker","render_marker","show_markers","min_date","marker_class","markerHeight","getRowTop","timeline_placeholder","scrollHeight","initMarkerArea","$marker_area","markerArea","_markers","createDatastore","initItem","renderMarkers","createDataRender","defaultContainer","addLayer","getMarker","getItem","addMarker","addItem","deleteMarker","exists","removeItem","updateMarker","refresh","_getMarkers","multiselect_one_level","_multiselect","_selected","_one_level","_active","_first_selected_when_shift","getDefaultSelected","selected","getSelected","setFirstSelected","getFirstSelected","updateState","active","select_task","setLastSelected","silent","unselect","getLastSelected","last","getSelectedId","afterSelect","isSelected","forSelected","isSameLevel","calculateTaskLevel","_quickRefresh","doSelection","_is_icon_open_click","target_ev","defaultLast","isLast","multiSelect","singleSelection","controller","cell","locateCell","inline_editors_multiselect_open","startEdit","blockSelection","first_indx","target_indx","last_indx","tmp","old_selectTask","old_unselectTask","toggleTaskSelection","eachSelectedTask","getLastSelectedTask","old_isSelected","new_id","task_id","oldSelectedId","oldSelectedTask","newSelectedTask","differentTreeLevel","$level","overlay","overlays","initOverlayArea","$overlay_area","overlayArea","attachUnnattached","isAttached","attachOverlay","showOverlayArea","hideIfNoVisibleLayers","isConnected","addOverlay","deleteOverlay","getOverlaysIds","refreshOverlay","showOverlay","hideOverlay","isOverlayVisible","export_api","_apiUrl","previousDateRage","str_to_date","date_format","_serializeHtml","_prepareConfigPDF","_serializeAll","_fixColumns","raw","_preparePDFConfigRaw","version","_sendToExport","_pdfExportRouter","_serializePlain","dates","smartRendering","smart_rendering","visual","convert","_eachTaskTimed","_no_progress_colors","_serializeTimeline","_serializeGrid","rawDates","scales","_serializeScales","worktime","_getWorktimeSettings","formData","File","FormData","append","_sendImportAjaxExcel","_sendImportAjaxMSP","importFromPrimaveraP6","importFromMSProject","skip_circular_links","oldXmlFormat","xml_format","oldFormatDate","format_date","oldXmlDate","xml_date","oldDateFormat","exportServiceDateFormat","date_to_str","_customProjectProperties","_customTaskProperties","_clearRecLinks","_exportConfig","$custom_data","custom","exportToPrimaveraP6","exportToMSProject","url","pack","cb","ajax","post","base","$template","server","JSON","stringify","sheet","xhr","XMLHttpRequest","onreadystatechange","readyState","status","onload","info","responseText","setRequestHeader","send","encodeURIComponent","_xdr","loader","xdoc","xmlDoc","col","editor","editor_types","skin","_serializableGanttConfig","_markColumns","_ajaxToExport","form","_createHiddenForm","submit","_hidden_export_form","deadline","formatDate","_color_box","_color_hash","color","_getColor","backgroundColor","parsedRanges","minutes","range","startMinute","endMinute","defaultWorkTimes","hours","time","work_time","wTime","_working_time_helper","get_calendar","worktimes","parsed","_getMinutesWorktimeSettings","master","branch","_pull","_originalCopyObject","json","_copyObject","task_text","_copyObjectBase","rgb","match","toISOstring","_copyObjectColumns","_copyObjectPlain","getDayIndex","_day_index_by_date","columnIndexByDate","$start","$end","hiddenCells","scaleCellsWidth","$type","$rendered_type","tmps","$text","$left","leftside_text","$right","rightside_text","_copyObjectTable","$color","ct","val","date_grid","smartScales","smart_scales","_copyObjectAll","_exportSerialize","_scale_helpers","_get_scales","minWidth","min_column_width","autosizeMinWidth","_get_resize_options","autosize_min_width","scale_height","prepareConfigs","availWidth","autosize","_getScales","rtl","$scaleHelper","_copyObjectColors","cellColors","timeline_cell_class","task_cell_class","_getRaw","steps","trace_x","styles","cellCss","_getStyles","Infinity","col_width","format","date_scale","scaleCell","scaleCell_class","scaleCss","exportMode","cols","ccount","tree","xmlFormat","serialize","_lvl","_setLevel","_makeLinksSameLevel","skippedLinks","_clearCircDependencies","_clearLinksSameLevel","_clearLevel","usedTasks","prevLink","sources","$_source","_onCircDependencyFind","targets","curLink","_source","targetLvl","linkT","$_target","projectName","projectDates","start_end","manual","durationUnit","projectProperties","taskProperties","exportToPDF","exportToPNG","exportToICal","exportToExcel","exportToJSON","importFromExcel","constants","KEY_CODES","UP","DOWN","LEFT","RIGHT","SPACE","ENTER","DELETE","ESC","TAB","ExtensionsManager","addExtension","_extensions","getExtension","layout","rows","resizer","auto_types","duration_unit","correct_work_time","skip_off_time","cascade_delete","autoscroll_speed","deepcopy_on_parse","show_links","show_task_cells","static_background","static_background_cells","branch_loading","branch_loading_property","show_loading","min_duration","start_on_monday","server_utc","show_progress","fit_tasks","preserve_scroll","container_resize_timeout","deadlines","drag_links","drag_progress","drag_resize","drag_move","resize","round_dnd_dates","link_wrapper_width","link_arrow_size","autofit","align","scale_offset_minimal","inherit_scale_class","time_step","duration_step","task_date","time_picker","link_attribute","layer_attribute","buttons_left","_migrate_buttons","dhx_save_btn","dhx_cancel_btn","dhx_delete_btn","buttons_right","lightbox","sections","project_sections","milestone_sections","single_date","drag_lightbox","details_on_create","details_on_dblclick","initial_scroll","order_branch_free","task_height","bar_height","bar_height_padding","min_grid_column_width","grid_resizer_column_attribute","keep_grid_width","grid_resize","grid_elastic_columns","show_unscheduled","resize_rows","task_grid_row_resizer_attribute","min_task_grid_row_height","readonly_property","editable_property","calendar_property","resource_calendars","dynamic_resource_calendars","inherit_calendar","type_renderers","open_tree_initially","optimize_render","prevent_default_scroll","show_errors","wai_aria_attributes","horizontal_scroll_key","drag_multiple","csp","isWindowAwailable","env","isIE","navigator","userAgent","isIE6","isIE7","isIE8","isOpera","isChrome","isKHTML","isFF","isIPad","search","isEdge","isNode","serialized","createConfig","Error","async","headers","fastVersion","utc","dateToStrFn","to_fixed","getISOWeek","getWeek","splt","strToDateFn","dateString","cspVersion","getUTCDate","getUTCMonth","getUTCFullYear","day_short","getUTCDay","getDay","day_full","month_short","month_full","getUTCHours","getHours","getUTCMinutes","getMinutes","getUTCSeconds","getSeconds","getUTCISOWeek","set","temp","month_short_hash","month_full_hash","UTC","canUseCsp","useCsp","dateHelper","s","date_part","setHours","hour_start","setTime","time_part","getTimezoneOffset","week_start","month_start","setDate","quarter_start","res_month","setMonth","year_start","day_start","setMinutes","minute_start","setSeconds","getMilliseconds","setMilliseconds","_add_days","modifiedDate","inc","originalDate","incCondition","getHoursCondition","getDateCondition","ndate","setYear","add_quarter","num","cspCompliantVersion","_getWeekNumber","isoWeek","nday","first_thursday","year_number","ordinal_date","convert_to_utc","parse_date","token","_url","_token","_mode","_seed","_queue","api","_events","Accept","credentials","fetch","then","websocket","_wrapper","connect","_socket","onclose","location","protocol","r","WebSocket","onmessage","fire","onError","_send","_resubscribe","Promise","_uid","resolve","reject","onCall","catch","onResponse","remoteEvents","remote","remote_client.Client","req","_ready","load","back","_remote","ready","on","checkTimeout","updPerSecond","_on_timeout","ceil","StateService","stateProviders","internal","utils.mixin","provider","Promise$1","$powerArray","$create","$removeAt","$remove","$find","$insertAt","$each","$map","$filter","isPlaceholderTask","DataStore","pull","$initItem","visibleOrder","powerArray","fullOrder","_skip_refresh","_filterRule","_searchVisibleOrder","_indexRangeCache","_getItemsCache","_attachDataChange","_parseInner","copyOnParse","utils.copy","isSilent","_updateOrder","updateItem","utils.defined","_removeItemInner","_addItemInner","order","data_size","getVisibleItems","getIndexRange","utils.uid","_changeIdInner","changeId","_moveInner","sindex","getIdByIndex","clearAll","alreadySilent","arraysEqual","arr1","arr2","quick","skipFilter","_quick_refresh","_mark_recompute","oldOrder","count","countVisible","eachItem","rule","filteredOrder","placeholderIds","_ganttConfig","cacheKey","ret","getIndexById","_getNullIfUndefined","getFirst","getLast","TreeDataStore","_branches","loadedItem","existingItem","$parentProperty","parentProperty","$getRootId","$openInitially","openInitially","_eachItemMainRangeCache","getConfig","splitParents","splitItems","taskOpenState","taskVisibility","haveSplitItems","_isSplitItem","canOpenSplitTasks","open_split_tasks","$expanded_branch","isHeadless","_buildTree","_add_branch","calculateItemLevel","getBranchIndex","targetIndex","_move_branch","_replace_branch_child","_traverseBranches","itemId","sid","source_pid","tbranch","tid","diff","childId","pid","getSiblings","getNextSibling","siblings","nextSibling","level","_eachItemCached","cache","_eachItemIterate","startId","itemsStack","useCache","buildCache","startItem","parentsHash","old_parent","new_parent","old_id","newbranch","field","desc","criteria","original_criteria","els","actualParent","_skipTaskRecalculation","datastoreRender","itemRepainter","renderer","renders","getLayers","render_item","allData","loadedRanges","layer","layerData","get_visible_range","prepare_data","render_items","update_items","extraDataArr","skipRepaint","getDataRender","onUpdateRequest","change_id","getDatastores","storeNames","facadeFactory","$StoreType","selectedId","deleteItem","subItem","storeAccessName","dropService","storeList","setService","_getDatastores","refreshData","stores","refresh_links","refreshLinks","refreshLink","_bulk_dnd","hasSplitParent","isSplitTask","linksStore","_update_flags","userdata","oldSelectId","_skipResourceRepaint","addTask","parentObj","deleteTask","utils.bind","changeTaskId","oldid","newid","getLinkCount","addLink","newLink","updateLink","deleteLink","changeLinkId","ScaleHelper","services","getSum","sizes","summ","setSumWidth","sum_width","adjustSize","full_width","splitSize","full","share","sortScales","cellSize","_isLegacyMode","scaleConfig","scale_unit","subscales","_prepareScaleObject","primaryScale","legacyMode","initTemplate","scale_cell_class","getSubScales","docLink","warn","min_coll_width","container_width","minDate","maxDate","heights","configs","main_scale","cfg","initScaleConfig","processIgnores","initColSizes","limitVisibleRange","alineScaleColumns","reverseScale","setPosSettings","indexes","trace_indexes","trace_index_transition","_ignore_time_config","skip","probe","isWorkTime","ignore_x","display_count","min_col_width","line_height","cont_width","column_count","ignores","eachColumn","trace_x_ascending","iterateScales","lower_scale","upper_scale","upper_dates","lower_dates","prevUpper","target_index","upper_start","upper_end","lower_start","lower_end","targetWidth","curr","tzOffset","_correct_dst_change","lastDate","outDate","shared","ScaleIgnoreHelper","helper","ignore_time","ignored_colls","_init_tasks_range","PrimaryScaleHelper","start_interval","onlyProjectTasks","extendRangeForDates","baselines","baseline","_min_date","_max_date","updateTasksRange","old_min","old_max","copyLinkIdsArray","targetHash","copyLinkIds","treeHelper","getSubtreeLinks","getSubtreeTasks","DataProcessorEvents","dp","$gantt","$dp","_dataProcessorHandlers","cascadeDelete","clientSideDelete","setGanttMode","setUpdated","_sendTaskOrder","deleteAfterConfirmation","needDbDelete","needCascadeDelete","dpMode","updateMode","setUpdateMode","cascade","storeItem","sendAllData","_tSend","_waitMode","itemLinks","_links","_dp","_tMode","_serverProcessor","_ganttMode","substring","serverProcessor","pluralizedMode","urlSeparator","upd","xml","_xmlNodeToJSON","isExist","objData","assignmentsStore","handleResourceCRUD","handleResourceAssignmentCRUD","handleBaselineCRUD","updated","updatedRows","clientOnly","getUserData","_in_progress","dataprocessor_assignments","resource_assignment_store","insertedTasks","pendingAssignments","insertResourceAssignment","assignment","dataprocessor_resources","resourcesStore","resource_store","resource","dataprocessor_baselines","baselineStore","SimpleStorage","_storage","getStoredItem","_de","DataProcessor$1","serverProcessorURL","action_param","autoUpdate","_headers","_payload","_postDelim","_routerParametersFormat","_invalid","messages","inserted","deleted","invalid","invalid_cell","enableUTFencoding","total","payload","_serializeAsJson","_router","router","_utf","escape","dnd","rowId","findRow","existing","set_invalid","setUserData","is_invalid","markRow","sendData","_methods","editStop","pendingUpdateModes","modes","checkBeforeUpdate","_beforeSendData","_getRowData","_serializeAsJSON","serialize_one","security_key","pref","valid","_forEachUpdatedRow","_sendData","_getAllData","pattern","_uActions","btag","ganttMode","correct","originalSid","that","_xml","getGanttMode","reqUrl","filePath","tag","processCallback","afterUpdateCallback","finalizeUpdate","xmltop","cleanUpdate","atag","xpath","_initialized","_dp_init","_setDefaultTransactionMode","delete_confirmation","_change_id","_row_style","$dataprocessor_class","_delete_task","$drop_target","setDp","dataProcessorEvents","user","_user","_needUpdate","_updateBusy","afterAutoUpdate","fullSync","loadUpdate","xml_node","getUpdates","vers","_getXmlNodeValue","updates","newState","dataToSend","processedData","_cleanupArgumentsBeforeSend","_cleanupItemBeforeSend","updatedItem","taskState","taskAction","getActionByState","_onResolvedCreateUpdate","actionPromise","errorMsgStart","errorMsgEnd","queryParams","afterUpdate","dhxVersion","urlParams","_applyPayload","preprocessedData","query","setTransactionMode","nodeValue","hasOne","traversedObjects","_prepareDate","helpers.arrayIncludes","_prepareArray","_prepareObject","rawItem","processedItem","dataItem","_prepareDataItem","DataProcessor","DEPRECATED_api","DataProcessor.DataProcessor","createDataProcessor","tMode","createMethod","disableMethod","methodName","dummyMethod","restoreMethod","disableMethods","methodsHash","restoreMethods","batchUpdatePayload","noRedraw","dp_mode","call_dp","resetProjects","resetProjectDates","createWbs","_needRecalc","_isRecalcNeeded","_isGroupSort","_getWBSCode","_calcWBS","$wbs","_setWBSCode","getWBSCode","getByWBSCode","_isFirst","_prevSibling","_getPrevNonPlaceholderSibling","_increaseWBS","_parent","siblingiId","_wbs","prevSibling","wbs","getTaskByWBSCode","createResourceMethods","resourceTaskCache","singleResourceCacheBuilt","falsyValuePrefix","random","resourceHashFunction","getCacheKey","resourceIds","typeFilter","getResourceTasks","matchingResources","resourceValue","selectAssignments","resource_property","owners","getTaskBy","propertyName","propertyValue","getResourceAssignments","assignments","resourcePlugin","renderEditableLabel","editable","$task_id","$resource_id","renderSummaryLabel","sum","Number","editableResourceCellTemplate","$role","editableResourceCellClass","capacity","getSummaryResourceAssignments","childResource","initEditableDiagram","resource_render_empty_cells","timeoutId","makeEditable","cancelAnimationFrame","contentEditable","getCellsByType","$content","currentFocusIndex","setNextFocus","focusableElementsAfterRender","dom_helpers.getFocusableNodes","assignmentEditInProcess","strValue","innerText","assignmentId","startDate","endDate","assignmentStore","nextChunk","updateTaskAssignments","editable_resource_diagram","fetchTasks","lightbox_resources","lightboxOptions","resourceStoreConfig","initItems","storeType","$resourcesStore","options","lightboxOptionsFnc","updateCollection","histogram_cell_class","histogram_cell_label","histogram_cell_allocated","histogram_cell_capacity","defaultResourceCellClass","defaultResourceCellTemplate","resource_cell_value","resource_cell_class","resource_assignments","resourceAssignmentsProperty","process_resource_assignments","resourceAssignmentFormats","auto","singleValue","valueArray","resourceValueArray","assignmentsArray","resourceAssignmentFormat","assignmentModes","fixedDates","fixedDuration","initAssignmentFields","initDelay","timing","_assignmentTimeFromTask","resourceAssignmentsStore","_makeAssignmentsFromTask","detectFormat","usedIds","defaultMode","_updateTaskBack","_assignAssignments","getTaskAssignments","_loadAssignmentsFromTask","_syncAssignments","storeAssignments","taskValues","assignmentsStoreValues","inBoth","inTaskNotInStore","inStoreNotInTask","taskOwner","ownerId","foundOwnerAssignment","taskSearch","storeSearch","processedIds","inTask","inStore","ignoreFields","_syncOnTaskUpdate","totalAssignments","needUpdate","needUpdateFor","undoBatchCancel","assignmentsHash","taskAssignmentsCache","idsSearch","deleteIds","resourceAssignmentsCache","resourceTaskAssignmentsCache","searchTaskId","resourceTaskCacheKey","getTaskResources","uniqueResources","addPlaceholder","callIfEnabled","insertPlaceholder","placeholders","new_task","afterEdit","dataProcessor","_silencedPlaceholder","isPlaceholderLink","auto_task_types","checkTaskType","changedTypes","targetType","getTaskTypeToUpdate","$needsUpdate","updateParentTypes","delTaskParent","allTypes","hasChildren","taskType","originalRowDndParent","originalMoveTaskParent","isParsingDone","updateAfterRemoveChild","DurationFormatter","canParse","_config","labelName","plural","short","formatUnits","useShortLabels","totalMinutes","transferUnits","toMinutes","_selectFormatForValue","countedValue","_getValueFromMinutes","_getValueInMinutes","_getLabelForConvert","part","isPartReady","needToParse","isNumber","symbol","_getNumericValue","fromMinutes","parseFloat","toFixed","_isUnitName","_getUnitName","isUnit","_defaultSettings","minutesPerHour","hoursPerDay","hoursPerWeek","daysPerMonth","daysPerYear","preparedSettings","values","numericValue","lettersValue","unitName","_be","LinkFormatterSimple","_linkReg","linkPart","exec","_findSource","pred","reqTemplate","_$e","LinkFormatter","super","formattedType","_getFormattedLinkType","_getLinkTypeName","_getLagString","lagPart","typeFormat","_findTypeFormat","typeNumber","_getLinkTypeNumber","_parseLag","linkName","formatted","durationFormatter","formatters","_xe","linkFormatter","empty_state_screen","show_empty_state","emptyStateElement","isGanttEmpty","placeholderContainer","empty_state_text_link","empty_state_text_description","clickEvents","detachAddTaskEvents","domHelpers","getContainer","wrapper","marginTop","oldNodes","attachAddTaskEvent","renderContent","emptyStateElementNode","hasBaselinesBelow","baselinesOnDifferentRow","render_mode","childrenHaveBaselines","hasBaselines","isSplitParent","getMaxParentHeight","heightLimit","maxHeight","shrinkHeight","splitChild","parentHeight","getItemPosition","rowHeight","getMilestoneHeight","getInvertedMilestoneHeight","getAdjustedPosition","childBaselines","splitParams","largerHeight","noNeedToShrink","heightDiff","additionalMargin","exceedBarHeight","exceedParentHeight","_adjustSplitParentHeight","maxParentHeight","adjustTaskHeightForBaselines","childHeight","_increaseSplitParentHeight","getLayoutView","getBarHeight","subtaskId","subtask","subtaskHeight","baselineSize","baselineAmount","subrowHeight","timelineView","newBaseline","existingBaseline","shouldRepaint","iteratedBaselines","taskBaselines","exisingBaselines","getTaskBaselines","exisingBaseline","repaint","createMixin","getItemTopCache","getRowTopCache","getItemHeightCache","totalHeightCache","getItemHeightCacheState","quickPosition","cachedRowHeight","canUseSimpleCalc","_getRowHeight","$getConfig","_refreshState","rowStore","globalRowHeight","canUseSimpleCalculation","_resetTopPositionHeight","_resetHeight","getCacheStateTotalHeight","shouldClearHeightCache","all","itemIndex","_fillHeightCache","defaultHeight","globalHeight","itemHeightCache","sumHeight","oldState","getHeight","visibleItems","totalHeight","next","ScrollableGrid","params","_scrollOrder","getCurrentX","_dnd","_scrollView","attachEvents","isScrollable","gridBoundingRect","maxLeft","minLeft","currentX","autoscrollRight","autoscrollStart","autoscrollLeft","autoscrollStop","scrollStep","COLUMN_ID_ATTR_NAME","ColumnsGridDnd","_targetMarker","calculateCurrentPosition","eventX","DND","updates_per_second","_scrollableGrid","_draggedCell","draggedColumn","draggedIndex","_gridConfig","outerHTML","lineHeight","_dragX","columnIndexes","findColumnsIndexes","setMarkerPosition","drawTargetMarker","targetColumn","cleanTargetMarker","reorderColumns","draggedId","xBefore","xAfter","currentColumn","startX","endX","columnRelativePos","compare","relativeX","getCorrection","gridOffset","_obj","nextPosition","domHelpers.addClassName","delegate","mouseEvents","h","Grid","factory","$parent","$state","topPositionMixin","parsing","jsonParseError","on_load","resp","responseURL","_process_loading","collections","_load_collections","assignmentsByTasks","collections_loaded","collection","serverList","option","option_key","$ignore","dhx_security","serializeTask","serializeLink","_copyLink","rawLinks","baselineCopy","attrs_only","attributes","_getCollections","opts","itms","attrs","k","attr","_getXML","toptag","getXMLTopNode","skey","evs","oldxml","startdate","est","enddate","predecessortasks","message","IsWorkTimeArgument","calendar","ClosestWorkTimeArgument","CalculateEndDateArgument","GetDurationArgument","gridAriaAttr","gridAttrString","gridDataAriaAttr","gridDataAttrString","reorder_grid_columns","gridScaleRowAttrString","item_attribute","layers","_createLayerConfig","_grid_resize","column_before_start","column_index","column_after_start","drag_index","column_drag_move","dd","target_column","pointerPosition","minPointerPosition","min_width","maxPointerPosition","markerStartPosition","marker_width","limit_max","max_width","maxWidth","rightColumnsWidth","parentLayout","parentWidth","$lastSize","$cells","column_drag_end","columns_width","final_width","grid_width","_setColumnsWidth","_syncCellSizes","isGravity","DnD","dnd_sensitivity","sensitivity","doOnRender","totalWidth","lineHeigth","resize_el","gridSeparatorAttr","_renderHeaderResizers","_mouseDelegates","mouseEventContainer","resizerrow","_task_grid_row_resize","row_before_start","row_id","row_after_start","row_drag_move","itemHeight","itemTop","marker_height","row_drag_end","oldItemHeight","finalHeight","_addLayers","_initEvents","_columnDND","ColumnDnd","_validateColumnWidth","numericWidth","setSize","outerWidth","innerWidth","elasticColumns","columnProperty","newColumnWidth","columnsWidth","getSize","contentHeight","contentWidth","_getGridWidth","contentX","contentY","scrollWidth","_bindStore","_gridCacheAttached","_unbindStore","_initSmartRenderingPlaceholder","_calculateGridWidth","_renderGridHeader","y_end","x_end","scrolled","getColumnIndex","excludeHidden","hiddenIndexShift","getColumn","hidden","gridLine","gridTaskRowResizer","_taskLayers","taskRenderer","taskLayers","bar_layer","_refreshPlaceholderOnStoreUpdate","scrollSize","$rowsPlaceholder","_staticBgHandler","_clearLayers","removeLayer","_getColumnWidth","new_width","_checkGridColumnMinWidthLimits","_getGridWidthLimits","min_limit","max_limit","newWidth","start_index","extra_width","start_width","iterator","curExtra","_getColsTotalWidth","cols_width","unknown","gridWidth","delta","changed","_setContentSize","cells","colWidth","_sort","direction","cssClass","grid_header_class","gridScaleCellAttrString","calendarArgumentsHelper","getWorkHoursArguments","setWorkTimeArguments","unsetWorkTimeArguments","isWorkTimeArguments","processedConfig","getClosestWorkTimeArguments","arg","_getStartEndConfig","param","argumentType","getDurationArguments","hasDurationArguments","calculateEndDateArguments","WorkTimeCalendarMerger","_getIntervals","hoursArray","_toHoursArray","intervalsArray","formatHHMM","secondsValue","minutePart","_intersectHourRanges","baseArray","overridesArray","_mergeAdjacentIntervals","_mergeHoursConfig","firstHours","secondHours","merge","firstConfig","secondConfig","mergedSettings","customWeeks","processCalendar","config1","config2","date1","date2","hours2","WorkUnitsMapCache","timestamp","has","subCache","rawValue","unitCache","yearCache","Map","WorkUnitsObjectCache","LargerUnitsCache","getMinutesPerWeek","weekStart","_weekCache","_calendar","minutesPerWeek","getHoursPerDay","getMinutesPerMonth","monthStart","_monthCache","minutesPerMonth","nextMonth","DateDurationCache","stepCache","durations","endDates","compute","_getCacheObject","startDateTimestamp","_endDateCacheKey","resultTimestamp","_durationCacheKey","endDateTimestamp","CalendarWorkTimeStrategy","argumentsHelper","_workingUnitsCache","_largeUnitsCache","_dateDurationCache","_worktime","_cached_timestamps","_cached_timestamps_count","_clearCaches","_getUnitOrder","_resetTimestampCache","_timestamp","_checkIfWorkingUnit","hasDuration","_is_work_day","_getWorkHours","_is_work_hour","startHour","endHour","_getTimeOfDayStamp","dayEnd","_is_work_minute","checkTime","_nextDate","_getWorkUnitsBetweenGeneric","stepStart","stepEnd","checkFirst","checkLast","isLastStep","_isWorkTime","unitOrder","biggerTimeUnit","_getClosestWorkTimeFuture","_getMinutesPerHour","hourStart","hourEnd","_getMinutesPerDay","durationMinutes","durationHours","_getWorkUnitsForRange","getUnitsPerDay","_getMinutesBetweenSingleDay","_getIntervalTimestamp","minuteFrom","minuteTo","_getMinutesBetween","firstDayStart","firstDayEnd","lastDayStart","lastDayEnd","startPart","endPart","_getHoursBetween","_setConfig","_parseSettings","haveCustomWeeks","customWeeksRangeStart","customWeeksRangeEnd","customWeeksBoundaries","_parseHours","minCustomRangeStart","maxCustomRangeEnd","customTime","rangeStart","rangeEnd","fromReadable","toReadable","currentWeek","_tryChangeCalendarSettings","backup","hasWorkTime","_arraysEqual","_compareSettings","mySettings","thatSettings","myDays","otherDates","myHours","otherHours","equals","myWeek","thatWeek","getWorkHours","dateValue","endHours","timestampRanges","timerangeConfig","durationSeconds","setWorkTime","calendarConfig","unsetWorkTime","reset_calendar","dateKey","isWorkUnit","setItem","getDuration","_calculateDuration","sign","mult","getEndDate","_calculateEndDate","_calculateMinuteEndDate","_subtractMinuteDate","_calculateHourEndDate","_addInterval","stopAction","added","dstShift","_addHoursUntilDayEnd","rangeHours","addHours","intervalEnd","durationLeft","_addMinutesUntilHourEnd","rangeMinutes","addMinutes","_subtractMinutesUntilHourStart","hourStartTimestamp","initialDateTimestamp","minutePrecision","_isMinutePrecision","addedInterval","calculatedDay","daySchedule","minutesInDay","dayStart","iterateFromDayEnd","isWorkHour","workInterval","prevInterval","minutesInHour","_getClosestWorkTimePast","times","lastInterval","_getClosestWorkTime","inputDate","closestFuture","closestPast","_getClosestWorkTimeGeneric","_findClosestTimeInDay","resultDate","fromDayEnd","_getClosestWorkMinute","increment","hasRegularHours","_checkWorkHours","dayConfig","legacyResourceCalendarConfig","isLegacyResourceCalendarFormat","resourceCalendarsProperty","getResourceProperty","resourceCalendarsConfig","getCalendarIdFromLegacyConfig","calendarId","dynamicResourceCalendars","dynamicCalendars","getCalendarIdFromMultipleResources","manager","getResourceCalendar","tempCalendar","mergeCalendars","addCalendar","CalendarManager","_calendars","_legacyConfig","_isLegacyConfig","createDefaultCalendars","CalendarDisabledTimeStrategy","TimeCalculator","calendarManager","createArgumentsHelper","$disabledCalendar","NoWorkTimeCalendar","_convertWorkTimeSettings","days","calendars","mergeHelper","CalendarMergeHelper","_createCalendarFromConfig","createCalendar","apiCore","preparedConfig","parentCalendar","defaults","fulltime","getCalendar","getCalendars","_getOwnCalendar","resourceProperty","calendarsConfig","getTaskCalendar","taskObject","groupMode","currentTask","$effective_calendar","isCalendar","deleteCalendar","restoreConfigCalendars","possibleCalendar","every","fixedUnits","_getCalendar","worktimeFacadeFactory","timeCalculator","isUnscheduledTask","_isAllowedUnscheduledTask","_isTaskInTimelineLimits","taskStart","taskEnd","_getProjectStart","getDefaultTaskDate","_set_default_task_timing","$new","showTask","_lightbox_id","_tasks_dnd","drag","getTaskTimingMode","task_type","$no_start","$no_end","scheduled_summary","updateTaskTiming","assignProjectDates","taskTiming","summaryDateFields","manuallyScheduledSummaryDateFields","dateFields","_init_task_timing","getSubtaskInfo","rollup","isScheduledSummary","task_mode","dirty","effectiveCalendar","taskMode","$rollup","getSubtaskDuration","_update_parents","updateAll","has_changed","startDateField","$auto_start_date","endDateField","$auto_end_date","oldStart","oldEnd","roundDate","upper","lower","colIndex","correctTaskWorkTime","listenWindowResize","resizeDelay","resizeTimeout","previousSize","getContainerSize","container_resize_method","lowlevelResizeWatcher","$scrollbarRepaint","currentSize","repaintGantt","previousHeight","previousWidth","gantt_core","expire","invalidContainerMessage","validateNode","cloneNode","_reinit","dropLayout","_clearTaskLayers","_clearLinkLayers","rebuildLayout","calculateScaleRange","createView","getPropertyValue","resizeWatcher","contentWindow","resetLayout","initTemplates","domHelpers.toNode","$mouseEvents","edit","question","confirm_deleting","confirm_deleting_title","_simple_confirm","hideLightbox","visibleDate","posX","_getHorizontalScrollbar","codeScrollLeft","preserveScroll","new_pos","posY","getScrollbarsInfo","scroll_info","scrollbarNodeVisible","$view","boundViews","viewName","x_pos","setSizes","changeLightboxType","getLightboxType","_silent_redraw_lightbox","_get_link_type","from_start","to_start","isLinkAllowed","prevOffset","time_unit","helpers.getSecondsInUnit","offsetChanged","domHelpers.getClassName","icon_save","icon_cancel","icon_details","confirm_closing","section_description","section_time","section_type","section_deadline","section_baselines","column_wbs","column_text","column_start_date","column_duration","column_add","confirm_link_deleting","link_start","link_end","type_task","type_project","type_milestone","weeks","months","years","message_ok","message_cancel","section_constraint","asap","alap","snet","snlt","fnet","fnlt","mso","mfo","resources_filter_placeholder","resources_filter_label","baselines_section_placeholder","baselines_add_button","baselines_remove_button","baselines_remove_all_button","deadline_enable_button","deadline_disable_button","LocaleManager","addLocale","_locales","getLocale","DHXGantt","license","edit_save","edit_cancel","supportedExtensions","extensionManager","ExtensionManager","activePlugins","plugin","getter","service","DOMParser","ActiveXObject","loadXML","parseFromString","tagname","responseXML","getElementsByTagName","xpathExp","docObj","selectNodes","ownerDocument","evaluate","XPathResult","ANY_TYPE","iterateNext","_call","onLoad","getSync","put","postData","del","postSync","isQt","noCache","toUpperCase","RemoteEvents","copyDomEvent","pageX","pageY","_settings","inputMethods","getInputMethods","_drag_start_timer","clearDragTimer","eventParams","passive","accessor","timeStamp","original_target","original_element_sizes","domHelpers.getClosestSizedElement","dragStart","touch_drag","traceDragEvents","inputMethod","mousemove","dragMove","dragScroll","limited_mousemove","started","dndActive","cancelable","mousemoveContainer","mouseup","checkPositionChange","diff_x","diff_y","pow","initDnDMarker","backupEventTarget","getEvent","backup_element","touchEventsSupported","touches","elementFromPoint","pointerEnabled","pointerType","msPointerEnabled","MSPOINTER_TYPE_MOUSE","getPosition","_prevent_touch_scroll","_touch_drag","_touch_feedback","targetTouches","templatesLoader","regTemplates","initial","template_name","progress_text","task_class","task_end_date","grid_row_class","task_row_class","timeline_cell_content","scale_row_class","grid_indent","grid_folder","grid_file","grid_open","grid_blank","task_unscheduled_time","grid_date_format","link_class","link_description","drag_link","drag_link_class","tooltip_date_format","baseline_text","stateService","selected_task","deletedLinks","originalTask","checkLinkedTaskVisibility","sync_link","sync_link_delete","sync_links","mapEvents","conf","mapFrom","mapTo","sourceEvent","targetEvent","taskLinks","existingLink","typeMatch","changedTask","sourceVisible","targetVisible","onItemLoading","onBeforeAdd","onAfterAdd","onBeforeUpdate","onAfterUpdate","onBeforeDelete","onAfterDelete","onIdChange","onBeforeItemMove","onAfterItemMove","onFilterItem","onItemOpen","onItemClose","onBeforeSelect","onAfterSelect","onAfterUnselect","modules","new_task_placeholder","getGridColumn","checkType","activate","_cached_functions","update_if_changed","critical_path_mode","wrap_methods","_prefetch_originals","prefetch","methodname","original","optimizer","argumentsArray","get_arguments_hash","cached_values","has_cached_value","get_cached_value","cache_value","arguments_hash","is_date","stringify_argument","deactivate","setup","override_gantt","gantt_methods","deactivTimeout","_eventRemoveAll","resetLightbox","i18n","en","ar","be","ca","cn","cs","da","de","es","fa","fi","fr","he","hr","hu","it","jp","kr","nb","nl","no","pl","pt","ro","ru","si","sk","sv","tr","ua","setLocale","localeObject","gantt_save_btn","gantt_cancel_btn","gantt_delete_btn","boxAttribute","_dhx_msg_cfg","usercall","modalBox","modal_key","messageBox","keyboard","cancelBubble","modality","cover","onkeydown","messageButtonAttrString","getFirstDefined","_createBox","ok","cancel","contentId","messageModalAttr","inner","btn","onclick","innerHeight","alertPopup","confirmPopup","boxPopup","box_params","messageInfoAttr","insertBefore","timers","hideAll","popups","alert","confirm","modalbox","extendSettings","parentSettings","own","$extendedConfig","setPrototypeOf","configurable$1","parentView","parentConfig","parentTemplates","$getTemplates","uiFactory$1","views","createdViews","creator","configure","configurable","initUI","registerView","viewConstructor","createMouseHandler","eventHandlers","doubleclick","contextMenu","addEventTarget","onClick","findEventHandlers","callEventHandlers","onContextMenu","src","delegateHandlers","onDoubleClick","onMouseMove","_last_move_event","domEvents","elementHandlers","callHandler","genericViewPortChecker","isLegacyRender","getRowRectangle","getVisibleTasksRange","indexStart","indexEnd","extraTasksIds","inlineEditorId","layerFactory","renderFactory","task_area_pulls","task_area_renderers","getRenderer","renderMethod","updateMethod","getRectangle","renderCallbackMethod","specializedViewPortChecker","basicGetRectangle","onrender","isInViewPort","layerView","viewConfig","rendererViewPort","useBuffer","remove_item","rendered","clear_container","basicGetRange","getVisibleRange","prepareData","buffer","createDocumentFragment","vis","itemsSearch","renderedItems","newElements","nodesToRemove","renderCalledFor","itemNode","restore","replace_item","item_id","newNode","replaceChild","clearRenderers","createGroup","relativeRoot","defaultFilters","initLayer","renderGroup","tempCollection","filters","_add","getLayer","pending","topmost","mergeFilters","requestUpdate","eachLayer","filter_methods","filter_method","barRectangle","startCoord","endCoord","calculated","rec","sourceBox","targetBox","initialized","visibleBoxes","isLinkInViewPort","sourceTop","sourceHeight","targetTop","targetHeight","sourceLeft","sourceRight","targetLeft","targetRight","$skipSmartRenderOnScroll","Cell","headerHeight","$domEvents","$name","$factory","_headerClickHandler","final","$preResize","topCont","topSize","minHeight","_hide","cellIndex","moveView","$toHTML","canCollapse","$fill","collapsed","size","gravity","getContentSize","_getBorderSizes","borders","horizontal","vertical","_currentBorders","_borders","_sizeHeader","_sizeContent","_setBorders","domHelpers.removeClassName","cssHash","xLayout","transform","__extends","__","Layout","_super","_parseConfig","domHelpers.removeNode","_resizeScrollbars","scrollbars","scrollChanged","visibleScrollbars","hiddenScrollbars","scrollbarsToHide","showScrollbar","scrollbar","hideScrollbar","shouldHide","shouldShow","visibleGroups","scrollbarsInfo","visible","_getLinkedViews","x_inner","y_inner","y_pos","groupName","newSize","_eachChild","_syncGroupSize","_xLayout","newSizeValue","ownSize","resizeSibling","siblingSize","totalGravity","totalSize","mainGrid","startStage","mainCall","_resizeInProgress","contentViews","setContentSize","_getAutosizeMode","$originalWidthStored","$originalWidth","$originalHeightStored","$originalHeight","cellId","sub","getCells","domHelpers.insertNode","domHelpers.getChildNodes","_cleanElSize","_getBoxStyles","computed","properties","boxSizing","clientHeight","MozBoxSizing","horPaddings","borderLeftWidth","borderRightWidth","vertPaddings","borderTopWidth","borderBottomWidth","borderBox","outerHeight","boxSizes","contentSizes","_sizes","margin","_calcFreeSpace","side","_free","_gravity","_calcSize","_configureBorders","borderClass","lastVisibleIndex","lastCell","borderColorClass","_updateCellVisibility","oldVisibleCells","_visibleCells","firstCall","visibleCells","parentVisibility","hide_empty","hideCell","cellView","marginSide","ViewLayout","$cell","byMaxSize","otherCell","ViewCell","childConfig","$initialized","unload","outerX","outerY","childSize","ResizerCell","startBackSize","startFrontSize","getPageCoordinates","_moveHandler","_moveResizer","_resizer","_upHandler","newSizes","_getNewSizes","front","_setSizes","_setBackground","_clearResizer","_clearListeneres","_startOnMove","_cancelDND","_downHandler","_callStartDNDEvent","_xMode","_behind","_front","_startDND","_eachGroupItem","_getSiblings","_isPosChanged","_setResizer","_positions","now","classes","_getDirection","_getResizePosition","behindSide","behindMin","frontSide","frontMin","newBehindSide","newFrontSide","_getGroupName","resizers","_getGroupResizePosition","minMax","av","nextX","nextY","_setGravity","frontSize","behindSize","newFrontG","newBehindG","_assignNewSizes","resizeValue","ScrollbarCell","SCROLL_MODIFIER_KEYS","_scrollHorizontalHandler","_scrollVerticalHandler","_outerScrollVerticalHandler","_outerScrollHorizontalHandler","_mouseWheelHandler","scroll_size","_isHorizontal","eachCell","_isVertical","_initVertical","_initHorizontal","_initMouseWheel","_initLinkedViews","_getRootParent","_eachView","$scroll_hor","$scroll_ver","_updateLinkedViews","scrollHorizontally","_scrolling","oldSize","scrollVertically","_wheel_time","_oldLeft","_getScrollSize","outerSize","isHorizontal","scrollProperty","innerSizeProperty","outerProperty","_getScrollOffset","cellScrollSize","nonScrollableSize","outerScroll","innerScroll","scrollSizes","_setScrollSize","toggleVisibility","_getScaleOffset","_oldTop","_checkWheelTarget","connectedViews","wheelSpeed","wheelSpeedConfig","wheel_scroll_sensitivity","ff","deltaX","wheelDeltaX","deltaY","wheelDelta","multiplier","deltaMode","wx","wy","horizontalScrollModifier","oldLeft","detail","oldTop","createStaticBgHelper","canvasBgCache","staticBgStyleId","parseRgb","rgbCss","g","getUrlFromCache","getHashKey","cellStyles","bottomBorderColor","rightBorderColor","cacheUrl","generateBgUrl","canvas","context","getContext","image","createImageData","imageSmoothingEnabled","verticalLineWidth","rightBorderWidth","verticalLineColor","drawDot","horizontalLineWidth","bottomBorderWidth","horizontalLineColor","putImageData","toDataURL","matrix","getCssClass","createProbeElement","styleParams","firstRow","secondRow","firstRowCell","rowStyles","png","widths","differentWidths","styleHTML","bgImage","bgDivs","bgTiles","tile","prevCell","divs","prevWidth","leftPos","maxTileSize","appVersion","currentTop","tileWidth","currentHeight","pointerEvents","whiteSpace","fragment","destroy","canvasRender","Timeline","_posFromDateCache","_timelineDragScroll","clearTaskStoreHandler","_delayRender","ownStore","handlerIdProperty","$attachedResourceViewHandler","$attachedTaskStoreHandler","initGrid","destroyGrid","_linkToTaskStore","previousDragId","relevantResources","delayRender","linkedStore","repaintStack","_getRelevantResources","_updateNestedTasks","_getIdsFromAssignments","resourceStore","toAddArray","toAdd","toDelete","addedTasks","resourceData","resource1","resource2","$task_scale","taskBg","$task_bg","$task_baselines","$task_links","$task_bars","$task_constraints","$task_deadlines","_tasks","linksAttr","bindLinks","linkLayers","_attachLayers","backgroundImage","data_els","_refreshScales","_scales","_getScaleChunkHtml","taskFilter","isTimedProject","expose","hide_bar","timedProjectBar","taskSplitBar","taskRollupBar","taskConstraints","taskDeadline","_linkLayers","_taskRenderer","_initStaticBackgroundRender","linkStore","linkRenderer","linkLayer","_linkRenderer","staticRender","staticBgContainer","$task_bg_static","staticBackgroundHeight","_render_tasks_scales","scales_html","outer_width","helpers","cfgs","fromPos","toPos","tplClass","_prepareScaleHtml","globalConfig","globalTemplates","helpers.findBinary","cssclass","floatConfig","sticky","labelPosition","approxLabelWidth","labelPos","translateValue","getTimelineCellAttr","_getColumnDuration","wholeCells","partCell","roundPos","_getNextVisibleColumn","visibleDateIndex","_getPrevVisibleColumn","_getClosestVisibleColumn","dateIndex","visibleIndex","transition","xLeft","xRight","displayStart","displayEnd","isMilestoneRender","_timelineCacheAttached","ResourceGrid","resourceStoreMixin","ResourceTimeline","resourceRow","ResourceHistogram","resourceHistogram","defaultMapping","isChanged","save","onShow","preventKeyNav","shouldPrevent","editPrevCell","editNextCell","onHide","keyNavMappings","onBlurDelay","keyNav","activeCell","editorState","hasEditor","editorType","anyModifier","BaseFactory","BaseEditor","set_value","get_input","get_value","is_changed","currentValue","is_valid","textEditorFactory","TextEditor","numberEditorFactory","NumberEditor","oninput","selectEditorFactory","SelectEditor","optionsHtml","dateEditorFactory","html5DateFormat","dateToStr","strToDate","DateEditor","minValue","maxValue","predecessorEditorFactory","PredecessorEditor","getFormatter","formatter","parseInputString","formatPredecessors","formatLinkKey","getLinksDiff","predecessorCodes","selectedLinks","existingLinksSearch","linksToAdd","linksToDelete","linksDiff","inputPredecessors","taskPredecessors","durationEditorFactory","linkedPropertiesProcessor","decreaseStartDate","initConfigs","number","keyboardMapping","mapping","setMapping","getMapping","eventBus","inlineEditController","createEditors","_createPlaceholder","inlineEditorAttr","updateTaskDateProperties","ganttHandlers","_itemId","_columnName","_editor","_editorType","_placeholder","setValue","getValue","_getItemValue","_findEditableCell","nextColumn","getNextCell","getFirstCell","getLastCell","canChangeRow","moveRow","nextItem","editNextRow","skipReadonly","editPrevRow","detachStore","isBarInViewport","createTaskRenderer","_task_default_render","controlsMargin","padd","milestoneHeight","milestoneWidth","done","pr","taskEditable","timelineDrag","markerPos","basic","link_from_start","link_target_id","link_landing_area","from_id","link_to_start","dragClass","progressColor","textColor","u","setProperty","_get_link_crossing_css","marginStyle","_render_side_content","setTaskBarAttr","_render_pair","outer","showLinkPoints","cond","ln","tp","marginLeft","marginRight","defaultRenderer","planned","plannedCoords","actual","actualCoords","opacity","isSplitTaskInViewport","getVisibleCellsRange","firstCellIndex","lastCellIndex","isColumnVisible","cellLeftCoord","cellRightCoord","bgPlaceholder","placeholderConfig","lastTaskId","placeholderTask","calendar_id","createLinkRender","drawer","current_pos","dirs","path","point","get_lines","line_to","get_path","line","_get_line","get_wrapper_sizes","wrapper_size","get_line_sizes","line_size","link_line_width","render_line","innerPos","render_corner","corner","radius","lineWidth","cornerDiv","borderVertical","borderHorizontal","arrow","get_direction","vect","path_builder","point_to","get_points","get_endpoint","xy","e_y","e_x","lineType","get_line_type","forward","getMilestonePosition","milestoneTask","siblingBaselines","shapes","lines","link_radius","arrowSize","nextLine","cornerX","cornerY","lastLine","arrowX","arrowY","shape","render_arrow","cssTemplate","linkAttr","createResourceTimelineBuilder","assignmentsPassed","timegrid","scaleUnit","scaleStep","precalculatedTimes","firstColumn","minScaleDate","currDate","cachedTimes","timetable","renderBar","renderConnection","prevLevel","nextLevel","generateRenderResourceHistogram","getResourceLoad","resourceTimetable","renderedHistogramCells","renderedHistogramRows","renderedHistogramCapacity","detachRenderedHistogramCell","renderedRow","renderCapacityElement","capacityMatrix","maxCapacity","renderedElement","capacityElement","colStart","colEnd","bar","connection","renderHistogramCell","fill","checkedColumns","renderedCell","areDatesInViewPort","dateProperties","checkTaskProperties","childProperties","isConstraintInViewPort","show_constraints","additional_properties","constraintNames","generateConstraintNode","constraintValue","constraintNodes","taskConstraint","childConstraint","isDeadlineInViewPort","isBaselineInViewPort","inViewport","iterateBaselines","rowDnd","checkPlaceholderTask","getStore","initial_open_state","$transparent","lastTaskOfLevel","last_item","_getGridPos","gridHeight","maxBottom","_getTargetY","scrollPos","_getTaskByY","dropIndex","gridDataSizes","reorderMarkerAttr","containerSize","targetY","allowedLevel","over","nextId","dropTarget","createDropTargetObject","targetId","nextSiblingTarget","dndTaskId","prevSiblingTarget","firstChildTarget","lastChildTarget","findClosesTarget","targetLevel","findTargetAbove","findTargetBelow","getSameLevelDropPosition","relTargetPos","eventTop","targetAbove","targetBelow","gridToPageCoordinates","gridPos","setWidthWithinContainer","higlighter","removeLineHighlight","markerLine","highlightPosition","ePos","markerFolder","folderHighlightWidth","linePos","indentNode","indent","iconWidth","childCount","markerLineTop","rowDndMarker","drop_target","getDropPosition","doctype","minTop","firstVisibleTaskIndex","firstVisibleTaskId","firstVisibleTaskPos","hiddenTaskPart","gridPosition","gridBottom","placeholderRowHeight","lockLevel","getLockedLevelTarget","initializer","onCreated","extendGantt","_inlineEditors","onInitialized","initEvents","extendDom","onDestroyed","clearEvents","notOpenIcon","showDate","sorting_method","taskDnD","createTaskDND","roundTaskDates","round_task_dates","dragMultiple","before_start","before_finish","after_finish","clear_drag_state","set_actions","drag_from_start","stage","_move","_resize","_resize_progress","on_mouse_move","on_mouse_down","on_mouse_up","start_x","start_y","coords_x","_drag_task_coords","minDurationInUnits","_calculateMinDuration","diffValue","_find_max_shift","dragItems","correctShift","minX","maxX","maxShift","minShift","multipleDragShift","new_start","new_end","obj_s_x","obj_e_x","_mouse_position_change","oldPos","newPos","_is_number","isFinite","start_drag","sX","sY","_start_dnd","_update_on_move","_update_item_on_move","curr_date","dragHash","_isMultiselect","dragProject","initialDrag","newStartPos","newEndPos","handle_offset","dragPos","dragX","childDrag","_get_drag_mode","_fix_dnd_scale_time","fixStart","_fix_working_times","_finalize_mouse_up","_fireEvent","_dhx_changed","finalizingBulkMove","moveCount","doFinalize","dragProperty","selectedTasksIds","selectedTask","_addSubtasksToDragMultiple","trigger","drag_state","summaryId","initLinksDND","_link_landing","_link_target_task","_link_target_task_start","_link_source_task","_link_source_task_start","getDndState","link_edge_marker","link_landing_hover_area","markerSize","viewportSize","ganttOffsetY","updateMarkedHtml","resetDndState","showDirectingLine","s_x","s_y","_direction","getDirectionLine","link_direction_class","tan","angle","atan","coordinateCircleQuarter","sin","cos","shiftLeft","shiftTop","eX","eY","_dir_start","landing","prevTarget","prevLanding","prevToStart","targ","absCoords","domHelpers.getRelativeNodePosition","_dir_end","targetChanged","linkDnD","_linksDnD","_tasksDnD","MouseDelegates","_attachDomEvents","_attachStateProvider","_clearDomEvents","_clearStateProvider","_delete_link_handler","coll","coll_date","scale_step","getVerticalScrollbar","getHorizontalScrollbar","_legacyGridResizerClass","gridResizer","mainTimeline","colsWidth","hideGrid","grid_limits","ganttContainerWidth","verticalScrollbarWidth","gridOverflow","original_grid_width","skinSettings","skins","_initScrollStateEvents","_getVerticalScrollbar","_findGridResizer","gridFirst","resizeInfo","initialWidth","prevCellWidth","nextCellWidth","viewCell","limits","newBehindSize","newFrontSize","oldBackSize","oldFrontSize","newBackSize","ui$1","attachInitializer","uiFactory","Resizer","Scrollbar","mainLayoutInitializer","mainTimelineInitializer","mainGridInitializer","layersEngine","createLayerFactory","previusSiblingContainer","defaultContainerSibling","addTaskLayer","rangeFunction","getVisibleTaskRange","_getTaskLayers","removeTaskLayer","addLinkLayer","getVisibleLinksRangeFactory","isLinkInViewport","_getLinkLayers","removeLinkLayer","gridEditorsFactory","layersApi","textValue","aria","gridAddButtonAttrString","justifyContent","center","gridCellAttrString","css_template","taskRowAttr","rowNode","cellNode","external_render","adapter","isElement","renderElement","renderedCells","isRendered","detachRenderedCell","getCellClassTemplate","getCellContentTemplate","renderOneCell","contentTemplate","cssTemplateContent","htmlTemplateContent","customCell","cellCssTemplate","cellHtmlTemplate","odd","placeholderTop","placeholderHeight","createBaseBarRender","renderedNodes","checkVisibility","generateChildElement","childCopy","$rendered_at","getKey","renderParentId","rollupKey","isInViewPortChild","isProject","milestoneChild","linkDragLeft","linkDragRight","offsetMargin","taskContent","shouldUseSplitRendering","splitKey","isInViewPortParent","renderConstraints","generateDeadlineNode","fontSize","deadlineNodes","childDeadline","generateBaselineNode","baselineEnd","milestoneMarginTop","baselineSubrowHeight","baselineBarHeight","siblingBaselinesSize","baselineNodes","taskBaseline","childBaseline","renderLink","renderedResourceLines","renderResourceLineCell","detachRenderedResourceLine","resourceHistogramRenderer","rowResizerAttr","layersService","_get_skin","themeVar","themeName","isCssVarTheme","href","_theme_info","theme","cssVarTheme","skinset","_second_column_width","_third_column_width","_lightbox_template","_redefine_lightbox_buttons","scrollRange","scrollDelay","scrollSpeed","isMove","delayTimeout","startPos","eventPos","isDisplayed","isScrollState","dragMarker","isResize","isLink","isClickDrag","defineDelayTimeout","speed","tick","autoscroll_delay","defineScrollInterval","autoscrollInterval","isScroll","gridDrag","need_scroll","currentScrollTop","scrollOuterHeight","scrollInnerHeight","currentScrollLeft","scrollOuterWidth","scrollInnerWidth","autoscroll_step","boxSize","$","jQuery","fn","dhx_gantt","each","newgantt","Gantt","getGanttInstance","jquery_hooks","dhtmlx","attaches","attachGantt","cmp","attachObject","dataType","dataObj","vs","border","gridId","gridObj","dhtmlXCellObject","dhtmlx_hooks","USE_KEY","_defaultScales","TimelineZoom","zoomIn","getCurrentLevel","setLevel","zoomOut","_levels","_activeLevelIndex","getLevels","zoomLevel","_getZoomIndexByName","levelName","_getVisibleDate","_visibleDate","cursorOffset","nextConfig","chartConfig","resourceView","resourceConfig","fixed_scales","cursorDate","newPosition","middleDate","_attachWheelEvent","_useKey","_handler","_defaultHandler","timelineOffset","wheelUp","stopPropagation","_setScaleSettings","_setScaleDates","_initialStartDate","_initialEndDate","activeLevelIndex","_mapScales","levels","_minColumnWidth","minColumnWidth","_maxColumnWidth","maxColumnWidth","_widthStep","widthStep","_stepUp","_stepDown","addTouchEvents","platform","maxTouchPoints","_touch_events","getTaskDND","tasksDnD","touch_feedback","touch_feedback_duration","vibrate","touchHandlers","names","dblclicktime","actionMode","scrollMode","actionStart","longTapTimer","currentDndId","dndNodes","targetView","multiTouchEvents","newScrollState","block_action","allViews","_locate_css","taskNode","dummy","BaseControl","BaseConstrutor","htmlHelpers","getHtmlSelect","_attributes","getHtmlOption","_getHtmlContainer","getHtmlButton","getHtmlDiv","getHtmlLabel","getHtmlInput","_getHtmlAttributes","SelectControlConstructor","Super","SelectControl","sns","_dhx_onchange","onchange","_focus","DurationFormatterNumeric","_Pa","ParentControlConstructor","ParentControl","_display","allow_root","root_label","form_blocks","tmpDom","newOptions","onselect","ResourcesControlConstructor","localCache","resourcesValues","eventsInitialized","ResourcesControl","_getAmountInput","disabled","_getInputElementSelector","isChecked","_getResourcesElement","_getFilterCache","checkbox","checked","filterApplied","resourceFilterPlaceholder","filter_placeholder","resourceFilterLabel","resourcesElement","htmlResourceRow","_applyFilter","resultSns","hideUnsetted","_saveValues","filterCache","getLightboxValues","controlConfig","comparison","resultConfig","cachedValue","helpers.arrayFind","itemIds","_resourceChangeListener","valueInput","resId","defaultValue","default_value","originalAssignmentId","wait","unassigned_value","searchResult","zoom","_offsetSizes","_center_lightbox","amountElement","selectorAdd","selectorSub","settedValuesHash","itemsAdd","itemsSub","originalId","amount","TemplateControl","TemplateControlConstructor","TextareaControl","_get_input","TimeControl","getTimePicker","sectionClassName","_time_format_order","auto_end_date","_update_lightbox_select","_fill_lightbox_select","_resolve_default_mapping","selects","getTimePickerValue","autofix_end","_get_timepicker_step","CheckboxControl","single_value","checkboxes","resArray","RadioControl","radio","DurationControl","_getStartDate","_getDuration","singleDate","lightboxDurationInputAttrString","durationInputClass","duration_val","inps","btns","endspan","_calc_date","_change_duration","charCode","ConstraintControl","isNonTimedConstraint","toggleTimeSelect","timeSelects","typeValue","isNonTimed","typeSelect","_eventsInitialized","TypeselectControl","typeKey","oldOnChange","_lightbox_current_type","BaselineControl","_generateBaselineRow","durationLabel","deleteLabel","durationEl","deleteButton","baselineRow","section","baselineNode","baselineId","dataset","updatedBaseline","button_click","_get_typed_lightbox_config","_lightbox_methods","_lightbox_root","showCover","_fill_lightbox","_setLbPosition","lightboxVisibleAttr","getLabel","list_name","_lightbox_type","lightboxDiv","fullWidth","ds","classNames","cspEnvironment","salesforceEnvironment","setParentNode","_lightbox","_is_lightbox_timepicker","wide_form","getHtmlButtons","lightboxAttr","onmousedown","_ready_to_dnd","ontouchstart","onselectstart","cursor","_init_dnd_events","show_cover","_cover","_render_sections","backup_overflow","labelBlock","inputBlock","inputId","_init_lightbox_events","block","rootElement","_move_while_dnd","_finish_dnd","_get_type_name","type_value","floatRight","lightboxButtonAttrString","getTimeFormat","time_format","getHtmlTimePickerOptions","start_year","end_year","tdate","timeFormat","year_range","_time_values","lightbox_events","_save_lightbox","_cancel_lightbox","sec","buttonTarget","time_optional","duration_optional","lightboxHiddenAttr","hideCover","_custom_lightbox","_set_lightbox_values","lightboxHeader","lightbox_header","getLightboxSection","get_template_control","control","get_select_control","get_textarea_control","get_time_control","_dnd_start_lb","gantt_unselectable","lb","_lb_start","ariaAttrs","limit_time_select","first_hour","last_hour","lightboxSelectAttrString","mapOffset","typeselect","oldType","ui","codeHelpers.arrayFind","domEventScope","uiApi","getTimeline","getGrid","getBaseCell","baseCell","getAttachedScrollbar","attachedScrollbar","DEFAULT_VALUE","tryCall","getTaskTop","getTaskBarHeight","domAttr","getLinkNode","oldH","oldV","verticalViews","horizontalViews","commonViews","viewId","newV","newH","date_x","scroll_to","_scroll_state","gridCell","timelineCell","scrollVer","scrollHor","horState","verState","cellName","horizontalScroll","verticalScroll","resetSkin","monitorThemeChange","_addThemeClass","setSkin","monitorIntervalId","csstheme","skyblue","lightbox_additional_height","dark","meadow","terrace","broadway","_config_buttons_left","_config_buttons_right","material","indx","_extend_to_optional","lightbox_block","optional_time","update_block","button_text","htmlTags","extraSpaces","stripHTMLLite","htmlText","singleQuotes","escapeQuotes","getAttributeString","_taskCommonAttr","linkTypes","toStart","fromStart","buttonName","role","tabindex","headerText","time_option","buttonLabel","targetAttribute","_locateHTML","firstTask","domHelpers.getScrollSize","availablePlugins","dynamicLoading","loadedBranches","oldHasChildren","_load_url","requestData","_load_type","cl"],"mappings":"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","x_google_ignoreList":[64]}